<?xml version="1.0" encoding="UTF-8"?>
<task id="073" project="ai-scope-resolution-enhancements">
  <metadata>
    <title>User Testing: Outlook Add-in Document Save</title>
    <phase>7</phase>
    <tags>testing, user-testing, manual, outlook</tags>
    <estimate>1-2 hours</estimate>
    <dependencies>070</dependencies>
    <parallel-group>C</parallel-group>
  </metadata>

  <prompt>
    <goal>
      Manually test Outlook add-in document save and verify AI analysis completes.
    </goal>
    <context>
      This is the PRIMARY test flow since it exercises AppOnlyDocumentAnalysis job type.

      Test flow:
      1. Open Outlook with add-in installed
      2. Select an email
      3. Use add-in to save email as document
      4. Wait for processing (UploadFinalizationWorker â†’ ProfileSummaryWorker)
      5. Verify sprk_analysis record created
      6. Check tool results populated
    </context>
    <constraints>
      - Use dev environment
      - This tests the exact flow that was failing with NoHandler error
      - Critical validation step
    </constraints>
  </prompt>

  <knowledge>
    <files>
      <file>projects/ai-scope-resolution-enhancements/spec.md</file>
    </files>
  </knowledge>

  <steps>
    <step order="1">Open Outlook with add-in</step>
    <step order="2">Select test email with attachments if possible</step>
    <step order="3">Click "Save to Spaarke" (or equivalent)</step>
    <step order="4">Monitor for processing completion</step>
    <step order="5">Check Service Bus dead-letter queue (should have NO new NoHandler errors)</step>
    <step order="6">Verify sprk_analysis record in Dataverse</step>
    <step order="7">Verify tool results populated</step>
    <step order="8">Document results with screenshots</step>
  </steps>

  <tools>
    <tool>Manual testing in Outlook</tool>
    <tool>Write - Document results</tool>
  </tools>

  <outputs>
    <output>Test results documentation with screenshots</output>
    <output>Confirmation NoHandler error resolved</output>
  </outputs>

  <acceptance-criteria>
    <criterion>Email saved successfully via add-in</criterion>
    <criterion>NO NoHandler dead-letter errors</criterion>
    <criterion>sprk_analysis record created</criterion>
    <criterion>Tool results populated correctly</criterion>
  </acceptance-criteria>
</task>
