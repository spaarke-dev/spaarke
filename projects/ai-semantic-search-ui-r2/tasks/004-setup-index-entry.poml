<?xml version="1.0" encoding="utf-8"?>
<task id="004" status="completed">
  <title>Set up index.ts entry point</title>
  <description>
    Implement the PCF control entry point using React 16 render pattern (ReactDOM.render, NOT createRoot).
    This is the main integration point between PCF lifecycle and React components.
  </description>
  <phase>1</phase>
  <phase-name>Project Setup &amp; Foundation</phase-name>
  <tags>pcf, react, entry-point</tags>
  <dependencies>001</dependencies>
  <parallel-group>none</parallel-group>
  <parallel-safe>false</parallel-safe>

  <constraints>
    <constraint source="ADR-022">MUST use ReactDOM.render (React 16 API)</constraint>
    <constraint source="ADR-022">MUST NOT use createRoot (React 18 API)</constraint>
    <constraint source="ADR-021">MUST wrap in FluentProvider</constraint>
  </constraints>

  <knowledge-files>
    <file>.claude/patterns/pcf/control-initialization.md</file>
    <file>.claude/adr/ADR-022-pcf-platform-libraries.md</file>
  </knowledge-files>

  <reference-implementations>
    <reference>src/client/pcf/DocumentRelationshipViewer/DocumentRelationshipViewer/index.ts</reference>
  </reference-implementations>

  <steps>
    <step order="1">Open index.ts (generated by PAC)</step>
    <step order="2">Import React and ReactDOM (NOT react-dom/client)</step>
    <step order="3">Implement init() to store container reference</step>
    <step order="4">Implement updateView() to call renderComponent()</step>
    <step order="5">Implement destroy() with ReactDOM.unmountComponentAtNode()</step>
    <step order="6">Create renderComponent() using ReactDOM.render()</step>
    <step order="7">Wrap component in FluentProvider with theme</step>
    <step order="8">Extract properties from context and pass to component</step>
  </steps>

  <acceptance-criteria>
    <criterion>index.ts uses ReactDOM.render (not createRoot)</criterion>
    <criterion>destroy() properly unmounts component</criterion>
    <criterion>FluentProvider wraps the root component</criterion>
    <criterion>Control renders placeholder content</criterion>
  </acceptance-criteria>
</task>
