{
  "description": "Playbook seed data for AI Document Intelligence R4",
  "created": "2026-01-05",
  "entity": "sprk_analysisplaybooks",

  "note": "MVP Playbooks - Implement first for initial release",

  "playbooks": [
    {
      "id": "PB-001",
      "sprk_name": "Quick Document Review",
      "sprk_description": "Rapid document triage with classification, entity extraction, and executive summary. Ideal for initial review of any document type to understand key information quickly.",
      "sprk_ispublic": true,
      "estimatedTime": "~30 seconds",
      "complexity": "Low",
      "scopes": {
        "skills": ["SKL-008"],
        "actions": ["ACT-001", "ACT-003", "ACT-004"],
        "knowledge": ["KNW-005"],
        "tools": ["TL-001", "TL-003", "TL-004"]
      },
      "scopeDescriptions": {
        "skills": {
          "SKL-008": "Executive Summary - High-level overview generation"
        },
        "actions": {
          "ACT-001": "Extract Entities - Named entity extraction",
          "ACT-003": "Classify Document - Document type classification",
          "ACT-004": "Summarize Content - Content summarization"
        },
        "knowledge": {
          "KNW-005": "Defined Terms - Standard legal definitions"
        },
        "tools": {
          "TL-001": "Entity Extractor - Extract parties, dates, amounts",
          "TL-003": "Document Classifier - Classify document type",
          "TL-004": "Summary Generator - Generate concise summary"
        }
      }
    },
    {
      "id": "PB-002",
      "sprk_name": "Full Contract Analysis",
      "sprk_description": "Comprehensive contract review including clause analysis, risk detection, entity extraction, and comparison against standard terms. Complete analysis for contract review workflows.",
      "sprk_ispublic": true,
      "estimatedTime": "~3 minutes",
      "complexity": "High",
      "scopes": {
        "skills": ["SKL-001", "SKL-009", "SKL-010"],
        "actions": ["ACT-001", "ACT-002", "ACT-003", "ACT-004", "ACT-005", "ACT-006"],
        "knowledge": ["KNW-001", "KNW-003", "KNW-004"],
        "tools": ["TL-001", "TL-002", "TL-003", "TL-004", "TL-005", "TL-006"]
      },
      "scopeDescriptions": {
        "skills": {
          "SKL-001": "Contract Analysis - Comprehensive contract examination",
          "SKL-009": "Risk Assessment - Risk identification and categorization",
          "SKL-010": "Clause Comparison - Compare against standards"
        },
        "actions": {
          "ACT-001": "Extract Entities - Named entity extraction",
          "ACT-002": "Analyze Clauses - Contract clause analysis",
          "ACT-003": "Classify Document - Document type classification",
          "ACT-004": "Summarize Content - Content summarization",
          "ACT-005": "Detect Risks - Risk identification",
          "ACT-006": "Compare Clauses - Clause comparison against standards"
        },
        "knowledge": {
          "KNW-001": "Standard Contract Terms - Industry-standard contract clauses",
          "KNW-003": "Best Practices - Contract review best practices",
          "KNW-004": "Risk Categories - Risk taxonomy for assessment"
        },
        "tools": {
          "TL-001": "Entity Extractor - Extract parties, dates, amounts",
          "TL-002": "Clause Analyzer - Identify and analyze clauses",
          "TL-003": "Document Classifier - Classify document type",
          "TL-004": "Summary Generator - Generate concise summary",
          "TL-005": "Risk Detector - Identify potential risks",
          "TL-006": "Clause Comparator - Compare to standard terms"
        }
      }
    },
    {
      "id": "PB-011",
      "sprk_name": "Document Profile",
      "sprk_description": "Auto-generated document profile on upload. Generates TL;DR, summary, keywords, document type classification, and entity extraction for immediate document insight.",
      "sprk_ispublic": true,
      "estimatedTime": "~20 seconds",
      "complexity": "Low",
      "isSystemPlaybook": true,
      "triggerContext": "document-upload",
      "scopes": {
        "skills": ["SKL-008"],
        "actions": ["ACT-001", "ACT-003", "ACT-004"],
        "knowledge": ["KNW-005"],
        "tools": ["TL-001", "TL-003", "TL-004"]
      },
      "scopeDescriptions": {
        "skills": {
          "SKL-008": "Executive Summary - High-level overview generation"
        },
        "actions": {
          "ACT-001": "Extract Entities - Named entity extraction (parties, dates, amounts)",
          "ACT-003": "Classify Document - Document type classification",
          "ACT-004": "Summarize Content - Generate TL;DR and summary"
        },
        "knowledge": {
          "KNW-005": "Defined Terms - Standard legal definitions"
        },
        "tools": {
          "TL-001": "Entity Extractor - Extract parties, dates, amounts",
          "TL-003": "Document Classifier - Classify document type",
          "TL-004": "Summary Generator - Generate TL;DR and summary"
        }
      },
      "outputMapping": {
        "tldr": "sprk_document.sprk_tldr",
        "summary": "sprk_document.sprk_summary",
        "keywords": "sprk_document.sprk_keywords",
        "documentType": "sprk_document.sprk_documenttype",
        "entities": "sprk_document.sprk_entities"
      }
    },
    {
      "id": "PB-010",
      "sprk_name": "Risk Scan",
      "sprk_description": "Fast risk identification focused on legal, financial, operational, and compliance risks. Ideal for quick risk assessment before detailed review.",
      "sprk_ispublic": true,
      "estimatedTime": "~45 seconds",
      "complexity": "Low",
      "scopes": {
        "skills": ["SKL-009"],
        "actions": ["ACT-001", "ACT-005"],
        "knowledge": ["KNW-004"],
        "tools": ["TL-001", "TL-005"]
      },
      "scopeDescriptions": {
        "skills": {
          "SKL-009": "Risk Assessment - Risk identification and categorization"
        },
        "actions": {
          "ACT-001": "Extract Entities - Named entity extraction for context",
          "ACT-005": "Detect Risks - Risk identification"
        },
        "knowledge": {
          "KNW-004": "Risk Categories - Risk taxonomy for assessment"
        },
        "tools": {
          "TL-001": "Entity Extractor - Extract parties, dates, amounts for context",
          "TL-005": "Risk Detector - Identify potential risks"
        }
      }
    },
    {
      "id": "PB-012",
      "sprk_name": "Email Analysis",
      "sprk_description": "Comprehensive email analysis combining email metadata, body text, and attachment contents. Generates TL;DR, summary, keywords, entities, and classification for email-to-document automation workflows.",
      "sprk_ispublic": true,
      "estimatedTime": "~30 seconds",
      "complexity": "Low",
      "isSystemPlaybook": true,
      "triggerContext": "email-to-document",
      "scopes": {
        "skills": ["SKL-008"],
        "actions": ["ACT-001", "ACT-003", "ACT-004"],
        "knowledge": ["KNW-005"],
        "tools": ["TL-001", "TL-003", "TL-004"]
      },
      "scopeDescriptions": {
        "skills": {
          "SKL-008": "Executive Summary - High-level overview generation"
        },
        "actions": {
          "ACT-001": "Extract Entities - Named entity extraction (parties, organizations, dates, amounts)",
          "ACT-003": "Classify Document - Email type classification (correspondence, notification, request)",
          "ACT-004": "Summarize Content - Generate TL;DR and summary from combined email+attachments"
        },
        "knowledge": {
          "KNW-005": "Defined Terms - Standard definitions"
        },
        "tools": {
          "TL-001": "Entity Extractor - Extract parties, organizations, dates, amounts from email context",
          "TL-003": "Document Classifier - Classify email type and purpose",
          "TL-004": "Summary Generator - Generate TL;DR and summary from email+attachments"
        }
      },
      "inputFormat": {
        "description": "Combined text input constructed by EmailAnalysisService",
        "structure": [
          "===== EMAIL METADATA =====",
          "Subject: {subject}",
          "From: {sender}",
          "To: {recipients}",
          "CC: {cc_recipients}",
          "Date: {sent_date}",
          "",
          "===== EMAIL BODY =====",
          "{email_body_text}",
          "",
          "===== ATTACHMENT: {filename} =====",
          "{attachment_extracted_text}",
          "(repeated for each attachment)"
        ],
        "maxInputSize": "100KB combined text"
      },
      "outputMapping": {
        "tldr": "email.sprk_tldr or sprk_document.sprk_tldr",
        "summary": "email.sprk_summary or sprk_document.sprk_summary",
        "keywords": "email.sprk_keywords or sprk_document.sprk_keywords",
        "documentType": "email.sprk_documenttype or sprk_document.sprk_documenttype",
        "entities": "email.sprk_entities or sprk_document.sprk_entities"
      },
      "notes": [
        "Uses same tools as Document Profile but with email-structured input",
        "EmailAnalysisService prepends email metadata to extracted text",
        "Attachment contents are concatenated with section headers",
        "Output fields updated on both email entity and associated documents"
      ]
    },
    {
      "id": "PB-013",
      "sprk_name": "Finance Invoice Processing",
      "sprk_description": "AI-powered invoice processing for legal matters. Extracts invoice header and line item data, generates AI summary, and updates Matter financials with total spend tracking. Designed for Finance Intelligence Module R1 MVP.",
      "sprk_ispublic": true,
      "estimatedTime": "~45 seconds",
      "complexity": "Medium",
      "isSystemPlaybook": true,
      "triggerContext": "finance-invoice-processing",
      "scopes": {
        "skills": ["SKL-002"],
        "actions": ["ACT-001", "ACT-008"],
        "knowledge": [],
        "tools": ["TL-009", "TL-011"]
      },
      "scopeDescriptions": {
        "skills": {
          "SKL-002": "Invoice Processing - Extract and validate invoice data systematically"
        },
        "actions": {
          "ACT-001": "Extract Entities - Named entity extraction for vendor, amounts, dates",
          "ACT-008": "Calculate Values - Validate monetary amounts and line item calculations"
        },
        "knowledge": {},
        "tools": {
          "TL-009": "Invoice Extraction Tool - AI-powered invoice data extraction with structured output",
          "TL-011": "Financial Calculation Tool - Calculate matter-level financial aggregations"
        }
      },
      "workflow": {
        "description": "Extract invoice data → Calculate matter totals → Apply outputMapping to update records",
        "steps": [
          {
            "order": 1,
            "tool": "TL-009",
            "description": "Extract invoice header and line items using AI",
            "outputVariable": "extraction"
          },
          {
            "order": 2,
            "tool": "TL-011",
            "description": "Calculate matter financial totals",
            "inputVariables": {
              "invoiceAmount": "${extraction.totalAmount}",
              "matterId": "${context.matterId}"
            },
            "outputVariable": "calculation"
          }
        ],
        "notes": "OutputOrchestrator applies outputMapping after tools complete"
      },
      "outputMapping": {
        "updates": [
          {
            "entityType": "sprk_invoice",
            "recordIdSource": "${context.invoiceId}",
            "fields": {
              "sprk_aisummary": "${extraction.aiSummary}",
              "sprk_extractedjson": "${extraction.extractedJson}",
              "sprk_totalamount": {
                "type": "Money",
                "value": "${extraction.totalAmount}",
                "currency": "USD"
              },
              "sprk_invoicenumber": "${extraction.invoiceNumber}",
              "sprk_invoicedate": "${extraction.invoiceDate}",
              "sprk_extractionstatus": 100000001
            }
          },
          {
            "entityType": "sprk_matter",
            "recordIdSource": "${context.matterId}",
            "fields": {
              "sprk_totalspendtodate": {
                "type": "Money",
                "value": "${calculation.totalSpend}"
              },
              "sprk_invoicecount": "${calculation.invoiceCount}",
              "sprk_remainingbudget": {
                "type": "Money",
                "value": "${calculation.remainingBudget}"
              }
            },
            "concurrencyMode": "optimistic",
            "retryOnConflict": true,
            "maxRetries": 3
          }
        ]
      },
      "notes": [
        "MVP implementation uses simplified architecture - no BillingEvents or SpendSnapshots",
        "Invoice data stored as JSON on invoice record (sprk_extractedjson)",
        "Matter totals denormalized and stored on matter record",
        "OutputMapping processed by OutputOrchestratorService - enables BA configuration without code deployment",
        "Matter updates use optimistic concurrency to prevent lost updates from concurrent invoices",
        "Variable resolution: context.* (job payload), extraction.* (TL-009 output), calculation.* (TL-011 output)",
        "Supports 3 UI scenarios: Matter Overview metrics, Invoice tab list, Invoice tab metrics",
        "Tool handlers registered in FinanceModule.cs DI configuration"
      ]
    }
  ],

  "futurePlaybooks": [
    {
      "id": "PB-003",
      "sprk_name": "NDA Review",
      "sprk_description": "Specialized analysis for Non-Disclosure Agreements",
      "priority": 2
    },
    {
      "id": "PB-004",
      "sprk_name": "Lease Review",
      "sprk_description": "Commercial lease analysis with financial calculations",
      "priority": 2
    },
    {
      "id": "PB-005",
      "sprk_name": "Employment Agreement Review",
      "sprk_description": "Employment contract analysis with compensation review",
      "priority": 2
    },
    {
      "id": "PB-006",
      "sprk_name": "Invoice Processing",
      "sprk_description": "Invoice data extraction and validation (superseded by PB-013 Finance Invoice Processing for Finance Module R1 MVP)",
      "priority": 3,
      "status": "Superseded by PB-013"
    },
    {
      "id": "PB-007",
      "sprk_name": "SLA Analysis",
      "sprk_description": "Service Level Agreement metric extraction and benchmarking",
      "priority": 3
    },
    {
      "id": "PB-008",
      "sprk_name": "Compliance Check",
      "sprk_description": "Regulatory compliance review",
      "priority": 3
    }
  ],

  "deploymentNotes": {
    "requirements": [
      "Seed data for Actions, Tools, Knowledge, and Skills must be deployed first",
      "Use PlaybookService.CreatePlaybookAsync() to create records",
      "N:N relationships are created via AssociateRelationshipsAsync()"
    ],
    "deployment_order": [
      "1. Deploy type-lookups.json",
      "2. Deploy actions.json",
      "3. Deploy tools.json",
      "4. Deploy knowledge.json",
      "5. Deploy skills.json",
      "6. Deploy playbooks.json (this file)",
      "7. Deploy output-types.json (for Document Profile)"
    ]
  }
}
