/*! For license information please see bundle.js.LICENSE.txt */
var pcf_tools_652ac3f36e1e4bca82eb3c1dc44e6fad;(()=>{"use strict";var e={d:(t,n)=>{for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})}};e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),e.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var t={};e.r(t),e.d(t,{DueDatesWidget:()=>Fe});const n=Reactv16,r=ReactDOMv16,o=FluentUIReactv940;var a="undefined"==typeof window?e.g:window,i="@griffel/";function l(e,t){return a[Symbol.for(i+e)]||(a[Symbol.for(i+e)]=t),a[Symbol.for(i+e)]}var c=l("DEFINITION_LOOKUP_TABLE",{}),s="data-make-styles-bucket";function u(e,t){return"___"+function(e){var t=e.length;if(7===t)return e;for(var n=t;n<7;n++)e+="0";return e}(function(e){for(var t,n=0,r=0,o=e.length;o>=4;++r,o-=4)t=1540483477*(65535&(t=255&e.charCodeAt(r)|(255&e.charCodeAt(++r))<<8|(255&e.charCodeAt(++r))<<16|(255&e.charCodeAt(++r))<<24))+(59797*(t>>>16)<<16),n=1540483477*(65535&(t^=t>>>24))+(59797*(t>>>16)<<16)^1540483477*(65535&n)+(59797*(n>>>16)<<16);switch(o){case 3:n^=(255&e.charCodeAt(r+2))<<16;case 2:n^=(255&e.charCodeAt(r+1))<<8;case 1:n=1540483477*(65535&(n^=255&e.charCodeAt(r)))+(59797*(n>>>16)<<16)}return(((n=1540483477*(65535&(n^=n>>>13))+(59797*(n>>>16)<<16))^n>>>15)>>>0).toString(36)}(e+t))}function d(e,t){var n="",r="";for(var o in e){var a=e[o];if(0!==a){var i=Array.isArray(a),l="rtl"===t?(i?a[1]:a)+" ":(i?a[0]:a)+" ";n+=l,r+=l}else r+=o+" "}return[n.slice(0,-1),r.slice(0,-1)]}function g(e,t){var n={};for(var r in e){var[o,a]=d(e[r],t);if(""!==a){var i=u(a,t),l=i+(""===o?"":" "+o);c[i]=[e[r],t],n[r]=l}else n[r]=""}return n}var v={};function m(){for(var e=arguments,t=null,n="",r="",o=new Array(arguments.length),a=function(){var t=e[i];if("string"==typeof t&&""!==t){var a=t.indexOf("___");if(-1===a)n+=t+" ";else{var l=t.substr(a,10);a>0&&(n+=t.slice(0,a)),r+=l,o[i]=l}}},i=0;i<arguments.length;i++)a();if(""===r)return n.slice(0,-1);var l=v[r];if(void 0!==l)return n+l;for(var s=[],g=0;g<arguments.length;g++){var m=o[g];if(m){var f=c[m];f&&(s.push(f[0]),t=f[1])}}var p=Object.assign.apply(Object,[{}].concat(s)),[h,y]=d(p,t),k=u(y,t),b=k+" "+h;return v[r]=b,c[k]=[p,t],n+b}var f=n.createContext(void 0),p={},h=(f.Provider,()=>{var e={};return function(t,n){void 0===e[t.id]&&(t.insertCSSRules(n),e[t.id]=!0)}}),y=n.useInsertionEffect?n.useInsertionEffect:void 0,k=()=>{var e={};return function(t,n){y&&"undefined"!=typeof window&&window.document&&window.document.createElement?y(()=>{t.insertCSSRules(n)},[t,n]):void 0===e[t.id]&&(t.insertCSSRules(n),e[t.id]=!0)}};function b(e){return Array.isArray(e)?e:[e]}var S=["r","d","l","v","w","f","i","h","a","s","k","t","m","c"].reduce((e,t,n)=>(e[t]=n,e),{});function w(e,t,n,r){var o,a,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},l="m"===e,c=null!==(o=i.m)&&void 0!==o?o:"0",u=null!==(a=i.p)&&void 0!==a?a:0,d=function(e,t,n){return("m"===e?e+t:e)+n}(e,c,u);if(!r.stylesheets[d]){var g=t&&t.createElement("style"),v=function(e,t,n,r){var o=[];if(r[s]=t,r["data-priority"]=String(n),e)for(var a in r)e.setAttribute(a,r[a]);return{elementAttributes:r,insertRule:function(t){return(null==e?void 0:e.sheet)?e.sheet.insertRule(t,e.sheet.cssRules.length):o.push(t)},element:e,bucketName:t,cssRules:()=>(null==e?void 0:e.sheet)?Array.from(e.sheet.cssRules).map(e=>e.cssText):o}}(g,e,u,Object.assign({},r.styleElementAttributes,l&&{media:c}));r.stylesheets[d]=v,(null==t?void 0:t.head)&&g&&t.head.insertBefore(g,function(e,t,n,r){var o,a,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},l=S[n],c=null!==(o=i.m)&&void 0!==o?o:"",u=null!==(a=i.p)&&void 0!==a?a:0,d=e=>l-S[e.getAttribute(s)],g=e.head.querySelectorAll("[".concat(s,"]"));if("m"===n){var v=e.head.querySelectorAll("[".concat(s,'="').concat(n,'"]'));v.length&&(g=v,d=e=>r.compareMediaQueries(c,e.media))}for(var m=e=>function(e,t,n){var r,o;return t+(null!==(r=n.m)&&void 0!==r?r:"")===e.getAttribute(s)+(null!==(o=e.media)&&void 0!==o?o:"")}(e,n,i)?u-Number(e.getAttribute("data-priority")):d(e),f=g.length,p=f-1;p>=0;){var h=g.item(p);if(m(h)>0)return h.nextSibling;p--}return f>0?g.item(0):t?t.nextSibling:null}(t,n,e,r,i))}return r.stylesheets[d]}function N(e,t){try{e.insertRule(t)}catch(e){}}":(".concat(["-moz-placeholder","-moz-focus-inner","-moz-focusring","-ms-input-placeholder","-moz-read-write","-moz-read-only"].join("|"),")");var x=0,E=(e,t)=>e<t?-1:e>t?1:0;function C(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"undefined"==typeof document?void 0:document,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{classNameHashSalt:n,unstable_filterCSSRule:r,insertionPoint:o,styleElementAttributes:a,compareMediaQueries:i=E}=t,l={classNameHashSalt:n,insertionCache:{},stylesheets:{},styleElementAttributes:Object.freeze(a),compareMediaQueries:i,id:"d".concat(x++),insertCSSRules(t){for(var n in t)for(var a=t[n],i=0,c=a.length;i<c;i++){var[s,u]=b(a[i]),d=w(n,e,o||null,l,u);l.insertionCache[s]||(l.insertionCache[s]=n,r?r(s)&&N(d,s):N(d,s))}}};return l}var D=n.createContext(C()),O=n.createContext("ltr");function T(e,t){var r=function(e,t){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:h)(),r=null,o=null;return function(a){var{dir:i,renderer:l}=a,c="ltr"===i;return c?null===r&&(r=g(e,i)):null===o&&(o=g(e,i)),n(l,t),c?r:o}}(e,t,k);return function(){var e=n.useContext(O),t=n.useContext(D);return r({dir:e,renderer:t})}}var P=T({root:{mc9l5x:"f1w7gpdv",Bg96gwp:"fez10in"},rtl:{Bz10aip:"f13rod7r"}},{d:[".f1w7gpdv{display:inline;}",".fez10in{line-height:0;}",".f13rod7r{transform:scaleX(-1);}"]}),R=["filled","title","primaryFill"];function I(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function j(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?I(Object(n),!0).forEach(function(t){B(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):I(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function B(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var z=T({root:{B8gzw0y:"f1dd5bof"}},{m:[["@media (forced-colors: active){.f1dd5bof{forced-color-adjust:auto;}}",{m:"(forced-colors: active)"}]]});function A(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function F(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?A(Object(n),!0).forEach(function(t){_(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):A(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function _(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var M=(e,t,r,o)=>{var a="1em"===t?"20":t,i=n.forwardRef((e,i)=>{var l=z(),c=((e,t)=>{var r,{filled:o,title:a,primaryFill:i="currentColor"}=e,l=j(j({},function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,R)),{},{fill:i}),c=P(),s=null!=(r=n.useContext(f))?r:p;return l.className=m(c.root,(null==t?void 0:t.flipInRtl)&&"rtl"===(null==s?void 0:s.textDirection)&&c.rtl,l.className),a&&(l["aria-label"]=a),l["aria-label"]||l["aria-labelledby"]?l.role="img":l["aria-hidden"]=!0,l})(e,{flipInRtl:null==o?void 0:o.flipInRtl}),s=F(F({},c),{},{className:m("fui-Icon",c.className,l.root),ref:i,width:t,height:t,viewBox:"0 0 ".concat(a," ").concat(a),xmlns:"http://www.w3.org/2000/svg"});return"string"==typeof r?n.createElement("svg",F(F({},s),{},{dangerouslySetInnerHTML:{__html:r}})):n.createElement("svg",s,...r.map(e=>n.createElement("path",{d:e,fill:s.fill})))});return i.displayName=e,i},V=M("Calendar20Regular","20",["M7 11a1 1 0 1 0 0-2 1 1 0 0 0 0 2Zm1 2a1 1 0 1 1-2 0 1 1 0 0 1 2 0Zm2-2a1 1 0 1 0 0-2 1 1 0 0 0 0 2Zm1 2a1 1 0 1 1-2 0 1 1 0 0 1 2 0Zm2-2a1 1 0 1 0 0-2 1 1 0 0 0 0 2Zm4-5.5A2.5 2.5 0 0 0 14.5 3h-9A2.5 2.5 0 0 0 3 5.5v9A2.5 2.5 0 0 0 5.5 17h9a2.5 2.5 0 0 0 2.5-2.5v-9ZM4 7h12v7.5c0 .83-.67 1.5-1.5 1.5h-9A1.5 1.5 0 0 1 4 14.5V7Zm1.5-3h9c.83 0 1.5.67 1.5 1.5V6H4v-.5C4 4.67 4.67 4 5.5 4Z"],{flipInRtl:!0}),L={entityName:"sprk_event",entitySetName:"sprk_events",fields:{eventId:"sprk_eventid",eventName:"sprk_eventname",dueDate:"sprk_duedate",baseDate:"sprk_basedate",finalDueDate:"sprk_finalduedate",eventStatus:"sprk_eventstatus",stateCode:"statecode",statusCode:"statuscode",priority:"sprk_priority",eventType:"sprk_eventtype",eventTypeName:"_sprk_eventtype_value",owner:"ownerid",ownerName:"_ownerid_value",regardingRecordType:"sprk_regardingrecordtype",regardingRecordName:"sprk_regardingrecordname",regardingRecordId:"sprk_regardingrecordid",createdOn:"createdon",modifiedOn:"modifiedon"}},W=0,H=1,U=2,X=3,Z=4,G=5,q=6,Y=7,$=[W,H,Z];function K(){var e=new Date;return e.setUTCHours(0,0,0,0),e}function Q(e){var t=K();return t.setUTCDate(t.getUTCDate()+e),t.setUTCHours(23,59,59,999),t}function J(e){return e.toISOString()}var ee={[W]:"Draft",[H]:"Open",[U]:"Completed",[X]:"Closed",[Z]:"On Hold",[G]:"Cancelled",[q]:"Reassigned",[Y]:"Archived"};function te(e){var t,n;if(!e.sprk_duedate)return null;var r=new Date(e.sprk_duedate),o=function(e){var t=K(),n=new Date(e);n.setUTCHours(0,0,0,0);var r=n.getTime()-t.getTime();return Math.ceil(r/864e5)}(r),a=o<0,i=null!==(n=null!==(t=e.sprk_eventstatus)&&void 0!==t?t:e.statuscode)&&void 0!==n?n:H,l=e["sprk_eventstatus@OData.Community.Display.V1.FormattedValue"]||e["statuscode@OData.Community.Display.V1.FormattedValue"]||function(e){var t;return null!==(t=ee[e])&&void 0!==t?t:"Unknown"}(i);return{id:e.sprk_eventid,name:e.sprk_eventname||"(Unnamed Event)",dueDate:r,eventType:e._sprk_eventtype_value||"",eventTypeName:e["_sprk_eventtype_value@OData.Community.Display.V1.FormattedValue"]||"Event",eventStatus:i,statusName:l,priority:e.sprk_priority,ownerId:e._ownerid_value,ownerName:e["_ownerid_value@OData.Community.Display.V1.FormattedValue"],isOverdue:a,daysUntilDue:o}}function ne(e,t){return n=this,r=void 0,a=function*(){var n,r=function(e){var{parentRecordId:t,daysAhead:n,maxItems:r,includeOverdue:o=!0}=e,a=L,i=K(),l=Q(n),c=[a.fields.eventId,a.fields.eventName,a.fields.dueDate,a.fields.eventStatus,a.fields.stateCode,a.fields.priority,a.fields.eventTypeName,a.fields.regardingRecordId,a.fields.regardingRecordName,a.fields.ownerName].join(","),s=[];t&&s.push("".concat(a.fields.regardingRecordId," eq '").concat(t,"'"));var u=$.map(e=>"".concat(a.fields.eventStatus," eq ").concat(e)).join(" or ");s.push("(".concat(u,")"));var d=J(i),g=J(l);s.push("".concat(a.fields.dueDate," ne null")),o?s.push("(".concat(a.fields.dueDate," lt ").concat(d," or ").concat(a.fields.dueDate," le ").concat(g,")")):(s.push("".concat(a.fields.dueDate," ge ").concat(d)),s.push("".concat(a.fields.dueDate," le ").concat(g)));var v=s.join(" and "),m="".concat(a.fields.dueDate," asc"),f=r,p=["$select=".concat(encodeURIComponent(c)),"$filter=".concat(encodeURIComponent(v)),"$orderby=".concat(encodeURIComponent(m)),"$top=".concat(f)];return"".concat(a.entitySetName,"?").concat(p.join("&"))}(t),o=function(e){var{parentRecordId:t,daysAhead:n,includeOverdue:r=!0}=e,o=L,a=K(),i=Q(n),l=[];t&&l.push("".concat(o.fields.regardingRecordId," eq '").concat(t,"'"));var c=$.map(e=>"".concat(o.fields.eventStatus," eq ").concat(e)).join(" or ");l.push("(".concat(c,")"));var s=J(a),u=J(i);l.push("".concat(o.fields.dueDate," ne null")),r?l.push("(".concat(o.fields.dueDate," lt ").concat(s," or ").concat(o.fields.dueDate," le ").concat(u,")")):(l.push("".concat(o.fields.dueDate," ge ").concat(s)),l.push("".concat(o.fields.dueDate," le ").concat(u)));var d=l.join(" and "),g=o.fields.eventId;return"".concat(o.entitySetName,"?$select=").concat(encodeURIComponent(g),"&$filter=").concat(encodeURIComponent(d))}(t);try{var[a,i]=yield Promise.all([e.retrieveMultipleRecords(L.entityName,"?".concat(r.split("?")[1])),e.retrieveMultipleRecords(L.entityName,"?".concat(o.split("?")[1]))]);return{events:(n=a.entities,n.map(te).filter(e=>null!==e)),totalCount:i.entities.length}}catch(e){throw console.error("[EventFilterService] Error fetching events with count:",e),e}},new((o=void 0)||(o=Promise))(function(e,t){function i(e){try{c(a.next(e))}catch(e){t(e)}}function l(e){try{c(a.throw(e))}catch(e){t(e)}}function c(t){var n;t.done?e(t.value):(n=t.value,n instanceof o?n:new o(function(e){e(n)})).then(i,l)}c((a=a.apply(n,r||[])).next())});var n,r,o,a}var re=function(e,t,n,r){return new(n||(n=Promise))(function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function l(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(i,l)}c((r=r.apply(e,t||[])).next())})},oe=7,ae=10,ie=(0,o.makeStyles)({container:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minWidth:"40px",paddingRight:o.tokens.spacingHorizontalM},dayNumber:{fontSize:o.tokens.fontSizeHero800,fontWeight:o.tokens.fontWeightSemibold,lineHeight:o.tokens.lineHeightHero800,color:o.tokens.colorNeutralForeground1},dayAbbreviation:{fontSize:o.tokens.fontSizeBase100,fontWeight:o.tokens.fontWeightMedium,color:o.tokens.colorNeutralForeground3,textTransform:"uppercase",letterSpacing:"0.5px"}}),le=e=>{var{date:t}=e,r=ie(),a=t.getDate(),i=(e=>["SUN","MON","TUE","WED","THU","FRI","SAT"][e.getDay()])(t);return n.createElement("div",{className:r.container},n.createElement(o.Text,{className:r.dayNumber},a),n.createElement(o.Text,{className:r.dayAbbreviation},i))},ce=(o.tokens.colorPaletteYellowBackground2,o.tokens.colorPaletteYellowForeground2,o.tokens.colorPaletteGreenBackground2,o.tokens.colorPaletteGreenForeground2,o.tokens.colorPalettePurpleBackground2,o.tokens.colorPalettePurpleForeground2,o.tokens.colorPaletteBlueBorderActive,o.tokens.colorPaletteBlueForeground2,o.tokens.colorPaletteDarkOrangeBackground2,o.tokens.colorPaletteDarkOrangeForeground2,o.tokens.colorPaletteRedBackground2,o.tokens.colorPaletteRedForeground2,o.tokens.colorPaletteTealBackground2,o.tokens.colorPaletteTealForeground2,o.tokens.colorNeutralBackground5,o.tokens.colorNeutralForeground2,[{keywords:["hearing"],color:"yellow"},{keywords:["court"],color:"yellow"},{keywords:["trial"],color:"yellow"},{keywords:["filing"],color:"green"},{keywords:["patent"],color:"green"},{keywords:["submission"],color:"green"},{keywords:["application"],color:"green"},{keywords:["regulatory"],color:"purple"},{keywords:["review"],color:"purple"},{keywords:["compliance"],color:"purple"},{keywords:["audit"],color:"purple"},{keywords:["meeting"],color:"blue"},{keywords:["conference"],color:"blue"},{keywords:["call"],color:"blue"},{keywords:["deadline"],color:"orange"},{keywords:["due"],color:"orange"},{keywords:["expiration"],color:"orange"},{keywords:["renewal"],color:"orange"},{keywords:["project"],color:"teal"},{keywords:["milestone"],color:"teal"},{keywords:["urgent"],color:"red"},{keywords:["critical"],color:"red"},{keywords:["emergency"],color:"red"}]);function se(e){if(!e)return"default";var t=e.toLowerCase().trim();for(var n of ce)for(var r of n.keywords)if(t.includes(r))return n.color;return"default"}var ue=(0,o.makeStyles)({container:{display:"flex",alignItems:"center",columnGap:o.tokens.spacingHorizontalS},badge:{width:"12px",height:"12px",borderRadius:o.tokens.borderRadiusSmall,flexShrink:0},yellow:{backgroundColor:o.tokens.colorPaletteYellowBackground2},green:{backgroundColor:o.tokens.colorPaletteGreenBackground2},purple:{backgroundColor:o.tokens.colorPalettePurpleBackground2},blue:{backgroundColor:o.tokens.colorPaletteBlueBorderActive},orange:{backgroundColor:o.tokens.colorPaletteDarkOrangeBackground2},red:{backgroundColor:o.tokens.colorPaletteRedBackground2},teal:{backgroundColor:o.tokens.colorPaletteTealBackground2},default:{backgroundColor:o.tokens.colorNeutralBackground5},typeName:{fontSize:o.tokens.fontSizeBase200,fontWeight:o.tokens.fontWeightSemibold,color:o.tokens.colorNeutralForeground1,whiteSpace:"nowrap"}}),de=e=>{var{typeName:t,color:r,indicatorOnly:a=!1,ariaLabel:i}=e,l=ue(),c=null!=r?r:se(t),s=(function(e){var t=se(e)}(t),l[c]||l.default),u=null!=i?i:"Event type: ".concat(t);return n.createElement("div",{className:l.container,role:"img","aria-label":u},n.createElement("div",{className:(0,o.mergeClasses)(l.badge,s),"aria-hidden":"true"}),!a&&n.createElement(o.Text,{className:l.typeName},t))};function ge(e){return e<0?"overdue":e<=1?"critical":e<=3?"urgent":e<=7?"warning":"normal"}function ve(e,t){return 0===e?"Today":t?"+".concat(Math.abs(e)):String(e)}function me(e,t){var n=Math.abs(e);return 0===e?"Due today":t?1===n?"1 day overdue":"".concat(n," days overdue"):1===e?"Due in 1 day":"Due in ".concat(e," days")}function fe(e,t){var n=function(e,t){var n=null!=t?t:new Date,r=new Date(e.getFullYear(),e.getMonth(),e.getDate()),o=new Date(n.getFullYear(),n.getMonth(),n.getDate()),a=r.getTime()-o.getTime();return Math.round(a/864e5)}(e,t),r=n<0,o=0===n;return{days:n,absoluteDays:Math.abs(n),isOverdue:r,isDueToday:o,displayValue:ve(n,r),urgency:ge(n),accessibleLabel:me(n,r)}}o.tokens.colorStatusDangerBackground3,o.tokens.colorNeutralForegroundOnBrand,o.tokens.colorPaletteRedBackground3,o.tokens.colorNeutralForegroundOnBrand,o.tokens.colorPaletteDarkOrangeBackground3,o.tokens.colorNeutralForegroundOnBrand,o.tokens.colorPaletteMarigoldBackground3,o.tokens.colorNeutralForeground1,o.tokens.colorNeutralBackground5,o.tokens.colorNeutralForeground1;var pe=(0,o.makeStyles)({badge:{display:"flex",alignItems:"center",justifyContent:"center",borderRadius:o.tokens.borderRadiusCircular,flexShrink:0},small:{minWidth:"20px",height:"20px",paddingLeft:o.tokens.spacingHorizontalXS,paddingRight:o.tokens.spacingHorizontalXS},medium:{minWidth:"24px",height:"24px",paddingLeft:o.tokens.spacingHorizontalSNudge,paddingRight:o.tokens.spacingHorizontalSNudge},overdue:{backgroundColor:o.tokens.colorStatusDangerBackground3},critical:{backgroundColor:o.tokens.colorPaletteRedBackground3},urgent:{backgroundColor:o.tokens.colorPaletteDarkOrangeBackground3},warning:{backgroundColor:o.tokens.colorPaletteMarigoldBackground3},normal:{backgroundColor:o.tokens.colorNeutralBackground5},text:{lineHeight:"1",fontWeight:o.tokens.fontWeightSemibold},textSmall:{fontSize:o.tokens.fontSizeBase100},textMedium:{fontSize:o.tokens.fontSizeBase200},textOnBrand:{color:o.tokens.colorNeutralForegroundOnBrand},textNormal:{color:o.tokens.colorNeutralForeground1}}),he=e=>{var{dueDate:t,daysUntilDue:r,isOverdue:a=!1,urgencyOverride:i,ariaLabel:l,size:c="medium"}=e,s=pe(),u=n.useMemo(()=>{if(t)return fe(t);var e=a?-Math.abs(null!=r?r:0):Math.abs(null!=r?r:0);return fe(new Date(Date.now()+24*e*60*60*1e3))},[t,r,a]),d=null!=i?i:u.urgency,g="small"===c?s.small:s.medium,v="small"===c?s.textSmall:s.textMedium,m=null!=l?l:u.accessibleLabel;return n.createElement("div",{className:(0,o.mergeClasses)(s.badge,g,(()=>{switch(d){case"overdue":return s.overdue;case"critical":return s.critical;case"urgent":return s.urgent;case"warning":return s.warning;default:return s.normal}})()),role:"status","aria-label":m},n.createElement(o.Text,{className:(0,o.mergeClasses)(s.text,v,(()=>{switch(d){case"overdue":case"critical":case"urgent":return s.textOnBrand;default:return s.textNormal}})()),"aria-hidden":"true"},u.displayValue))},ye=(0,o.makeStyles)({container:{display:"flex",flexDirection:"row",alignItems:"center",width:"100%",paddingTop:o.tokens.spacingVerticalM,paddingBottom:o.tokens.spacingVerticalM,paddingLeft:o.tokens.spacingHorizontalS,paddingRight:o.tokens.spacingHorizontalS,boxSizing:"border-box",borderRadius:o.tokens.borderRadiusMedium,cursor:"pointer",backgroundColor:"transparent",transitionProperty:"background-color, opacity",transitionDuration:o.tokens.durationNormal,transitionTimingFunction:o.tokens.curveEasyEase,"&:hover":{backgroundColor:o.tokens.colorNeutralBackground1Hover},"&:focus":{outline:"2px solid ".concat(o.tokens.colorBrandStroke1),outlineOffset:"-2px"},"&:focus-visible":{outline:"2px solid ".concat(o.tokens.colorBrandStroke1),outlineOffset:"-2px"},"&:active":{backgroundColor:o.tokens.colorNeutralBackground1Pressed}},containerNavigating:{opacity:.7,pointerEvents:"none"},dateSection:{flexShrink:0},contentSection:{display:"flex",flexDirection:"column",flexGrow:1,minWidth:0,rowGap:o.tokens.spacingVerticalXXS},headerRow:{display:"flex",flexDirection:"row",alignItems:"center",columnGap:o.tokens.spacingHorizontalM},eventName:{fontSize:o.tokens.fontSizeBase300,fontWeight:o.tokens.fontWeightSemibold,color:o.tokens.colorNeutralForeground1,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},description:{fontSize:o.tokens.fontSizeBase200,color:o.tokens.colorNeutralForeground3,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%"},badgeSection:{flexShrink:0,marginLeft:o.tokens.spacingHorizontalM,display:"flex",alignItems:"center"},withSeparator:{borderBottom:"1px solid ".concat(o.tokens.colorNeutralStroke2)},loadingSpinner:{marginLeft:o.tokens.spacingHorizontalXS}}),ke=e=>{var{id:t,name:r,dueDate:a,eventType:i,eventTypeName:l,description:c,daysUntilDue:s,isOverdue:u,eventTypeColor:d,onClick:g,isNavigating:v=!1}=e,m=ye(),f=(0,o.mergeClasses)(m.container,v&&m.containerNavigating);return n.createElement("div",{className:f,onClick:()=>{v||null==g||g(t,i)},onKeyDown:e=>{v||"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),null==g||g(t,i))},role:"button",tabIndex:v?-1:0,"aria-label":"".concat(r,", ").concat(l,", due ").concat(a.toLocaleDateString(),", ").concat(u?"".concat(Math.abs(s)," days overdue"):"".concat(s," days remaining")).concat(v?", loading":""),"aria-busy":v,"aria-disabled":v},n.createElement("div",{className:m.dateSection},n.createElement(le,{date:a})),n.createElement("div",{className:m.contentSection},n.createElement("div",{className:m.headerRow},n.createElement(de,{typeName:l,color:d}),n.createElement(o.Text,{className:m.eventName},r)),c&&n.createElement(o.Text,{className:m.description},c)),n.createElement("div",{className:m.badgeSection},n.createElement(he,{daysUntilDue:s,isOverdue:u}),v&&n.createElement(o.Spinner,{size:"tiny",className:m.loadingSpinner,"aria-label":"Opening event..."})))},be=M("ChevronRight20Regular","20",["M7.65 4.15c.2-.2.5-.2.7 0l5.49 5.46c.21.22.21.57 0 .78l-5.49 5.46a.5.5 0 0 1-.7-.7L12.8 10 7.65 4.85a.5.5 0 0 1 0-.7Z"]),Se=(0,o.makeStyles)({footer:Object.assign(Object.assign(Object.assign({display:"flex",alignItems:"center",justifyContent:"flex-end"},o.shorthands.padding(o.tokens.spacingVerticalS,o.tokens.spacingHorizontalM)),o.shorthands.borderTop("1px","solid",o.tokens.colorNeutralStroke2)),{marginTop:"auto"}),linkContainer:{display:"flex",alignItems:"center",columnGap:o.tokens.spacingHorizontalXS},link:{display:"flex",alignItems:"center",fontSize:o.tokens.fontSizeBase200,fontWeight:o.tokens.fontWeightMedium,color:o.tokens.colorBrandForeground1,textDecoration:"none",cursor:"pointer",transitionProperty:"color",transitionDuration:o.tokens.durationNormal,"&:hover":{color:o.tokens.colorBrandForeground2,textDecoration:"underline"},"&:focus":{outlineStyle:"solid",outlineWidth:"2px",outlineColor:o.tokens.colorStrokeFocus2,outlineOffset:"2px"}},chevron:{fontSize:"12px",marginLeft:o.tokens.spacingHorizontalXXS,color:"inherit"},badge:{marginLeft:o.tokens.spacingHorizontalXS},badgeText:{fontWeight:o.tokens.fontWeightSemibold}}),we=e=>{var{totalEventCount:t,displayedCount:r,onViewAllClick:a}=e,i=Se(),l=t>r&&t>10,c=t-r;return n.createElement("div",{className:i.footer},n.createElement("div",{className:i.linkContainer},n.createElement(o.Link,{className:i.link,onClick:a,onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),a())},tabIndex:0,"aria-label":l?"View all events (".concat(t," total, ").concat(c," more)"):"View all events"},"All Events",n.createElement(be,{className:i.chevron})),l&&n.createElement(o.Badge,{className:i.badge,appearance:"filled",color:"informative",size:"small","aria-label":"".concat(c," more events")},n.createElement(o.Text,{className:i.badgeText},"+",c))))},Ne=function(e,t,n,r){return new(n||(n=Promise))(function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function l(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(i,l)}c((r=r.apply(e,t||[])).next())})},xe="eventDetailPane",Ee=["events","Events","eventsTab","tab_events","sprk_events"];function Ce(){return"undefined"!=typeof Xrm&&Xrm.App&&Xrm.App.sidePanes?Xrm.App.sidePanes:null}function De(e,t){var n=new URLSearchParams;return n.set("eventId",e),t&&n.set("eventType",t),{pageType:"webresource",webresourceName:"sprk_eventdetailsidepane.html",data:n.toString()}}function Oe(){var e="undefined"!=typeof Xrm&&Xrm.Page&&Xrm.Page.ui?Xrm.Page.ui:null;if(!e||!e.tabs)return console.log("[NavigationService] Form context not available for tab navigation"),!1;for(var t of Ee)try{var n=e.tabs.get(t);if(n&&"function"==typeof n.setFocus)return"function"!=typeof n.getVisible||n.getVisible()||"function"==typeof n.setVisible&&n.setVisible(!0),n.setFocus(),console.log("[NavigationService] Navigated to Events tab: ".concat(t)),!0}catch(e){continue}try{var r=void 0;if(e.tabs.forEach(e=>{e.getName().toLowerCase().includes("event")&&void 0===r&&(r=e)}),void 0!==r){var o=r;return"function"!=typeof o.getVisible||o.getVisible()||"function"==typeof o.setVisible&&o.setVisible(!0),o.setFocus(),console.log("[NavigationService] Navigated to Events tab (found by iteration)"),!0}}catch(e){console.log("[NavigationService] Error iterating tabs:",e)}return console.log("[NavigationService] Events tab not found on current form"),!1}var Te=(0,o.makeStyles)({container:{display:"flex",flexDirection:"column",height:"100%",width:"100%",boxSizing:"border-box",position:"relative"},header:Object.assign(Object.assign({display:"flex",alignItems:"center",justifyContent:"space-between"},o.shorthands.padding(o.tokens.spacingVerticalS,o.tokens.spacingHorizontalM)),{marginBottom:o.tokens.spacingVerticalXS}),headerTitleText:{fontSize:o.tokens.fontSizeBase400,fontWeight:o.tokens.fontWeightSemibold,color:o.tokens.colorNeutralForeground1},eventList:Object.assign({display:"flex",flexDirection:"column",overflowY:"auto",flexGrow:1},o.shorthands.padding(0,o.tokens.spacingHorizontalM)),emptyState:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",flexGrow:1,color:o.tokens.colorNeutralForeground3,rowGap:o.tokens.spacingVerticalS},emptyIcon:{fontSize:"48px",color:o.tokens.colorNeutralForeground4},loadingContainer:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%"},errorContainer:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100%",color:o.tokens.colorStatusDangerForeground1,rowGap:o.tokens.spacingVerticalS},versionText:{position:"absolute",bottom:o.tokens.spacingVerticalXS,right:o.tokens.spacingHorizontalS,fontSize:o.tokens.fontSizeBase100,color:o.tokens.colorNeutralForeground4}}),Pe=e=>{var{context:t,parentRecordId:r,parentEntityName:a,maxItems:i,daysAhead:l,onEventSelect:c}=e,s=Te(),[u,d]=n.useState(null),[g,v]=n.useState(null),{events:m,totalCount:f,loading:p,error:h,initialized:y}=function(e){var{context:t,parentRecordId:r,daysAhead:o=oe,maxItems:a=ae,includeOverdue:i=!0,autoFetch:l=!0}=e,[c,s]=n.useState([]),[u,d]=n.useState(0),[g,v]=n.useState(!1),[m,f]=n.useState(null),[p,h]=n.useState(!1),y=n.useRef(!0),k=n.useRef(t);k.current=t;var b=n.useCallback(()=>re(this,void 0,void 0,function*(){var e;if(!r)return s([]),d(0),v(!1),void h(!0);if(!(null===(e=k.current)||void 0===e?void 0:e.webAPI))return f("WebAPI not available"),v(!1),void h(!0);v(!0),f(null);try{var t={parentRecordId:r,daysAhead:o,maxItems:a,includeOverdue:i},n=yield ne(k.current.webAPI,t);y.current&&(s(n.events),d(n.totalCount),f(null))}catch(e){console.error("[useUpcomingEvents] Error fetching events:",e),y.current&&(e instanceof Error?e.message.includes("401")||e.message.includes("Unauthorized")?f("Authentication required. Please refresh the page."):e.message.includes("403")||e.message.includes("Forbidden")?f("You don't have permission to view events."):e.message.includes("Network")||e.message.includes("fetch")?f("Unable to connect. Please check your connection."):f("Failed to load events. Please try again."):f("An unexpected error occurred."))}finally{y.current&&(v(!1),h(!0))}}),[r,o,a,i]),S=n.useCallback(()=>re(this,void 0,void 0,function*(){yield b()}),[b]);return n.useEffect(()=>{l&&b()},[l,b]),n.useEffect(()=>(y.current=!0,()=>{y.current=!1}),[]),{events:c,totalCount:u,loading:g,error:m,refresh:S,initialized:p}}({context:t,parentRecordId:r,daysAhead:l,maxItems:i,includeOverdue:!0,autoFetch:!0}),k=n.useCallback((e,t)=>{return n=void 0,r=void 0,a=function*(){v(null),d(e);try{var n=yield function(e){return Ne(this,void 0,void 0,function*(){var{eventId:t,eventType:n,navigateToTab:r=!0,onNavigationComplete:o,onNavigationError:a}=e,i={success:!1,navigatedToTab:!1,openedSidePane:!1};if(console.log("[NavigationService] Navigating to event",{eventId:t,eventType:n,navigateToTab:r}),!t||""===t.trim()){var l="eventId is required for navigation";return console.error("[NavigationService]",l),i.error=l,null==a||a(l),i}r&&(i.navigatedToTab=Oe());var c=Ce();if(!c){var s="Xrm.App.sidePanes API is not available. Side pane cannot be opened.";return console.warn("[NavigationService]",s),i.navigatedToTab?(i.success=!0,null==o||o()):(i.error=s,null==a||a(s)),i}try{var u=c.getPane(xe);if(u){console.log("[NavigationService] Reusing existing side pane");var d=De(t,n);yield u.navigate(d),u.select(),i.openedSidePane=!0,i.success=!0}else{console.log("[NavigationService] Creating new side pane");var g=yield c.createPane({title:"Event Details",paneId:xe,canClose:!0,width:400,isSelected:!0}),v=De(t,n);yield g.navigate(v),i.openedSidePane=!0,i.success=!0}console.log("[NavigationService] Navigation complete",i),null==o||o()}catch(l){var m=l instanceof Error?l.message:String(l);console.error("[NavigationService] Failed to open side pane:",m),i.error="Failed to open side pane: ".concat(m),i.navigatedToTab?(i.success=!0,null==o||o()):null==a||a(i.error)}return i})}({eventId:e,eventType:t,navigateToTab:!0,onNavigationComplete:()=>{console.log("[DueDatesWidget] Navigation complete for event:",e)},onNavigationError:e=>{console.error("[DueDatesWidget] Navigation error:",e),v(e)}});c(e,t),!n.success&&n.error&&v(n.error)}catch(e){var r=e instanceof Error?e.message:"Navigation failed";console.error("[DueDatesWidget] Unexpected navigation error:",e),v(r)}finally{d(null)}},new((o=void 0)||(o=Promise))(function(e,t){function i(e){try{c(a.next(e))}catch(e){t(e)}}function l(e){try{c(a.throw(e))}catch(e){t(e)}}function c(t){var n;t.done?e(t.value):(n=t.value,n instanceof o?n:new o(function(e){e(n)})).then(i,l)}c((a=a.apply(n,r||[])).next())});var n,r,o,a},[c]),b=n.useCallback(()=>{console.log("[DueDatesWidget] View All Events clicked"),function(e){Ne(this,void 0,void 0,function*(){var{onNavigationComplete:t,onNavigationError:n}=e||{};if(console.log("[NavigationService] Navigating to Events page/tab"),Oe())return console.log("[NavigationService] Navigated to Events tab on current form"),null==t||t(),!0;try{if("undefined"!=typeof Xrm&&Xrm.Navigation&&Xrm.Navigation.navigateTo)return console.log("[NavigationService] Navigating to Events Custom Page"),yield Xrm.Navigation.navigateTo({pageType:"custom",name:"sprk_eventspage"}),null==t||t(),!0}catch(e){console.error("[NavigationService] Failed to navigate to Events page:",e)}try{if("undefined"!=typeof Xrm&&Xrm.Navigation&&Xrm.Navigation.navigateTo)return console.log("[NavigationService] Navigating to Events entity list (fallback)"),yield Xrm.Navigation.navigateTo({pageType:"entitylist",entityName:"sprk_event"}),null==t||t(),!0}catch(e){console.error("[NavigationService] Failed to navigate to Events entity list:",e)}var r="Unable to navigate to Events page - Xrm.Navigation API not available";return console.warn("[NavigationService]",r),null==n||n(r),!1})}({onNavigationComplete:()=>{console.log("[DueDatesWidget] Navigation to Events page complete")},onNavigationError:e=>{console.error("[DueDatesWidget] Navigation to Events page failed:",e),v(e)}})},[]);return p&&!y?n.createElement("div",{className:s.container},n.createElement("div",{className:s.loadingContainer},n.createElement(o.Spinner,{size:"medium",label:"Loading events..."})),n.createElement("span",{className:s.versionText},"v1.0.3")):h?n.createElement("div",{className:s.container},n.createElement("div",{className:s.errorContainer},n.createElement(o.Text,null,h)),n.createElement("span",{className:s.versionText},"v1.0.3")):n.createElement("div",{className:s.container},n.createElement("div",{className:s.header},n.createElement(o.Text,{className:s.headerTitleText},"Upcoming Events")),0===m.length?n.createElement("div",{className:s.emptyState},n.createElement(V,{className:s.emptyIcon}),n.createElement(o.Text,null,"No upcoming events")):n.createElement("div",{className:s.eventList},m.map(e=>n.createElement(ke,{key:e.id,id:e.id,name:e.name,dueDate:e.dueDate,eventType:e.eventType,eventTypeName:e.eventTypeName,description:e.description,daysUntilDue:e.daysUntilDue,isOverdue:e.isOverdue,onClick:k,isNavigating:u===e.id}))),n.createElement(we,{totalEventCount:f,displayedCount:m.length,onViewAllClick:b}),n.createElement("span",{className:s.versionText},"v1.0.3"))},Re=M("ErrorCircle20Regular","20",["M10 2a8 8 0 1 1 0 16 8 8 0 0 1 0-16Zm0 1a7 7 0 1 0 0 14 7 7 0 0 0 0-14Zm0 9.5a.75.75 0 1 1 0 1.5.75.75 0 0 1 0-1.5ZM10 6a.5.5 0 0 1 .5.41V11a.5.5 0 0 1-1 .09V6.5c0-.28.22-.5.5-.5Z"]),Ie=(0,o.makeStyles)({container:Object.assign(Object.assign(Object.assign({display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100%"},o.shorthands.padding(o.tokens.spacingVerticalL)),{backgroundColor:o.tokens.colorStatusDangerBackground1}),o.shorthands.borderRadius(o.tokens.borderRadiusMedium)),icon:{color:o.tokens.colorStatusDangerForeground1,marginBottom:o.tokens.spacingVerticalS},title:{color:o.tokens.colorStatusDangerForeground1,fontWeight:o.tokens.fontWeightSemibold,marginBottom:o.tokens.spacingVerticalS},message:{color:o.tokens.colorNeutralForeground1,textAlign:"center",marginBottom:o.tokens.spacingVerticalM}});class je extends n.Component{constructor(e){super(e),this.handleRetry=()=>{this.setState({hasError:!1,error:void 0})},this.state={hasError:!1}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){console.error("[DueDatesWidget] Component error:",e,t)}render(){return this.state.hasError?n.createElement(Be,{onRetry:this.handleRetry}):this.props.children}}var Be=e=>{var{onRetry:t}=e,r=Ie();return n.createElement("div",{className:r.container},n.createElement(Re,{className:r.icon}),n.createElement(o.Text,{className:r.title},"Something went wrong"),n.createElement(o.Text,{className:r.message,size:200},"The widget encountered an error. Please try again."),n.createElement(o.Button,{appearance:"primary",onClick:t},"Retry"))},ze="spaarke-theme-change";function Ae(){try{var e=localStorage.getItem("spaarke-theme");if("light"===e||"dark"===e||"auto"===e)return e}catch(e){}return"auto"}class Fe{constructor(){this.container=null,this.context=null,this.cleanupThemeListener=null,this.selectedEventOutputValue="",this.handleEventSelect=(e,t)=>{this.selectedEventOutputValue=JSON.stringify({eventId:e,eventType:t}),this.notifyOutputChanged()}}init(e,t,n,r){this.container=r,this.context=e,this.notifyOutputChanged=t,e.mode.trackContainerResize(!0),this.cleanupThemeListener=function(e){var t=()=>e(),n=()=>{"auto"===Ae()&&e()};window.addEventListener(ze,t);var r=window.matchMedia("(prefers-color-scheme: dark)");return r.addEventListener("change",n),()=>{window.removeEventListener(ze,t),r.removeEventListener("change",n)}}(()=>{this.context&&this.container&&this.renderComponent()}),this.renderComponent()}updateView(e){this.context=e,this.renderComponent()}getOutputs(){return{selectedEventOutput:this.selectedEventOutputValue}}destroy(){this.cleanupThemeListener&&(this.cleanupThemeListener(),this.cleanupThemeListener=null),this.container&&(r.unmountComponentAtNode(this.container),this.container=null),this.context=null}renderComponent(){var e,t,a,i,l,c;if(this.container&&this.context){var s=function(e){try{return function(e){var t,n=Ae();if("dark"===n)return!0;if("light"===n)return!1;if(void 0!==(null===(t=null==e?void 0:e.fluentDesignLanguage)||void 0===t?void 0:t.isDarkTheme))return e.fluentDesignLanguage.isDarkTheme;var r=function(){try{var e=document.querySelector('[data-id="navbar-container"]');if(e){var t=window.getComputedStyle(e).backgroundColor;if("rgb(10, 10, 10)"===t)return!0;if("rgb(240, 240, 240)"===t)return!1}}catch(e){}return null}();return null!==r?r:function(){try{return window.matchMedia("(prefers-color-scheme: dark)").matches}catch(e){return!1}}()}(e)?o.webDarkTheme:o.webLightTheme}catch(e){return o.webLightTheme}}(this.context),u=(null===(e=this.context.parameters.parentRecordId)||void 0===e?void 0:e.raw)||"",d=(null===(t=this.context.parameters.parentEntityName)||void 0===t?void 0:t.raw)||"",g=null!==(i=null===(a=this.context.parameters.maxItems)||void 0===a?void 0:a.raw)&&void 0!==i?i:5,v=null!==(c=null===(l=this.context.parameters.daysAhead)||void 0===l?void 0:l.raw)&&void 0!==c?c:30;r.render(n.createElement(o.FluentProvider,{theme:s},n.createElement(je,null,n.createElement(Pe,{context:this.context,parentRecordId:u,parentEntityName:d,maxItems:g,daysAhead:v,onEventSelect:this.handleEventSelect}))),this.container)}}}pcf_tools_652ac3f36e1e4bca82eb3c1dc44e6fad=t})();
if (window.ComponentFramework && window.ComponentFramework.registerControl) {
	ComponentFramework.registerControl('Spaarke.Controls.DueDatesWidget', pcf_tools_652ac3f36e1e4bca82eb3c1dc44e6fad.DueDatesWidget);
} else {
	var Spaarke = Spaarke || {};
	Spaarke.Controls = Spaarke.Controls || {};
	Spaarke.Controls.DueDatesWidget = pcf_tools_652ac3f36e1e4bca82eb3c1dc44e6fad.DueDatesWidget;
	pcf_tools_652ac3f36e1e4bca82eb3c1dc44e6fad = undefined;
}