<?xml version="1.0" encoding="utf-8" ?>
<manifest>
  <control namespace="Sprk" constructor="ScopeConfigEditor" version="1.2.6"
           display-name-key="Scope Config Editor"
           description-key="Clear max-height to allow full expansion (v1.2.6)"
           control-type="virtual">

    <!--
      SCOPE CONFIG EDITOR PCF CONTROL

      Purpose: Provides an adaptive editing experience for all 4 scope entity forms:
        - Action  (sprk_analysisaction)   → Rich system prompt textarea with token counter
        - Skill   (sprk_analysisskill)   → Compact prompt fragment textarea with injection preview
        - Knowledge Source (sprk_analysisknowledge) → Markdown textarea + file upload
        - Tool    (sprk_analysistool)     → CodeMirror JSON editor + handler class dropdown

      ADR Compliance:
        - ADR-006: PCF over webresources
        - ADR-021: Fluent UI v9, design tokens, dark mode, WCAG 2.1 AA
        - ADR-022: React 16 APIs (virtual control), platform-library manifest, unmanaged solution

      Bundle Target: < 1MB (using CodeMirror ~300KB, NOT Monaco ~4MB)
    -->

    <external-service-usage enabled="true">
      <domain>spe-api-dev-67e2xz.azurewebsites.net</domain>
    </external-service-usage>

    <!-- BOUND: The field content being edited (text value on the record) -->
    <property name="fieldValue" display-name-key="Field Value"
              description-key="The bound field value (system prompt text, JSON config, etc.)"
              of-type="Multiple" usage="bound" required="false" />

    <!-- INPUT: API Base URL for handler discovery -->
    <property name="apiBaseUrl" display-name-key="API Base URL"
              description-key="BFF API base URL for /api/ai/tools/handlers endpoint"
              of-type="SingleLine.Text" usage="input" required="false" />

    <!-- INPUT: Tenant ID for MSAL authentication -->
    <property name="tenantId" display-name-key="Tenant ID"
              description-key="Azure AD Tenant ID for authentication"
              of-type="SingleLine.Text" usage="input" required="false" />

    <!-- INPUT: BFF App ID for token scope -->
    <property name="bffAppId" display-name-key="BFF App ID"
              description-key="BFF API Application ID (api://{bffAppId}/SDAP.Access)"
              of-type="SingleLine.Text" usage="input" required="false" />

    <!-- OUTPUT: Updated field value after editing -->
    <property name="updatedValue" display-name-key="Updated Value"
              description-key="The updated field value after user edits"
              of-type="Multiple" usage="output" required="false" />

    <resources>
      <code path="index.ts" order="1"/>
      <!-- Platform-provided libraries (not bundled) per ADR-022 -->
      <platform-library name="React" version="16.14.0" />
      <platform-library name="Fluent" version="9.46.2" />
    </resources>

    <feature-usage>
      <uses-feature name="WebAPI" required="false" />
      <uses-feature name="Utility" required="false" />
    </feature-usage>
  </control>
</manifest>
