/*! For license information please see bundle.js.LICENSE.txt */
var pcf_tools_652ac3f36e1e4bca82eb3c1dc44e6fad;(()=>{"use strict";var e={31(e){e.exports=Reactv16},61(e,t,n){var r,o,i,a,l;n.d(t,{BO:()=>a,Dn:()=>r,bi:()=>o,s:()=>i}),function(e){e.Arabic="Segoe UI Web (Arabic)",e.Cyrillic="Segoe UI Web (Cyrillic)",e.EastEuropean="Segoe UI Web (East European)",e.Greek="Segoe UI Web (Greek)",e.Hebrew="Segoe UI Web (Hebrew)",e.Thai="Leelawadee UI Web",e.Vietnamese="Segoe UI Web (Vietnamese)",e.WestEuropean="Segoe UI Web (West European)",e.Selawik="Selawik Web",e.Armenian="Segoe UI Web (Armenian)",e.Georgian="Segoe UI Web (Georgian)"}(r||(r={})),function(e){e.Arabic="'".concat(r.Arabic,"'"),e.ChineseSimplified="'Microsoft Yahei UI', Verdana, Simsun",e.ChineseTraditional="'Microsoft Jhenghei UI', Pmingliu",e.Cyrillic="'".concat(r.Cyrillic,"'"),e.EastEuropean="'".concat(r.EastEuropean,"'"),e.Greek="'".concat(r.Greek,"'"),e.Hebrew="'".concat(r.Hebrew,"'"),e.Hindi="'Nirmala UI'",e.Japanese="'Yu Gothic UI', 'Meiryo UI', Meiryo, 'MS Pgothic', Osaka",e.Korean="'Malgun Gothic', Gulim",e.Selawik="'".concat(r.Selawik,"'"),e.Thai="'Leelawadee UI Web', 'Kmer UI'",e.Vietnamese="'".concat(r.Vietnamese,"'"),e.WestEuropean="'".concat(r.WestEuropean,"'"),e.Armenian="'".concat(r.Armenian,"'"),e.Georgian="'".concat(r.Georgian,"'")}(o||(o={})),function(e){e.size10="10px",e.size12="12px",e.size14="14px",e.size16="16px",e.size18="18px",e.size20="20px",e.size24="24px",e.size28="28px",e.size32="32px",e.size42="42px",e.size68="68px",e.mini="10px",e.xSmall="10px",e.small="12px",e.smallPlus="12px",e.medium="14px",e.mediumPlus="16px",e.icon="16px",e.large="18px",e.xLarge="20px",e.xLargePlus="24px",e.xxLarge="28px",e.xxLargePlus="32px",e.superLarge="42px",e.mega="68px"}(i||(i={})),function(e){e.light=100,e.semilight=300,e.regular=400,e.semibold=600,e.bold=700}(a||(a={})),function(e){e.xSmall="10px",e.small="12px",e.medium="16px",e.large="20px"}(l||(l={}))},62(e,t,n){n.d(t,{h:()=>o});var r=n(226);function o(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var o=[],i=[],a=e;return function e(t){for(var n=0,l=t;n<l.length;n++){var s=l[n];if(s&&!(0,r.db)(s))if("string"==typeof s)if(s.indexOf(" ")>=0)e(s.split(" "));else{var c=a.argsFromClassName(s);c?e(c):-1===o.indexOf(s)&&o.push(s)}else Array.isArray(s)?e(s):"object"==typeof s&&i.push(s)}}(t),{classes:o,objects:i}}},85(e,t,n){function r(){return"undefined"!=typeof window&&!(!window.document||!window.document.createElement)}n.d(t,{S:()=>r})},93(e,t,n){n.d(t,{Z:()=>f});var r=n(228),o=n(462),i=n(958),a=n(62),l=n(353),s=n(226);var c=n(103),u=n(358),d=0,h=r.nr.getInstance();h&&h.onReset&&h.onReset(function(){return d++});var p="__retval__";function f(e){void 0===e&&(e={});var t=new Map,n=0,h=0,f=d;return function(g,m){var y;if(void 0===m&&(m={}),e.useStaticStyles&&"function"==typeof g&&g.__noStyleOverride__)return g(m);h++;var _=g?g.__shadowConfig__:void 0,x=_&&_.window?_.window:"__default__";t.has(x)||t.set(x,new Map);var b=t.get(x),C=m.theme,k=C&&void 0!==C.rtl?C.rtl:(0,c.jI)(),w=e.disableCaching;if(f!==d&&(f=d,t.set(x,new Map),b=t.get(x),n=0),e.disableCaching||(b=v(t.get(x),g),b=v(b,m)),!w&&b[p]||(b[p]=void 0===g?{}:function(e,t){var n,c={subComponentStyles:{}},u=void 0;(0,s.db)(e[0])?(u=e[0],n=e[1]):n=e[0],null!=u||(u=null==t?void 0:t.shadowConfig);var d=(0,o.Cl)((0,o.Cl)({},t),{shadowConfig:u});if(!n&&e.length<=1)return{subComponentStyles:{}};var h=r.nr.getInstance(u);d.stylesheet=h;var p=i.T.apply(void 0,e),f=[];for(var g in p)if(p.hasOwnProperty(g)){if("subComponentStyles"===g){c.subComponentStyles=p.subComponentStyles||{};continue}if("__shadowConfig__"===g)continue;var v=p[g],m=(0,a.h)(h,v),y=m.classes,_=m.objects;(null==_?void 0:_.length)?(C=(0,l.GJ)(d||{},{displayName:g},_))&&(f.push(C),c[g]=y.concat([C.className]).join(" ")):c[g]=y.join(" ")}for(var x=0,b=f;x<b.length;x++){var C;(C=b[x])&&(0,l.Ae)(C,null==t?void 0:t.specificityMultiplier,u)}return c}(["function"==typeof g?g(m):g],{shadowConfig:g.__shadowConfig__,rtl:!!k,specificityMultiplier:e.useStaticStyles?5:void 0}),w||n++),n>(e.cacheSize||50)){var E=(0,u.z)();(null===(y=null==E?void 0:E.FabricConfig)||void 0===y?void 0:y.enableClassNameCacheFullWarning)&&(console.warn("Styles are being recalculated too frequently. Cache miss rate is ".concat(n,"/").concat(h,".")),console.trace()),t.get(x).clear(),n=0,e.disableCaching=!0}return b[p]}}function g(e,t){return t=function(e){switch(e){case void 0:return"__undefined__";case null:return"__null__";default:return e}}(t),e.has(t)||e.set(t,new Map),e.get(t)}function v(e,t){if("function"==typeof t)if(t.__cachedInputs__)for(var n=0,r=t.__cachedInputs__;n<r.length;n++)e=g(e,r[n]);else e=g(e,t);else if("object"==typeof t)for(var o in t)t.hasOwnProperty(o)&&(e=g(e,t[o]));return e}},103(e,t,n){n.d(t,{jI:()=>s});var r,o=n(403),i=n(800),a=n(884),l="isRTL";function s(e){if(void 0===e&&(e={}),void 0!==e.rtl)return e.rtl;if(void 0===r){var t=(0,i.G)(l);null!==t&&function(e,t){void 0===t&&(t=!1);var n=(0,o.Y)();n&&n.documentElement.setAttribute("dir",e?"rtl":"ltr"),t&&(0,i.S)(l,e?"1":"0"),r=e,(0,a.DU)(r)}(r="1"===t);var n=(0,o.Y)();void 0===r&&n&&(r="rtl"===(n.body&&n.body.getAttribute("dir")||n.documentElement.getAttribute("dir")),(0,a.DU)(r))}return!!r}},202(e,t,n){n.d(t,{X:()=>f});var r=n(462),o=n(358),i="__globalSettings__",a="__callbacks__",l=0,s=function(){function e(){}return e.getValue=function(e,t){var n=c();return void 0===n[e]&&(n[e]="function"==typeof t?t():t),n[e]},e.setValue=function(e,t){var n=c(),r=n[a],o=n[e];if(t!==o){n[e]=t;var i={oldValue:o,value:t,key:e};for(var l in r)r.hasOwnProperty(l)&&r[l](i)}return t},e.addChangeListener=function(e){var t=e.__id__,n=u();t||(t=e.__id__=String(l++)),n[t]=e},e.removeChangeListener=function(e){delete u()[e.__id__]},e}();function c(){var e,t=(0,o.z)()||{};return t[i]||(t[i]=((e={})[a]={},e)),t[i]}function u(){return c()[a]}var d={settings:{},scopedSettings:{},inCustomizerContext:!1},h=s.getValue("customizations",{settings:{},scopedSettings:{},inCustomizerContext:!1}),p=[],f=function(){function e(){}return e.reset=function(){h.settings={},h.scopedSettings={}},e.applySettings=function(t){h.settings=(0,r.Cl)((0,r.Cl)({},h.settings),t),e._raiseChange()},e.applyScopedSettings=function(t,n){h.scopedSettings[t]=(0,r.Cl)((0,r.Cl)({},h.scopedSettings[t]),n),e._raiseChange()},e.getSettings=function(e,t,n){void 0===n&&(n=d);for(var r={},o=t&&n.scopedSettings[t]||{},i=t&&h.scopedSettings[t]||{},a=0,l=e;a<l.length;a++){var s=l[a];r[s]=o[s]||n.settings[s]||i[s]||h.settings[s]}return r},e.applyBatchedUpdates=function(t,n){e._suppressUpdates=!0;try{t()}catch(e){}e._suppressUpdates=!1,n||e._raiseChange()},e.observe=function(e){p.push(e)},e.unobserve=function(e){p=p.filter(function(t){return t!==e})},e._raiseChange=function(){e._suppressUpdates||p.forEach(function(e){return e()})},e}()},226(e,t,n){n.d(t,{P6:()=>r,Se:()=>o,db:()=>a,ou:()=>i});var r="__global__",o="__shadow_dom_stylesheet__",i={stylesheetKey:r,inShadow:!1,window:void 0,__isShadowConfig__:!0},a=function(e){return!(!e||!function(e){return null!==e&&"object"==typeof e&&!Array.isArray(e)}(e))&&!0===e.__isShadowConfig__}},228(e,t,n){n.d(t,{nr:()=>c});var r,o=n(462),i=n(226),a="__stylesheet__",l="undefined"!=typeof navigator&&/rv:11.0/.test(navigator.userAgent),s={};try{s=window||{}}catch(e){}var c=function(){function e(e,t){var n,r,i,a,l,s;this._rules=[],this._preservedRules=[],this._counter=0,this._keyToClassName={},this._onInsertRuleCallbacks=[],this._onResetCallbacks=[],this._classNameToArgs={},this._config=(0,o.Cl)({injectionMode:"undefined"==typeof document?0:1,defaultPrefix:"css",namespace:void 0,cspSettings:void 0},e),this._classNameToArgs=null!==(n=null==t?void 0:t.classNameToArgs)&&void 0!==n?n:this._classNameToArgs,this._counter=null!==(r=null==t?void 0:t.counter)&&void 0!==r?r:this._counter,this._keyToClassName=null!==(a=null!==(i=this._config.classNameCache)&&void 0!==i?i:null==t?void 0:t.keyToClassName)&&void 0!==a?a:this._keyToClassName,this._preservedRules=null!==(l=null==t?void 0:t.preservedRules)&&void 0!==l?l:this._preservedRules,this._rules=null!==(s=null==t?void 0:t.rules)&&void 0!==s?s:this._rules}return e.getInstance=function(t){if(r=s[a],s[i.Se])return s[i.Se].getInstance(t);if(!r||r._lastStyleElement&&r._lastStyleElement.ownerDocument!==document){var n=(null==s?void 0:s.FabricConfig)||{},o=new e(n.mergeStyles,n.serializedStylesheet);r=o,s[a]=o}return r},e.prototype.serialize=function(){return JSON.stringify({classNameToArgs:this._classNameToArgs,counter:this._counter,keyToClassName:this._keyToClassName,preservedRules:this._preservedRules,rules:this._rules})},e.prototype.setConfig=function(e){this._config=(0,o.Cl)((0,o.Cl)({},this._config),e)},e.prototype.onReset=function(e){var t=this;return this._onResetCallbacks.push(e),function(){t._onResetCallbacks=t._onResetCallbacks.filter(function(t){return t!==e})}},e.prototype.onInsertRule=function(e){var t=this;return this._onInsertRuleCallbacks.push(e),function(){t._onInsertRuleCallbacks=t._onInsertRuleCallbacks.filter(function(t){return t!==e})}},e.prototype.getClassName=function(e){var t=this._config.namespace,n=e||this._config.defaultPrefix;return"".concat(t?t+"-":"").concat(n,"-").concat(this._counter++)},e.prototype.cacheClassName=function(e,t,n,r){this._keyToClassName[this._getCacheKey(t)]=e,this._classNameToArgs[e]={args:n,rules:r}},e.prototype.classNameFromKey=function(e){return this._keyToClassName[this._getCacheKey(e)]},e.prototype.getClassNameCache=function(){return this._keyToClassName},e.prototype.argsFromClassName=function(e){var t=this._classNameToArgs[e];return t&&t.args},e.prototype.insertedRulesFromClassName=function(e){var t=this._classNameToArgs[e];return t&&t.rules},e.prototype.insertRule=function(e,t,n){void 0===n&&(n=i.P6);var r=this._config.injectionMode,o=0!==r?this._getStyleElement():void 0;if(t&&this._preservedRules.push(e),o)switch(r){case 1:this._insertRuleIntoSheet(o.sheet,e);break;case 2:o.appendChild(document.createTextNode(e))}else this._rules.push(e);this._config.onInsertRule&&this._config.onInsertRule(e),this._onInsertRuleCallbacks.forEach(function(t){return t({key:n,sheet:o?o.sheet:void 0,rule:e})})},e.prototype.getRules=function(e){return(e?this._preservedRules.join(""):"")+this._rules.join("")},e.prototype.reset=function(){this._rules=[],this._counter=0,this._classNameToArgs={},this._keyToClassName={},this._onResetCallbacks.forEach(function(e){return e()})},e.prototype.resetKeys=function(){this._keyToClassName={}},e.prototype._createStyleElement=function(){var e,t=(null===(e=this._config.window)||void 0===e?void 0:e.document)||document,n=t.head,r=t.createElement("style"),o=null;r.setAttribute("data-merge-styles","true");var i=this._config.cspSettings;if(i&&i.nonce&&r.setAttribute("nonce",i.nonce),this._lastStyleElement)o=this._lastStyleElement.nextElementSibling;else{var a=this._findPlaceholderStyleTag();o=a?a.nextElementSibling:n.childNodes[0]}return n.insertBefore(r,n.contains(o)?o:null),this._lastStyleElement=r,r},e.prototype._insertRuleIntoSheet=function(e,t){if(!e)return!1;try{return e.insertRule(t,e.cssRules.length),!0}catch(e){}return!1},e.prototype._getCacheKey=function(e){return e},e.prototype._getStyleElement=function(){var e=this;return this._styleElement||(this._styleElement=this._createStyleElement(),l||(this._config.window||window).requestAnimationFrame(function(){e._styleElement=void 0})),this._styleElement},e.prototype._findPlaceholderStyleTag=function(){var e=document.head;return e?e.querySelector("style[data-merge-styles]"):null},e}()},280(e,t,n){n.d(t,{Z:()=>s});var r=n(62),o=n(226),i=n(884),a=n(228),l=n(353);function s(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(e,t){var n=e instanceof Array?e:[e],i=t||{};(0,o.db)(n[0])&&(i.shadowConfig=n[0]),i.stylesheet=a.nr.getInstance(i.shadowConfig);var s=(0,r.h)(i.stylesheet,n),c=s.classes,u=s.objects;return u.length&&c.push((0,l.kG)(i,u)),c.join(" ")}(e,(0,i.Iy)())}},293(e,t,n){n.d(t,{J5:()=>d,J9:()=>u});var r=n(228),o=!1,i=0,a={empty:!0},l={},s="undefined"==typeof WeakMap?null:WeakMap;function c(){i++}function u(e,t,n){if(void 0===t&&(t=100),void 0===n&&(n=!1),!s)return e;if(!o){var a=r.nr.getInstance();a&&a.onReset&&r.nr.getInstance().onReset(c),o=!0}var l,u=0,d=i;return function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];var a=l;(void 0===l||d!==i||t>0&&u>t)&&(l=p(),u=0,d=i),a=l;for(var s=0;s<r.length;s++){var c=h(r[s]);a.map.has(c)||a.map.set(c,p()),a=a.map.get(c)}return a.hasOwnProperty("value")||(a.value=e.apply(void 0,r),u++),!n||null!==a.value&&void 0!==a.value||(a.value=e.apply(void 0,r)),a.value}}function d(e){if(!s)return e;var t=new s;return function(n){if(!n||"function"!=typeof n&&"object"!=typeof n)return e(n);if(t.has(n))return t.get(n);var r=e(n);return t.set(n,r),r}}function h(e){return e?"object"==typeof e||"function"==typeof e?e:(l[e]||(l[e]={val:e}),l[e]):a}function p(){return{map:s?new s:null}}},353(e,t,n){n.d(t,{Ae:()=>T,bz:()=>E,kG:()=>D,GJ:()=>S});var r,o=n(462),i=n(228),a={};function l(e,t){var n=e[t];"-"!==n.charAt(0)&&(e[t]=a[n]=a[n]||n.replace(/([A-Z])/g,"-$1").toLowerCase())}var s={"user-select":1};function c(e,t){var n=function(){var e;if(!r){var t="undefined"!=typeof document?document:void 0,n="undefined"!=typeof navigator?navigator:void 0,o=null===(e=null==n?void 0:n.userAgent)||void 0===e?void 0:e.toLowerCase();r=t?{isWebkit:!(!t||!("WebkitAppearance"in t.documentElement.style)),isMoz:!!(o&&o.indexOf("firefox")>-1),isOpera:!!(o&&o.indexOf("opera")>-1),isMs:!(!n||!/rv:11.0/i.test(n.userAgent)&&!/Edge\/\d./i.test(navigator.userAgent))}:{isWebkit:!0,isMoz:!0,isOpera:!0,isMs:!0}}return r}(),o=e[t];if(s[o]){var i=e[t+1];s[o]&&(n.isWebkit&&e.push("-webkit-"+o,i),n.isMoz&&e.push("-moz-"+o,i),n.isMs&&e.push("-ms-"+o,i),n.isOpera&&e.push("-o-"+o,i))}}var u,d=["column-count","font-weight","flex","flex-grow","flex-shrink","fill-opacity","opacity","order","z-index","zoom"];function h(e,t){var n=e[t],r=e[t+1];if("number"==typeof r){var o=d.indexOf(n)>-1,i=n.indexOf("--")>-1,a=o||i?"":"px";e[t+1]="".concat(r).concat(a)}}var p="left",f="right",g=((u={})[p]=f,u[f]=p,u),v={"w-resize":"e-resize","sw-resize":"se-resize","nw-resize":"ne-resize"};function m(e,t,n){if(e.rtl){var r=t[n];if(!r)return;var o=t[n+1];if("string"==typeof o&&o.indexOf("@noflip")>=0)t[n+1]=o.replace(/\s*(?:\/\*\s*)?\@noflip\b(?:\s*\*\/)?\s*?/g,"");else if(r.indexOf(p)>=0)t[n]=r.replace(p,f);else if(r.indexOf(f)>=0)t[n]=r.replace(f,p);else if(String(o).indexOf(p)>=0)t[n+1]=o.replace(p,f);else if(String(o).indexOf(f)>=0)t[n+1]=o.replace(f,p);else if(g[r])t[n]=g[r];else if(v[o])t[n+1]=v[o];else switch(r){case"margin":case"padding":t[n+1]=function(e){if("string"==typeof e){var t=e.split(" ");if(4===t.length)return"".concat(t[0]," ").concat(t[3]," ").concat(t[2]," ").concat(t[1])}return e}(o);break;case"box-shadow":t[n+1]=function(e){var t=e.split(" "),n=parseInt(t[0],10);return t[0]=t[0].replace(String(n),String(-1*n)),t.join(" ")}(o)}}}var y=/\:global\((.+?)\)/g;function _(e){return e.indexOf(":global(")>=0||0===e.indexOf(":")}function x(e,t){return e.indexOf(":global(")>=0?e.replace(y,"$1"):0===e.indexOf(":host(")?e:0===e.indexOf(":")?t+e:e.indexOf("&")<0?t+" "+e:e}function b(e,t,n,r,o){void 0===t&&(t={__order:[]}),0===n.indexOf("@")?C([r],t,n=n+"{"+e,o):n.indexOf(",")>-1?function(e){if(!y.test(e))return e;for(var t=[],n=/\:global\((.+?)\)/g,r=null;r=n.exec(e);)r[1].indexOf(",")>-1&&t.push([r.index,r.index+r[0].length,r[1].split(",").map(function(e){return":global(".concat(e.trim(),")")}).join(", ")]);return t.reverse().reduce(function(e,t){var n=t[0],r=t[1],o=t[2];return e.slice(0,n)+o+e.slice(r)},e)}(n).split(",").map(function(e){return e.trim()}).forEach(function(n){return C([r],t,x(n,e),o)}):C([r],t,x(n,e),o)}function C(e,t,n,r){void 0===t&&(t={__order:[]}),void 0===n&&(n="&");var o=t[n];o||(o={},t[n]=o,t.__order.push(n));for(var i=0,a=e;i<a.length;i++){var l=a[i];if("string"==typeof l){var s=r.argsFromClassName(l);s&&C(s,t,n,r)}else if(Array.isArray(l))C(l,t,n,r);else for(var c in l)if(l.hasOwnProperty(c)){var u=l[c];if("selectors"===c){var d=l.selectors;for(var h in d)d.hasOwnProperty(h)&&b(n,t,h,d[h],r)}else"object"==typeof u||_(c)?null!=u&&b(n,t,c,u,r):void 0!==u&&("margin"===c||"padding"===c?k(o,c,u):o[c]=u)}}return t}function k(e,t,n){var r="string"==typeof n?function(e){for(var t=[],n=0,r=0,o=0;o<e.length;o++)switch(e[o]){case"(":r++;break;case")":r&&r--;break;case"\t":case" ":r||(o>n&&t.push(e.substring(n,o)),n=o+1)}return n<e.length&&t.push(e.substring(n)),t}(n):[n];0===r.length&&r.push(n),"!important"===r[r.length-1]&&(r=r.slice(0,-1).map(function(e){return e+" !important"})),e[t+"Top"]=r[0],e[t+"Right"]=r[1]||r[0],e[t+"Bottom"]=r[2]||r[0],e[t+"Left"]=r[3]||r[1]||r[0]}function w(e,t){return t<=0?"":1===t?e:e+w(e,t-1)}function E(e,t){if(!t)return"";var n=[];for(var r in t)t.hasOwnProperty(r)&&"displayName"!==r&&void 0!==t[r]&&n.push(r,t[r]);for(var o=0;o<n.length;o+=2)l(n,o),h(n,o),m(e,n,o),c(n,o);for(o=1;o<n.length;o+=4)n.splice(o,1,":",n[o],";");return n.join("")}function S(e){for(var t,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var o=null!==(t=e.stylesheet)&&void 0!==t?t:i.nr.getInstance(e.shadowConfig),a=C(n,void 0,void 0,o),l=function(e,t){for(var n=[e.rtl?"rtl":"ltr"],r=!1,o=0,i=t.__order;o<i.length;o++){var a=i[o];n.push(a);var l=t[a];for(var s in l)l.hasOwnProperty(s)&&void 0!==l[s]&&(r=!0,n.push(s,l[s]))}return r?n.join(""):void 0}(e,a);if(l){var s={className:o.classNameFromKey(l),key:l,args:n};if(!s.className){s.className=o.getClassName(function(e){var t=e&&e["&"];return t?t.displayName:void 0}(a));for(var c=[],u=0,d=a.__order;u<d.length;u++){var h=d[u];c.push(h,E(e,a[h]))}s.rulesToInsert=c}return s}}function T(e,t,n,r){void 0===t&&(t=1);var o=null!=r?r:i.nr.getInstance(n),a=e.className,l=e.key,s=e.args,c=e.rulesToInsert;if(c){for(var u=0;u<c.length;u+=2){var d=c[u+1];if(d){var h=c[u];h=h.replace(/&/g,w(".".concat(e.className),t));var p="".concat(h,"{").concat(d,"}").concat(0===h.indexOf("@")?"}":"");o.insertRule(p)}}o.cacheClassName(a,l,s,c)}}function D(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=S.apply(void 0,(0,o.fX)([e],t,!1));return r?(T(r,e.specificityMultiplier,e.shadowConfig,e.stylesheet),r.className):""}},358(e,t,n){n.d(t,{z:()=>i});var r=n(85),o=void 0;try{o=window}catch(e){}function i(e){if((0,r.S)()&&void 0!==o){var t=e;return t&&t.ownerDocument&&t.ownerDocument.defaultView?t.ownerDocument.defaultView:o}}},403(e,t,n){n.d(t,{Y:()=>o});var r=n(85);function o(e){if((0,r.S)()&&"undefined"!=typeof document){var t=e;return t&&t.ownerDocument?t.ownerDocument:document}}},462(e,t,n){n.d(t,{C6:()=>o,Cl:()=>i,Tt:()=>a,YH:()=>s,fX:()=>c,sH:()=>l});var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)};function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var i=function(){return i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},i.apply(this,arguments)};function a(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}function l(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function l(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){e.done?o(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(a,l)}s((r=r.apply(e,t||[])).next())})}function s(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=l(0),a.throw=l(1),a.return=l(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function l(l){return function(s){return function(l){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,l[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&l[0]?r.return:l[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,l[1])).done)return o;switch(r=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return i.label++,{value:l[1],done:!1};case 5:i.label++,r=l[1],l=[0];continue;case 7:l=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){i=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){i.label=l[1];break}if(6===l[0]&&i.label<o[1]){i.label=o[1],o=l;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(l);break}o[2]&&i.ops.pop(),i.trys.pop();continue}l=t.call(e,i)}catch(e){l=[6,e],r=0}finally{n=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}}function c(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))}Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError},497(e,t,n){n.d(t,{ChartHoverCard:()=>d});var r=n(882),o=n(462),i=n(31),a=n(93),l=n(794),s=(0,a.Z)(),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.C6)(t,e),t.prototype.render=function(){var e=this.props,t=e.color,n=e.Legend,r=e.XValue,o=e.YValue,a=e.styles,c=e.theme,u=e.ratio,d=e.descriptionMessage,h=e.culture;return this._classNames=s(a,{theme:c,color:t,XValue:r,isRatioPresent:!!u}),i.createElement("div",{className:this._classNames.calloutContentRoot},i.createElement("div",{className:this._classNames.calloutDateTimeContainer},i.createElement("div",{className:this._classNames.calloutContentX},r," ")),i.createElement("div",{className:this._classNames.calloutInfoContainer},i.createElement("div",{className:this._classNames.calloutBlockContainer},i.createElement("div",{className:this._classNames.calloutlegendText},(0,l.c$)(n,h)),i.createElement("div",{className:this._classNames.calloutContentY},(0,l.c$)(o,h))),!!u&&i.createElement("div",{className:this._classNames.ratio},i.createElement(i.Fragment,null,i.createElement("span",{className:this._classNames.numerator},(0,l.c$)(u[0],h)),"/",i.createElement("span",{className:this._classNames.denominator},(0,l.c$)(u[1],h))))),!!d&&i.createElement("div",{className:this._classNames.descriptionMessage},d))},t}(i.Component),u=n(811),d=(0,r.I)(c,function(e){var t,n,r,o=e.color,i=e.XValue,a=e.theme,l=e.isRatioPresent,s=void 0!==l&&l;return{calloutContentRoot:[{display:"grid",overflow:"hidden",padding:"11px 16px 10px 16px",backgroundColor:a.semanticColors.bodyBackground,backgroundBlendMode:"normal, luminosity"}],calloutDateTimeContainer:{display:"flex",flexDirection:"row",justifyContent:"space-between"},calloutContentX:[a.fonts.small,{lineHeight:"16px",opacity:"0.85",color:a.semanticColors.bodySubtext}],calloutBlockContainer:[a.fonts.xxLarge,{marginTop:i?"13px":"unset",paddingLeft:"8px",lineHeight:"22px",color:a.semanticColors.bodyText,borderLeft:"4px solid ".concat(o),selectors:(t={},t[u.up]={forcedColorAdjust:"none"},t)}],calloutlegendText:[a.fonts.small,{lineHeight:"16px",color:a.semanticColors.bodyText,selectors:(n={},n[u.up]={color:"CanvasText"},n)}],calloutContentY:[a.fonts.xxLarge,{color:o||a.semanticColors.bodyText,fontWeight:"bold",lineHeight:"36px",selectors:(r={},r[u.up]={color:"CanvasText"},r)}],calloutInfoContainer:[s&&{display:"flex",alignItems:"flex-end"}],ratio:[a.fonts.small,{marginLeft:"6px",color:a.semanticColors.bodyText}],numerator:{fontWeight:u.BO.bold},denominator:{fontWeight:u.BO.semibold},descriptionMessage:[a.fonts.small,{color:a.semanticColors.bodyText,marginTop:"10px",paddingTop:"10px",borderTop:"1px solid ".concat(a.semanticColors.menuDivider)}]}})},585(e,t,n){n.d(t,{Y2:()=>r});var r="ms-Fabric--isFocusVisible"},702(e,t,n){n.d(t,{a:()=>M});var r,o={themeDarker:"#004578",themeDark:"#005a9e",themeDarkAlt:"#106ebe",themePrimary:"#0078d4",themeSecondary:"#2b88d8",themeTertiary:"#71afe5",themeLight:"#c7e0f4",themeLighter:"#deecf9",themeLighterAlt:"#eff6fc",black:"#000000",blackTranslucent40:"rgba(0,0,0,.4)",neutralDark:"#201f1e",neutralPrimary:"#323130",neutralPrimaryAlt:"#3b3a39",neutralSecondary:"#605e5c",neutralSecondaryAlt:"#8a8886",neutralTertiary:"#a19f9d",neutralTertiaryAlt:"#c8c6c4",neutralQuaternary:"#d2d0ce",neutralQuaternaryAlt:"#e1dfdd",neutralLight:"#edebe9",neutralLighter:"#f3f2f1",neutralLighterAlt:"#faf9f8",accent:"#0078d4",white:"#ffffff",whiteTranslucent40:"rgba(255,255,255,.4)",yellowDark:"#d29200",yellow:"#ffb900",yellowLight:"#fff100",orange:"#d83b01",orangeLight:"#ea4300",orangeLighter:"#ff8c00",redDark:"#a4262c",red:"#e81123",magentaDark:"#5c005c",magenta:"#b4009e",magentaLight:"#e3008c",purpleDark:"#32145a",purple:"#5c2d91",purpleLight:"#b4a0ff",blueDark:"#002050",blueMid:"#00188f",blue:"#0078d4",blueLight:"#00bcf2",tealDark:"#004b50",teal:"#008272",tealLight:"#00b294",greenDark:"#004b1c",green:"#107c10",greenLight:"#bad80a"};!function(e){e.depth0="0 0 0 0 transparent",e.depth4="0 1.6px 3.6px 0 rgba(0, 0, 0, 0.132), 0 0.3px 0.9px 0 rgba(0, 0, 0, 0.108)",e.depth8="0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132), 0 0.6px 1.8px 0 rgba(0, 0, 0, 0.108)",e.depth16="0 6.4px 14.4px 0 rgba(0, 0, 0, 0.132), 0 1.2px 3.6px 0 rgba(0, 0, 0, 0.108)",e.depth64="0 25.6px 57.6px 0 rgba(0, 0, 0, 0.22), 0 4.8px 14.4px 0 rgba(0, 0, 0, 0.18)"}(r||(r={}));var i={elevation4:r.depth4,elevation8:r.depth8,elevation16:r.depth16,elevation64:r.depth64,roundedCorner2:"2px",roundedCorner4:"4px",roundedCorner6:"6px"},a=n(884),l=n(228),s=n(353),c=n(61),u="'Segoe UI', '".concat(c.Dn.WestEuropean,"'"),d={ar:c.bi.Arabic,bg:c.bi.Cyrillic,cs:c.bi.EastEuropean,el:c.bi.Greek,et:c.bi.EastEuropean,he:c.bi.Hebrew,hi:c.bi.Hindi,hr:c.bi.EastEuropean,hu:c.bi.EastEuropean,ja:c.bi.Japanese,kk:c.bi.EastEuropean,ko:c.bi.Korean,lt:c.bi.EastEuropean,lv:c.bi.EastEuropean,pl:c.bi.EastEuropean,ru:c.bi.Cyrillic,sk:c.bi.EastEuropean,"sr-latn":c.bi.EastEuropean,th:c.bi.Thai,tr:c.bi.EastEuropean,uk:c.bi.Cyrillic,vi:c.bi.Vietnamese,"zh-hans":c.bi.ChineseSimplified,"zh-hant":c.bi.ChineseTraditional,hy:c.bi.Armenian,ka:c.bi.Georgian};function h(e,t,n){return{fontFamily:n,MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontSize:e,fontWeight:t}}var p,f,g,v=n(403),m=n(358),y=n(800),_="language",x=(f=function(e){for(var t in d)if(d.hasOwnProperty(t)&&e&&0===t.indexOf(e))return d[t];return u}(function(e){if(void 0===e&&(e="sessionStorage"),void 0===p){var t=(0,v.Y)(),n="localStorage"===e?function(e){var t=null;try{var n=(0,m.z)();t=n?n.localStorage.getItem(e):null}catch(e){}return t}(_):"sessionStorage"===e?y.G(_):void 0;n&&(p=n),void 0===p&&t&&(p=t.documentElement.getAttribute("lang")),void 0===p&&(p="en")}return p}()),g="".concat(f,", ").concat("'Segoe UI', -apple-system, BlinkMacSystemFont, 'Roboto', 'Helvetica Neue', sans-serif"),{tiny:h(c.s.mini,c.BO.regular,g),xSmall:h(c.s.xSmall,c.BO.regular,g),small:h(c.s.small,c.BO.regular,g),smallPlus:h(c.s.smallPlus,c.BO.regular,g),medium:h(c.s.medium,c.BO.regular,g),mediumPlus:h(c.s.mediumPlus,c.BO.regular,g),large:h(c.s.large,c.BO.regular,g),xLarge:h(c.s.xLarge,c.BO.semibold,g),xLargePlus:h(c.s.xLargePlus,c.BO.semibold,g),xxLarge:h(c.s.xxLarge,c.BO.semibold,g),xxLargePlus:h(c.s.xxLargePlus,c.BO.semibold,g),superLarge:h(c.s.superLarge,c.BO.semibold,g),mega:h(c.s.mega,c.BO.semibold,g)});function b(e,t,n,r){!function(e){var t=l.nr.getInstance(),n=(0,s.bz)((0,a.Iy)(),e);if(!t.classNameFromKey(n)){var r=t.getClassName();t.insertRule("@font-face{".concat(n,"}"),!0),t.cacheClassName(r,n,[],["font-face",n])}}({fontFamily:e="'".concat(e,"'"),src:(void 0!==r?"local('".concat(r,"'),"):"")+"url('".concat(t,".woff2') format('woff2'),")+"url('".concat(t,".woff') format('woff')"),fontWeight:n,fontStyle:"normal",fontDisplay:"swap"})}function C(e,t,n,r,o){void 0===r&&(r="segoeui");var i="".concat(e,"/").concat(n,"/").concat(r);b(t,i+"-light",c.BO.light,o&&o+" Light"),b(t,i+"-semilight",c.BO.semilight,o&&o+" SemiLight"),b(t,i+"-regular",c.BO.regular,o),b(t,i+"-semibold",c.BO.semibold,o&&o+" SemiBold"),b(t,i+"-bold",c.BO.bold,o&&o+" Bold")}function k(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=0,o=t;r<o.length;r++)w(e||{},o[r]);return e}function w(e,t,n){for(var r in void 0===n&&(n=[]),n.push(t),t)if(t.hasOwnProperty(r)&&"__proto__"!==r&&"constructor"!==r&&"prototype"!==r){var o=t[r];if("object"!=typeof o||null===o||Array.isArray(o))e[r]=o;else{var i=n.indexOf(o)>-1;e[r]=i?o:w(e[r]||{},o,n)}}return n.pop(),e}!function(e){if(e){var t="".concat(e,"/fonts");C(t,c.Dn.Thai,"leelawadeeui-thai","leelawadeeui"),C(t,c.Dn.Arabic,"segoeui-arabic"),C(t,c.Dn.Cyrillic,"segoeui-cyrillic"),C(t,c.Dn.EastEuropean,"segoeui-easteuropean"),C(t,c.Dn.Greek,"segoeui-greek"),C(t,c.Dn.Hebrew,"segoeui-hebrew"),C(t,c.Dn.Vietnamese,"segoeui-vietnamese"),C(t,c.Dn.WestEuropean,"segoeui-westeuropean","segoeui","Segoe UI"),C(t,c.bi.Selawik,"selawik","selawik"),C(t,c.Dn.Armenian,"segoeui-armenian"),C(t,c.Dn.Georgian,"segoeui-georgian"),b("Leelawadee UI Web","".concat(t,"/leelawadeeui-thai/leelawadeeui-semilight"),c.BO.light),b("Leelawadee UI Web","".concat(t,"/leelawadeeui-thai/leelawadeeui-bold"),c.BO.semibold)}}(function(){var e,t,n=null===(e=(0,m.z)())||void 0===e?void 0:e.FabricConfig;return null!==(t=null==n?void 0:n.fontBaseUrl)&&void 0!==t?t:"https://res-1.cdn.office.net/files/fabric-cdn-prod_20230815.002/assets"}());var E=n(462);function S(e,t,n,r,o){return void 0===o&&(o=!1),function(e,t){var n="";return!0===t&&(n=" /* @deprecated */"),e.listTextColor=e.listText+n,e.menuItemBackgroundChecked+=n,e.warningHighlight+=n,e.warningText=e.messageText+n,e.successText+=n,e}(T(e,t,(0,E.Cl)({primaryButtonBorder:"transparent",errorText:r?"#F1707B":"#a4262c",messageText:r?"#F3F2F1":"#323130",messageLink:r?"#6CB8F6":"#005A9E",messageLinkHovered:r?"#82C7FF":"#004578",infoIcon:r?"#C8C6C4":"#605e5c",errorIcon:r?"#F1707B":"#A80000",blockingIcon:r?"#442726":"#FDE7E9",warningIcon:r?"#C8C6C4":"#797775",severeWarningIcon:r?"#FCE100":"#D83B01",successIcon:r?"#92C353":"#107C10",infoBackground:r?"#323130":"#f3f2f1",errorBackground:r?"#442726":"#FDE7E9",blockingBackground:r?"#442726":"#FDE7E9",warningBackground:r?"#433519":"#FFF4CE",severeWarningBackground:r?"#4F2A0F":"#FED9CC",successBackground:r?"#393D1B":"#DFF6DD",warningHighlight:r?"#fff100":"#ffb900",successText:r?"#92c353":"#107C10"},n),r),o)}function T(e,t,n,r,o){void 0===o&&(o=!1);var i={},a=e||{},l=a.white,s=a.black,c=a.themePrimary,u=a.themeDark,d=a.themeDarker,h=a.themeDarkAlt,p=a.themeLighter,f=a.neutralLight,g=a.neutralLighter,v=a.neutralDark,m=a.neutralQuaternary,y=a.neutralQuaternaryAlt,_=a.neutralPrimary,x=a.neutralSecondary,b=a.neutralSecondaryAlt,C=a.neutralTertiary,k=a.neutralTertiaryAlt,w=a.neutralLighterAlt,S=a.accent;return l&&(i.bodyBackground=l,i.bodyFrameBackground=l,i.accentButtonText=l,i.buttonBackground=l,i.primaryButtonText=l,i.primaryButtonTextHovered=l,i.primaryButtonTextPressed=l,i.inputBackground=l,i.inputForegroundChecked=l,i.listBackground=l,i.menuBackground=l,i.cardStandoutBackground=l),s&&(i.bodyTextChecked=s,i.buttonTextCheckedHovered=s),c&&(i.link=c,i.primaryButtonBackground=c,i.inputBackgroundChecked=c,i.inputIcon=c,i.inputFocusBorderAlt=c,i.menuIcon=c,i.menuHeader=c,i.accentButtonBackground=c),u&&(i.primaryButtonBackgroundPressed=u,i.inputBackgroundCheckedHovered=u,i.inputIconHovered=u),d&&(i.linkHovered=d),h&&(i.primaryButtonBackgroundHovered=h),p&&(i.inputPlaceholderBackgroundChecked=p),f&&(i.bodyBackgroundChecked=f,i.bodyFrameDivider=f,i.bodyDivider=f,i.variantBorder=f,i.buttonBackgroundCheckedHovered=f,i.buttonBackgroundPressed=f,i.listItemBackgroundChecked=f,i.listHeaderBackgroundPressed=f,i.menuItemBackgroundPressed=f,i.menuItemBackgroundChecked=f),g&&(i.bodyBackgroundHovered=g,i.buttonBackgroundHovered=g,i.buttonBackgroundDisabled=g,i.buttonBorderDisabled=g,i.primaryButtonBackgroundDisabled=g,i.disabledBackground=g,i.listItemBackgroundHovered=g,i.listHeaderBackgroundHovered=g,i.menuItemBackgroundHovered=g),m&&(i.primaryButtonTextDisabled=m,i.disabledSubtext=m),y&&(i.listItemBackgroundCheckedHovered=y),C&&(i.disabledBodyText=C,i.variantBorderHovered=(null==n?void 0:n.variantBorderHovered)||C,i.buttonTextDisabled=C,i.inputIconDisabled=C,i.disabledText=C),_&&(i.bodyText=_,i.actionLink=_,i.buttonText=_,i.inputBorderHovered=_,i.inputText=_,i.listText=_,i.menuItemText=_),w&&(i.bodyStandoutBackground=w,i.defaultStateBackground=w),v&&(i.actionLinkHovered=v,i.buttonTextHovered=v,i.buttonTextChecked=v,i.buttonTextPressed=v,i.inputTextHovered=v,i.menuItemTextHovered=v),x&&(i.bodySubtext=x,i.focusBorder=x,i.inputBorder=x,i.smallInputBorder=x,i.inputPlaceholderText=x),b&&(i.buttonBorder=b),k&&(i.disabledBodySubtext=k,i.disabledBorder=k,i.buttonBackgroundChecked=k,i.menuDivider=k),S&&(i.accentButtonBackground=S),(null==t?void 0:t.elevation4)&&(i.cardShadow=t.elevation4),!r&&(null==t?void 0:t.elevation8)?i.cardShadowHovered=t.elevation8:i.variantBorderHovered&&(i.cardShadowHovered="0 0 1px "+i.variantBorderHovered),(0,E.Cl)((0,E.Cl)({},i),n)}var D={s2:"4px",s1:"8px",m:"16px",l1:"20px",l2:"32px"};function M(e,t){void 0===e&&(e={}),void 0===t&&(t=!1);var n=!!e.isInverted;return function(e,t){var n,r,o;void 0===t&&(t={});var i=k({},e,t,{semanticColors:T(t.palette,t.effects,t.semanticColors,void 0===t.isInverted?e.isInverted:t.isInverted)});if((null===(n=t.palette)||void 0===n?void 0:n.themePrimary)&&!(null===(r=t.palette)||void 0===r?void 0:r.accent)&&(i.palette.accent=t.palette.themePrimary),t.defaultFontStyle)for(var a=0,l=Object.keys(i.fonts);a<l.length;a++){var s=l[a];i.fonts[s]=k(i.fonts[s],t.defaultFontStyle,null===(o=null==t?void 0:t.fonts)||void 0===o?void 0:o[s])}return i}({palette:o,effects:i,fonts:x,spacing:D,isInverted:n,disableGlobalClassNames:!1,semanticColors:S(o,i,void 0,n,t),rtl:void 0},e)}},790(e,t,n){n.d(t,{z:()=>r});var r=n(31).createContext({customizations:{inCustomizerContext:!1,settings:{},scopedSettings:{}}})},794(e,t,n){function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach(function(t){i(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function i(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e){var t=Math.round(e);return Math.abs(e-t)<1e-6?t:e}n.d(t,{Di:()=>a,Yn:()=>c,c$:()=>l,c2:()=>u});var l=(e,t,n)=>{if(null==e||""===e||Number.isNaN(e))return e;if(t=t||void 0,"number"==typeof e){var r=Math.abs(e)>=1e4;return a(e).toLocaleString(t,{useGrouping:r})}if("string"==typeof e&&!window.isNaN(Number(e))){var o=Number(e),i=Math.abs(o)>=1e4;return a(o).toLocaleString(t,{useGrouping:i})}return e instanceof Date?c(e,t,!!n):e},s={year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0},c=function(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=arguments.length>4?arguments[4]:void 0;return t=t||void 0,i=i||s,n&&(i=o(o({},i),{},{timeZone:"UTC"})),r&&(i=o(o({},i),{},{timeZoneName:"short"})),e.toLocaleString(t,i)};function u(e,t){var n={second:"2-digit"},r={minute:"2-digit",second:"2-digit"},o={hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0},i={weekday:"short",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"},a={month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"},l={hour:"2-digit",minute:"2-digit",hour12:!0},c={month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!0},u={month:"short",day:"2-digit",hour:"2-digit",hour12:!0},d={month:"short",day:"2-digit"},h={year:"numeric",month:"2-digit",day:"2-digit"},p=[[n,n,r,o,i,a,a,s],[s,n,r,o,i,a,a,s],[s,s,l,l,{weekday:"short",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!0},c,c,{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!0}],[s,s,s,{hour:"2-digit",hour12:!0},{weekday:"short",day:"2-digit",hour:"2-digit",hour12:!0},u,u,{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",hour12:!0}],[s,s,s,s,{weekday:"short",day:"2-digit"},d,d,h],[s,s,s,s,s,d,d,h],[s,s,s,s,s,s,{month:"long"},{month:"short",year:"numeric"}],[s,s,s,s,s,s,s,{year:"numeric"}]];return void 0===e||e<0||e>=p.length?s:void 0===t||t<e?p[e][e]:t>=p[e].length?p[e][p[e].length-1]:p[e][t]}},800(e,t,n){n.d(t,{G:()=>o,S:()=>i});var r=n(358);function o(e){var t=null;try{var n=(0,r.z)();t=n?n.sessionStorage.getItem(e):null}catch(e){}return t}function i(e,t){var n;try{null===(n=(0,r.z)())||void 0===n||n.sessionStorage.setItem(e,t)}catch(e){}}},811(e,t,n){n.d(t,{lw:()=>$,s:()=>ke.s,BO:()=>ke.BO,up:()=>ne,nA:()=>te,QN:()=>ie,gm:()=>oe,Km:()=>ee,O4:()=>Ce,dX:()=>J});var r=n(280),o=n(884),i=n(228),a=n(353);function l(e){var t=i.nr.getInstance(),n=[];for(var r in e)e.hasOwnProperty(r)&&n.push(r,"{",(0,a.bz)((0,o.Iy)(),e[r]),"}");var l=n.join(""),s=t.classNameFromKey(l);if(s)return s;var c=t.getClassName();return t.insertRule("@keyframes ".concat(c,"{").concat(l,"}"),!0),t.cacheClassName(c,l,[],["keyframes",l]),c}var s="cubic-bezier(.1,.9,.2,1)",c="cubic-bezier(.1,.25,.75,.9)",u="0.167s",d="0.267s",h="0.367s",p="0.467s",f=l({from:{opacity:0},to:{opacity:1}}),g=l({from:{opacity:1},to:{opacity:0,visibility:"hidden"}}),v=q(-10),m=q(-20),y=q(-40),_=q(-400),x=q(10),b=q(20),C=q(40),k=q(400),w=G(10),E=G(20),S=G(-10),T=G(-20),D=K(10),M=K(20),A=K(40),L=K(400),P=K(-10),I=K(-20),N=K(-40),O=K(-400),F=Z(-10),R=Z(-20),V=Z(10),B=Z(20),H=l({from:{transform:"scale3d(.98,.98,1)"},to:{transform:"scale3d(1,1,1)"}}),z=l({from:{transform:"scale3d(1,1,1)"},to:{transform:"scale3d(.98,.98,1)"}}),W=l({from:{transform:"scale3d(1.03,1.03,1)"},to:{transform:"scale3d(1,1,1)"}}),Y=l({from:{transform:"scale3d(1,1,1)"},to:{transform:"scale3d(1.03,1.03,1)"}}),j=l({from:{transform:"rotateZ(0deg)"},to:{transform:"rotateZ(90deg)"}}),U=l({from:{transform:"rotateZ(0deg)"},to:{transform:"rotateZ(-90deg)"}});function X(e,t,n){return{animationName:e,animationDuration:t,animationTimingFunction:n,animationFillMode:"both"}}function q(e){return l({from:{transform:"translate3d(".concat(e,"px,0,0)"),pointerEvents:"none"},to:{transform:"translate3d(0,0,0)",pointerEvents:"auto"}})}function G(e){return l({from:{transform:"translate3d(0,".concat(e,"px,0)"),pointerEvents:"none"},to:{transform:"translate3d(0,0,0)",pointerEvents:"auto"}})}function K(e){return l({from:{transform:"translate3d(0,0,0)"},to:{transform:"translate3d(".concat(e,"px,0,0)")}})}function Z(e){return l({from:{transform:"translate3d(0,0,0)"},to:{transform:"translate3d(0,".concat(e,"px,0)")}})}var $=function(e){var t={},n=function(n){var o;e.hasOwnProperty(n)&&Object.defineProperty(t,n,{get:function(){return void 0===o&&(o=(0,r.Z)(e[n]).toString()),o},enumerable:!0,configurable:!0})};for(var o in e)n(o);return t}({slideRightIn10:X("".concat(f,",").concat(v),h,s),slideRightIn20:X("".concat(f,",").concat(m),h,s),slideRightIn40:X("".concat(f,",").concat(y),h,s),slideRightIn400:X("".concat(f,",").concat(_),h,s),slideLeftIn10:X("".concat(f,",").concat(x),h,s),slideLeftIn20:X("".concat(f,",").concat(b),h,s),slideLeftIn40:X("".concat(f,",").concat(C),h,s),slideLeftIn400:X("".concat(f,",").concat(k),h,s),slideUpIn10:X("".concat(f,",").concat(w),h,s),slideUpIn20:X("".concat(f,",").concat(E),h,s),slideDownIn10:X("".concat(f,",").concat(S),h,s),slideDownIn20:X("".concat(f,",").concat(T),h,s),slideRightOut10:X("".concat(g,",").concat(D),h,s),slideRightOut20:X("".concat(g,",").concat(M),h,s),slideRightOut40:X("".concat(g,",").concat(A),h,s),slideRightOut400:X("".concat(g,",").concat(L),h,s),slideLeftOut10:X("".concat(g,",").concat(P),h,s),slideLeftOut20:X("".concat(g,",").concat(I),h,s),slideLeftOut40:X("".concat(g,",").concat(N),h,s),slideLeftOut400:X("".concat(g,",").concat(O),h,s),slideUpOut10:X("".concat(g,",").concat(F),h,s),slideUpOut20:X("".concat(g,",").concat(R),h,s),slideDownOut10:X("".concat(g,",").concat(V),h,s),slideDownOut20:X("".concat(g,",").concat(B),h,s),scaleUpIn100:X("".concat(f,",").concat(H),h,s),scaleDownIn100:X("".concat(f,",").concat(W),h,s),scaleUpOut103:X("".concat(g,",").concat(Y),u,c),scaleDownOut98:X("".concat(g,",").concat(z),u,c),fadeIn100:X(f,u,c),fadeIn200:X(f,d,c),fadeIn400:X(f,h,c),fadeIn500:X(f,p,c),fadeOut100:X(g,u,c),fadeOut200:X(g,d,c),fadeOut400:X(g,h,c),fadeOut500:X(g,p,c),rotate90deg:X(j,"0.1s",c),rotateN90deg:X(U,"0.1s",c)}),J={position:"absolute",width:1,height:1,margin:-1,padding:0,border:0,overflow:"hidden",whiteSpace:"nowrap"},Q=(0,n(293).J9)(function(e,t){var n=i.nr.getInstance();return t?Object.keys(e).reduce(function(t,r){return t[r]=n.getClassName(e[r]),t},{}):e});function ee(e,t,n){return Q(e,void 0!==n?n:t.disableGlobalClassNames)}var te,ne="@media screen and (-ms-high-contrast: active), screen and (forced-colors: active)",re=n(585);function oe(e,t,n,r,o,i,a,l){return function(e,t){var n,r;void 0===t&&(t={});var o=t.borderRadius,i=t.inset,a=void 0===i?0:i,l=t.width,s=void 0===l?1:l,c=t.position,u=void 0===c?"relative":c,d=t.highContrastStyle,h=t.borderColor,p=void 0===h?e.palette.white:h,f=t.outlineColor,g=void 0===f?e.palette.neutralSecondary:f,v=t.isFocusedOnly,m=void 0===v||v,y=t.pointerEvents;return{outline:"transparent",position:u,selectors:(n={"::-moz-focus-inner":{border:"0"}},n[".".concat(re.Y2," &").concat(m?":focus":"",":after, :host(.").concat(re.Y2,") &").concat(m?":focus":"",":after")]={content:'""',position:"absolute",pointerEvents:y,left:a+1,top:a+1,bottom:a+1,right:a+1,border:"".concat(s,"px solid ").concat(p),outline:"".concat(s,"px solid ").concat(g),zIndex:te.FocusStyle,borderRadius:o,selectors:(r={},r[ne]=d,r)},n)}}(e,"number"!=typeof t&&t?t:{inset:t,position:n,highContrastStyle:r,borderColor:o,outlineColor:i,isFocusedOnly:a,borderRadius:l})}function ie(){return{selectors:{"&::-moz-focus-inner":{border:0},"&":{outline:"transparent"}}}}!function(e){e.Nav=1,e.ScrollablePane=1,e.FocusStyle=1,e.Coachmark=1e3,e.Layer=1e6,e.KeytipLayer=1000001}(te||(te={}));var ae,le=n(462),se=n(358),ce=n(202),ue=function(){return ue=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},ue.apply(this,arguments)},de="undefined"==typeof window?n.g:window,he=de&&de.CSPSettings&&de.CSPSettings.nonce,pe=((ae=de.__themeState__||{theme:void 0,lastStyleElement:void 0,registeredStyles:[]}).runState||(ae=ue(ue({},ae),{perf:{count:0,duration:0},runState:{flushTimer:0,mode:0,buffer:[]}})),ae.registeredThemableStyles||(ae=ue(ue({},ae),{registeredThemableStyles:[]})),de.__themeState__=ae,ae);function fe(e){pe.theme=e,function(){if(pe.theme){for(var e=[],t=0,n=pe.registeredThemableStyles;t<n.length;t++){var r=n[t];e.push(r.themableStyle)}e.length>0&&(void 0===(i=1)&&(i=3),3!==i&&2!==i||(ge(pe.registeredStyles),pe.registeredStyles=[]),3!==i&&1!==i||(ge(pe.registeredThemableStyles),pe.registeredThemableStyles=[]),o=[].concat.apply([],e),pe.loadStyles?pe.loadStyles(ve(o).styleString,o):function(e){if("undefined"!=typeof document){var t=document.getElementsByTagName("head")[0],n=document.createElement("style"),r=ve(e),o=r.styleString,i=r.themable;n.setAttribute("data-load-themed-styles","true"),he&&n.setAttribute("nonce",he),n.appendChild(document.createTextNode(o)),pe.perf.count++,t.appendChild(n);var a=document.createEvent("HTMLEvents");a.initEvent("styleinsert",!0,!1),a.args={newStyle:n},document.dispatchEvent(a);var l={styleElement:n,themableStyle:e};i?pe.registeredThemableStyles.push(l):pe.registeredStyles.push(l)}}(o))}var o,i}()}function ge(e){e.forEach(function(e){var t=e&&e.styleElement;t&&t.parentElement&&t.parentElement.removeChild(t)})}function ve(e){var t=pe.theme,n=!1;return{styleString:(e||[]).map(function(e){var r=e.theme;if(r){n=!0;var o=t?t[r]:void 0,i=e.defaultValue||"inherit";return t&&!o&&console&&!(r in t)&&"undefined"!=typeof DEBUG&&DEBUG&&console.warn('Theming value not provided for "'.concat(r,'". Falling back to "').concat(i,'".')),o||i}return e.rawString}).join(""),themable:n}}var me=n(702),ye=(0,me.a)({}),_e=[],xe="theme";function be(){var e,t,n,r=(0,se.z)();(null===(t=null==r?void 0:r.FabricConfig)||void 0===t?void 0:t.legacyTheme)?function(e,t){var n;void 0===t&&(t=!1),ye=(0,me.a)(e,t),fe((0,le.Cl)((0,le.Cl)((0,le.Cl)((0,le.Cl)({},ye.palette),ye.semanticColors),ye.effects),function(e){for(var t={},n=0,r=Object.keys(e.fonts);n<r.length;n++)for(var o=r[n],i=e.fonts[o],a=0,l=Object.keys(i);a<l.length;a++){var s=l[a],c=o+s.charAt(0).toUpperCase()+s.slice(1),u=i[s];"fontSize"===s&&"number"==typeof u&&(u+="px"),t[c]=u}return t}(ye))),ce.X.applySettings(((n={})[xe]=ye,n)),_e.forEach(function(e){try{e(ye)}catch(e){}})}(r.FabricConfig.legacyTheme):ce.X.getSettings([xe]).theme||((null===(n=null==r?void 0:r.FabricConfig)||void 0===n?void 0:n.theme)&&(ye=(0,me.a)(r.FabricConfig.theme)),ce.X.applySettings(((e={})[xe]=ye,e)))}function Ce(e){return void 0===e&&(e=!1),!0===e&&(ye=(0,me.a)({},e)),ye}be();var ke=n(61),we={},Ee=void 0;try{Ee=window}catch(e){}function Se(e,t){if(void 0!==Ee){var n=Ee.__packages__=Ee.__packages__||{};n[e]&&we[e]||(we[e]=t,(n[e]=n[e]||[]).push(t))}}Se("@fluentui/set-version","6.0.0"),Se("@fluentui/style-utilities","8.13.6"),be()},882(e,t,n){n.d(t,{I:()=>p});var r=n(462),o=n(31),i=n(958),a=n(226),l=function(){return!1},s=function(){},c=o.createContext({stylesheets:new Map,useAdoptedStylesheetEx:l,useAdoptedStylesheet:l,useShadowConfig:function(){return a.ou},useMergeStylesShadowRootContext:s,useHasMergeStylesShadowRootContext:l,useMergeStylesRootStylesheets:function(){return new Map},useWindow:s,useStyled:s}),u=n(202),d=n(790);var h=["theme","styles"];function p(e,t,n,a,l){var s=(a=a||{scope:"",fields:void 0}).scope,p=a.fields,f=void 0===p?h:p,g=o.forwardRef(function(a,l){var h,p,g,v,m,y,_,x=o.useRef(void 0),b=(p=f,g=s,v=o.useState(0)[1],m=function(){return v(function(e){return++e})},y=o.useContext(d.z).customizations,_=y.inCustomizerContext,o.useEffect(function(){return _||u.X.observe(m),function(){_||u.X.unobserve(m)}},[_]),u.X.getSettings(p,g,y)),C=b.styles,k=(b.dir,(0,r.Tt)(b,["styles","dir"])),w=n?n(a):void 0,E=(h=o.useContext(c),{useAdoptedStylesheet:h.useAdoptedStylesheet,useAdoptedStylesheetEx:h.useAdoptedStylesheetEx,useShadowConfig:h.useShadowConfig,useMergeStylesShadowRootContext:h.useMergeStylesShadowRootContext,useHasMergeStylesShadowRootContext:h.useHasMergeStylesShadowRootContext,useMergeStylesRootStylesheets:h.useMergeStylesRootStylesheets,useWindow:h.useWindow,useStyled:h.useStyled}).useStyled,S=x.current&&x.current.__cachedInputs__||[],T=a.styles;if(!x.current||C!==S[1]||T!==S[2]){var D=function(e){return function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=[],o=0,a=t;o<a.length;o++){var l=a[o];l&&r.push("function"==typeof l?l(e):l)}return 1===r.length?r[0]:r.length?i.T.apply(void 0,r):{}}(e,t,C,T)};D.__cachedInputs__=[t,C,T],D.__noStyleOverride__=!C&&!T,x.current=D}return x.current.__shadowConfig__=E(s),o.createElement(e,(0,r.Cl)({ref:l},k,w,a,{styles:x.current}))});g.displayName="Styled".concat(e.displayName||e.name);var v=l?o.memo(g):g;return g.displayName&&(v.displayName=g.displayName),v}},884(e,t,n){n.d(t,{DU:()=>i,Iy:()=>l});var r,o=n(226);function i(e){r!==e&&(r=e)}function a(){return void 0===r&&(r="undefined"!=typeof document&&!!document.documentElement&&"rtl"===document.documentElement.getAttribute("dir")),r}function l(){return{rtl:a(),shadowConfig:o.ou}}r=a()},958(e,t,n){n.d(t,{T:()=>i});var r=n(462),o=n(226);function i(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(e&&1===e.length&&e[0]&&!e[0].subComponentStyles&&!(0,o.db)(e[0]))return e[0];for(var n={},a={},l=0,s=e;l<s.length;l++){var c=s[l];if(c&&!(0,o.db)(c))for(var u in c)if(c.hasOwnProperty(u)){if("subComponentStyles"===u&&void 0!==c.subComponentStyles){var d=c.subComponentStyles;for(var h in d)d.hasOwnProperty(h)&&(a.hasOwnProperty(h)?a[h].push(d[h]):a[h]=[d[h]]);continue}var p=n[u],f=c[u];n[u]=void 0===p?f:(0,r.fX)((0,r.fX)([],Array.isArray(p)?p:[p],!0),Array.isArray(f)?f:[f],!0)}}if(Object.keys(a).length>0){n.subComponentStyles={};var g=n.subComponentStyles,v=function(e){if(a.hasOwnProperty(e)){var t=a[e];g[e]=function(e){return i.apply(void 0,t.map(function(t){return"function"==typeof t?t(e):t}))}}};for(var h in a)v(h)}return n}}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;if(void 0===e[r]){var i=new Error("Cannot find module '"+r+"'");throw i.code="MODULE_NOT_FOUND",i}var a=t[r]={exports:{}};return e[r](a,a.exports,n),a.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var r={};n.r(r),n.d(r,{VisualHost:()=>Lg});var o=n(31);const i=ReactDOMv16,a=FluentUIReactv940;var l="undefined"==typeof window?n.g:window,s="@griffel/";function c(e,t){return l[Symbol.for(s+e)]||(l[Symbol.for(s+e)]=t),l[Symbol.for(s+e)]}var u=c("DEFINITION_LOOKUP_TABLE",{}),d="data-make-styles-bucket";function h(e,t){return"___"+function(e){var t=e.length;if(7===t)return e;for(var n=t;n<7;n++)e+="0";return e}(function(e){for(var t,n=0,r=0,o=e.length;o>=4;++r,o-=4)t=1540483477*(65535&(t=255&e.charCodeAt(r)|(255&e.charCodeAt(++r))<<8|(255&e.charCodeAt(++r))<<16|(255&e.charCodeAt(++r))<<24))+(59797*(t>>>16)<<16),n=1540483477*(65535&(t^=t>>>24))+(59797*(t>>>16)<<16)^1540483477*(65535&n)+(59797*(n>>>16)<<16);switch(o){case 3:n^=(255&e.charCodeAt(r+2))<<16;case 2:n^=(255&e.charCodeAt(r+1))<<8;case 1:n=1540483477*(65535&(n^=255&e.charCodeAt(r)))+(59797*(n>>>16)<<16)}return(((n=1540483477*(65535&(n^=n>>>13))+(59797*(n>>>16)<<16))^n>>>15)>>>0).toString(36)}(e+t))}function p(e,t){var n="",r="";for(var o in e){var i=e[o];if(0!==i){var a=Array.isArray(i),l="rtl"===t?(a?i[1]:i)+" ":(a?i[0]:i)+" ";n+=l,r+=l}else r+=o+" "}return[n.slice(0,-1),r.slice(0,-1)]}function f(e,t){var n={};for(var r in e){var[o,i]=p(e[r],t);if(""!==i){var a=h(i,t),l=a+(""===o?"":" "+o);u[a]=[e[r],t],n[r]=l}else n[r]=""}return n}var g={};function v(){for(var e=arguments,t=null,n="",r="",o=new Array(arguments.length),i=function(){var t=e[a];if("string"==typeof t&&""!==t){var i=t.indexOf("___");if(-1===i)n+=t+" ";else{var l=t.substr(i,10);i>0&&(n+=t.slice(0,i)),r+=l,o[a]=l}}},a=0;a<arguments.length;a++)i();if(""===r)return n.slice(0,-1);var l=g[r];if(void 0!==l)return n+l;for(var s=[],c=0;c<arguments.length;c++){var d=o[c];if(d){var f=u[d];f&&(s.push(f[0]),t=f[1])}}var v=Object.assign.apply(Object,[{}].concat(s)),[m,y]=p(v,t),_=h(y,t),x=_+" "+m;return g[r]=x,u[_]=[v,t],n+x}var m=o.createContext(void 0),y={},_=(m.Provider,()=>{var e={};return function(t,n){void 0===e[t.id]&&(t.insertCSSRules(n),e[t.id]=!0)}}),x=o.useInsertionEffect?o.useInsertionEffect:void 0,b=()=>{var e={};return function(t,n){x&&"undefined"!=typeof window&&window.document&&window.document.createElement?x(()=>{t.insertCSSRules(n)},[t,n]):void 0===e[t.id]&&(t.insertCSSRules(n),e[t.id]=!0)}};function C(e){return Array.isArray(e)?e:[e]}var k=["r","d","l","v","w","f","i","h","a","s","k","t","m","c"].reduce((e,t,n)=>(e[t]=n,e),{});function w(e,t,n,r){var o,i,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},l="m"===e,s=null!==(o=a.m)&&void 0!==o?o:"0",c=null!==(i=a.p)&&void 0!==i?i:0,u=function(e,t,n){return("m"===e?e+t:e)+n}(e,s,c);if(!r.stylesheets[u]){var h=t&&t.createElement("style"),p=function(e,t,n,r){var o=[];if(r[d]=t,r["data-priority"]=String(n),e)for(var i in r)e.setAttribute(i,r[i]);return{elementAttributes:r,insertRule:function(t){return(null==e?void 0:e.sheet)?e.sheet.insertRule(t,e.sheet.cssRules.length):o.push(t)},element:e,bucketName:t,cssRules:()=>(null==e?void 0:e.sheet)?Array.from(e.sheet.cssRules).map(e=>e.cssText):o}}(h,e,c,Object.assign({},r.styleElementAttributes,l&&{media:s}));r.stylesheets[u]=p,(null==t?void 0:t.head)&&h&&t.head.insertBefore(h,function(e,t,n,r){var o,i,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},l=k[n],s=null!==(o=a.m)&&void 0!==o?o:"",c=null!==(i=a.p)&&void 0!==i?i:0,u=e=>l-k[e.getAttribute(d)],h=e.head.querySelectorAll("[".concat(d,"]"));if("m"===n){var p=e.head.querySelectorAll("[".concat(d,'="').concat(n,'"]'));p.length&&(h=p,u=e=>r.compareMediaQueries(s,e.media))}for(var f=e=>function(e,t,n){var r,o;return t+(null!==(r=n.m)&&void 0!==r?r:"")===e.getAttribute(d)+(null!==(o=e.media)&&void 0!==o?o:"")}(e,n,a)?c-Number(e.getAttribute("data-priority")):u(e),g=h.length,v=g-1;v>=0;){var m=h.item(v);if(f(m)>0)return m.nextSibling;v--}return g>0?h.item(0):t?t.nextSibling:null}(t,n,e,r,a))}return r.stylesheets[u]}function E(e,t){try{e.insertRule(t)}catch(e){}}":(".concat(["-moz-placeholder","-moz-focus-inner","-moz-focusring","-ms-input-placeholder","-moz-read-write","-moz-read-only"].join("|"),")");var S=0,T=(e,t)=>e<t?-1:e>t?1:0;function D(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"undefined"==typeof document?void 0:document,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{classNameHashSalt:n,unstable_filterCSSRule:r,insertionPoint:o,styleElementAttributes:i,compareMediaQueries:a=T}=t,l={classNameHashSalt:n,insertionCache:{},stylesheets:{},styleElementAttributes:Object.freeze(i),compareMediaQueries:a,id:"d".concat(S++),insertCSSRules(t){for(var n in t)for(var i=t[n],a=0,s=i.length;a<s;a++){var[c,u]=C(i[a]),d=w(n,e,o||null,l,u);l.insertionCache[c]||(l.insertionCache[c]=n,r?r(c)&&E(d,c):E(d,c))}}};return l}var M=o.createContext(D()),A=o.createContext("ltr");function L(e,t){var n=function(e,t){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:_)(),r=null,o=null;return function(i){var{dir:a,renderer:l}=i,s="ltr"===a;return s?null===r&&(r=f(e,a)):null===o&&(o=f(e,a)),n(l,t),s?r:o}}(e,t,b);return function(){var e=o.useContext(A),t=o.useContext(M);return n({dir:e,renderer:t})}}var P=L({root:{mc9l5x:"f1w7gpdv",Bg96gwp:"fez10in"},rtl:{Bz10aip:"f13rod7r"}},{d:[".f1w7gpdv{display:inline;}",".fez10in{line-height:0;}",".f13rod7r{transform:scaleX(-1);}"]}),I=["title","primaryFill"];function N(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?N(Object(n),!0).forEach(function(t){F(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):N(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function F(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var R=L({root:{B8gzw0y:"f1dd5bof"}},{m:[["@media (forced-colors: active){.f1dd5bof{forced-color-adjust:auto;}}",{m:"(forced-colors: active)"}]]});function V(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function B(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?V(Object(n),!0).forEach(function(t){H(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):V(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function H(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var z,W,Y,j=(e,t,n,r)=>{var i="1em"===t?"20":t,a=o.forwardRef((e,a)=>{var l=R(),s=((e,t)=>{var n,{title:r,primaryFill:i="currentColor"}=e,a=O(O({},function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,I)),{},{title:void 0,fill:i}),l=P(),s=null!=(n=o.useContext(m))?n:y;return a.className=v(l.root,(null==t?void 0:t.flipInRtl)&&"rtl"===(null==s?void 0:s.textDirection)&&l.rtl,a.className),r&&(a["aria-label"]=r),a["aria-label"]||a["aria-labelledby"]?a.role="img":a["aria-hidden"]=!0,a})(e,{flipInRtl:null==r?void 0:r.flipInRtl}),c=B(B({},s),{},{className:v(s.className,l.root),ref:a,width:t,height:t,viewBox:"0 0 ".concat(i," ").concat(i),xmlns:"http://www.w3.org/2000/svg"});return"string"==typeof n?o.createElement("svg",B(B({},c),{},{dangerouslySetInnerHTML:{__html:n}})):o.createElement("svg",c,...n.map(e=>o.createElement("path",{d:e,fill:c.fill})))});return a.displayName=e,a},U=j("OpenRegular","1em",["M6 4a2 2 0 0 0-2 2v8c0 1.1.9 2 2 2h8a2 2 0 0 0 2-2v-2.5a.5.5 0 0 1 1 0V14a3 3 0 0 1-3 3H6a3 3 0 0 1-3-3V6a3 3 0 0 1 3-3h2.5a.5.5 0 0 1 0 1H6Zm5-.5c0-.28.22-.5.5-.5h5c.28 0 .5.22.5.5v5a.5.5 0 0 1-1 0V4.7l-4.15 4.15a.5.5 0 0 1-.7-.7L15.29 4H11.5a.5.5 0 0 1-.5-.5Z"]);!function(e){e[e.MetricCard=1e8]="MetricCard",e[e.BarChart=100000001]="BarChart",e[e.LineChart=100000002]="LineChart",e[e.AreaChart=100000003]="AreaChart",e[e.DonutChart=100000004]="DonutChart",e[e.StatusBar=100000005]="StatusBar",e[e.Calendar=100000006]="Calendar",e[e.MiniTable=100000007]="MiniTable",e[e.DueDateCard=100000008]="DueDateCard",e[e.DueDateCardList=100000009]="DueDateCardList"}(z||(z={})),function(e){e[e.None=1e8]="None",e[e.OpenRecordForm=100000001]="OpenRecordForm",e[e.OpenSidePane=100000002]="OpenSidePane",e[e.NavigateToPage=100000003]="NavigateToPage",e[e.OpenDatasetGrid=100000004]="OpenDatasetGrid"}(W||(W={})),function(e){e[e.Count=1e8]="Count",e[e.Sum=100000001]="Sum",e[e.Average=100000002]="Average",e[e.Min=100000003]="Min",e[e.Max=100000004]="Max"}(Y||(Y={}));var X,q,G,K,Z,$,J,Q,ee,te,ne,re,oe,ie,ae=j("ArrowDownRegular","1em",["M16.87 10.84a.5.5 0 1 0-.74-.68l-5.63 6.17V2.5a.5.5 0 0 0-1 0v13.83l-5.63-6.17a.5.5 0 0 0-.74.68l6.31 6.91a.75.75 0 0 0 1.11 0l6.32-6.91Z"]),le=j("ArrowUpRegular","1em",["M3.13 9.16a.5.5 0 1 0 .74.68L9.5 3.67V17.5a.5.5 0 1 0 1 0V3.67l5.63 6.17a.5.5 0 0 0 .74-.68l-6.32-6.92a.75.75 0 0 0-1.1 0L3.13 9.16Z"],{flipInRtl:!0}),se=(0,a.makeStyles)({card:{minWidth:"200px",minHeight:"120px",cursor:"default",transition:"box-shadow 0.2s ease-in-out, transform 0.2s ease-in-out"},cardInteractive:{cursor:"pointer","&:hover":{boxShadow:a.tokens.shadow8,transform:"translateY(-2px)"},"&:active":{transform:"translateY(0)"}},cardCompact:{minHeight:"80px",minWidth:"150px"},content:{display:"flex",flexDirection:"column",alignItems:"flex-start",padding:a.tokens.spacingVerticalM,gap:a.tokens.spacingVerticalXS},contentCompact:{padding:a.tokens.spacingVerticalS},valueContainer:{display:"flex",alignItems:"baseline",gap:a.tokens.spacingHorizontalS},value:{fontSize:a.tokens.fontSizeHero800,fontWeight:a.tokens.fontWeightSemibold,lineHeight:a.tokens.lineHeightHero800,color:a.tokens.colorNeutralForeground1},valueCompact:{fontSize:a.tokens.fontSizeBase600,lineHeight:a.tokens.lineHeightBase600},label:{fontSize:a.tokens.fontSizeBase300,color:a.tokens.colorNeutralForeground2,fontWeight:a.tokens.fontWeightRegular},labelCompact:{fontSize:a.tokens.fontSizeBase200},description:{fontSize:a.tokens.fontSizeBase200,color:a.tokens.colorNeutralForeground3,marginTop:a.tokens.spacingVerticalXXS},trendContainer:{display:"flex",alignItems:"center",gap:a.tokens.spacingHorizontalXXS,fontSize:a.tokens.fontSizeBase200,fontWeight:a.tokens.fontWeightMedium},trendUp:{color:a.tokens.colorPaletteGreenForeground1},trendDown:{color:a.tokens.colorPaletteRedForeground1},trendNeutral:{color:a.tokens.colorNeutralForeground3},trendIcon:{fontSize:"16px"}}),ce=e=>{var{value:t,label:n,description:r,trend:i,trendValue:l,onDrillInteraction:s,drillField:c,drillValue:u,interactive:d=!0,compact:h=!1}=e,p=se(),f=()=>{d&&s&&c&&s({field:c,operator:"eq",value:null!=u?u:t,label:n})},g=d&&s&&c,v=()=>{switch(i){case"up":return p.trendUp;case"down":return p.trendDown;default:return p.trendNeutral}};return o.createElement(a.Card,{className:(0,a.mergeClasses)(p.card,g&&p.cardInteractive,h&&p.cardCompact),onClick:g?f:void 0,onKeyDown:g?e=>{!d||"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),f())}:void 0,tabIndex:g?0:void 0,role:g?"button":void 0,"aria-label":g?"".concat(n,": ").concat(t,". Click to view details."):void 0},o.createElement("div",{className:(0,a.mergeClasses)(p.content,h&&p.contentCompact)},o.createElement(a.Text,{className:(0,a.mergeClasses)(p.label,h&&p.labelCompact)},n),o.createElement("div",{className:p.valueContainer},o.createElement(a.Text,{className:(0,a.mergeClasses)(p.value,h&&p.valueCompact)},(e=>"string"==typeof e?e:e>=1e6?"".concat((e/1e6).toFixed(1),"M"):e>=1e3?"".concat((e/1e3).toFixed(1),"K"):e.toLocaleString())(t)),(()=>{if(!i||"neutral"===i)return null;var e="up"===i?le:ae;return o.createElement("div",{className:(0,a.mergeClasses)(p.trendContainer,v())},o.createElement(e,{className:p.trendIcon}),void 0!==l&&o.createElement("span",null,l>0?"+":"",l.toFixed(1),"%"))})()),r&&o.createElement(a.Text,{className:p.description},r)))},ue=n(882),de=n(462);function he(e,t){var n;if(void 0===t)for(var r of e)null!=r&&(n<r||void 0===n&&r>=r)&&(n=r);else{var o=-1;for(var i of e)null!=(i=t(i,++o,e))&&(n<i||void 0===n&&i>=i)&&(n=i)}return n}function pe(e,t){var n;if(void 0===t)for(var r of e)null!=r&&(n>r||void 0===n&&r>=r)&&(n=r);else{var o=-1;for(var i of e)null!=(i=t(i,++o,e))&&(n>i||void 0===n&&i>=i)&&(n=i)}return n}function fe(e){return"object"==typeof e&&"length"in e?e:Array.from(e)}function ge(e){return function(){return e}}function ve(e){this._context=e}function me(e){return new ve(e)}function ye(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}Array.prototype.slice,ve.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t)}}};var _e=Math.PI,xe=2*_e,be=1e-6,Ce=xe-be;function ke(e){this._+=e[0];for(var t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}class we{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=null==e?ke:function(e){var t=Math.floor(e);if(!(t>=0))throw new Error("invalid digits: ".concat(e));if(t>15)return ke;var n=10**t;return function(e){this._+=e[0];for(var t=1,r=e.length;t<r;++t)this._+=Math.round(arguments[t]*n)/n+e[t]}}(e)}moveTo(e,t){this._append(X||(X=ye(["M",",",""])),this._x0=this._x1=+e,this._y0=this._y1=+t)}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._append(q||(q=ye(["Z"]))))}lineTo(e,t){this._append(G||(G=ye(["L",",",""])),this._x1=+e,this._y1=+t)}quadraticCurveTo(e,t,n,r){this._append(K||(K=ye(["Q",",",",",",",""])),+e,+t,this._x1=+n,this._y1=+r)}bezierCurveTo(e,t,n,r,o,i){this._append(Z||(Z=ye(["C",",",",",",",",",",",""])),+e,+t,+n,+r,this._x1=+o,this._y1=+i)}arcTo(e,t,n,r,o){if(e=+e,t=+t,n=+n,r=+r,(o=+o)<0)throw new Error("negative radius: ".concat(o));var i=this._x1,a=this._y1,l=n-e,s=r-t,c=i-e,u=a-t,d=c*c+u*u;if(null===this._x1)this._append($||($=ye(["M",",",""])),this._x1=e,this._y1=t);else if(d>be)if(Math.abs(u*l-s*c)>be&&o){var h=n-i,p=r-a,f=l*l+s*s,g=h*h+p*p,v=Math.sqrt(f),m=Math.sqrt(d),y=o*Math.tan((_e-Math.acos((f+d-g)/(2*v*m)))/2),_=y/m,x=y/v;Math.abs(_-1)>be&&this._append(Q||(Q=ye(["L",",",""])),e+_*c,t+_*u),this._append(ee||(ee=ye(["A",",",",0,0,",",",",",""])),o,o,+(u*h>c*p),this._x1=e+x*l,this._y1=t+x*s)}else this._append(J||(J=ye(["L",",",""])),this._x1=e,this._y1=t)}arc(e,t,n,r,o,i){if(e=+e,t=+t,i=!!i,(n=+n)<0)throw new Error("negative radius: ".concat(n));var a=n*Math.cos(r),l=n*Math.sin(r),s=e+a,c=t+l,u=1^i,d=i?r-o:o-r;null===this._x1?this._append(te||(te=ye(["M",",",""])),s,c):(Math.abs(this._x1-s)>be||Math.abs(this._y1-c)>be)&&this._append(ne||(ne=ye(["L",",",""])),s,c),n&&(d<0&&(d=d%xe+xe),d>Ce?this._append(re||(re=ye(["A",",",",0,1,",",",",","A",",",",0,1,",",",",",""])),n,n,u,e-a,t-l,n,n,u,this._x1=s,this._y1=c):d>be&&this._append(oe||(oe=ye(["A",",",",0,",",",",",",",""])),n,n,+(d>=_e),u,this._x1=e+n*Math.cos(o),this._y1=t+n*Math.sin(o)))}rect(e,t,n,r){this._append(ie||(ie=ye(["M",",","h","v","h","Z"])),this._x0=this._x1=+e,this._y0=this._y1=+t,n=+n,+r,-n)}toString(){return this._}}function Ee(e){var t=3;return e.digits=function(n){if(!arguments.length)return t;if(null==n)t=null;else{var r=Math.floor(n);if(!(r>=0))throw new RangeError("invalid digits: ".concat(n));t=r}return e},()=>new we(t)}function Se(e){return e[0]}function Te(e){return e[1]}function De(e,t){var n=ge(!0),r=null,o=me,i=null,a=Ee(l);function l(l){var s,c,u,d=(l=fe(l)).length,h=!1;for(null==r&&(i=o(u=a())),s=0;s<=d;++s)!(s<d&&n(c=l[s],s,l))===h&&((h=!h)?i.lineStart():i.lineEnd()),h&&i.point(+e(c,s,l),+t(c,s,l));if(u)return i=null,u+""||null}return e="function"==typeof e?e:void 0===e?Se:ge(e),t="function"==typeof t?t:void 0===t?Te:ge(t),l.x=function(t){return arguments.length?(e="function"==typeof t?t:ge(+t),l):e},l.y=function(e){return arguments.length?(t="function"==typeof e?e:ge(+e),l):t},l.defined=function(e){return arguments.length?(n="function"==typeof e?e:ge(!!e),l):n},l.curve=function(e){return arguments.length?(o=e,null!=r&&(i=o(r)),l):o},l.context=function(e){return arguments.length?(null==e?r=i=null:i=o(r=e),l):r},l}function Me(){}function Ae(e){return null==e?Me:function(){return this.querySelector(e)}}function Le(e){return null==e?[]:Array.isArray(e)?e:Array.from(e)}function Pe(){return[]}function Ie(e){return function(t){return t.matches(e)}}var Ne=Array.prototype.find;function Oe(){return this.firstElementChild}var Fe=Array.prototype.filter;function Re(){return Array.from(this.children)}function Ve(e){return new Array(e.length)}function Be(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}function He(e,t,n,r,o,i){for(var a,l=0,s=t.length,c=i.length;l<c;++l)(a=t[l])?(a.__data__=i[l],r[l]=a):n[l]=new Be(e,i[l]);for(;l<s;++l)(a=t[l])&&(o[l]=a)}function ze(e,t,n,r,o,i,a){var l,s,c,u=new Map,d=t.length,h=i.length,p=new Array(d);for(l=0;l<d;++l)(s=t[l])&&(p[l]=c=a.call(s,s.__data__,l,t)+"",u.has(c)?o[l]=s:u.set(c,s));for(l=0;l<h;++l)c=a.call(e,i[l],l,i)+"",(s=u.get(c))?(r[l]=s,s.__data__=i[l],u.delete(c)):n[l]=new Be(e,i[l]);for(l=0;l<d;++l)(s=t[l])&&u.get(p[l])===s&&(o[l]=s)}function We(e){return e.__data__}function Ye(e){return"object"==typeof e&&"length"in e?e:Array.from(e)}function je(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}Be.prototype={constructor:Be,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};var Ue="http://www.w3.org/1999/xhtml";const Xe={svg:"http://www.w3.org/2000/svg",xhtml:Ue,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function qe(e){var t=e+="",n=t.indexOf(":");return n>=0&&"xmlns"!==(t=e.slice(0,n))&&(e=e.slice(n+1)),Xe.hasOwnProperty(t)?{space:Xe[t],local:e}:e}function Ge(e){return function(){this.removeAttribute(e)}}function Ke(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Ze(e,t){return function(){this.setAttribute(e,t)}}function $e(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function Je(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttribute(e):this.setAttribute(e,n)}}function Qe(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function et(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function tt(e){return function(){this.style.removeProperty(e)}}function nt(e,t,n){return function(){this.style.setProperty(e,t,n)}}function rt(e,t,n){return function(){var r=t.apply(this,arguments);null==r?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function ot(e){return function(){delete this[e]}}function it(e,t){return function(){this[e]=t}}function at(e,t){return function(){var n=t.apply(this,arguments);null==n?delete this[e]:this[e]=n}}function lt(e){return e.trim().split(/^|\s+/)}function st(e){return e.classList||new ct(e)}function ct(e){this._node=e,this._names=lt(e.getAttribute("class")||"")}function ut(e,t){for(var n=st(e),r=-1,o=t.length;++r<o;)n.add(t[r])}function dt(e,t){for(var n=st(e),r=-1,o=t.length;++r<o;)n.remove(t[r])}function ht(e){return function(){ut(this,e)}}function pt(e){return function(){dt(this,e)}}function ft(e,t){return function(){(t.apply(this,arguments)?ut:dt)(this,e)}}function gt(){this.textContent=""}function vt(e){return function(){this.textContent=e}}function mt(e){return function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}}function yt(){this.innerHTML=""}function _t(e){return function(){this.innerHTML=e}}function xt(e){return function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}}function bt(){this.nextSibling&&this.parentNode.appendChild(this)}function Ct(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function kt(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===Ue&&t.documentElement.namespaceURI===Ue?t.createElement(e):t.createElementNS(n,e)}}function wt(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Et(e){var t=qe(e);return(t.local?wt:kt)(t)}function St(){return null}function Tt(){var e=this.parentNode;e&&e.removeChild(this)}function Dt(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Mt(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function At(e){return function(){var t=this.__on;if(t){for(var n,r=0,o=-1,i=t.length;r<i;++r)n=t[r],e.type&&n.type!==e.type||n.name!==e.name?t[++o]=n:this.removeEventListener(n.type,n.listener,n.options);++o?t.length=o:delete this.__on}}}function Lt(e,t,n){return function(){var r,o=this.__on,i=function(e){return function(t){e.call(this,t,this.__data__)}}(t);if(o)for(var a=0,l=o.length;a<l;++a)if((r=o[a]).type===e.type&&r.name===e.name)return this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=i,r.options=n),void(r.value=t);this.addEventListener(e.type,i,n),r={type:e.type,name:e.name,value:t,listener:i,options:n},o?o.push(r):this.__on=[r]}}function Pt(e,t,n){var r=et(e),o=r.CustomEvent;"function"==typeof o?o=new o(t,n):(o=r.document.createEvent("Event"),n?(o.initEvent(t,n.bubbles,n.cancelable),o.detail=n.detail):o.initEvent(t,!1,!1)),e.dispatchEvent(o)}function It(e,t){return function(){return Pt(this,e,t)}}function Nt(e,t){return function(){return Pt(this,e,t.apply(this,arguments))}}ct.prototype={add:function(e){this._names.indexOf(e)<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};var Ot=[null];function Ft(e,t){this._groups=e,this._parents=t}function Rt(e){return"string"==typeof e?new Ft([[document.querySelector(e)]],[document.documentElement]):new Ft([[e]],Ot)}Ft.prototype=function(){return new Ft([[document.documentElement]],Ot)}.prototype={constructor:Ft,select:function(e){"function"!=typeof e&&(e=Ae(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var i,a,l=t[o],s=l.length,c=r[o]=new Array(s),u=0;u<s;++u)(i=l[u])&&(a=e.call(i,i.__data__,u,l))&&("__data__"in i&&(a.__data__=i.__data__),c[u]=a);return new Ft(r,this._parents)},selectAll:function(e){e="function"==typeof e?function(e){return function(){return Le(e.apply(this,arguments))}}(e):function(e){return null==e?Pe:function(){return this.querySelectorAll(e)}}(e);for(var t=this._groups,n=t.length,r=[],o=[],i=0;i<n;++i)for(var a,l=t[i],s=l.length,c=0;c<s;++c)(a=l[c])&&(r.push(e.call(a,a.__data__,c,l)),o.push(a));return new Ft(r,o)},selectChild:function(e){return this.select(null==e?Oe:function(e){return function(){return Ne.call(this.children,e)}}("function"==typeof e?e:Ie(e)))},selectChildren:function(e){return this.selectAll(null==e?Re:function(e){return function(){return Fe.call(this.children,e)}}("function"==typeof e?e:Ie(e)))},filter:function(e){"function"!=typeof e&&(e=function(e){return function(){return this.matches(e)}}(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var i,a=t[o],l=a.length,s=r[o]=[],c=0;c<l;++c)(i=a[c])&&e.call(i,i.__data__,c,a)&&s.push(i);return new Ft(r,this._parents)},data:function(e,t){if(!arguments.length)return Array.from(this,We);var n,r=t?ze:He,o=this._parents,i=this._groups;"function"!=typeof e&&(n=e,e=function(){return n});for(var a=i.length,l=new Array(a),s=new Array(a),c=new Array(a),u=0;u<a;++u){var d=o[u],h=i[u],p=h.length,f=Ye(e.call(d,d&&d.__data__,u,o)),g=f.length,v=s[u]=new Array(g),m=l[u]=new Array(g);r(d,h,v,m,c[u]=new Array(p),f,t);for(var y,_,x=0,b=0;x<g;++x)if(y=v[x]){for(x>=b&&(b=x+1);!(_=m[b])&&++b<g;);y._next=_||null}}return(l=new Ft(l,o))._enter=s,l._exit=c,l},enter:function(){return new Ft(this._enter||this._groups.map(Ve),this._parents)},exit:function(){return new Ft(this._exit||this._groups.map(Ve),this._parents)},join:function(e,t,n){var r=this.enter(),o=this,i=this.exit();return"function"==typeof e?(r=e(r))&&(r=r.selection()):r=r.append(e+""),null!=t&&(o=t(o))&&(o=o.selection()),null==n?i.remove():n(i),r&&o?r.merge(o).order():o},merge:function(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,o=n.length,i=r.length,a=Math.min(o,i),l=new Array(o),s=0;s<a;++s)for(var c,u=n[s],d=r[s],h=u.length,p=l[s]=new Array(h),f=0;f<h;++f)(c=u[f]||d[f])&&(p[f]=c);for(;s<o;++s)l[s]=n[s];return new Ft(l,this._parents)},selection:function(){return this},order:function(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r,o=e[t],i=o.length-1,a=o[i];--i>=0;)(r=o[i])&&(a&&4^r.compareDocumentPosition(a)&&a.parentNode.insertBefore(r,a),a=r);return this},sort:function(e){function t(t,n){return t&&n?e(t.__data__,n.__data__):!t-!n}e||(e=je);for(var n=this._groups,r=n.length,o=new Array(r),i=0;i<r;++i){for(var a,l=n[i],s=l.length,c=o[i]=new Array(s),u=0;u<s;++u)(a=l[u])&&(c[u]=a);c.sort(t)}return new Ft(o,this._parents).order()},call:function(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],o=0,i=r.length;o<i;++o){var a=r[o];if(a)return a}return null},size:function(){var e=0;for(var t of this)++e;return e},empty:function(){return!this.node()},each:function(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var o,i=t[n],a=0,l=i.length;a<l;++a)(o=i[a])&&e.call(o,o.__data__,a,i);return this},attr:function(e,t){var n=qe(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==t?n.local?Ke:Ge:"function"==typeof t?n.local?Qe:Je:n.local?$e:Ze)(n,t))},style:function(e,t,n){return arguments.length>1?this.each((null==t?tt:"function"==typeof t?rt:nt)(e,t,null==n?"":n)):function(e,t){return e.style.getPropertyValue(t)||et(e).getComputedStyle(e,null).getPropertyValue(t)}(this.node(),e)},property:function(e,t){return arguments.length>1?this.each((null==t?ot:"function"==typeof t?at:it)(e,t)):this.node()[e]},classed:function(e,t){var n=lt(e+"");if(arguments.length<2){for(var r=st(this.node()),o=-1,i=n.length;++o<i;)if(!r.contains(n[o]))return!1;return!0}return this.each(("function"==typeof t?ft:t?ht:pt)(n,t))},text:function(e){return arguments.length?this.each(null==e?gt:("function"==typeof e?mt:vt)(e)):this.node().textContent},html:function(e){return arguments.length?this.each(null==e?yt:("function"==typeof e?xt:_t)(e)):this.node().innerHTML},raise:function(){return this.each(bt)},lower:function(){return this.each(Ct)},append:function(e){var t="function"==typeof e?e:Et(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})},insert:function(e,t){var n="function"==typeof e?e:Et(e),r=null==t?St:"function"==typeof t?t:Ae(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})},remove:function(){return this.each(Tt)},clone:function(e){return this.select(e?Mt:Dt)},datum:function(e){return arguments.length?this.property("__data__",e):this.node().__data__},on:function(e,t,n){var r,o,i=function(e){return e.trim().split(/^|\s+/).map(function(e){var t="",n=e.indexOf(".");return n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),{type:e,name:t}})}(e+""),a=i.length;if(!(arguments.length<2)){for(l=t?Lt:At,r=0;r<a;++r)this.each(l(i[r],t,n));return this}var l=this.node().__on;if(l)for(var s,c=0,u=l.length;c<u;++c)for(r=0,s=l[c];r<a;++r)if((o=i[r]).type===s.type&&o.name===s.name)return s.value},dispatch:function(e,t){return this.each(("function"==typeof t?Nt:It)(e,t))},[Symbol.iterator]:function*(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r,o=e[t],i=0,a=o.length;i<a;++i)(r=o[i])&&(yield r)}};var Vt=Math.sqrt(50),Bt=Math.sqrt(10),Ht=Math.sqrt(2);function zt(e,t,n){var r,o,i,a=(t-e)/Math.max(0,n),l=Math.floor(Math.log10(a)),s=a/Math.pow(10,l),c=s>=Vt?10:s>=Bt?5:s>=Ht?2:1;return l<0?(i=Math.pow(10,-l)/c,(r=Math.round(e*i))/i<e&&++r,(o=Math.round(t*i))/i>t&&--o,i=-i):(i=Math.pow(10,l)*c,(r=Math.round(e/i))*i<e&&++r,(o=Math.round(t/i))*i>t&&--o),o<r&&.5<=n&&n<2?zt(e,t,2*n):[r,o,i]}function Wt(e,t,n){if(!((n=+n)>0))return[];if((e=+e)===(t=+t))return[e];var r=t<e,[o,i,a]=r?zt(t,e,n):zt(e,t,n);if(!(i>=o))return[];var l=i-o+1,s=new Array(l);if(r)if(a<0)for(var c=0;c<l;++c)s[c]=(i-c)/-a;else for(var u=0;u<l;++u)s[u]=(i-u)*a;else if(a<0)for(var d=0;d<l;++d)s[d]=(o+d)/-a;else for(var h=0;h<l;++h)s[h]=(o+h)*a;return s}function Yt(e,t,n){return zt(e=+e,t=+t,n=+n)[2]}function jt(e,t,n){n=+n;var r=(t=+t)<(e=+e),o=r?Yt(t,e,n):Yt(e,t,n);return(r?-1:1)*(o<0?1/-o:o)}function Ut(e,t){return null==e||null==t?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Xt(e,t){return null==e||null==t?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function qt(e){var t,n,r;function o(e,r){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length;if(o<i){if(0!==t(r,r))return i;do{var a=o+i>>>1;n(e[a],r)<0?o=a+1:i=a}while(o<i)}return o}return 2!==e.length?(t=Ut,n=(t,n)=>Ut(e(t),n),r=(t,n)=>e(t)-n):(t=e===Ut||e===Xt?e:Gt,n=e,r=e),{left:o,center:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=o(e,t,n,(arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length)-1);return i>n&&r(e[i-1],t)>-r(e[i],t)?i-1:i},right:function(e,r){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length;if(o<i){if(0!==t(r,r))return i;do{var a=o+i>>>1;n(e[a],r)<=0?o=a+1:i=a}while(o<i)}return o}}}function Gt(){return 0}var Kt=qt(Ut),Zt=Kt.right;Kt.left,qt(function(e){return null===e?NaN:+e}).center;const $t=Zt;function Jt(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Qt(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function en(){}var tn=.7,nn=1/tn,rn="\\s*([+-]?\\d+)\\s*",on="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",an="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",ln=/^#([0-9a-f]{3,8})$/,sn=new RegExp("^rgb\\(".concat(rn,",").concat(rn,",").concat(rn,"\\)$")),cn=new RegExp("^rgb\\(".concat(an,",").concat(an,",").concat(an,"\\)$")),un=new RegExp("^rgba\\(".concat(rn,",").concat(rn,",").concat(rn,",").concat(on,"\\)$")),dn=new RegExp("^rgba\\(".concat(an,",").concat(an,",").concat(an,",").concat(on,"\\)$")),hn=new RegExp("^hsl\\(".concat(on,",").concat(an,",").concat(an,"\\)$")),pn=new RegExp("^hsla\\(".concat(on,",").concat(an,",").concat(an,",").concat(on,"\\)$")),fn={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function gn(){return this.rgb().formatHex()}function vn(){return this.rgb().formatRgb()}function mn(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=ln.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?yn(t):3===n?new bn(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?_n(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?_n(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=sn.exec(e))?new bn(t[1],t[2],t[3],1):(t=cn.exec(e))?new bn(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=un.exec(e))?_n(t[1],t[2],t[3],t[4]):(t=dn.exec(e))?_n(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=hn.exec(e))?Tn(t[1],t[2]/100,t[3]/100,1):(t=pn.exec(e))?Tn(t[1],t[2]/100,t[3]/100,t[4]):fn.hasOwnProperty(e)?yn(fn[e]):"transparent"===e?new bn(NaN,NaN,NaN,0):null}function yn(e){return new bn(e>>16&255,e>>8&255,255&e,1)}function _n(e,t,n,r){return r<=0&&(e=t=n=NaN),new bn(e,t,n,r)}function xn(e,t,n,r){return 1===arguments.length?((o=e)instanceof en||(o=mn(o)),o?new bn((o=o.rgb()).r,o.g,o.b,o.opacity):new bn):new bn(e,t,n,null==r?1:r);var o}function bn(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}function Cn(){return"#".concat(Sn(this.r)).concat(Sn(this.g)).concat(Sn(this.b))}function kn(){var e=wn(this.opacity);return"".concat(1===e?"rgb(":"rgba(").concat(En(this.r),", ").concat(En(this.g),", ").concat(En(this.b)).concat(1===e?")":", ".concat(e,")"))}function wn(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function En(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Sn(e){return((e=En(e))<16?"0":"")+e.toString(16)}function Tn(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Mn(e,t,n,r)}function Dn(e){if(e instanceof Mn)return new Mn(e.h,e.s,e.l,e.opacity);if(e instanceof en||(e=mn(e)),!e)return new Mn;if(e instanceof Mn)return e;var t=(e=e.rgb()).r/255,n=e.g/255,r=e.b/255,o=Math.min(t,n,r),i=Math.max(t,n,r),a=NaN,l=i-o,s=(i+o)/2;return l?(a=t===i?(n-r)/l+6*(n<r):n===i?(r-t)/l+2:(t-n)/l+4,l/=s<.5?i+o:2-i-o,a*=60):l=s>0&&s<1?0:a,new Mn(a,l,s,e.opacity)}function Mn(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function An(e){return(e=(e||0)%360)<0?e+360:e}function Ln(e){return Math.max(0,Math.min(1,e||0))}function Pn(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}function In(e,t,n,r,o){var i=e*e,a=i*e;return((1-3*e+3*i-a)*t+(4-6*i+3*a)*n+(1+3*e+3*i-3*a)*r+a*o)/6}Jt(en,mn,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:gn,formatHex:gn,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return Dn(this).formatHsl()},formatRgb:vn,toString:vn}),Jt(bn,xn,Qt(en,{brighter(e){return e=null==e?nn:Math.pow(nn,e),new bn(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=null==e?tn:Math.pow(tn,e),new bn(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new bn(En(this.r),En(this.g),En(this.b),wn(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Cn,formatHex:Cn,formatHex8:function(){return"#".concat(Sn(this.r)).concat(Sn(this.g)).concat(Sn(this.b)).concat(Sn(255*(isNaN(this.opacity)?1:this.opacity)))},formatRgb:kn,toString:kn})),Jt(Mn,function(e,t,n,r){return 1===arguments.length?Dn(e):new Mn(e,t,n,null==r?1:r)},Qt(en,{brighter(e){return e=null==e?nn:Math.pow(nn,e),new Mn(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=null==e?tn:Math.pow(tn,e),new Mn(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,o=2*n-r;return new bn(Pn(e>=240?e-240:e+120,o,r),Pn(e,o,r),Pn(e<120?e+240:e-120,o,r),this.opacity)},clamp(){return new Mn(An(this.h),Ln(this.s),Ln(this.l),wn(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){var e=wn(this.opacity);return"".concat(1===e?"hsl(":"hsla(").concat(An(this.h),", ").concat(100*Ln(this.s),"%, ").concat(100*Ln(this.l),"%").concat(1===e?")":", ".concat(e,")"))}}));const Nn=e=>()=>e;function On(e,t){var n=t-e;return n?function(e,t){return function(n){return e+n*t}}(e,n):Nn(isNaN(e)?t:e)}const Fn=function e(t){var n=function(e){return 1===(e=+e)?On:function(t,n){return n-t?function(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}(t,n,e):Nn(isNaN(t)?n:t)}}(t);function r(e,t){var r=n((e=xn(e)).r,(t=xn(t)).r),o=n(e.g,t.g),i=n(e.b,t.b),a=On(e.opacity,t.opacity);return function(t){return e.r=r(t),e.g=o(t),e.b=i(t),e.opacity=a(t),e+""}}return r.gamma=e,r}(1);function Rn(e){return function(t){var n,r,o=t.length,i=new Array(o),a=new Array(o),l=new Array(o);for(n=0;n<o;++n)r=xn(t[n]),i[n]=r.r||0,a[n]=r.g||0,l[n]=r.b||0;return i=e(i),a=e(a),l=e(l),r.opacity=1,function(e){return r.r=i(e),r.g=a(e),r.b=l(e),r+""}}}function Vn(e,t){var n,r=t?t.length:0,o=e?Math.min(r,e.length):0,i=new Array(o),a=new Array(r);for(n=0;n<o;++n)i[n]=Xn(e[n],t[n]);for(;n<r;++n)a[n]=t[n];return function(e){for(n=0;n<o;++n)a[n]=i[n](e);return a}}function Bn(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function Hn(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function zn(e,t){var n,r={},o={};for(n in null!==e&&"object"==typeof e||(e={}),null!==t&&"object"==typeof t||(t={}),t)n in e?r[n]=Xn(e[n],t[n]):o[n]=t[n];return function(e){for(n in r)o[n]=r[n](e);return o}}Rn(function(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),o=e[r],i=e[r+1],a=r>0?e[r-1]:2*o-i,l=r<t-1?e[r+2]:2*i-o;return In((n-r/t)*t,a,o,i,l)}}),Rn(function(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),o=e[(r+t-1)%t],i=e[r%t],a=e[(r+1)%t],l=e[(r+2)%t];return In((n-r/t)*t,o,i,a,l)}});var Wn=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Yn=new RegExp(Wn.source,"g");function jn(e,t){var n,r,o,i=Wn.lastIndex=Yn.lastIndex=0,a=-1,l=[],s=[];for(e+="",t+="";(n=Wn.exec(e))&&(r=Yn.exec(t));)(o=r.index)>i&&(o=t.slice(i,o),l[a]?l[a]+=o:l[++a]=o),(n=n[0])===(r=r[0])?l[a]?l[a]+=r:l[++a]=r:(l[++a]=null,s.push({i:a,x:Hn(n,r)})),i=Yn.lastIndex;return i<t.length&&(o=t.slice(i),l[a]?l[a]+=o:l[++a]=o),l.length<2?s[0]?function(e){return function(t){return e(t)+""}}(s[0].x):function(e){return function(){return e}}(t):(t=s.length,function(e){for(var n,r=0;r<t;++r)l[(n=s[r]).i]=n.x(e);return l.join("")})}function Un(e,t){t||(t=[]);var n,r=e?Math.min(t.length,e.length):0,o=t.slice();return function(i){for(n=0;n<r;++n)o[n]=e[n]*(1-i)+t[n]*i;return o}}function Xn(e,t){var n,r,o=typeof t;return null==t||"boolean"===o?Nn(t):("number"===o?Hn:"string"===o?(n=mn(t))?(t=n,Fn):jn:t instanceof mn?Fn:t instanceof Date?Bn:(r=t,!ArrayBuffer.isView(r)||r instanceof DataView?Array.isArray(t)?Vn:"function"!=typeof t.valueOf&&"function"!=typeof t.toString||isNaN(t)?zn:Hn:Un))(e,t)}function qn(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}function Gn(e){return+e}var Kn=[0,1];function Zn(e){return e}function $n(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:(n=isNaN(t)?NaN:.5,function(){return n});var n}function Jn(e,t,n){var r=e[0],o=e[1],i=t[0],a=t[1];return o<r?(r=$n(o,r),i=n(a,i)):(r=$n(r,o),i=n(i,a)),function(e){return i(r(e))}}function Qn(e,t,n){var r=Math.min(e.length,t.length)-1,o=new Array(r),i=new Array(r),a=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++a<r;)o[a]=$n(e[a],e[a+1]),i[a]=n(t[a],t[a+1]);return function(t){var n=$t(e,t,1,r)-1;return i[n](o[n](t))}}function er(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function tr(){var e,t,n,r,o,i,a=Kn,l=Kn,s=Xn,c=Zn;function u(){var e,t,n,s=Math.min(a.length,l.length);return c!==Zn&&(e=a[0],t=a[s-1],e>t&&(n=e,e=t,t=n),c=function(n){return Math.max(e,Math.min(t,n))}),r=s>2?Qn:Jn,o=i=null,d}function d(t){return null==t||isNaN(t=+t)?n:(o||(o=r(a.map(e),l,s)))(e(c(t)))}return d.invert=function(n){return c(t((i||(i=r(l,a.map(e),Hn)))(n)))},d.domain=function(e){return arguments.length?(a=Array.from(e,Gn),u()):a.slice()},d.range=function(e){return arguments.length?(l=Array.from(e),u()):l.slice()},d.rangeRound=function(e){return l=Array.from(e),s=qn,u()},d.clamp=function(e){return arguments.length?(c=!!e||Zn,u()):c!==Zn},d.interpolate=function(e){return arguments.length?(s=e,u()):s},d.unknown=function(e){return arguments.length?(n=e,d):n},function(n,r){return e=n,t=r,u()}}function nr(){return tr()(Zn,Zn)}function rr(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e)}return this}var or,ir=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function ar(e){if(!(t=ir.exec(e)))throw new Error("invalid format: "+e);var t;return new lr({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function lr(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}function sr(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function cr(e){return(e=sr(Math.abs(e)))?e[1]:NaN}function ur(e,t){var n=sr(e,t);if(!n)return e+"";var r=n[0],o=n[1];return o<0?"0."+new Array(-o).join("0")+r:r.length>o+1?r.slice(0,o+1)+"."+r.slice(o+1):r+new Array(o-r.length+2).join("0")}ar.prototype=lr.prototype,lr.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const dr={"%":(e,t)=>(100*e).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:function(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)},e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>ur(100*e,t),r:ur,s:function(e,t){var n=sr(e,t);if(!n)return e+"";var r=n[0],o=n[1],i=o-(or=3*Math.max(-8,Math.min(8,Math.floor(o/3))))+1,a=r.length;return i===a?r:i>a?r+new Array(i-a+1).join("0"):i>0?r.slice(0,i)+"."+r.slice(i):"0."+new Array(1-i).join("0")+sr(e,Math.max(0,t+i-1))[0]},X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function hr(e){return e}var pr,fr,gr,vr=Array.prototype.map,mr=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function yr(){var e=nr();return e.copy=function(){return er(e,yr())},rr.apply(e,arguments),function(e){var t=e.domain;return e.ticks=function(e){var n=t();return Wt(n[0],n[n.length-1],null==e?10:e)},e.tickFormat=function(e,n){var r=t();return function(e,t,n,r){var o,i=jt(e,t,n);switch((r=ar(null==r?",f":r)).type){case"s":var a=Math.max(Math.abs(e),Math.abs(t));return null!=r.precision||isNaN(o=function(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(cr(t)/3)))-cr(Math.abs(e)))}(i,a))||(r.precision=o),gr(r,a);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(o=function(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,cr(t)-cr(e))+1}(i,Math.max(Math.abs(e),Math.abs(t))))||(r.precision=o-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(o=function(e){return Math.max(0,-cr(Math.abs(e)))}(i))||(r.precision=o-2*("%"===r.type))}return fr(r)}(r[0],r[r.length-1],null==e?10:e,n)},e.nice=function(n){null==n&&(n=10);var r,o,i=t(),a=0,l=i.length-1,s=i[a],c=i[l],u=10;for(c<s&&(o=s,s=c,c=o,o=a,a=l,l=o);u-- >0;){if((o=Yt(s,c,n))===r)return i[a]=s,i[l]=c,t(i);if(o>0)s=Math.floor(s/o)*o,c=Math.ceil(c/o)*o;else{if(!(o<0))break;s=Math.ceil(s*o)/o,c=Math.floor(c*o)/o}r=o}return e},e}(e)}pr=function(e){var t,n,r=void 0===e.grouping||void 0===e.thousands?hr:(t=vr.call(e.grouping,Number),n=e.thousands+"",function(e,r){for(var o=e.length,i=[],a=0,l=t[0],s=0;o>0&&l>0&&(s+l+1>r&&(l=Math.max(1,r-s)),i.push(e.substring(o-=l,o+l)),!((s+=l+1)>r));)l=t[a=(a+1)%t.length];return i.reverse().join(n)}),o=void 0===e.currency?"":e.currency[0]+"",i=void 0===e.currency?"":e.currency[1]+"",a=void 0===e.decimal?".":e.decimal+"",l=void 0===e.numerals?hr:function(e){return function(t){return t.replace(/[0-9]/g,function(t){return e[+t]})}}(vr.call(e.numerals,String)),s=void 0===e.percent?"%":e.percent+"",c=void 0===e.minus?"":e.minus+"",u=void 0===e.nan?"NaN":e.nan+"";function d(e){var t=(e=ar(e)).fill,n=e.align,d=e.sign,h=e.symbol,p=e.zero,f=e.width,g=e.comma,v=e.precision,m=e.trim,y=e.type;"n"===y?(g=!0,y="g"):dr[y]||(void 0===v&&(v=12),m=!0,y="g"),(p||"0"===t&&"="===n)&&(p=!0,t="0",n="=");var _="$"===h?o:"#"===h&&/[boxX]/.test(y)?"0"+y.toLowerCase():"",x="$"===h?i:/[%p]/.test(y)?s:"",b=dr[y],C=/[defgprs%]/.test(y);function k(e){var o,i,s,h=_,k=x;if("c"===y)k=b(e)+k,e="";else{var w=(e=+e)<0||1/e<0;if(e=isNaN(e)?u:b(Math.abs(e),v),m&&(e=function(e){e:for(var t,n=e.length,r=1,o=-1;r<n;++r)switch(e[r]){case".":o=t=r;break;case"0":0===o&&(o=r),t=r;break;default:if(!+e[r])break e;o>0&&(o=0)}return o>0?e.slice(0,o)+e.slice(t+1):e}(e)),w&&0===+e&&"+"!==d&&(w=!1),h=(w?"("===d?d:c:"-"===d||"("===d?"":d)+h,k=("s"===y?mr[8+or/3]:"")+k+(w&&"("===d?")":""),C)for(o=-1,i=e.length;++o<i;)if(48>(s=e.charCodeAt(o))||s>57){k=(46===s?a+e.slice(o+1):e.slice(o))+k,e=e.slice(0,o);break}}g&&!p&&(e=r(e,1/0));var E=h.length+e.length+k.length,S=E<f?new Array(f-E+1).join(t):"";switch(g&&p&&(e=r(S+e,S.length?f-k.length:1/0),S=""),n){case"<":e=h+e+k+S;break;case"=":e=h+S+e+k;break;case"^":e=S.slice(0,E=S.length>>1)+h+e+k+S.slice(E);break;default:e=S+h+e+k}return l(e)}return v=void 0===v?6:/[gprs]/.test(y)?Math.max(1,Math.min(21,v)):Math.max(0,Math.min(20,v)),k.toString=function(){return e+""},k}return{format:d,formatPrefix:function(e,t){var n=d(((e=ar(e)).type="f",e)),r=3*Math.max(-8,Math.min(8,Math.floor(cr(t)/3))),o=Math.pow(10,-r),i=mr[8+r/3];return function(e){return n(o*e)+i}}}}({thousands:",",grouping:[3],currency:["$",""]}),fr=pr.format,gr=pr.formatPrefix;var _r=1e3,xr=6e4,br=36e5,Cr=864e5,kr=6048e5,wr=31536e6,Er=new Date,Sr=new Date;function Tr(e,t,n,r){function o(t){return e(t=0===arguments.length?new Date:new Date(+t)),t}return o.floor=t=>(e(t=new Date(+t)),t),o.ceil=n=>(e(n=new Date(n-1)),t(n,1),e(n),n),o.round=e=>{var t=o(e),n=o.ceil(e);return e-t<n-e?t:n},o.offset=(e,n)=>(t(e=new Date(+e),null==n?1:Math.floor(n)),e),o.range=(n,r,i)=>{var a,l=[];if(n=o.ceil(n),i=null==i?1:Math.floor(i),!(n<r&&i>0))return l;do{l.push(a=new Date(+n)),t(n,i),e(n)}while(a<n&&n<r);return l},o.filter=n=>Tr(t=>{if(t>=t)for(;e(t),!n(t);)t.setTime(t-1)},(e,r)=>{if(e>=e)if(r<0)for(;++r<=0;)for(;t(e,-1),!n(e););else for(;--r>=0;)for(;t(e,1),!n(e););}),n&&(o.count=(t,r)=>(Er.setTime(+t),Sr.setTime(+r),e(Er),e(Sr),Math.floor(n(Er,Sr))),o.every=e=>(e=Math.floor(e),isFinite(e)&&e>0?e>1?o.filter(r?t=>r(t)%e===0:t=>o.count(0,t)%e===0):o:null)),o}var Dr=Tr(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);Dr.every=e=>(e=Math.floor(e),isFinite(e)&&e>0?e>1?Tr(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):Dr:null),Dr.range;var Mr=Tr(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*_r)},(e,t)=>(t-e)/_r,e=>e.getUTCSeconds()),Ar=(Mr.range,Tr(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*_r)},(e,t)=>{e.setTime(+e+t*xr)},(e,t)=>(t-e)/xr,e=>e.getMinutes())),Lr=(Ar.range,Tr(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*xr)},(e,t)=>(t-e)/xr,e=>e.getUTCMinutes())),Pr=(Lr.range,Tr(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*_r-e.getMinutes()*xr)},(e,t)=>{e.setTime(+e+t*br)},(e,t)=>(t-e)/br,e=>e.getHours())),Ir=(Pr.range,Tr(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*br)},(e,t)=>(t-e)/br,e=>e.getUTCHours())),Nr=(Ir.range,Tr(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*xr)/Cr,e=>e.getDate()-1)),Or=(Nr.range,Tr(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Cr,e=>e.getUTCDate()-1)),Fr=(Or.range,Tr(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Cr,e=>Math.floor(e/Cr)));function Rr(e){return Tr(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(e,t)=>{e.setDate(e.getDate()+7*t)},(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*xr)/kr)}Fr.range;var Vr=Rr(0),Br=Rr(1),Hr=Rr(2),zr=Rr(3),Wr=Rr(4),Yr=Rr(5),jr=Rr(6);function Ur(e){return Tr(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+7*t)},(e,t)=>(t-e)/kr)}Vr.range,Br.range,Hr.range,zr.range,Wr.range,Yr.range,jr.range;var Xr=Ur(0),qr=Ur(1),Gr=Ur(2),Kr=Ur(3),Zr=Ur(4),$r=Ur(5),Jr=Ur(6),Qr=(Xr.range,qr.range,Gr.range,Kr.range,Zr.range,$r.range,Jr.range,Tr(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear()),e=>e.getMonth())),eo=(Qr.range,Tr(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+12*(t.getUTCFullYear()-e.getUTCFullYear()),e=>e.getUTCMonth())),to=(eo.range,Tr(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear()));to.every=e=>isFinite(e=Math.floor(e))&&e>0?Tr(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)}):null,to.range;var no=Tr(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());function ro(e,t,n,r,o,i){var a=[[Mr,1,_r],[Mr,5,5e3],[Mr,15,15e3],[Mr,30,3e4],[i,1,xr],[i,5,3e5],[i,15,9e5],[i,30,18e5],[o,1,br],[o,3,108e5],[o,6,216e5],[o,12,432e5],[r,1,Cr],[r,2,1728e5],[n,1,kr],[t,1,2592e6],[t,3,7776e6],[e,1,wr]];function l(t,n,r){var o=Math.abs(n-t)/r,i=qt(e=>{var[,,t]=e;return t}).right(a,o);if(i===a.length)return e.every(jt(t/wr,n/wr,r));if(0===i)return Dr.every(Math.max(jt(t,n,r),1));var[l,s]=a[o/a[i-1][2]<a[i][2]/o?i-1:i];return l.every(s)}return[function(e,t,n){var r=t<e;r&&([e,t]=[t,e]);var o=n&&"function"==typeof n.range?n:l(e,t,n),i=o?o.range(e,+t+1):[];return r?i.reverse():i},l]}no.every=e=>isFinite(e=Math.floor(e))&&e>0?Tr(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)}):null,no.range;var[oo,io]=ro(no,eo,Xr,Fr,Ir,Lr),[ao,lo]=ro(to,Qr,Vr,Nr,Pr,Ar),so=new Date,co=new Date;function uo(e,t,n,r){function o(t){return e(t=0===arguments.length?new Date:new Date(+t)),t}return o.floor=function(t){return e(t=new Date(+t)),t},o.ceil=function(n){return e(n=new Date(n-1)),t(n,1),e(n),n},o.round=function(e){var t=o(e),n=o.ceil(e);return e-t<n-e?t:n},o.offset=function(e,n){return t(e=new Date(+e),null==n?1:Math.floor(n)),e},o.range=function(n,r,i){var a,l=[];if(n=o.ceil(n),i=null==i?1:Math.floor(i),!(n<r&&i>0))return l;do{l.push(a=new Date(+n)),t(n,i),e(n)}while(a<n&&n<r);return l},o.filter=function(n){return uo(function(t){if(t>=t)for(;e(t),!n(t);)t.setTime(t-1)},function(e,r){if(e>=e)if(r<0)for(;++r<=0;)for(;t(e,-1),!n(e););else for(;--r>=0;)for(;t(e,1),!n(e););})},n&&(o.count=function(t,r){return so.setTime(+t),co.setTime(+r),e(so),e(co),Math.floor(n(so,co))},o.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?o.filter(r?function(t){return r(t)%e===0}:function(t){return o.count(0,t)%e===0}):o:null}),o}var ho=864e5,po=6048e5;function fo(e){return uo(function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+7*t)},function(e,t){return(t-e)/po})}var go=fo(0),vo=fo(1),mo=fo(2),yo=fo(3),_o=fo(4),xo=fo(5),bo=fo(6),Co=(go.range,vo.range,mo.range,yo.range,_o.range,xo.range,bo.range,uo(function(e){e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+t)},function(e,t){return(t-e)/ho},function(e){return e.getUTCDate()-1}));const ko=Co;function wo(e){return uo(function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},function(e,t){e.setDate(e.getDate()+7*t)},function(e,t){return(t-e-6e4*(t.getTimezoneOffset()-e.getTimezoneOffset()))/po})}Co.range;var Eo=wo(0),So=wo(1),To=wo(2),Do=wo(3),Mo=wo(4),Ao=wo(5),Lo=wo(6),Po=(Eo.range,So.range,To.range,Do.range,Mo.range,Ao.range,Lo.range,uo(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-6e4*(t.getTimezoneOffset()-e.getTimezoneOffset()))/ho,e=>e.getDate()-1));const Io=Po;Po.range;var No=uo(function(e){e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e,t){return t.getFullYear()-e.getFullYear()},function(e){return e.getFullYear()});No.every=function(e){return isFinite(e=Math.floor(e))&&e>0?uo(function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,n){t.setFullYear(t.getFullYear()+n*e)}):null};const Oo=No;No.range;var Fo=uo(function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)},function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()},function(e){return e.getUTCFullYear()});Fo.every=function(e){return isFinite(e=Math.floor(e))&&e>0?uo(function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n*e)}):null};const Ro=Fo;function Vo(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function Bo(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Ho(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function zo(e){var t=e.dateTime,n=e.date,r=e.time,o=e.periods,i=e.days,a=e.shortDays,l=e.months,s=e.shortMonths,c=$o(o),u=Jo(o),d=$o(i),h=Jo(i),p=$o(a),f=Jo(a),g=$o(l),v=Jo(l),m=$o(s),y=Jo(s),_={a:function(e){return a[e.getDay()]},A:function(e){return i[e.getDay()]},b:function(e){return s[e.getMonth()]},B:function(e){return l[e.getMonth()]},c:null,d:_i,e:_i,f:wi,g:Oi,G:Ri,H:xi,I:bi,j:Ci,L:ki,m:Ei,M:Si,p:function(e){return o[+(e.getHours()>=12)]},q:function(e){return 1+~~(e.getMonth()/3)},Q:aa,s:la,S:Ti,u:Di,U:Mi,V:Li,w:Pi,W:Ii,x:null,X:null,y:Ni,Y:Fi,Z:Vi,"%":ia},x={a:function(e){return a[e.getUTCDay()]},A:function(e){return i[e.getUTCDay()]},b:function(e){return s[e.getUTCMonth()]},B:function(e){return l[e.getUTCMonth()]},c:null,d:Bi,e:Bi,f:ji,g:ta,G:ra,H:Hi,I:zi,j:Wi,L:Yi,m:Ui,M:Xi,p:function(e){return o[+(e.getUTCHours()>=12)]},q:function(e){return 1+~~(e.getUTCMonth()/3)},Q:aa,s:la,S:qi,u:Gi,U:Ki,V:$i,w:Ji,W:Qi,x:null,X:null,y:ea,Y:na,Z:oa,"%":ia},b={a:function(e,t,n){var r=p.exec(t.slice(n));return r?(e.w=f.get(r[0].toLowerCase()),n+r[0].length):-1},A:function(e,t,n){var r=d.exec(t.slice(n));return r?(e.w=h.get(r[0].toLowerCase()),n+r[0].length):-1},b:function(e,t,n){var r=m.exec(t.slice(n));return r?(e.m=y.get(r[0].toLowerCase()),n+r[0].length):-1},B:function(e,t,n){var r=g.exec(t.slice(n));return r?(e.m=v.get(r[0].toLowerCase()),n+r[0].length):-1},c:function(e,n,r){return w(e,t,n,r)},d:ci,e:ci,f:gi,g:ii,G:oi,H:di,I:di,j:ui,L:fi,m:si,M:hi,p:function(e,t,n){var r=c.exec(t.slice(n));return r?(e.p=u.get(r[0].toLowerCase()),n+r[0].length):-1},q:li,Q:mi,s:yi,S:pi,u:ei,U:ti,V:ni,w:Qo,W:ri,x:function(e,t,r){return w(e,n,t,r)},X:function(e,t,n){return w(e,r,t,n)},y:ii,Y:oi,Z:ai,"%":vi};function C(e,t){return function(n){var r,o,i,a=[],l=-1,s=0,c=e.length;for(n instanceof Date||(n=new Date(+n));++l<c;)37===e.charCodeAt(l)&&(a.push(e.slice(s,l)),null!=(o=Uo[r=e.charAt(++l)])?r=e.charAt(++l):o="e"===r?" ":"0",(i=t[r])&&(r=i(n,o)),a.push(r),s=l+1);return a.push(e.slice(s,l)),a.join("")}}function k(e,t){return function(n){var r,o,i=Ho(1900,void 0,1);if(w(i,e,n+="",0)!=n.length)return null;if("Q"in i)return new Date(i.Q);if("s"in i)return new Date(1e3*i.s+("L"in i?i.L:0));if(t&&!("Z"in i)&&(i.Z=0),"p"in i&&(i.H=i.H%12+12*i.p),void 0===i.m&&(i.m="q"in i?i.q:0),"V"in i){if(i.V<1||i.V>53)return null;"w"in i||(i.w=1),"Z"in i?(o=(r=Bo(Ho(i.y,0,1))).getUTCDay(),r=o>4||0===o?vo.ceil(r):vo(r),r=ko.offset(r,7*(i.V-1)),i.y=r.getUTCFullYear(),i.m=r.getUTCMonth(),i.d=r.getUTCDate()+(i.w+6)%7):(o=(r=Vo(Ho(i.y,0,1))).getDay(),r=o>4||0===o?So.ceil(r):So(r),r=Io.offset(r,7*(i.V-1)),i.y=r.getFullYear(),i.m=r.getMonth(),i.d=r.getDate()+(i.w+6)%7)}else("W"in i||"U"in i)&&("w"in i||(i.w="u"in i?i.u%7:"W"in i?1:0),o="Z"in i?Bo(Ho(i.y,0,1)).getUTCDay():Vo(Ho(i.y,0,1)).getDay(),i.m=0,i.d="W"in i?(i.w+6)%7+7*i.W-(o+5)%7:i.w+7*i.U-(o+6)%7);return"Z"in i?(i.H+=i.Z/100|0,i.M+=i.Z%100,Bo(i)):Vo(i)}}function w(e,t,n,r){for(var o,i,a=0,l=t.length,s=n.length;a<l;){if(r>=s)return-1;if(37===(o=t.charCodeAt(a++))){if(o=t.charAt(a++),!(i=b[o in Uo?t.charAt(a++):o])||(r=i(e,n,r))<0)return-1}else if(o!=n.charCodeAt(r++))return-1}return r}return _.x=C(n,_),_.X=C(r,_),_.c=C(t,_),x.x=C(n,x),x.X=C(r,x),x.c=C(t,x),{format:function(e){var t=C(e+="",_);return t.toString=function(){return e},t},parse:function(e){var t=k(e+="",!1);return t.toString=function(){return e},t},utcFormat:function(e){var t=C(e+="",x);return t.toString=function(){return e},t},utcParse:function(e){var t=k(e+="",!0);return t.toString=function(){return e},t}}}Fo.range;var Wo,Yo,jo,Uo={"-":"",_:" ",0:"0"},Xo=/^\s*\d+/,qo=/^%/,Go=/[\\^$*+?|[\]().{}]/g;function Ko(e,t,n){var r=e<0?"-":"",o=(r?-e:e)+"",i=o.length;return r+(i<n?new Array(n-i+1).join(t)+o:o)}function Zo(e){return e.replace(Go,"\\$&")}function $o(e){return new RegExp("^(?:"+e.map(Zo).join("|")+")","i")}function Jo(e){return new Map(e.map((e,t)=>[e.toLowerCase(),t]))}function Qo(e,t,n){var r=Xo.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function ei(e,t,n){var r=Xo.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function ti(e,t,n){var r=Xo.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function ni(e,t,n){var r=Xo.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function ri(e,t,n){var r=Xo.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function oi(e,t,n){var r=Xo.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function ii(e,t,n){var r=Xo.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function ai(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function li(e,t,n){var r=Xo.exec(t.slice(n,n+1));return r?(e.q=3*r[0]-3,n+r[0].length):-1}function si(e,t,n){var r=Xo.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function ci(e,t,n){var r=Xo.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function ui(e,t,n){var r=Xo.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function di(e,t,n){var r=Xo.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function hi(e,t,n){var r=Xo.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function pi(e,t,n){var r=Xo.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function fi(e,t,n){var r=Xo.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function gi(e,t,n){var r=Xo.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function vi(e,t,n){var r=qo.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function mi(e,t,n){var r=Xo.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function yi(e,t,n){var r=Xo.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function _i(e,t){return Ko(e.getDate(),t,2)}function xi(e,t){return Ko(e.getHours(),t,2)}function bi(e,t){return Ko(e.getHours()%12||12,t,2)}function Ci(e,t){return Ko(1+Io.count(Oo(e),e),t,3)}function ki(e,t){return Ko(e.getMilliseconds(),t,3)}function wi(e,t){return ki(e,t)+"000"}function Ei(e,t){return Ko(e.getMonth()+1,t,2)}function Si(e,t){return Ko(e.getMinutes(),t,2)}function Ti(e,t){return Ko(e.getSeconds(),t,2)}function Di(e){var t=e.getDay();return 0===t?7:t}function Mi(e,t){return Ko(Eo.count(Oo(e)-1,e),t,2)}function Ai(e){var t=e.getDay();return t>=4||0===t?Mo(e):Mo.ceil(e)}function Li(e,t){return e=Ai(e),Ko(Mo.count(Oo(e),e)+(4===Oo(e).getDay()),t,2)}function Pi(e){return e.getDay()}function Ii(e,t){return Ko(So.count(Oo(e)-1,e),t,2)}function Ni(e,t){return Ko(e.getFullYear()%100,t,2)}function Oi(e,t){return Ko((e=Ai(e)).getFullYear()%100,t,2)}function Fi(e,t){return Ko(e.getFullYear()%1e4,t,4)}function Ri(e,t){var n=e.getDay();return Ko((e=n>=4||0===n?Mo(e):Mo.ceil(e)).getFullYear()%1e4,t,4)}function Vi(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Ko(t/60|0,"0",2)+Ko(t%60,"0",2)}function Bi(e,t){return Ko(e.getUTCDate(),t,2)}function Hi(e,t){return Ko(e.getUTCHours(),t,2)}function zi(e,t){return Ko(e.getUTCHours()%12||12,t,2)}function Wi(e,t){return Ko(1+ko.count(Ro(e),e),t,3)}function Yi(e,t){return Ko(e.getUTCMilliseconds(),t,3)}function ji(e,t){return Yi(e,t)+"000"}function Ui(e,t){return Ko(e.getUTCMonth()+1,t,2)}function Xi(e,t){return Ko(e.getUTCMinutes(),t,2)}function qi(e,t){return Ko(e.getUTCSeconds(),t,2)}function Gi(e){var t=e.getUTCDay();return 0===t?7:t}function Ki(e,t){return Ko(go.count(Ro(e)-1,e),t,2)}function Zi(e){var t=e.getUTCDay();return t>=4||0===t?_o(e):_o.ceil(e)}function $i(e,t){return e=Zi(e),Ko(_o.count(Ro(e),e)+(4===Ro(e).getUTCDay()),t,2)}function Ji(e){return e.getUTCDay()}function Qi(e,t){return Ko(vo.count(Ro(e)-1,e),t,2)}function ea(e,t){return Ko(e.getUTCFullYear()%100,t,2)}function ta(e,t){return Ko((e=Zi(e)).getUTCFullYear()%100,t,2)}function na(e,t){return Ko(e.getUTCFullYear()%1e4,t,4)}function ra(e,t){var n=e.getUTCDay();return Ko((e=n>=4||0===n?_o(e):_o.ceil(e)).getUTCFullYear()%1e4,t,4)}function oa(){return"+0000"}function ia(){return"%"}function aa(e){return+e}function la(e){return Math.floor(+e/1e3)}function sa(e,t){var n,r=0,o=(e=e.slice()).length-1,i=e[r],a=e[o];return a<i&&(n=r,r=o,o=n,n=i,i=a,a=n),e[r]=t.floor(i),e[o]=t.ceil(a),e}function ca(e){return new Date(e)}function ua(e){return e instanceof Date?+e:+new Date(+e)}function da(e,t,n,r,o,i,a,l,s,c){var u=nr(),d=u.invert,h=u.domain,p=c(".%L"),f=c(":%S"),g=c("%I:%M"),v=c("%I %p"),m=c("%a %d"),y=c("%b %d"),_=c("%B"),x=c("%Y");function b(e){return(s(e)<e?p:l(e)<e?f:a(e)<e?g:i(e)<e?v:r(e)<e?o(e)<e?m:y:n(e)<e?_:x)(e)}return u.invert=function(e){return new Date(d(e))},u.domain=function(e){return arguments.length?h(Array.from(e,ua)):h().map(ca)},u.ticks=function(t){var n=h();return e(n[0],n[n.length-1],null==t?10:t)},u.tickFormat=function(e,t){return null==t?b:c(t)},u.nice=function(e){var n=h();return e&&"function"==typeof e.range||(e=t(n[0],n[n.length-1],null==e?10:e)),e?h(sa(n,e)):u},u.copy=function(){return er(u,da(e,t,n,r,o,i,a,l,s,c))},u}function ha(){return rr.apply(da(ao,lo,to,Qr,Vr,Nr,Pr,Ar,Mr,Yo).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function pa(){return rr.apply(da(oo,io,no,eo,Xr,Or,Ir,Lr,Mr,jo).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}Wo=zo({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}),Yo=Wo.format,Wo.parse,jo=Wo.utcFormat,Wo.utcParse;class fa extends Map{constructor(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:va;if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:t}}),null!=e)for(var[n,r]of e)this.set(n,r)}get(e){return super.get(ga(this,e))}has(e){return super.has(ga(this,e))}set(e,t){return super.set(function(e,t){var{_intern:n,_key:r}=e,o=r(t);return n.has(o)?n.get(o):(n.set(o,t),t)}(this,e),t)}delete(e){return super.delete(function(e,t){var{_intern:n,_key:r}=e,o=r(t);return n.has(o)&&(t=n.get(o),n.delete(o)),t}(this,e))}}function ga(e,t){var{_intern:n,_key:r}=e,o=r(t);return n.has(o)?n.get(o):t}function va(e){return null!==e&&"object"==typeof e?e.valueOf():e}Set;var ma=Symbol("implicit");function ya(){var e=new fa,t=[],n=[],r=ma;function o(o){var i=e.get(o);if(void 0===i){if(r!==ma)return r;e.set(o,i=t.push(o)-1)}return n[i%n.length]}return o.domain=function(n){if(!arguments.length)return t.slice();for(var r of(t=[],e=new fa,n))e.has(r)||e.set(r,t.push(r)-1);return o},o.range=function(e){return arguments.length?(n=Array.from(e),o):n.slice()},o.unknown=function(e){return arguments.length?(r=e,o):r},o.copy=function(){return ya(t,n).unknown(r)},rr.apply(o,arguments),o}function _a(){var e,t,n=ya().unknown(void 0),r=n.domain,o=n.range,i=0,a=1,l=!1,s=0,c=0,u=.5;function d(){var n=r().length,d=a<i,h=d?a:i,p=d?i:a;e=(p-h)/Math.max(1,n-s+2*c),l&&(e=Math.floor(e)),h+=(p-h-e*(n-s))*u,t=e*(1-s),l&&(h=Math.round(h),t=Math.round(t));var f=function(e,t,n){e=+e,t=+t,n=(o=arguments.length)<2?(t=e,e=0,1):o<3?1:+n;for(var r=-1,o=0|Math.max(0,Math.ceil((t-e)/n)),i=new Array(o);++r<o;)i[r]=e+r*n;return i}(n).map(function(t){return h+e*t});return o(d?f.reverse():f)}return delete n.unknown,n.domain=function(e){return arguments.length?(r(e),d()):r()},n.range=function(e){return arguments.length?([i,a]=e,i=+i,a=+a,d()):[i,a]},n.rangeRound=function(e){return[i,a]=e,i=+i,a=+a,l=!0,d()},n.bandwidth=function(){return t},n.step=function(){return e},n.round=function(e){return arguments.length?(l=!!e,d()):l},n.padding=function(e){return arguments.length?(s=Math.min(1,c=+e),d()):s},n.paddingInner=function(e){return arguments.length?(s=Math.min(1,e),d()):s},n.paddingOuter=function(e){return arguments.length?(c=+e,d()):c},n.align=function(e){return arguments.length?(u=Math.max(0,Math.min(1,e)),d()):u},n.copy=function(){return _a(r(),[i,a]).round(l).paddingInner(s).paddingOuter(c).align(u)},rr.apply(d(),arguments)}var xa=n(93),ba=n(103),Ca=n(358),ka=n(228),wa="__currentId__",Ea=(0,Ca.z)()||{};void 0===Ea[wa]&&(Ea[wa]=0);var Sa=!1;function Ta(e){if(!Sa){var t=ka.nr.getInstance();t&&t.onReset&&t.onReset(Da),Sa=!0}return(void 0===e?"id__":e)+Ea[wa]++}function Da(e){void 0===e&&(e=0),Ea[wa]=e}function Ma(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return t.length<2?t[0]:function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];t.forEach(function(t){return t&&t.apply(e,n)})}}function Aa(e){!function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=Ma(e,e[n],t[n]))}(e,{componentDidMount:La,componentDidUpdate:Pa,componentWillUnmount:Ia})}function La(){Na(this.props.componentRef,this)}function Pa(e){e.componentRef!==this.props.componentRef&&(Na(e.componentRef,null),Na(this.props.componentRef,this))}function Ia(){Na(this.props.componentRef,null)}function Na(e,t){e&&("object"==typeof e?e.current=t:"function"==typeof e&&e(t))}var Oa=n(497),Fa=n(811),Ra={host:"ms-HoverCard-host"},Va=27,Ba=function(){function e(e,t){this._timeoutIds=null,this._immediateIds=null,this._intervalIds=null,this._animationFrameIds=null,this._isDisposed=!1,this._parent=e||null,this._onErrorHandler=t,this._noop=function(){}}return e.prototype.dispose=function(){var e;if(this._isDisposed=!0,this._parent=null,this._timeoutIds){for(e in this._timeoutIds)this._timeoutIds.hasOwnProperty(e)&&this.clearTimeout(parseInt(e,10));this._timeoutIds=null}if(this._immediateIds){for(e in this._immediateIds)this._immediateIds.hasOwnProperty(e)&&this.clearImmediate(parseInt(e,10));this._immediateIds=null}if(this._intervalIds){for(e in this._intervalIds)this._intervalIds.hasOwnProperty(e)&&this.clearInterval(parseInt(e,10));this._intervalIds=null}if(this._animationFrameIds){for(e in this._animationFrameIds)this._animationFrameIds.hasOwnProperty(e)&&this.cancelAnimationFrame(parseInt(e,10));this._animationFrameIds=null}},e.prototype.setTimeout=function(e,t){var n=this,r=0;return this._isDisposed||(this._timeoutIds||(this._timeoutIds={}),r=setTimeout(function(){try{n._timeoutIds&&delete n._timeoutIds[r],e.apply(n._parent)}catch(e){n._logError(e)}},t),this._timeoutIds[r]=!0),r},e.prototype.clearTimeout=function(e){this._timeoutIds&&this._timeoutIds[e]&&(clearTimeout(e),delete this._timeoutIds[e])},e.prototype.setImmediate=function(e,t){var n=this,r=0,o=(0,Ca.z)(t);return this._isDisposed||(this._immediateIds||(this._immediateIds={}),r=o.setTimeout(function(){try{n._immediateIds&&delete n._immediateIds[r],e.apply(n._parent)}catch(e){n._logError(e)}},0),this._immediateIds[r]=!0),r},e.prototype.clearImmediate=function(e,t){var n=(0,Ca.z)(t);this._immediateIds&&this._immediateIds[e]&&(n.clearTimeout(e),delete this._immediateIds[e])},e.prototype.setInterval=function(e,t){var n=this,r=0;return this._isDisposed||(this._intervalIds||(this._intervalIds={}),r=setInterval(function(){try{e.apply(n._parent)}catch(e){n._logError(e)}},t),this._intervalIds[r]=!0),r},e.prototype.clearInterval=function(e){this._intervalIds&&this._intervalIds[e]&&(clearInterval(e),delete this._intervalIds[e])},e.prototype.throttle=function(e,t,n){var r=this;if(this._isDisposed)return this._noop;var o,i,a=t||0,l=!0,s=!0,c=0,u=null;n&&"boolean"==typeof n.leading&&(l=n.leading),n&&"boolean"==typeof n.trailing&&(s=n.trailing);var d=function(t){var n=Date.now(),h=n-c,p=l?a-h:a;return h>=a&&(!t||l)?(c=n,u&&(r.clearTimeout(u),u=null),o=e.apply(r._parent,i)):null===u&&s&&(u=r.setTimeout(d,p)),o};return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return i=e,d(!0)}},e.prototype.debounce=function(e,t,n){var r=this;if(this._isDisposed){var o=function(){};return o.cancel=function(){},o.flush=function(){return null},o.pending=function(){return!1},o}var i,a,l=t||0,s=!1,c=!0,u=null,d=0,h=Date.now(),p=null;n&&"boolean"==typeof n.leading&&(s=n.leading),n&&"boolean"==typeof n.trailing&&(c=n.trailing),n&&"number"==typeof n.maxWait&&!isNaN(n.maxWait)&&(u=n.maxWait);var f=function(e){p&&(r.clearTimeout(p),p=null),h=e},g=function(t){f(t),i=e.apply(r._parent,a)},v=function(e){var t=Date.now(),n=!1;e&&(s&&t-d>=l&&(n=!0),d=t);var o=t-d,a=l-o,f=t-h,m=!1;return null!==u&&(f>=u&&p?m=!0:a=Math.min(a,u-f)),o>=l||m||n?g(t):null!==p&&e||!c||(p=r.setTimeout(v,a)),i},m=function(){return!!p},y=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return a=e,v(!0)};return y.cancel=function(){m()&&f(Date.now())},y.flush=function(){return m()&&g(Date.now()),i},y.pending=m,y},e.prototype.requestAnimationFrame=function(e,t){var n=this,r=0,o=(0,Ca.z)(t);if(!this._isDisposed){this._animationFrameIds||(this._animationFrameIds={});var i=function(){try{n._animationFrameIds&&delete n._animationFrameIds[r],e.apply(n._parent)}catch(e){n._logError(e)}};r=o.requestAnimationFrame?o.requestAnimationFrame(i):o.setTimeout(i,0),this._animationFrameIds[r]=!0}return r},e.prototype.cancelAnimationFrame=function(e,t){var n=(0,Ca.z)(t);this._animationFrameIds&&this._animationFrameIds[e]&&(n.cancelAnimationFrame?n.cancelAnimationFrame(e):n.clearTimeout(e),delete this._animationFrameIds[e])},e.prototype._logError=function(e){this._onErrorHandler&&this._onErrorHandler(e)},e}(),Ha=n(403);function za(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return Wa.apply(this,[null,e].concat(t))}function Wa(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];t=t||{};for(var o=0,i=n;o<i.length;o++){var a=i[o];if(a)for(var l in a)!a.hasOwnProperty(l)||e&&!e(l)||(t[l]=a[l])}return t}var Ya,ja,Ua=function(){function e(t){this._id=e._uniqueId++,this._parent=t,this._eventRecords=[]}return e.raise=function(t,n,r,o,i){var a,l=null!=i?i:(0,Ha.Y)();if(e._isElement(t)){if(void 0!==l&&l.createEvent){var s=l.createEvent("HTMLEvents");s.initEvent(n,o||!1,!0),za(s,r),a=t.dispatchEvent(s)}else if(void 0!==l&&l.createEventObject){var c=l.createEventObject(r);t.fireEvent("on"+n,c)}}else for(;t&&!1!==a;){var u=t.__events__,d=u?u[n]:null;if(d)for(var h in d)if(d.hasOwnProperty(h))for(var p=d[h],f=0;!1!==a&&f<p.length;f++){var g=p[f];g.objectCallback&&(a=g.objectCallback.call(g.parent,r))}t=o?t.parent:null}return a},e.isObserved=function(e,t){var n=e&&e.__events__;return!!n&&!!n[t]},e.isDeclared=function(e,t){var n=e&&e.__declaredEvents;return!!n&&!!n[t]},e.stopPropagation=function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},e._isElement=function(e){return!!e&&(!!e.addEventListener||"undefined"!=typeof HTMLElement&&e instanceof HTMLElement)},e.prototype.dispose=function(){this._isDisposed||(this._isDisposed=!0,this.off(),this._parent=null)},e.prototype.onAll=function(e,t,n){for(var r in t)t.hasOwnProperty(r)&&this.on(e,r,t[r],n)},e.prototype.on=function(t,n,r,o){var i=this;if(n.indexOf(",")>-1)for(var a=n.split(/[ ,]+/),l=0;l<a.length;l++)this.on(t,a[l],r,o);else{var s=this._parent,c={target:t,eventName:n,parent:s,callback:r,options:o};if((a=t.__events__=t.__events__||{})[n]=a[n]||{count:0},a[n][this._id]=a[n][this._id]||[],a[n][this._id].push(c),a[n].count++,e._isElement(t)){var u=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(!i._isDisposed){var n;try{if(!1===(n=r.apply(s,e))&&e[0]){var o=e[0];o.preventDefault&&o.preventDefault(),o.stopPropagation&&o.stopPropagation(),o.cancelBubble=!0}}catch(o){}return n}};c.elementCallback=u,t.addEventListener?t.addEventListener(n,u,o):t.attachEvent&&t.attachEvent("on"+n,u)}else c.objectCallback=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(!i._isDisposed)return r.apply(s,e)};this._eventRecords.push(c)}},e.prototype.off=function(e,t,n,r){for(var o=0;o<this._eventRecords.length;o++){var i=this._eventRecords[o];if(!(e&&e!==i.target||t&&t!==i.eventName||n&&n!==i.callback||"boolean"==typeof r&&r!==i.options)){var a=i.target.__events__,l=a[i.eventName],s=l?l[this._id]:null;s&&(1!==s.length&&n?(l.count--,s.splice(s.indexOf(i),1)):(l.count-=s.length,delete a[i.eventName][this._id]),l.count||delete a[i.eventName]),i.elementCallback&&(i.target.removeEventListener?i.target.removeEventListener(i.eventName,i.elementCallback,i.options):i.target.detachEvent&&i.target.detachEvent("on"+i.eventName,i.elementCallback)),this._eventRecords.splice(o--,1)}}},e.prototype.raise=function(t,n,r){return e.raise(this._parent,t,n,r)},e.prototype.declare=function(e){var t=this._parent.__declaredEvents=this._parent.__declaredEvents||{};if("string"==typeof e)t[e]=!0;else for(var n=0;n<e.length;n++)t[e[n]]=!0},e._uniqueId=0,e}(),Xa=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n={},r=0,o=e;r<o.length;r++)for(var i=o[r],a=0,l=Array.isArray(i)?i:Object.keys(i);a<l.length;a++)n[l[a]]=1;return n},qa=Xa(["onCopy","onCut","onPaste","onCompositionEnd","onCompositionStart","onCompositionUpdate","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onInput","onSubmit","onLoad","onError","onKeyDown","onKeyDownCapture","onKeyPress","onKeyUp","onAbort","onCanPlay","onCanPlayThrough","onDurationChange","onEmptied","onEncrypted","onEnded","onLoadedData","onLoadedMetadata","onLoadStart","onPause","onPlay","onPlaying","onProgress","onRateChange","onSeeked","onSeeking","onStalled","onSuspend","onTimeUpdate","onVolumeChange","onWaiting","onClick","onClickCapture","onContextMenu","onDoubleClick","onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onMouseUpCapture","onSelect","onTouchCancel","onTouchEnd","onTouchMove","onTouchStart","onScroll","onWheel","onPointerCancel","onPointerDown","onPointerEnter","onPointerLeave","onPointerMove","onPointerOut","onPointerOver","onPointerUp","onGotPointerCapture","onLostPointerCapture"]),Ga=Xa(["accessKey","children","className","contentEditable","dir","draggable","hidden","htmlFor","id","lang","ref","role","style","tabIndex","title","translate","spellCheck","name"]),Ka=Xa(Ga,qa),Za=(Xa(Ka,["form"]),Xa(Ka,["height","loop","muted","preload","src","width"])),$a=(Xa(Za,["poster"]),Xa(Ka,["start"]),Xa(Ka,["value"]),Xa(Ka,["download","href","hrefLang","media","rel","target","type"]),Xa(Ka,["autoFocus","disabled","form","formAction","formEncType","formMethod","formNoValidate","formTarget","type","value"])),Ja=(Xa($a,["accept","alt","autoCapitalize","autoComplete","checked","dirname","form","height","inputMode","list","max","maxLength","min","minLength","multiple","pattern","placeholder","readOnly","required","src","step","size","type","value","width"]),Xa($a,["autoCapitalize","cols","dirname","form","maxLength","minLength","placeholder","readOnly","required","rows","wrap"]),Xa($a,["form","multiple","required"]),Xa(Ka,["selected","value"]),Xa(Ka,["cellPadding","cellSpacing"]),Xa(Ka,["rowSpan","scope"]),Xa(Ka,["colSpan","headers","rowSpan","scope"]),Xa(Ka,["span"]),Xa(Ka,["span"]),Xa(Ka,["acceptCharset","action","encType","encType","method","noValidate","target"]),Xa(Ka,["allow","allowFullScreen","allowPaymentRequest","allowTransparency","csp","height","importance","referrerPolicy","sandbox","src","srcDoc","width"]),Xa(Ka,["alt","crossOrigin","height","src","srcSet","useMap","width"]),Ka);function Qa(e,t,n){for(var r=Array.isArray(t),o={},i=0,a=Object.keys(e);i<a.length;i++){var l=a[i];!(!r&&t[l]||r&&t.indexOf(l)>=0||0===l.indexOf("data-")||0===l.indexOf("aria-"))||n&&-1!==(null==n?void 0:n.indexOf(l))||(o[l]=e[l])}return o}!function(e){e[e.hover=0]="hover",e[e.hotKey=1]="hotKey"}(Ya||(Ya={})),function(e){e.plain="PlainCard",e.expanding="ExpandingCard"}(ja||(ja={}));var el,tl={root:"ms-ExpandingCard-root",compactCard:"ms-ExpandingCard-compactCard",expandedCard:"ms-ExpandingCard-expandedCard",expandedCardScroll:"ms-ExpandingCard-expandedCardScrollRegion"};function nl(e,t){var n,r;if(void 0===t&&(t=!0),!e)return null;var o=t&&function(e){var t,n;return e&&(n=e)&&n._virtual&&(t=e._virtual.parent),t}(e);return o||("function"!=typeof e.assignedElements&&(null===(n=e.assignedSlot)||void 0===n?void 0:n.parentNode)?e.assignedSlot:11===(null===(r=e.parentNode)||void 0===r?void 0:r.nodeType)?e.parentNode.host:e.parentNode)}function rl(e,t,n){return null!=n||(n=document),!e||e===n.body||e instanceof Document?null:t(e)?e:rl(nl(e),t)}function ol(e,t,n){void 0===n&&(n=!0);var r=!1;if(e&&t)if(n)if(e===t)r=!0;else for(r=!1;t;){var o=nl(t);if(o===e){r=!0;break}t=o}else e.contains&&(r=e.contains(t));return r}function il(e,t,n){var r=ll(e,e,!0,!1,!1,!0,void 0,void 0,t,n);return!!r&&(fl(r),!0)}function al(e,t,n,r,o,i,a,l,s){var c;if(!t||!a&&t===e)return null;var u=sl(t);if(o&&u&&(i||!dl(t)&&!hl(t))){var d=al(e,t.lastElementChild||s&&(null===(c=t.shadowRoot)||void 0===c?void 0:c.lastElementChild),!0,!0,!0,i,a,l,s);if(d){if(l&&ul(d,!0,s)||!l)return d;var h=al(e,d.previousElementSibling,!0,!0,!0,i,a,l,s);if(h)return h;for(var p=d.parentElement;p&&p!==t;){var f=al(e,p.previousElementSibling,!0,!0,!0,i,a,l,s);if(f)return f;p=p.parentElement}}}return n&&u&&ul(t,l,s)?t:al(e,t.previousElementSibling,!0,!0,!0,i,a,l,s)||(r?null:al(e,t.parentElement,!0,!1,!1,i,a,l,s))}function ll(e,t,n,r,o,i,a,l,s,c){var u;if(!t||t===e&&o&&!a)return null;var d=(s?cl:sl)(t);if(n&&d&&ul(t,l,c))return t;if(!o&&d&&(i||!dl(t)&&!hl(t))){var h=ll(e,t.firstElementChild||c&&(null===(u=t.shadowRoot)||void 0===u?void 0:u.firstElementChild),!0,!0,!1,i,a,l,s,c);if(h)return h}return t===e?null:ll(e,t.nextElementSibling,!0,!0,!1,i,a,l,s,c)||(r?null:ll(e,t.parentElement,!1,!1,!0,i,a,l,s,c))}function sl(e){if(!e||!e.getAttribute)return!1;var t=e.getAttribute("data-is-visible");return null!=t?"true"===t:0!==e.offsetHeight||null!==e.offsetParent||!0===e.isVisible}function cl(e,t){var n=null!=t?t:(0,Ca.z)();return!!e&&sl(e)&&!e.hidden&&"hidden"!==n.getComputedStyle(e).visibility}function ul(e,t,n){if(void 0===n&&(n=!0),!e||e.disabled)return!1;var r=0,o=null;e&&e.getAttribute&&(o=e.getAttribute("tabIndex"))&&(r=parseInt(o,10));var i=e.getAttribute?e.getAttribute("data-is-focusable"):null,a=null!==o&&r>=0,l=!(!n||!e.shadowRoot||!e.shadowRoot.delegatesFocus),s=!!e&&"false"!==i&&("A"===e.tagName||"BUTTON"===e.tagName||"INPUT"===e.tagName||"TEXTAREA"===e.tagName||"SELECT"===e.tagName||"true"===i||a||l);return t?-1!==r&&s:s}function dl(e){return!!(e&&e.getAttribute&&e.getAttribute("data-focuszone-id"))}function hl(e){return!(!e||!e.getAttribute||"true"!==e.getAttribute("data-is-sub-focuszone"))}!function(e){e[e.compact=0]="compact",e[e.expanded=1]="expanded"}(el||(el={}));var pl=void 0;function fl(e){if(e){var t=(0,Ca.z)(e);t&&(void 0!==pl&&t.cancelAnimationFrame(pl),pl=t.requestAnimationFrame(function(){e&&e.focus(),pl=void 0}))}}function gl(e,t,n,r){return e.addEventListener(t,n,r),function(){return e.removeEventListener(t,n,r)}}function vl(e,t){for(var n=(0,de.Cl)({},t),r=0,o=Object.keys(e);r<o.length;r++){var i=o[r];void 0===n[i]&&(n[i]=e[i])}return n}function ml(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=[],r=0,o=e;r<o.length;r++){var i=o[r];if(i)if("string"==typeof i)n.push(i);else if(i.hasOwnProperty("toString")&&"function"==typeof i.toString)n.push(i.toString());else for(var a in i)i[a]&&n.push(a)}return n.join(" ")}var yl,_l,xl,bl=n(280),Cl=((0,bl.Z)({overflow:"hidden !important"}),"data-is-scrollable");function kl(e){for(var t=e,n=(0,Ha.Y)(e);t&&t!==n.body;){if("true"===t.getAttribute(Cl))return t;t=t.parentElement}for(t=e;t&&t!==n.body;){if("false"!==t.getAttribute(Cl)){var r=getComputedStyle(t),o=r?r.getPropertyValue("overflow-y"):"";if(o&&("scroll"===o||"auto"===o))return t}t=t.parentElement}return t&&t!==n.body||(t=(0,Ca.z)(e)),t}!function(e){e[e.top=1]="top",e[e.bottom=-1]="bottom",e[e.left=2]="left",e[e.right=-2]="right"}(_l||(_l={})),function(e){e[e.top=0]="top",e[e.bottom=1]="bottom",e[e.start=2]="start",e[e.end=3]="end"}(xl||(xl={}));var wl,El=function(){function e(e,t,n,r){void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=0),void 0===r&&(r=0),this.top=n,this.bottom=r,this.left=e,this.right=t}return Object.defineProperty(e.prototype,"width",{get:function(){return this.right-this.left},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.bottom-this.top},enumerable:!1,configurable:!0}),e.prototype.equals=function(e){return parseFloat(this.top.toFixed(4))===parseFloat(e.top.toFixed(4))&&parseFloat(this.bottom.toFixed(4))===parseFloat(e.bottom.toFixed(4))&&parseFloat(this.left.toFixed(4))===parseFloat(e.left.toFixed(4))&&parseFloat(this.right.toFixed(4))===parseFloat(e.right.toFixed(4))},e}();function Sl(e,t,n){return{targetEdge:e,alignmentEdge:t,isAuto:n}}var Tl=((wl={})[0]=Sl(_l.top,_l.left),wl[1]=Sl(_l.top),wl[2]=Sl(_l.top,_l.right),wl[3]=Sl(_l.top,void 0,!0),wl[4]=Sl(_l.bottom,_l.left),wl[5]=Sl(_l.bottom),wl[6]=Sl(_l.bottom,_l.right),wl[7]=Sl(_l.bottom,void 0,!0),wl[8]=Sl(_l.left,_l.top),wl[9]=Sl(_l.left),wl[10]=Sl(_l.left,_l.bottom),wl[11]=Sl(_l.right,_l.top),wl[12]=Sl(_l.right),wl[13]=Sl(_l.right,_l.bottom),wl);function Dl(e,t){return!(e.top<t.top||e.bottom>t.bottom||e.left<t.left||e.right>t.right)}function Ml(e,t){var n=[];return e.top<t.top&&n.push(_l.top),e.bottom>t.bottom&&n.push(_l.bottom),e.left<t.left&&n.push(_l.left),e.right>t.right&&n.push(_l.right),n}function Al(e,t){return e[_l[t]]}function Ll(e,t,n){return e[_l[t]]=n,e}function Pl(e,t){var n=jl(t);return(Al(e,n.positiveEdge)+Al(e,n.negativeEdge))/2}function Il(e,t){return e>0?t:-1*t}function Nl(e,t){return Il(e,Al(t,e))}function Ol(e,t,n){return Il(n,Al(e,n)-Al(t,n))}function Fl(e,t,n,r){void 0===r&&(r=!0);var o=Al(e,t)-n,i=Ll(e,t,n);return r&&(i=Ll(e,-1*t,Al(e,-1*t)-o)),i}function Rl(e,t,n,r){return void 0===r&&(r=0),Fl(e,n,Al(t,n)+Il(n,r))}function Vl(e,t,n){return Nl(n,e)>Nl(n,t)}function Bl(e,t){for(var n=0,r=0,o=Ml(e,t);r<o.length;r++){var i=o[r];n+=Math.pow(Ol(e,t,i),2)}return n}function Hl(e,t,n,r){return void 0===r&&(r=200),(n===_l.bottom||n===_l.top)&&Ol(e,t,n)>=r}function zl(e,t,n,r){for(var o=0,i=e;o<i.length;o++){var a=i[o],l=void 0;r&&r===-1*a?(l=Fl(t.elementRectangle,a,Al(n,a),!1),t.forcedInBounds=!0):Vl(l=Rl(t.elementRectangle,n,a),n,-1*a)||(l=Fl(l,-1*a,Al(n,-1*a),!1),t.forcedInBounds=!0),t.elementRectangle=l}return t}function Wl(e,t,n){var r=jl(t).positiveEdge;return Fl(e,r,n-(Pl(e,t)-Al(e,r)))}function Yl(e,t,n,r,o){void 0===r&&(r=0);var i=new El(e.left,e.right,e.top,e.bottom),a=n.alignmentEdge,l=n.targetEdge,s=o?l:-1*l;return i=o?Rl(i,t,l,r):function(e,t,n,r){void 0===r&&(r=0);var o=Il(-1*n,r);return Fl(e,-1*n,Al(t,n)+o)}(i,t,l,r),i=a?Rl(i,t,a):Wl(i,s,Pl(t,l))}function jl(e){return e===_l.top||e===_l.bottom?{positiveEdge:_l.left,negativeEdge:_l.right}:{positiveEdge:_l.top,negativeEdge:_l.bottom}}function Ul(e,t,n){return n&&Math.abs(Ol(e,n,t))>Math.abs(Ol(e,n,-1*t))?-1*t:t}function Xl(e,t,n,r,o,i,a,l){var s,c={},u=Kl(t),d=i?n:-1*n,h=o||jl(n).positiveEdge;return a&&!function(e,t,n){return void 0!==n&&Al(e,t)===Al(n,t)}(e,(s=h,-1*s),r)||(h=Ul(e,h,r)),c[_l[d]]=Ol(e,u,d),c[_l[h]]=Ol(e,u,h),l&&(c[_l[-1*d]]=Ol(e,u,-1*d),c[_l[-1*h]]=Ol(e,u,-1*h)),c}function ql(e,t,n){var r=Pl(t,e),o=Pl(n,e),i=jl(e),a=i.positiveEdge,l=i.negativeEdge;return r<=o?a:l}function Gl(e,t,n,r,o,i,a,l,s){void 0===i&&(i=!1);var c=Yl(e,t,r,o,s);return Dl(c,n)?{elementRectangle:c,targetEdge:r.targetEdge,alignmentEdge:r.alignmentEdge}:function(e,t,n,r,o,i,a,l,s){void 0===o&&(o=!1),void 0===a&&(a=0);var c=r.alignmentEdge,u=r.alignTargetEdge,d={elementRectangle:e,targetEdge:r.targetEdge,alignmentEdge:c};l||s||(d=function(e,t,n,r,o,i,a){void 0===o&&(o=!1),void 0===a&&(a=0);var l=[_l.left,_l.right,_l.bottom,_l.top];(0,ba.jI)()&&(l[0]*=-1,l[1]*=-1);for(var s,c=e,u=r.targetEdge,d=r.alignmentEdge,h=u,p=d,f=0;f<4;f++){if(Vl(c,n,u))return{elementRectangle:c,targetEdge:u,alignmentEdge:d};if(o&&Hl(t,n,u,i)){switch(u){case _l.bottom:c.bottom=n.bottom;break;case _l.top:c.top=n.top}return{elementRectangle:c,targetEdge:u,alignmentEdge:d,forcedInBounds:!0}}var g=Bl(c,n);(!s||g<s)&&(s=g,h=u,p=d),l.splice(l.indexOf(u),1),l.length>0&&(l.indexOf(-1*u)>-1?u*=-1:(d=u,u=l.slice(-1)[0]),c=Yl(e,t,{targetEdge:u,alignmentEdge:d},a))}return{elementRectangle:c=Yl(e,t,{targetEdge:h,alignmentEdge:p},a),targetEdge:h,alignmentEdge:p}}(e,t,n,r,o,i,a));var h=Ml(d.elementRectangle,n),p=l?-d.targetEdge:void 0;if(h.length>0)if(u)if(d.alignmentEdge&&h.indexOf(-1*d.alignmentEdge)>-1){var f=function(e,t,n,r){var o=e.alignmentEdge,i=e.targetEdge,a=-1*o;return{elementRectangle:Yl(e.elementRectangle,t,{targetEdge:i,alignmentEdge:a},n,r),targetEdge:i,alignmentEdge:a}}(d,t,a,s);if(Dl(f.elementRectangle,n))return f;d=zl(Ml(f.elementRectangle,n),d,n,p)}else d=zl(h,d,n,p);else d=zl(h,d,n,p);return d}(c,t,n,r,i,a,o,l,s)}function Kl(e){var t=e.getBoundingClientRect();return new El(t.left,t.right,t.top,t.bottom)}function Zl(e,t,n,r,o,i){void 0===o&&(o=!1);var a=e.gapSpace?e.gapSpace:0,l=function(e,t){var n;if(t){if(t.preventDefault){var r=t;n=new El(r.clientX,r.clientX,r.clientY,r.clientY)}else if(t.getBoundingClientRect)n=Kl(t);else{var o=t,i=o.left||o.x,a=o.top||o.y,l=o.right||i,s=o.bottom||a;n=new El(i,l,a,s)}if(!Dl(n,e))for(var c=0,u=Ml(n,e);c<u.length;c++){var d=u[c];n[_l[d]]=e[_l[d]]}}else n=new El(0,0,0,0);return n}(n,e.target),s=function(e,t,n,r,o){return e.isAuto&&(e.alignmentEdge=ql(e.targetEdge,t,n)),e.alignTargetEdge=o,e}(function(e,t,n){if(void 0===e&&(e=7),n)return{alignmentEdge:n.alignmentEdge,isAuto:n.isAuto,targetEdge:n.targetEdge};var r=(0,de.Cl)({},Tl[e]);return(0,ba.jI)()?(r.alignmentEdge&&r.alignmentEdge%2==0&&(r.alignmentEdge=-1*r.alignmentEdge),void 0!==t?Tl[t]:r):r}(e.directionalHint,e.directionalHintForRTL,r),l,n,e.coverTarget,e.alignTargetEdge),c=Gl(Kl(t),l,n,s,a,o,i,e.directionalHintFixed,e.coverTarget);return(0,de.Cl)((0,de.Cl)({},c),{targetRectangle:l})}function $l(e,t,n){return void 0===t&&(t=0),void 0===n&&(n=0),function(e){return Math.sqrt(e*e*2)}(e?t:0)/2+n}function Jl(e,t,n,r,o,i,a,l){void 0===o&&(o=!1);var s=null!=l?l:(0,Ca.z)(),c=e.isBeakVisible&&e.beakWidth||0,u=$l(e.isBeakVisible,e.beakWidth,e.gapSpace),d=e;d.gapSpace=u;var h,p,f,g,v,m,y,_,x,b=e.bounds?(x=e.bounds,new El(x.left,x.right,x.top,x.bottom)):new El(0,s.innerWidth-function(){if(void 0===yl){var e=(0,Ha.Y)(),t=e.createElement("div");t.style.setProperty("width","100px"),t.style.setProperty("height","100px"),t.style.setProperty("overflow","scroll"),t.style.setProperty("position","absolute"),t.style.setProperty("top","-9999px"),e.body.appendChild(t),yl=t.offsetWidth-t.clientWidth,e.body.removeChild(t)}return yl}(),0,s.innerHeight),C=Zl(d,n,b,r,o,i),k=(h=C,p=function(e,t){var n=t.targetRectangle,r=jl(t.targetEdge),o=r.positiveEdge,i=r.negativeEdge,a=Pl(n,t.targetEdge),l=new El(e/2,t.elementRectangle.width-e/2,e/2,t.elementRectangle.height-e/2),s=new El(0,e,0,e);return Vl(s=Wl(s=Fl(s,-1*t.targetEdge,-e/2),-1*t.targetEdge,a-Nl(o,t.elementRectangle)),l,o)?Vl(s,l,i)||(s=Rl(s,l,i)):s=Rl(s,l,o),s}(c,C),f=b,g=-1*h.targetEdge,v=new El(0,h.elementRectangle.width,0,h.elementRectangle.height),m={},y=Ul(h.elementRectangle,h.alignmentEdge?h.alignmentEdge:jl(g).positiveEdge,f),_=Ol(h.elementRectangle,h.targetRectangle,g)>Math.abs(Al(p,g)),m[_l[g]]=Al(p,g),m[_l[y]]=Ol(p,v,y),{elementPosition:(0,de.Cl)({},m),closestEdge:ql(h.targetEdge,p,v),targetEdge:g,hideBeak:!_});return(0,de.Cl)((0,de.Cl)({},function(e,t,n,r,o){return{elementPosition:Xl(e.elementRectangle,t,e.targetEdge,n,e.alignmentEdge,r,o,e.forcedInBounds),targetEdge:e.targetEdge,alignmentEdge:e.alignmentEdge}}(C,t,b,e.coverTarget,a)),{beakPosition:k})}var Ql=["TEMPLATE","STYLE","SCRIPT"];function es(e){var t=(0,Ha.Y)(e);if(!t)return function(){};for(var n=[];e!==t.body&&e.parentElement;){for(var r=0,o=e.parentElement.children;r<o.length;r++){var i=o[r],a=i.getAttribute("aria-hidden");i!==e&&"true"!==(null==a?void 0:a.toLowerCase())&&-1===Ql.indexOf(i.tagName)&&n.push([i,a])}e=e.parentElement}return n.forEach(function(e){e[0].setAttribute("aria-hidden","true")}),function(){!function(e){e.forEach(function(e){var t=e[0],n=e[1];n?t.setAttribute("aria-hidden",n):t.removeAttribute("aria-hidden")})}(n),n=[]}}function ts(){var e=o.useRef(void 0);return e.current||(e.current=new Ba),o.useEffect(function(){return function(){var t;null===(t=e.current)||void 0===t||t.dispose(),e.current=void 0}},[]),e.current}function ns(e,t,n,r){var i=o.useRef(n);i.current=n,o.useEffect(function(){var n=e&&"current"in e?e.current:e;if(n&&n.addEventListener)return gl(n,t,function(e){return i.current(e)},r)},[e,t,r])}function rs(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=o.useCallback(function(t){n.current=t;for(var r=0,o=e;r<o.length;r++){var i=o[r];"function"==typeof i?i(t):i&&(i.current=t)}},(0,de.fX)([],e,!0));return n}var os=o.createContext({window:"object"==typeof window?window:void 0}),is=function(){return o.useContext(os).window},as=function(){var e;return null===(e=o.useContext(os).window)||void 0===e?void 0:e.document};function ls(e){var t=e.originalElement,n=e.containsFocus;t&&n&&t!==(0,Ca.z)()&&setTimeout(function(){var e;null===(e=t.focus)||void 0===e||e.call(t)},0)}var ss=o.forwardRef(function(e,t){var n=vl({shouldRestoreFocus:!0,enableAriaHiddenSiblings:!0},e),r=o.useRef(void 0),i=rs(r,t);!function(e,t){var n="true"===String(e["aria-modal"]).toLowerCase()&&e.enableAriaHiddenSiblings;o.useEffect(function(){if(n&&t.current)return es(t.current)},[t,n])}(n,r),function(e,t){var n=e.onRestoreFocus,r=void 0===n?ls:n,i=o.useRef(void 0),a=o.useRef(!1);o.useEffect(function(){var e,n,o;return i.current=(0,Ha.Y)().activeElement,e=t.current,(o=(n=(0,Ha.Y)(e))&&n.activeElement)&&ol(e,o)&&(a.current=!0),function(){var e;null==r||r({originalElement:i.current,containsFocus:a.current,documentContainsFocus:(null===(e=(0,Ha.Y)())||void 0===e?void 0:e.hasFocus())||!1}),i.current=void 0}},[]),ns(t,"focus",o.useCallback(function(){a.current=!0},[]),!0),ns(t,"blur",o.useCallback(function(e){t.current&&e.relatedTarget&&!t.current.contains(e.relatedTarget)&&(a.current=!1)},[]),!0)}(n,r);var a=n.role,l=n.className,s=n.ariaLabel,c=n.ariaLabelledBy,u=n.ariaDescribedBy,d=n.style,h=n.children,p=n.onDismiss,f=function(e,t){var n=ts(),r=o.useState(!1),i=r[0],a=r[1];return o.useEffect(function(){return n.requestAnimationFrame(function(){var n;if(!e.style||!e.style.overflowY){var r=!1;if(t&&t.current&&(null===(n=t.current)||void 0===n?void 0:n.firstElementChild)){var o=t.current.clientHeight,l=t.current.firstElementChild.clientHeight;o>0&&l>o&&(r=l-o>1)}i!==r&&a(r)}}),function(){return n.dispose()}}),i}(n,r),g=o.useCallback(function(e){e.which===Va&&p&&(p(e),e.preventDefault(),e.stopPropagation())},[p]);return ns(is(),"keydown",g),o.createElement("div",(0,de.Cl)({ref:i},Qa(n,Ja),{className:l,role:a,"aria-label":s,"aria-labelledby":c,"aria-describedby":u,onKeyDown:g,style:(0,de.Cl)({overflowY:f?"scroll":void 0,outline:"none"},d)}),h)});function cs(e){var t=o.useRef(void 0);return void 0===t.current&&(t.current={value:"function"==typeof e?e():e}),t.current.value}ss.displayName="Popup";var us,ds=function(){var e;return null!==(e=is())&&void 0!==e?e:"undefined"!=typeof window?window:void 0},hs=function(e){var t,n;return null!==(n=null===(t=null==e?void 0:e.window)||void 0===t?void 0:t.document)&&void 0!==n?n:"undefined"!=typeof document?document:void 0},ps=((us={})[_l.top]=Fa.lw.slideUpIn10,us[_l.bottom]=Fa.lw.slideDownIn10,us[_l.left]=Fa.lw.slideLeftIn10,us[_l.right]=Fa.lw.slideRightIn10,us),fs={opacity:0,filter:"opacity(0)",pointerEvents:"none"},gs=["role","aria-roledescription"],vs={preventDismissOnLostFocus:!1,preventDismissOnScroll:!1,preventDismissOnResize:!1,isBeakVisible:!0,beakWidth:16,gapSpace:0,minPagePadding:8,directionalHint:7},ms=(0,xa.Z)({disableCaching:!0});function ys(e,t,n,r){var i,a=e.calloutMaxHeight,l=e.finalHeight,s=e.directionalHint,c=e.directionalHintFixed,u=e.hidden,d=e.gapSpace,h=e.beakWidth,p=e.isBeakVisible,f=e.coverTarget,g=o.useState(),v=g[0],m=g[1],y=null!==(i=null==r?void 0:r.elementPosition)&&void 0!==i?i:{},_=y.top,x=y.bottom,b=(null==n?void 0:n.current)?function(e){var t,n,r,o,i=e,a=e,l=e,s=null!==(t=l.left)&&void 0!==t?t:l.x,c=null!==(n=l.top)&&void 0!==n?n:l.y,u=null!==(r=l.right)&&void 0!==r?r:s,d=null!==(o=l.bottom)&&void 0!==o?o:c;return i.stopPropagation?new El(i.clientX,i.clientX,i.clientY,i.clientY):void 0!==s&&void 0!==c?new El(s,u,c,d):Kl(a)}(n.current):void 0;return o.useEffect(function(){var e,n,o=null!==(e=t())&&void 0!==e?e:{},i=o.top,l=o.bottom;(null==r?void 0:r.targetEdge)===_l.top&&(null==b?void 0:b.top)&&!f&&(l=b.top-function(e,t,n){return $l(e,t,n)}(p,h,d)),"number"==typeof _&&l?n=l-_:"number"==typeof x&&"number"==typeof i&&l&&(n=l-i-x),m(!a&&!u||a&&n&&a>n?n:a||void 0)},[x,a,l,s,c,t,u,r,_,d,h,p,b,f]),v}function _s(e,t,n,r,i,a){var l,s=o.useState(),c=s[0],u=s[1],d=o.useRef(0),h=o.useRef(void 0),p=ts(),f=e.hidden,g=e.target,v=e.finalHeight,m=e.calloutMaxHeight,y=e.onPositioned,_=e.directionalHint,x=e.hideOverflow,b=e.preferScrollResizePositioning,C=ds(),k=o.useRef(void 0);k.current!==a.current&&(k.current=a.current,l=a.current?null==C?void 0:C.getComputedStyle(a.current):void 0);var w=null==l?void 0:l.overflowY;return o.useEffect(function(){if(!f){var o=p.requestAnimationFrame(function(){var o,a,l,s;if(t.current&&n){var p=(0,de.Cl)((0,de.Cl)({},e),{target:r.current,bounds:i()}),f=n.cloneNode(!0);f.style.maxHeight=m?"".concat(m):"",f.style.visibility="hidden",null===(o=n.parentElement)||void 0===o||o.appendChild(f);var _=h.current===g?c:void 0,k=b&&!(x||"clip"===w||"hidden"===w),E=v?function(e,t,n,r,o){return function(e,t,n,r,o){return Jl(e,t,n,r,!1,void 0,!0,null!=o?o:(0,Ca.z)())}(e,t,n,r,o)}(p,t.current,f,_,C):function(e,t,n,r,o,i,a){return Jl(e,t,n,r,o,void 0,void 0,a)}(p,t.current,f,_,k,0,C);null===(a=n.parentElement)||void 0===a||a.removeChild(f),!c&&E||c&&E&&(s=E,!Cs((l=c).elementPosition,s.elementPosition)||!Cs(l.beakPosition.elementPosition,s.beakPosition.elementPosition))&&d.current<5?(d.current++,u(E)):d.current>0&&(d.current=0,null==y||y(c))}},n);return h.current=g,function(){p.cancelAnimationFrame(o),h.current=void 0}}u(void 0),d.current=0},[f,_,p,n,m,t,r,v,i,y,c,e,g,x,b,w,C]),c}var xs=o.memo(o.forwardRef(function(e,t){var n=vl(vs,e),r=n.styles,i=n.style,a=n.ariaLabel,l=n.ariaDescribedBy,s=n.ariaLabelledBy,c=n.className,u=n.isBeakVisible,d=n.children,h=n.beakWidth,p=n.calloutWidth,f=n.calloutMaxWidth,g=n.calloutMinWidth,v=n.doNotLayer,m=n.finalHeight,y=n.hideOverflow,_=void 0===y?!!m:y,x=n.backgroundColor,b=n.calloutMaxHeight,C=n.onScroll,k=n.shouldRestoreFocus,w=void 0===k||k,E=n.target,S=n.hidden,T=n.onLayerMounted,D=n.popupProps,M=o.useRef(null),A=rs(o.useRef(null),null==D?void 0:D.ref),L=o.useState(null),P=L[0],I=L[1],N=o.useCallback(function(e){I(e)},[]),O=rs(M,t),F=function(e,t){var n,r,i,a=o.useRef(void 0),l=o.useRef(null),s=is();if(!e||e!==a.current||"string"==typeof e){var c=null==t?void 0:t.current;if(e)if("string"==typeof e)if(null===(n=null==c?void 0:c.getRootNode())||void 0===n?void 0:n.host)l.current=null!==(i=null===(r=null==c?void 0:c.getRootNode())||void 0===r?void 0:r.querySelector(e))&&void 0!==i?i:null;else{var u=(0,Ha.Y)(c);l.current=u?u.querySelector(e):null}else l.current="stopPropagation"in e||"getBoundingClientRect"in e?e:"current"in e?e.current:e;a.current=e}return[l,s]}(n.target,{current:P}),R=F[0],V=F[1],B=function(e,t,n){var r=e.bounds,i=e.minPagePadding,a=void 0===i?vs.minPagePadding:i,l=e.target,s=o.useState(!1),c=s[0],u=s[1],d=o.useRef(void 0),h=o.useCallback(function(){if(!d.current||c){var e="function"==typeof r?n?r(l,n):void 0:r;!e&&n&&(e=function(e,t){return function(e,t){var n=void 0;if(t.getWindowSegments&&(n=t.getWindowSegments()),void 0===n||n.length<=1)return{top:0,left:0,right:t.innerWidth,bottom:t.innerHeight,width:t.innerWidth,height:t.innerHeight};var r=0,o=0;if(null!==e&&e.getBoundingClientRect){var i=e.getBoundingClientRect();r=(i.left+i.right)/2,o=(i.top+i.bottom)/2}else null!==e&&(r=e.left||e.x,o=e.top||e.y);for(var a={top:0,left:0,right:0,bottom:0,width:0,height:0},l=0,s=n;l<s.length;l++){var c=s[l];r&&c.left<=r&&c.right>=r&&o&&c.top<=o&&c.bottom>=o&&(a={top:c.top,left:c.left,right:c.right,bottom:c.bottom,width:c.width,height:c.height})}return a}(e,t)}(t.current,n),e={top:e.top+a,left:e.left+a,right:e.right-a,bottom:e.bottom-a,width:e.width-2*a,height:e.height-2*a}),d.current=e,c&&u(!1)}return d.current},[r,a,l,t,n,c]),p=ts();return ns(n,"resize",p.debounce(function(){u(!0)},500,{leading:!0})),h}(n,R,V),H=_s(n,M,P,R,B,A),z=ys(n,B,R,H),W=function(e,t,n,r,i){var a=e.hidden,l=e.onDismiss,s=e.preventDismissOnScroll,c=e.preventDismissOnResize,u=e.preventDismissOnLostFocus,d=e.dismissOnTargetClick,h=e.shouldDismissOnWindowFocus,p=e.preventDismissOnEvent,f=o.useRef(!1),g=ts(),v=cs([function(){f.current=!0},function(){f.current=!1}]),m=!!t;return o.useEffect(function(){var e=function(e){m&&!s&&v(e)},t=function(e){c||p&&p(e)||null==l||l(e)},o=function(e){u||v(e)},v=function(e){var t=e.composedPath?e.composedPath():[],o=t.length>0?t[0]:e.target,a=n.current&&!ol(n.current,o);if(a&&f.current)f.current=!1;else if(!r.current&&a||e.target!==i&&a&&(!r.current||"stopPropagation"in r.current||d||o!==r.current&&!ol(r.current,o))){if(p&&p(e))return;null==l||l(e)}},y=function(e){h&&((!p||p(e))&&(p||u)||(null==i?void 0:i.document.hasFocus())||null!==e.relatedTarget||null==l||l(e))},_=new Promise(function(n){g.setTimeout(function(){if(!a&&i){var r=[gl(i,"scroll",e,!0),gl(i,"resize",t,!0),gl(i.document.documentElement,"focus",o,!0),gl(i.document.documentElement,"click",o,!0),gl(i,"blur",y,!0)];n(function(){r.forEach(function(e){return e()})})}},0)});return function(){_.then(function(e){return e()})}},[a,g,n,r,i,l,h,d,u,c,s,m,p]),v}(n,H,M,R,V),Y=W[0],j=W[1],U=(null==H?void 0:H.elementPosition.top)&&(null==H?void 0:H.elementPosition.bottom),X=(0,de.Cl)((0,de.Cl)({},null==H?void 0:H.elementPosition),{maxHeight:z});if(U&&(X.bottom=void 0),function(e,t,n){var r=e.hidden,i=e.setInitialFocus,a=ts(),l=!!t;o.useEffect(function(){if(!r&&i&&l&&n){var e=a.requestAnimationFrame(function(){return il(n)},n);return function(){return a.cancelAnimationFrame(e)}}},[r,l,a,n,i])}(n,H,P),o.useEffect(function(){S||null==T||T()},[S]),!V)return null;var q=_,G=u&&!!E,K=ms(r,{theme:n.theme,className:c,overflowYHidden:q,calloutWidth:p,positions:H,beakWidth:h,backgroundColor:x,calloutMaxWidth:f,calloutMinWidth:g,doNotLayer:v}),Z=(0,de.Cl)((0,de.Cl)({maxHeight:b||"100%"},i),q&&{overflowY:"hidden"}),$=n.hidden?{visibility:"hidden"}:void 0;return o.createElement("div",{ref:O,className:K.container,style:$},o.createElement("div",(0,de.Cl)({},Qa(n,Ja,gs),{className:ml(K.root,H&&H.targetEdge&&ps[H.targetEdge]),style:H?(0,de.Cl)({},X):fs,tabIndex:-1,ref:N}),G&&o.createElement("div",{className:K.beak,style:bs(H)}),G&&o.createElement("div",{className:K.beakCurtain}),o.createElement(ss,(0,de.Cl)({role:n.role,"aria-roledescription":n["aria-roledescription"],ariaDescribedBy:l,ariaLabel:a,ariaLabelledBy:s,className:K.calloutMain,onDismiss:n.onDismiss,onMouseDown:Y,onMouseUp:j,onRestoreFocus:n.onRestoreFocus,onScroll:C,shouldRestoreFocus:w,style:Z},D,{ref:A}),d)))}),function(e,t){return!(t.shouldUpdateWhenHidden||!e.hidden||!t.hidden)||function(e,t){if(!e||!t)return!e&&!t;for(var n in e)if(e.hasOwnProperty(n)&&(!t.hasOwnProperty(n)||t[n]!==e[n]))return!1;for(var n in t)if(t.hasOwnProperty(n)&&!e.hasOwnProperty(n))return!1;return!0}(e,t)});function bs(e){var t,n,r=(0,de.Cl)((0,de.Cl)({},null===(t=null==e?void 0:e.beakPosition)||void 0===t?void 0:t.elementPosition),{display:(null===(n=null==e?void 0:e.beakPosition)||void 0===n?void 0:n.hideBeak)?"none":void 0});return r.top||r.bottom||r.left||r.right||(r.left=0,r.top=0),r}function Cs(e,t){for(var n in t)if(t.hasOwnProperty(n)){var r=e[n],o=t[n];if(void 0===r||void 0===o)return!1;if(r.toFixed(2)!==o.toFixed(2))return!1}return!0}function ks(e){return{height:e,width:e}}xs.displayName="CalloutContentBase";var ws={container:"ms-Callout-container",root:"ms-Callout",beak:"ms-Callout-beak",beakCurtain:"ms-Callout-beakCurtain",calloutMain:"ms-Callout-main"},Es=(0,ue.I)(xs,function(e){var t,n=e.theme,r=e.className,o=e.overflowYHidden,i=e.calloutWidth,a=e.beakWidth,l=e.backgroundColor,s=e.calloutMaxWidth,c=e.calloutMinWidth,u=e.doNotLayer,d=(0,Fa.Km)(ws,n),h=n.semanticColors,p=n.effects;return{container:[d.container,{position:"relative"}],root:[d.root,n.fonts.medium,{position:"absolute",display:"flex",zIndex:u?Fa.nA.Layer:void 0,boxSizing:"border-box",borderRadius:p.roundedCorner2,boxShadow:p.elevation16,selectors:(t={},t[Fa.up]={borderWidth:1,borderStyle:"solid",borderColor:"WindowText"},t)},(0,Fa.QN)(),r,!!i&&{width:i},!!s&&{maxWidth:s},!!c&&{minWidth:c}],beak:[d.beak,{position:"absolute",backgroundColor:h.menuBackground,boxShadow:"inherit",border:"inherit",boxSizing:"border-box",transform:"rotate(45deg)"},ks(a),l&&{backgroundColor:l}],beakCurtain:[d.beakCurtain,{position:"absolute",top:0,right:0,bottom:0,left:0,backgroundColor:h.menuBackground,borderRadius:p.roundedCorner2}],calloutMain:[d.calloutMain,{backgroundColor:h.menuBackground,overflowX:"hidden",overflowY:"auto",position:"relative",width:"100%",borderRadius:p.roundedCorner2},o&&{overflowY:"hidden"},l&&{backgroundColor:l}]}},void 0,{scope:"CalloutContent"}),Ss=o.createContext(void 0),Ts=function(){return function(){}};Ss.Provider;var Ds=n(293);new WeakMap,new WeakMap;var Ms=o.createContext(void 0),As=function(e){var t=e.providerRef,n=e.layerRoot,r=o.useState([])[0],i=o.useContext(Ms),a=void 0!==i&&!n,l=o.useMemo(function(){return a?void 0:{providerRef:t,registeredProviders:r,registerProvider:function(e){r.push(e),null==i||i.registerProvider(e)},unregisterProvider:function(e){null==i||i.unregisterProvider(e);var t=r.indexOf(e);t>=0&&r.splice(t,1)}}},[t,r,i,a]);return o.useEffect(function(){if(l)return l.registerProvider(l.providerRef),function(){return l.unregisterProvider(l.providerRef)}},[l]),l?o.createElement(Ms.Provider,{value:l},e.children):o.createElement(o.Fragment,null,e.children)},Ls=n(202),Ps=n(790);function Is(e,t){void 0===e&&(e={});var n=Ns(t)?t:function(e){return function(t){return e?(0,de.Cl)((0,de.Cl)({},t),e):t}}(t);return n(e)}function Ns(e){return"function"==typeof e}var Os=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._onCustomizationChange=function(){return t.forceUpdate()},t}return(0,de.C6)(t,e),t.prototype.componentDidMount=function(){Ls.X.observe(this._onCustomizationChange)},t.prototype.componentWillUnmount=function(){Ls.X.unobserve(this._onCustomizationChange)},t.prototype.render=function(){var e=this,t=this.props.contextTransform;return o.createElement(Ps.z.Consumer,null,function(n){var r=function(e,t){var n,r,o,i=(t||{}).customizations,a=void 0===i?{settings:{},scopedSettings:{}}:i;return{customizations:{settings:Is(a.settings,e.settings),scopedSettings:(n=a.scopedSettings,r=e.scopedSettings,void 0===n&&(n={}),(Ns(r)?r:(void 0===(o=r)&&(o={}),function(e){var t=(0,de.Cl)({},e);for(var n in o)o.hasOwnProperty(n)&&(t[n]=(0,de.Cl)((0,de.Cl)({},e[n]),o[n]));return t}))(n)),inCustomizerContext:!0}}}(e.props,n);return t&&(r=t(r)),o.createElement(Ps.z.Provider,{value:r},e.props.children)})},t}(o.Component),Fs=n(702),Rs=(0,xa.Z)(),Vs=(0,Ds.J9)(function(e,t){return(0,Fs.a)((0,de.Cl)((0,de.Cl)({},e),{rtl:t}))}),Bs=o.forwardRef(function(e,t){var n=e.className,r=e.theme,i=e.applyTheme,a=e.applyThemeToBody,l=e.styles,s=Rs(l,{theme:r,applyTheme:i,className:n}),c=o.useRef(null);return function(e,t,n){var r=t.bodyThemed;o.useEffect(function(){if(e){var t=(0,Ha.Y)(n.current);if(t)return t.body.classList.add(r),function(){t.body.classList.remove(r)}}},[r,e,n])}(a,s,c),o.createElement(o.Fragment,null,function(e,t,n,r){var i=t.root,a=e.as,l=void 0===a?"div":a,s=e.dir,c=e.theme,u=Qa(e,Ja,["dir"]),d=function(e){var t=e.theme,n=e.dir,r=(0,ba.jI)(t)?"rtl":"ltr",o=(0,ba.jI)()?"rtl":"ltr",i=n||r;return{rootDir:i!==r||i!==o?i:n,needsTheme:i!==r}}(e),h=d.rootDir,p=d.needsTheme,f=o.createElement(As,{providerRef:n},o.createElement(l,(0,de.Cl)({dir:h},u,{className:i,ref:rs(n,r)})));return p&&(f=o.createElement(Os,{settings:{theme:Vs(c,"rtl"===s)}},f)),f}(e,s,c,t))});Bs.displayName="FabricBase";var Hs,zs={fontFamily:"inherit"},Ws={root:"ms-Fabric",bodyThemed:"ms-Fabric-bodyThemed"},Ys=(0,ue.I)(Bs,function(e){var t=e.applyTheme,n=e.className,r=e.preventBlanketFontInheritance,o=e.theme;return{root:[(0,Fa.Km)(Ws,o).root,o.fonts.medium,{color:o.palette.neutralPrimary},!r&&{"& button":zs,"& input":zs,"& textarea":zs},t&&{color:o.semanticColors.bodyText,backgroundColor:o.semanticColors.bodyBackground},n],bodyThemed:[{backgroundColor:o.semanticColors.bodyBackground}]}},void 0,{scope:"Fabric"}),js=n(585),Us="data-portal-element",Xs={},qs={},Gs="fluent-default-layer-host",Ks="#".concat(Gs),Zs=n(85),$s=(0,Zs.S)()?o.useLayoutEffect:o.useEffect,Js=(0,xa.Z)(),Qs=o.forwardRef(function(e,t){var n,r=null!==(n=o.useContext(Ss))&&void 0!==n?n:Ts,a=o.useRef(null),l=rs(a,t),s=o.useRef(void 0),c=o.useRef(null),u=o.useContext(Ms),d=o.useState(!1),h=d[0],p=d[1],f=o.useCallback(function(e){var t,n=!!(null==(t=null==u?void 0:u.providerRef)?void 0:t.current)&&t.current.classList.contains(js.Y2);e&&n&&e.classList.add(js.Y2)},[u]),g=e.children,v=e.className,m=e.eventBubblingEnabled,y=e.fabricProps,_=e.hostId,x=e.insertFirst,b=e.onLayerDidMount,C=void 0===b?function(){}:b,k=e.onLayerMounted,w=void 0===k?function(){}:k,E=e.onLayerWillUnmount,S=e.styles,T=e.theme,D=rs(c,null==y?void 0:y.ref,f),M=Js(S,{theme:T,className:v,isNotHost:!_}),A=function(){null==E||E();var e=s.current;s.current=void 0,e&&e.parentNode&&e.parentNode.removeChild(e)},L=function(){var e,t,n,r,o=(0,Ha.Y)(a.current),i=(null===(t=null===(e=a.current)||void 0===e?void 0:e.getRootNode())||void 0===t?void 0:t.host)?null===(n=null==a?void 0:a.current)||void 0===n?void 0:n.getRootNode():void 0;if(o&&(o||i)){var l=function(e,t){var n,r;void 0===t&&(t=null);var o=null!=t?t:e;if(_){var i=function(e){var t=qs[e];return t&&t[0]||void 0}(_);return i?null!==(n=i.rootRef.current)&&void 0!==n?n:null:null!==(r=o.getElementById(_))&&void 0!==r?r:null}var a=Ks,l=a?o.querySelector(a):null;return l||(l=function(e,t){void 0===t&&(t=null);var n=e.createElement("div");return n.setAttribute("id",Gs),n.style.cssText="position:fixed;z-index:1000000",t?t.appendChild(n):null==e||e.body.appendChild(n),n}(e,t)),l}(o,i);if(l){l.__tabsterElementFlags||(l.__tabsterElementFlags={}),l.__tabsterElementFlags.noDirectAriaHidden=!0,A();var c=(null!==(r=l.ownerDocument)&&void 0!==r?r:o).createElement("div");c.className=M.root,c.setAttribute(Us,"true"),function(e,t){var n=e,r=t;n._virtual||(n._virtual={children:[]});var o=n._virtual.parent;if(o&&o!==t){var i=o._virtual.children.indexOf(n);i>-1&&o._virtual.children.splice(i,1)}n._virtual.parent=r||void 0,r&&(r._virtual||(r._virtual={children:[]}),r._virtual.children.push(n))}(c,a.current),x?l.insertBefore(c,l.firstChild):l.appendChild(c),s.current=c,p(!0)}}};return $s(function(){L(),_&&function(e,t){Xs[e]||(Xs[e]=[]),Xs[e].push(t);var n=qs[e];if(n)for(var r=0,o=n;r<o.length;r++)o[r].notifyLayersChanged()}(_,L);var e=s.current?r(s.current):void 0;return function(){e&&e(),A(),_&&function(e,t){var n=Xs[e];if(n){var r=n.indexOf(t);r>=0&&(n.splice(r,1),0===n.length&&delete Xs[e])}var o=qs[e];if(o)for(var i=0,a=o;i<a.length;i++)a[i].notifyLayersChanged()}(_,L)}},[_]),o.useEffect(function(){s.current&&h&&(null==w||w(),null==C||C(),p(!1))},[h,w,C]),o.createElement("span",{className:"ms-layer",ref:l},s.current&&i.createPortal(o.createElement(As,{layerRoot:!0,providerRef:D},o.createElement(Ys,(0,de.Cl)({},!m&&(Hs||(Hs={},["onClick","onContextMenu","onDoubleClick","onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOver","onMouseOut","onMouseUp","onTouchMove","onTouchStart","onTouchCancel","onTouchEnd","onKeyDown","onKeyPress","onKeyUp","onFocus","onBlur","onChange","onInput","onInvalid","onSubmit"].forEach(function(e){return Hs[e]=ec})),Hs),y,{className:ml(M.content,null==y?void 0:y.className),ref:D}),g)),s.current))});Qs.displayName="LayerBase";var ec=function(e){e.eventPhase===Event.BUBBLING_PHASE&&"mouseenter"!==e.type&&"mouseleave"!==e.type&&"touchstart"!==e.type&&"touchend"!==e.type&&e.stopPropagation()},tc={root:"ms-Layer",rootNoHost:"ms-Layer--fixed",content:"ms-Layer-content"},nc=(0,ue.I)(Qs,function(e){var t=e.className,n=e.isNotHost,r=e.theme,o=(0,Fa.Km)(tc,r);return{root:[o.root,r.fonts.medium,n&&[o.rootNoHost,{position:"fixed",zIndex:Fa.nA.Layer,top:0,left:0,bottom:0,right:0,visibility:"hidden"}],t],content:[o.content,{visibility:"visible"}]}},void 0,{scope:"Layer",fields:["hostId","theme","styles"]}),rc=o.forwardRef(function(e,t){var n=e.layerProps,r=e.doNotLayer,i=(0,de.Tt)(e,["layerProps","doNotLayer"]),a=o.createElement(Es,(0,de.Cl)({},i,{doNotLayer:r,ref:t}));return r?a:o.createElement(nc,(0,de.Cl)({},n),a)});rc.displayName="Callout";var oc=o.createContext(void 0),ic=function(e){for(var t=e.activeElement;null==t?void 0:t.shadowRoot;)t=t.shadowRoot.activeElement;return t},ac=function(e){var t=e.target;return t&&t.shadowRoot&&(t=e.composedPath()[0]),t};function lc(e){var t=o.useRef(void 0);return o.useEffect(function(){t.current=e}),t.current}function sc(e,t){var n=o.useRef(t);return n.current||(n.current=Ta(e)),n.current}function cc(e){var t=o.useRef(function(){throw new Error("Cannot call an event handler while rendering")});return $s(function(){t.current=e},[e]),cs(function(){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.current.apply(void 0,e)}})}var uc={disabled:!1,disableFirstFocus:!1,forceFocusInsideTrap:!0,isClickableOutsideFocusTrap:!1,"data-tabster":'{"uncontrolled": {"completely": true}}'},dc=o.forwardRef(function(e,t){var n,r,i,a=o.useRef(null),l=o.useRef(null),s=o.useRef(null),c=rs(a,t),u=as(),d=ds(),h=!!o.useContext(oc),p=null===(n=lc(!1))||void 0===n||n,f=vl(uc,e),g=cs({hasFocus:!1,focusStackId:sc("ftz-",f.id)}),v=f.children,m=f.componentRef,y=f.disabled,_=f.disableFirstFocus,x=f.forceFocusInsideTrap,b=f.focusPreviouslyFocusedInnerElement,C=f.firstFocusableSelector,k=f.firstFocusableTarget,w=f.disableRestoreFocus,E=void 0===w?f.ignoreExternalFocusing:w,S=f.isClickableOutsideFocusTrap,T=f.enableAriaHiddenSiblings,D={"aria-hidden":!0,style:{pointerEvents:"none",position:"fixed"},tabIndex:y?-1:0,"data-is-visible":!0,"data-is-focus-trap-zone-bumper":!0},M=o.useCallback(function(e){e!==l.current&&e!==s.current&&fl(e)},[]),A=cc(function(){if(a.current){var e=g.previouslyFocusedElementInTrapZone;if(b&&e&&ol(a.current,e))M(e);else{var t=null;if("string"==typeof k)t=a.current.querySelector(k);else if(k)t=k(a.current);else if(C){var n="string"==typeof C?C:C();t=a.current.querySelector("."+n)}t||(t=ll(a.current,a.current.firstChild,!1,!1,!1,!0,void 0,void 0,void 0,h)),t&&M(t)}}}),L=function(e){if(!y&&a.current){var t,n=e===g.hasFocus?(void 0===(t=!1)&&(t=!0),al(a.current,s.current,t,!1,!0,!0,!1,!0,h)):function(e,t,n,r,o){return void 0===r&&(r=!0),ll(e,t,r,!1,!1,!0,!1,!0,void 0,o)}(a.current,l.current,0,!1,h);n&&(n===l.current||n===s.current?A():n.focus())}},P=cc(function(e){if(dc.focusStack=dc.focusStack.filter(function(e){return g.focusStackId!==e}),u){var t=u.activeElement;E||"function"!=typeof(null==e?void 0:e.focus)||!ol(a.current,t)&&t!==u.body&&!t.shadowRoot||M(e)}}),I=cc(function(e){if(!y&&g.focusStackId===dc.focusStack.slice(-1)[0]){var t=ac(e);t&&!ol(a.current,t)&&(u&&ic(u)===u.body?setTimeout(function(){u&&ic(u)===u.body&&(A(),g.hasFocus=!0)},0):(A(),g.hasFocus=!0),e.preventDefault(),e.stopPropagation())}});return o.useEffect(function(){var e=[];return x&&e.push(gl(d,"focus",I,!0)),S||e.push(gl(d,"click",I,!0)),function(){e.forEach(function(e){return e()})}},[x,S,d]),o.useEffect(function(){if(!y&&(p||x)&&a.current){dc.focusStack.push(g.focusStackId);var e=f.elementToFocusOnDismiss||ic(u);return _||ol(a.current,e)||A(),function(){return P(e)}}},[x,y]),o.useEffect(function(){if(!y&&T)return es(a.current)},[y,T,a]),r=function(){delete g.previouslyFocusedElementInTrapZone},(i=o.useRef(r)).current=r,o.useEffect(function(){return function(){var e;null===(e=i.current)||void 0===e||e.call(i)}},[]),function(e,t,n){o.useImperativeHandle(e,function(){return{get previouslyFocusedElement(){return t},focus:n}},[n,t])}(m,g.previouslyFocusedElementInTrapZone,A),o.createElement("div",(0,de.Cl)({"aria-labelledby":f.ariaLabelledBy},Qa(f,Ja),{ref:c,onFocusCapture:function(e){var t;null===(t=f.onFocusCapture)||void 0===t||t.call(f,e),e.target===l.current?L(!0):e.target===s.current&&L(!1),g.hasFocus=!0,e.target!==e.currentTarget&&e.target!==l.current&&e.target!==s.current&&(g.previouslyFocusedElementInTrapZone=ac(e.nativeEvent))},onBlurCapture:function(e){var t;null===(t=f.onBlurCapture)||void 0===t||t.call(f,e);var n=e.relatedTarget;null===e.relatedTarget&&(n=ic(u)),ol(a.current,n)||(g.hasFocus=!1)}}),o.createElement("div",(0,de.Cl)({},D,{ref:l})),v,o.createElement("div",(0,de.Cl)({},D,{ref:s})))});dc.displayName="FocusTrapZone",dc.focusStack=[];var hc,pc=function(e){return o.createElement(rc,(0,de.Cl)({},e),o.createElement(dc,(0,de.Cl)({disabled:e.hidden},e.focusTrapProps),e.children))},fc=function(e){var t=e.gapSpace,n=void 0===t?0:t,r=e.directionalHint,i=void 0===r?4:r,a=e.directionalHintFixed,l=e.targetElement,s=e.firstFocus,c=e.trapFocus,u=e.onLeave,d=e.className,h=e.finalHeight,p=e.content,f=e.calloutProps,g=(0,de.Cl)((0,de.Cl)((0,de.Cl)({},Qa(e,Ja)),{className:d,target:l,isBeakVisible:!1,directionalHint:i,directionalHintFixed:a,finalHeight:h,minPagePadding:24,onDismiss:u,gapSpace:n}),f);return o.createElement(o.Fragment,null,c?o.createElement(pc,(0,de.Cl)({},g,{focusTrapProps:{forceFocusInsideTrap:!1,isClickableOutsideFocusTrap:!0,disableFirstFocus:!s}}),p):o.createElement(rc,(0,de.Cl)({},g),p))},gc=(0,xa.Z)(),vc=function(e){function t(t){var n=e.call(this,t)||this;return n._expandedElem=o.createRef(),n._onKeyDown=function(e){e.which===Va&&n.props.onLeave&&n.props.onLeave(e)},n._onRenderCompactCard=function(){return o.createElement("div",{className:n._classNames.compactCard},n.props.onRenderCompactCard(n.props.renderData))},n._onRenderExpandedCard=function(){return!n.state.firstFrameRendered&&n._async.requestAnimationFrame(function(){n.setState({firstFrameRendered:!0})}),o.createElement("div",{className:n._classNames.expandedCard,ref:n._expandedElem},o.createElement("div",{className:n._classNames.expandedCardScroll},n.props.onRenderExpandedCard&&n.props.onRenderExpandedCard(n.props.renderData)))},n._checkNeedsScroll=function(){var e=n.props.expandedCardHeight;n._async.requestAnimationFrame(function(){n._expandedElem.current&&n._expandedElem.current.scrollHeight>=e&&n.setState({needsScroll:!0})})},n._async=new Ba(n),Aa(n),n.state={firstFrameRendered:!1,needsScroll:!1},n}return(0,de.C6)(t,e),t.prototype.componentDidMount=function(){this._checkNeedsScroll()},t.prototype.componentWillUnmount=function(){this._async.dispose()},t.prototype.render=function(){var e=this.props,t=e.styles,n=e.compactCardHeight,r=e.expandedCardHeight,i=e.theme,a=e.mode,l=e.className,s=this.state,c=s.needsScroll,u=s.firstFrameRendered,d=n+r;this._classNames=gc(t,{theme:i,compactCardHeight:n,className:l,expandedCardHeight:r,needsScroll:c,expandedCardFirstFrameRendered:a===el.expanded&&u});var h=o.createElement("div",{onMouseEnter:this.props.onEnter,onMouseLeave:this.props.onLeave,onKeyDown:this._onKeyDown},this._onRenderCompactCard(),this._onRenderExpandedCard());return o.createElement(fc,(0,de.Cl)({},this.props,{content:h,finalHeight:d,className:this._classNames.root}))},t.defaultProps={compactCardHeight:156,expandedCardHeight:384,directionalHintFixed:!0},t}(o.Component),mc=(0,ue.I)(vc,function(e){var t,n=e.theme,r=e.needsScroll,o=e.expandedCardFirstFrameRendered,i=e.compactCardHeight,a=e.expandedCardHeight,l=e.className,s=n.palette,c=(0,Fa.Km)(tl,n);return{root:[c.root,{width:320,pointerEvents:"none",selectors:(t={},t[Fa.up]={border:"1px solid WindowText"},t)},l],compactCard:[c.compactCard,{pointerEvents:"auto",position:"relative",height:i}],expandedCard:[c.expandedCard,{height:1,overflowY:"hidden",pointerEvents:"auto",transition:"height 0.467s cubic-bezier(0.5, 0, 0, 1)",selectors:{":before":{content:'""',position:"relative",display:"block",top:0,left:24,width:272,height:1,backgroundColor:s.neutralLighter}}},o&&{height:a}],expandedCardScroll:[c.expandedCardScroll,r&&{height:"100%",boxSizing:"border-box",overflowY:"auto"}]}},void 0,{scope:"ExpandingCard"}),yc={root:"ms-PlainCard-root"},_c=(0,xa.Z)(),xc=function(e){function t(t){var n=e.call(this,t)||this;return n._onKeyDown=function(e){e.which===Va&&n.props.onLeave&&n.props.onLeave(e)},Aa(n),n}return(0,de.C6)(t,e),t.prototype.render=function(){var e=this.props,t=e.styles,n=e.theme,r=e.className;this._classNames=_c(t,{theme:n,className:r});var i=o.createElement("div",{onMouseEnter:this.props.onEnter,onMouseLeave:this.props.onLeave,onKeyDown:this._onKeyDown},this.props.onRenderPlainCard(this.props.renderData));return o.createElement(fc,(0,de.Cl)({},this.props,{content:i,className:this._classNames.root}))},t}(o.Component),bc=(0,ue.I)(xc,function(e){var t,n=e.theme,r=e.className;return{root:[(0,Fa.Km)(yc,n).root,{pointerEvents:"auto",selectors:(t={},t[Fa.up]={border:"1px solid WindowText"},t)},r]}},void 0,{scope:"PlainCard"}),Cc=(0,xa.Z)(),kc=function(e){function t(t){var n=e.call(this,t)||this;return n._hoverCard=o.createRef(),n.dismiss=function(e){n._async.clearTimeout(n._openTimerId),n._async.clearTimeout(n._dismissTimerId),e?n._dismissTimerId=n._async.setTimeout(function(){n._setDismissedState()},n.props.cardDismissDelay):n._setDismissedState()},n._cardOpen=function(e){n._shouldBlockHoverCard()||"keydown"===e.type&&e.which!==n.props.openHotKey||(n._async.clearTimeout(n._dismissTimerId),"mouseenter"===e.type&&(n._currentMouseTarget=e.currentTarget),n._executeCardOpen(e))},n._executeCardOpen=function(e){n._async.clearTimeout(n._openTimerId),n._openTimerId=n._async.setTimeout(function(){n.setState(function(t){return t.isHoverCardVisible?t:{isHoverCardVisible:!0,mode:el.compact,openMode:"keydown"===e.type?Ya.hotKey:Ya.hover}})},n.props.cardOpenDelay)},n._cardDismiss=function(e,t){if(e){if(!(t instanceof MouseEvent))return;if("keydown"===t.type&&t.which!==Va)return;n.props.sticky||n._currentMouseTarget!==t.currentTarget&&t.which!==Va||n.dismiss(!0)}else{if(n.props.sticky&&!(t instanceof MouseEvent)&&t.nativeEvent instanceof MouseEvent&&"mouseleave"===t.type)return;n.dismiss(!0)}},n._setDismissedState=function(){n.setState({isHoverCardVisible:!1,mode:el.compact,openMode:Ya.hover})},n._instantOpenAsExpanded=function(e){n._async.clearTimeout(n._dismissTimerId),n.setState(function(e){return e.isHoverCardVisible?e:{isHoverCardVisible:!0,mode:el.expanded}})},n._setEventListeners=function(){var e=n.props,t=e.trapFocus,r=e.instantOpenOnClick,o=e.eventListenerTarget,i=o?n._getTargetElement(o):n._getTargetElement(n.props.target),a=n._nativeDismissEvent;i&&(n._events.on(i,"mouseenter",n._cardOpen),n._events.on(i,"mouseleave",a),t?n._events.on(i,"keydown",n._cardOpen):(n._events.on(i,"focus",n._cardOpen),n._events.on(i,"blur",a)),r?n._events.on(i,"click",n._instantOpenAsExpanded):(n._events.on(i,"mousedown",a),n._events.on(i,"keydown",a)))},Aa(n),n._async=new Ba(n),n._events=new Ua(n),n._nativeDismissEvent=n._cardDismiss.bind(n,!0),n._childDismissEvent=n._cardDismiss.bind(n,!1),n.state={isHoverCardVisible:!1,mode:el.compact,openMode:Ya.hover},n}return(0,de.C6)(t,e),t.prototype.componentDidMount=function(){this._setEventListeners()},t.prototype.componentWillUnmount=function(){this._async.dispose(),this._events.dispose()},t.prototype.componentDidUpdate=function(e,t){var n=this;e.target!==this.props.target&&(this._events.off(),this._setEventListeners()),t.isHoverCardVisible!==this.state.isHoverCardVisible&&(this.state.isHoverCardVisible?(this._async.setTimeout(function(){n.setState({mode:el.expanded},function(){n.props.onCardExpand&&n.props.onCardExpand()})},this.props.expandedCardOpenDelay),this.props.onCardVisible&&this.props.onCardVisible()):(this.setState({mode:el.compact}),this.props.onCardHide&&this.props.onCardHide()))},t.prototype.render=function(){var e=this.props,t=e.expandingCardProps,n=e.children,r=e.id,i=e.setAriaDescribedBy,a=void 0===i||i,l=e.styles,s=e.theme,c=e.className,u=e.type,d=e.plainCardProps,h=e.trapFocus,p=e.setInitialFocus,f=this.state,g=f.isHoverCardVisible,v=f.mode,m=f.openMode,y=r||Ta("hoverCard");this._classNames=Cc(l,{theme:s,className:c});var _=(0,de.Cl)((0,de.Cl)({},Qa(this.props,Ja)),{id:y,trapFocus:!!h,firstFocus:p||m===Ya.hotKey,targetElement:this._getTargetElement(this.props.target),onEnter:this._cardOpen,onLeave:this._childDismissEvent}),x=(0,de.Cl)((0,de.Cl)((0,de.Cl)({},t),_),{mode:v}),b=(0,de.Cl)((0,de.Cl)({},d),_);return o.createElement("div",{className:this._classNames.host,ref:this._hoverCard,"aria-describedby":a&&g?y:void 0,"data-is-focusable":!this.props.target},n,g&&(u===ja.expanding?o.createElement(mc,(0,de.Cl)({},x)):o.createElement(bc,(0,de.Cl)({},b))))},t.prototype._getTargetElement=function(e){switch(typeof e){case"string":return(0,Ha.Y)().querySelector(e);case"object":return e;default:return this._hoverCard.current||void 0}},t.prototype._shouldBlockHoverCard=function(){return!(!this.props.shouldBlockHoverCard||!this.props.shouldBlockHoverCard())},t.defaultProps={cardOpenDelay:500,cardDismissDelay:100,expandedCardOpenDelay:1500,instantOpenOnClick:!1,setInitialFocus:!1,openHotKey:67,type:ja.expanding},t}(o.Component),wc=(0,ue.I)(kc,function(e){var t=e.className,n=e.theme;return{host:[(0,Fa.Km)(Ra,n).host,t]}},void 0,{scope:"HoverCard"});function Ec(e,t,n){void 0===n&&(n=0);for(var r=-1,o=n;e&&o<e.length;o++)if(t(e[o],o)){r=o;break}return r}function Sc(e,t){var n=Ec(e,t);if(!(n<0))return e[n]}!function(e){e[e.horizontal=0]="horizontal",e[e.vertical=1]="vertical"}(hc||(hc={}));var Tc=function(e){var t;void 0===e&&(t={},e={getCachedMeasurement:function(e){if(e&&e.cacheKey&&t.hasOwnProperty(e.cacheKey))return t[e.cacheKey]},addMeasurementToCache:function(e,n){e.cacheKey&&(t[e.cacheKey]=n)}});var n,r=e;function o(e,t){var n=r.getCachedMeasurement(e);if(void 0!==n)return n;var o=t();return r.addMeasurementToCache(e,o),o}function i(e,t,i){for(var a=e,l=o(e,i);l>n;){var s=t(a);if(void 0===s)return{renderedData:a,resizeDirection:void 0,dataToMeasure:void 0};if(void 0===(l=r.getCachedMeasurement(s)))return{dataToMeasure:s,resizeDirection:"shrink"};a=s}return{renderedData:a,resizeDirection:void 0,dataToMeasure:void 0}}return{getNextState:function(e,t,a,l){if(void 0!==l||void 0!==t.dataToMeasure){if(l){if(n&&t.renderedData&&!t.dataToMeasure)return(0,de.Cl)((0,de.Cl)({},t),function(e,t,r,o){var i;return i=e>n?o?{resizeDirection:"grow",dataToMeasure:o(r)}:{resizeDirection:"shrink",dataToMeasure:t}:{resizeDirection:"shrink",dataToMeasure:r},n=e,(0,de.Cl)((0,de.Cl)({},i),{measureContainer:!1})}(l,e.data,t.renderedData,e.onGrowData));n=l}var s=(0,de.Cl)((0,de.Cl)({},t),{measureContainer:!1});return t.dataToMeasure&&(s="grow"===t.resizeDirection&&e.onGrowData?(0,de.Cl)((0,de.Cl)({},s),function(e,t,a,l){for(var s=e,c=o(e,a);c<n;){var u=t(s);if(void 0===u)return{renderedData:s,resizeDirection:void 0,dataToMeasure:void 0};if(void 0===(c=r.getCachedMeasurement(u)))return{dataToMeasure:u};s=u}return(0,de.Cl)({resizeDirection:"shrink"},i(s,l,a))}(t.dataToMeasure,e.onGrowData,a,e.onReduceData)):(0,de.Cl)((0,de.Cl)({},s),i(t.dataToMeasure,e.onReduceData,a))),s}},shouldRenderDataForMeasurement:function(e){return!(!e||void 0!==r.getCachedMeasurement(e))},getInitialResizeGroupState:function(e){return{dataToMeasure:(0,de.Cl)({},e),resizeDirection:"grow",measureContainer:!0}}}},Dc=o.createContext({isMeasured:!1}),Mc={position:"fixed",visibility:"hidden"},Ac={position:"relative"};function Lc(e,t){var n;switch(t.type){case"resizeData":return(0,de.Cl)({},t.value);case"dataToMeasure":return(0,de.Cl)((0,de.Cl)({},e),{dataToMeasure:t.value,resizeDirection:"grow",measureContainer:!0});default:return(0,de.Cl)((0,de.Cl)({},e),((n={})[t.type]=t.value,n))}}var Pc={isMeasured:!0},Ic=o.forwardRef(function(e,t){var n=o.useRef(null),r=rs(n,t),i=function(e,t){var n=cs(Tc),r=o.useRef(null),i=o.useRef(null),a=o.useRef(!1),l=ts(),s=function(e,t,n){var r=cs(function(){return t.getInitialResizeGroupState(e.data)}),i=o.useReducer(Lc,r),a=i[0],l=i[1];o.useEffect(function(){l({type:"dataToMeasure",value:e.data})},[e.data]);var s=o.useRef(r);return s.current=(0,de.Cl)({},a),[s,o.useCallback(function(e){e&&l({type:"resizeData",value:e})},[]),o.useCallback(function(){n.current&&l({type:"measureContainer",value:!0})},[n])]}(e,n,t),c=s[0],u=s[1],d=s[2];o.useEffect(function(){var t;c.current.renderedData&&(a.current=!0,null===(t=e.dataDidRender)||void 0===t||t.call(e,c.current.renderedData))}),o.useEffect(function(){l.requestAnimationFrame(function(){var o=void 0;if(c.current.measureContainer&&t.current){var l=t.current.getBoundingClientRect();o=e.direction===hc.vertical?l.height:l.width}var s=n.getNextState(e,c.current,function(){var t=a.current?i:r;if(!t.current)return 0;var n=t.current.getBoundingClientRect();return e.direction===hc.vertical?n.height:n.width},o);u(s)},t.current)}),ns(is(),"resize",l.debounce(d,16,{leading:!0}));var h=n.shouldRenderDataForMeasurement(c.current.dataToMeasure),p=!a.current&&h;return[c.current.dataToMeasure,c.current.renderedData,d,r,i,h,p]}(e,n),a=i[0],l=i[1],s=i[2],c=i[3],u=i[4],d=i[5],h=i[6];o.useImperativeHandle(e.componentRef,function(){return{remeasure:s}},[s]);var p=e.className,f=e.onRenderData,g=Qa(e,Ja,["data"]);return o.createElement("div",(0,de.Cl)({},g,{className:p,ref:r}),o.createElement("div",{style:Ac},d&&!h&&o.createElement("div",{style:Mc,ref:u},o.createElement(Dc.Provider,{value:Pc},f(a))),o.createElement("div",{ref:c,style:h?Mc:void 0,"data-automation-id":"visibleContent"},h?f(a):l&&f(l))))});Ic.displayName="ResizeGroupBase";var Nc,Oc=Ic;!function(e){e.KEYTIP_ADDED="keytipAdded",e.KEYTIP_REMOVED="keytipRemoved",e.KEYTIP_UPDATED="keytipUpdated",e.PERSISTED_KEYTIP_ADDED="persistedKeytipAdded",e.PERSISTED_KEYTIP_REMOVED="persistedKeytipRemoved",e.PERSISTED_KEYTIP_EXECUTE="persistedKeytipExecute",e.ENTER_KEYTIP_MODE="enterKeytipMode",e.EXIT_KEYTIP_MODE="exitKeytipMode"}(Nc||(Nc={}));var Fc=function(){function e(){this.keytips={},this.persistedKeytips={},this.sequenceMapping={},this.inKeytipMode=!1,this.shouldEnterKeytipMode=!0,this.delayUpdatingKeytipChange=!1}return e.getInstance=function(){return this._instance},e.prototype.init=function(e){this.delayUpdatingKeytipChange=e},e.prototype.register=function(e,t){void 0===t&&(t=!1);var n=e;t||(n=this.addParentOverflow(e),this.sequenceMapping[n.keySequences.toString()]=n);var r=this._getUniqueKtp(n);if(t?this.persistedKeytips[r.uniqueID]=r:this.keytips[r.uniqueID]=r,this.inKeytipMode||!this.delayUpdatingKeytipChange){var o=t?Nc.PERSISTED_KEYTIP_ADDED:Nc.KEYTIP_ADDED;Ua.raise(this,o,{keytip:n,uniqueID:r.uniqueID})}return r.uniqueID},e.prototype.update=function(e,t){var n=this.addParentOverflow(e),r=this._getUniqueKtp(n,t),o=this.keytips[t];o&&(r.keytip.visible=o.keytip.visible,this.keytips[t]=r,delete this.sequenceMapping[o.keytip.keySequences.toString()],this.sequenceMapping[r.keytip.keySequences.toString()]=r.keytip,!this.inKeytipMode&&this.delayUpdatingKeytipChange||Ua.raise(this,Nc.KEYTIP_UPDATED,{keytip:r.keytip,uniqueID:r.uniqueID}))},e.prototype.unregister=function(e,t,n){void 0===n&&(n=!1),n?delete this.persistedKeytips[t]:delete this.keytips[t],!n&&delete this.sequenceMapping[e.keySequences.toString()];var r=n?Nc.PERSISTED_KEYTIP_REMOVED:Nc.KEYTIP_REMOVED;!this.inKeytipMode&&this.delayUpdatingKeytipChange||Ua.raise(this,r,{keytip:e,uniqueID:t})},e.prototype.enterKeytipMode=function(){Ua.raise(this,Nc.ENTER_KEYTIP_MODE)},e.prototype.exitKeytipMode=function(){Ua.raise(this,Nc.EXIT_KEYTIP_MODE)},e.prototype.getKeytips=function(){var e=this;return Object.keys(this.keytips).map(function(t){return e.keytips[t].keytip})},e.prototype.addParentOverflow=function(e){var t=(0,de.fX)([],e.keySequences,!0);if(t.pop(),0!==t.length){var n=this.sequenceMapping[t.toString()];if(n&&n.overflowSetSequence)return(0,de.Cl)((0,de.Cl)({},e),{overflowSetSequence:n.overflowSetSequence})}return e},e.prototype.menuExecute=function(e,t){Ua.raise(this,Nc.PERSISTED_KEYTIP_EXECUTE,{overflowButtonSequences:e,keytipSequences:t})},e.prototype._getUniqueKtp=function(e,t){return void 0===t&&(t=Ta()),{keytip:(0,de.Cl)({},e),uniqueID:t}},e._instance=new e,e}(),Rc=function(e,t,n){for(var r=0,o=e;r<o.length;r++){var i=o[r];n[t.register(i,!0)]=i}},Vc=function(e,t){for(var n=0,r=Object.keys(t);n<r.length;n++){var o=r[n];e.unregister(t[o],o,!0),delete t[o]}},Bc=function(e){var t=Fc.getInstance(),n=e.className,r=e.overflowItems,i=e.keytipSequences,a=e.itemSubMenuProvider,l=e.onRenderOverflowButton,s=cs({}),c=o.useCallback(function(e){return a?a(e):e.subMenuProps?e.subMenuProps.items:void 0},[a]),u=o.useMemo(function(){var e=[],n=[];return i?null==r||r.forEach(function(r){var o,a=r.keytipProps;if(a){var l={content:a.content,keySequences:a.keySequences,disabled:a.disabled||!(!r.disabled&&!r.isDisabled),hasDynamicChildren:a.hasDynamicChildren,hasMenu:a.hasMenu};a.hasDynamicChildren||c(r)?(l.onExecute=t.menuExecute.bind(t,i,null===(o=null==r?void 0:r.keytipProps)||void 0===o?void 0:o.keySequences),l.hasOverflowSubMenu=!0):l.onExecute=a.onExecute,e.push(l);var s=(0,de.Cl)((0,de.Cl)({},r),{keytipProps:(0,de.Cl)((0,de.Cl)({},a),{overflowSetSequence:i})});null==n||n.push(s)}else null==n||n.push(r)}):n=r,{modifiedOverflowItems:n,keytipsToRegister:e}},[r,c,t,i]),d=u.modifiedOverflowItems;return function(e,t,n){var r=lc(e);o.useEffect(function(){r&&(Vc(n,r),Rc(t,n,e))}),o.useEffect(function(){return Rc(t,n,e),function(){Vc(n,e)}},[])}(s,u.keytipsToRegister,t),o.createElement("div",{className:n},l(d))},Hc=(0,xa.Z)(),zc=o.forwardRef(function(e,t){var n=o.useRef(null),r=rs(n,t);!function(e,t){var n=function(){var e;return null!==(e=as())&&void 0!==e?e:"undefined"!=typeof document?document:void 0}();o.useImperativeHandle(e.componentRef,function(){return{focus:function(e,n){var r=!1;return t.current&&(r=il(t.current,n)),r},focusElement:function(e){var r=!1;return!!e&&(t.current&&ol(t.current,e)&&(e.focus(),r=(null==n?void 0:n.activeElement)===e),r)}}},[t,n])}(e,n);var i=e.items,a=e.overflowItems,l=e.className,s=e.styles,c=e.vertical,u=e.role,d=e.overflowSide,h=void 0===d?"end":d,p=e.onRenderItem,f=Hc(s,{className:l,vertical:c}),g=!!a&&a.length>0;return o.createElement("div",(0,de.Cl)({},Qa(e,Ja),{role:u||"group","aria-orientation":"menubar"===u?!0===c?"vertical":"horizontal":void 0,className:f.root,ref:r}),"start"===h&&g&&o.createElement(Bc,(0,de.Cl)({},e,{className:f.overflowButton})),i&&i.map(function(e,t){return o.createElement("div",{className:f.item,key:e.key,role:"none"},p(e))}),"end"===h&&g&&o.createElement(Bc,(0,de.Cl)({},e,{className:f.overflowButton})))});zc.displayName="OverflowSet";var Wc,Yc={flexShrink:0,display:"inherit"},jc=(0,ue.I)(zc,function(e){var t=e.className;return{root:["ms-OverflowSet",{position:"relative",display:"flex",flexWrap:"nowrap"},e.vertical&&{flexDirection:"column"},t],item:["ms-OverflowSet-item",Yc],overflowButton:["ms-OverflowSet-overflowButton",Yc]}},void 0,{scope:"OverflowSet"});function Uc(e,t,n){var r,o=rl(e,function(e){var n;return t===e||!!(null===(n=e.hasAttribute)||void 0===n?void 0:n.call(e,Us))},n);return null!==o&&!!(null===(r=o.hasAttribute)||void 0===r?void 0:r.call(o,Us))}!function(e){e[e.vertical=0]="vertical",e[e.horizontal=1]="horizontal",e[e.bidirectional=2]="bidirectional",e[e.domOrder=3]="domOrder"}(Wc||(Wc={}));var Xc,qc="data-is-focusable",Gc="data-focuszone-id",Kc="tabindex",Zc="data-no-vertical-wrap",$c="data-no-horizontal-wrap",Jc=999999999,Qc=-999999999;function eu(e,t){var n;"function"==typeof MouseEvent?n=new MouseEvent("click",{ctrlKey:null==t?void 0:t.ctrlKey,metaKey:null==t?void 0:t.metaKey,shiftKey:null==t?void 0:t.shiftKey,altKey:null==t?void 0:t.altKey,bubbles:null==t?void 0:t.bubbles,cancelable:null==t?void 0:t.cancelable}):(n=document.createEvent("MouseEvents")).initMouseEvent("click",!!t&&t.bubbles,!!t&&t.cancelable,window,0,0,0,0,0,!!t&&t.ctrlKey,!!t&&t.altKey,!!t&&t.shiftKey,!!t&&t.metaKey,0,null),e.dispatchEvent(n)}var tu={},nu=new Set,ru=["text","number","password","email","tel","url","search","textarea"],ou=!1,iu=function(e){function t(n){var r,i,a,l,s,c=e.call(this,n)||this;c._root=o.createRef(),c._mergedRef=(s={refs:[]},function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return s.resolver&&function(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}(s.refs,e)||(s.resolver=function(e){return function(t){for(var n=0,r=e.refs;n<r.length;n++){var o=r[n];"function"==typeof o?o(t):o&&(o.current=t)}}}(s)),s.refs=e,s.resolver}),c._onFocus=function(e){if(!c._portalContainsElement(e.target)){var t,n=c.props,r=n.onActiveElementChanged,o=n.doNotAllowFocusEventToPropagate,i=n.stopFocusPropagation,a=n.onFocusNotification,l=n.onFocus,s=n.shouldFocusInnerElementWhenReceivedFocus,u=n.defaultTabbableElement,d=c._isImmediateDescendantOfZone(e.target);if(d)t=e.target;else for(var h=e.target;h&&h!==c._root.current;){if(ul(h,void 0,c._inShadowRoot)&&c._isImmediateDescendantOfZone(h)){t=h;break}h=nl(h,ou)}if(s&&e.target===c._root.current){var p=u&&"function"==typeof u&&c._root.current&&u(c._root.current);p&&ul(p,void 0,c._inShadowRoot)?(t=p,p.focus()):(c.focus(!0),c._activeElement&&(t=null))}var f=!c._activeElement;t&&t!==c._activeElement&&((d||f)&&c._setFocusAlignment(t,!0,!0),c._activeElement=t,f&&c._updateTabIndexes()),r&&r(c._activeElement,e),(i||o)&&e.stopPropagation(),l?l(e):a&&a()}},c._onBlur=function(){c._setParkedFocus(!1)},c._onMouseDown=function(e){if(!c._portalContainsElement(e.target)&&!c.props.disabled){for(var t=e.target,n=[];t&&t!==c._root.current;)n.push(t),t=nl(t,ou);for(;n.length&&((t=n.pop())&&ul(t,void 0,c._inShadowRoot)&&c._setActiveElement(t,!0),!dl(t)););}},c._onKeyDown=function(e,t){if(!c._portalContainsElement(e.target)){var n=c.props,r=n.direction,o=n.disabled,i=n.isInnerZoneKeystroke,a=n.pagingSupportDisabled,l=n.shouldEnterInnerZone;if(!(o||(c.props.onKeyDown&&c.props.onKeyDown(e),e.isDefaultPrevented()||c._getDocument().activeElement===c._root.current&&c._isInnerZone))){if((l&&l(e)||i&&i(e))&&c._isImmediateDescendantOfZone(e.target)){var s=c._getFirstInnerZone();if(s){if(!s.focus(!0))return}else{if(!hl(e.target))return;if(!c.focusElement(ll(e.target,e.target.firstChild,!0)))return}}else{if(e.altKey)return;switch(e.which){case 32:if(c._shouldRaiseClicksOnSpace&&c._tryInvokeClickForFocusable(e.target,e))break;return;case 37:if(r!==Wc.vertical&&(c._preventDefaultWhenHandled(e),c._moveFocusLeft(t)))break;return;case 39:if(r!==Wc.vertical&&(c._preventDefaultWhenHandled(e),c._moveFocusRight(t)))break;return;case 38:if(r!==Wc.horizontal&&(c._preventDefaultWhenHandled(e),c._moveFocusUp()))break;return;case 40:if(r!==Wc.horizontal&&(c._preventDefaultWhenHandled(e),c._moveFocusDown()))break;return;case 34:if(!a&&c._moveFocusPaging(!0))break;return;case 33:if(!a&&c._moveFocusPaging(!1))break;return;case 9:if(c.props.allowTabKey||1===c.props.handleTabKey||2===c.props.handleTabKey&&c._isElementInput(e.target)){var u=!1;if(c._processingTabKey=!0,u=r!==Wc.vertical&&c._shouldWrapFocus(c._activeElement,$c)?((0,ba.jI)(t)?!e.shiftKey:e.shiftKey)?c._moveFocusLeft(t):c._moveFocusRight(t):e.shiftKey?c._moveFocusUp():c._moveFocusDown(),c._processingTabKey=!1,u)break;c.props.shouldResetActiveElementWhenTabFromZone&&(c._activeElement=null)}return;case 36:if(c._isContentEditableElement(e.target)||c._isElementInput(e.target)&&!c._shouldInputLoseFocus(e.target,!1))return!1;var d=c._root.current&&c._root.current.firstChild;if(c._root.current&&d&&c.focusElement(ll(c._root.current,d,!0)))break;return;case 35:if(c._isContentEditableElement(e.target)||c._isElementInput(e.target)&&!c._shouldInputLoseFocus(e.target,!0))return!1;var h=c._root.current&&c._root.current.lastChild;if(c._root.current&&c.focusElement(al(c._root.current,h,!0,!0,!0)))break;return;case 13:if(c._shouldRaiseClicksOnEnter&&c._tryInvokeClickForFocusable(e.target,e))break;return;default:return}}e.preventDefault(),e.stopPropagation()}}},c._getHorizontalDistanceFromCenter=function(e,t,n){var r=c._focusAlignment.left||c._focusAlignment.x||0,o=Math.floor(n.top),i=Math.floor(t.bottom),a=Math.floor(n.bottom),l=Math.floor(t.top);return e&&o>i||!e&&a<l?r>=n.left&&r<=n.left+n.width?0:Math.abs(n.left+n.width/2-r):c._shouldWrapFocus(c._activeElement,Zc)?Jc:Qc},Aa(c),c._id=Ta("FocusZone"),c._focusAlignment={left:0,top:0},c._processingTabKey=!1;var u=null===(i=null!==(r=n.shouldRaiseClicks)&&void 0!==r?r:t.defaultProps.shouldRaiseClicks)||void 0===i||i;return c._shouldRaiseClicksOnEnter=null!==(a=n.shouldRaiseClicksOnEnter)&&void 0!==a?a:u,c._shouldRaiseClicksOnSpace=null!==(l=n.shouldRaiseClicksOnSpace)&&void 0!==l?l:u,c}return(0,de.C6)(t,e),t.getOuterZones=function(){return nu.size},t._onKeyDownCapture=function(e){9===e.which&&nu.forEach(function(e){return e._updateTabIndexes()})},t.prototype.componentDidMount=function(){var e,n=this._root.current;if(this._inShadowRoot=!!(null===(e=this.context)||void 0===e?void 0:e.shadowRoot),tu[this._id]=this,n){for(var r=nl(n,ou);r&&r!==this._getDocument().body&&1===r.nodeType;){if(dl(r)){this._isInnerZone=!0;break}r=nl(r,ou)}this._isInnerZone||(nu.add(this),this._root.current&&this._root.current.addEventListener("keydown",t._onKeyDownCapture,!0)),this._root.current&&this._root.current.addEventListener("blur",this._onBlur,!0),this._updateTabIndexes(),this.props.defaultTabbableElement&&"string"==typeof this.props.defaultTabbableElement?this._activeElement=this._getDocument().querySelector(this.props.defaultTabbableElement):this.props.defaultActiveElement&&(this._activeElement=this._getDocument().querySelector(this.props.defaultActiveElement)),this.props.shouldFocusOnMount&&this.focus()}},t.prototype.componentDidUpdate=function(){var e,t=this._root.current,n=this._getDocument();if(this._inShadowRoot=!!(null===(e=this.context)||void 0===e?void 0:e.shadowRoot),(this._activeElement&&!ol(this._root.current,this._activeElement,ou)||this._defaultFocusElement&&!ol(this._root.current,this._defaultFocusElement,ou))&&(this._activeElement=null,this._defaultFocusElement=null,this._updateTabIndexes()),!this.props.preventFocusRestoration&&n&&this._lastIndexPath&&(n.activeElement===n.body||null===n.activeElement||n.activeElement===t)){var r=function(e,t){for(var n=e,r=0,o=t;r<o.length;r++){var i=o[r],a=n.children[Math.min(i,n.children.length-1)];if(!a)break;n=a}return ul(n)&&sl(n)?n:ll(e,n,!0)||al(e,n)}(t,this._lastIndexPath);r?(this._setActiveElement(r,!0),r.focus(),this._setParkedFocus(!1)):this._setParkedFocus(!0)}},t.prototype.componentWillUnmount=function(){delete tu[this._id],this._isInnerZone||(nu.delete(this),this._root.current&&this._root.current.removeEventListener("keydown",t._onKeyDownCapture,!0)),this._root.current&&this._root.current.removeEventListener("blur",this._onBlur,!0),this._activeElement=null,this._defaultFocusElement=null},t.prototype.render=function(){var e=this,t=this.props,n=t.as,r=t.elementType,i=t.rootProps,a=t.ariaDescribedBy,l=t.ariaLabelledBy,s=t.className,c=Qa(this.props,Ka),u=n||r||"div";this._evaluateFocusBeforeRender();var d=(0,Fa.O4)();return o.createElement(u,(0,de.Cl)({"aria-labelledby":l,"aria-describedby":a},c,i,{className:ml((Xc||(Xc=(0,bl.Z)({selectors:{":focus":{outline:"none"}}},"ms-FocusZone")),Xc),s),ref:this._mergedRef(this.props.elementRef,this._root),"data-focuszone-id":this._id,onKeyDown:function(t){return e._onKeyDown(t,d)},onFocus:this._onFocus,onMouseDownCapture:this._onMouseDown}),this.props.children)},t.prototype.focus=function(e,t){if(void 0===e&&(e=!1),void 0===t&&(t=!1),this._root.current){if(!e&&"true"===this._root.current.getAttribute(qc)&&this._isInnerZone){var n=this._getOwnerZone(this._root.current);if(n!==this._root.current){var r=tu[n.getAttribute(Gc)];return!!r&&r.focusElement(this._root.current)}return!1}if(!e&&this._activeElement&&ol(this._root.current,this._activeElement)&&ul(this._activeElement,void 0,this._inShadowRoot)&&(!t||cl(this._activeElement)))return this._activeElement.focus(),!0;var o=this._root.current.firstChild;return this.focusElement(ll(this._root.current,o,!0,void 0,void 0,void 0,void 0,void 0,t))}return!1},t.prototype.focusLast=function(){if(this._root.current){var e=this._root.current&&this._root.current.lastChild;return this.focusElement(al(this._root.current,e,!0,!0,!0))}return!1},t.prototype.focusElement=function(e,t){var n=this.props,r=n.onBeforeFocus,o=n.shouldReceiveFocus;return!(o&&!o(e)||r&&!r(e)||!e||(this._setActiveElement(e,t),this._activeElement&&this._activeElement.focus(),0))},t.prototype.setFocusAlignment=function(e){this._focusAlignment=e},Object.defineProperty(t.prototype,"defaultFocusElement",{get:function(){return this._defaultFocusElement},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"activeElement",{get:function(){return this._activeElement},enumerable:!1,configurable:!0}),t.prototype._evaluateFocusBeforeRender=function(){var e=this._root.current,t=this._getDocument();if(t){var n=t.activeElement;if(n!==e){var r=ol(e,n,!1);this._lastIndexPath=r?function(e,t){for(var n=[];t&&e&&t!==e;){var r=nl(t,!0);if(null===r)return[];n.unshift(Array.prototype.indexOf.call(r.children,t)),t=r}return n}(e,n):void 0}}},t.prototype._setParkedFocus=function(e){var t=this._root.current;t&&this._isParked!==e&&(this._isParked=e,e?(this.props.allowFocusRoot||(this._parkedTabIndex=t.getAttribute("tabindex"),t.setAttribute("tabindex","-1")),t.focus()):this.props.allowFocusRoot||(this._parkedTabIndex?(t.setAttribute("tabindex",this._parkedTabIndex),this._parkedTabIndex=void 0):t.removeAttribute("tabindex")))},t.prototype._setActiveElement=function(e,t){var n=this._activeElement;this._activeElement=e,n&&(dl(n)&&this._updateTabIndexes(n),n.tabIndex=-1),this._activeElement&&(this._focusAlignment&&!t||this._setFocusAlignment(e,!0,!0),this._activeElement.tabIndex=0)},t.prototype._preventDefaultWhenHandled=function(e){this.props.preventDefaultWhenHandled&&e.preventDefault()},t.prototype._tryInvokeClickForFocusable=function(e,t){var n=e;if(n===this._root.current)return!1;do{if("BUTTON"===n.tagName||"A"===n.tagName||"INPUT"===n.tagName||"TEXTAREA"===n.tagName||"SUMMARY"===n.tagName)return!1;if(this._isImmediateDescendantOfZone(n)&&"true"===n.getAttribute(qc)&&"true"!==n.getAttribute("data-disable-click-on-enter"))return eu(n,t),!0;n=nl(n,ou)}while(n!==this._root.current);return!1},t.prototype._getFirstInnerZone=function(e){if(!(e=e||this._activeElement||this._root.current))return null;if(dl(e))return tu[e.getAttribute(Gc)];for(var t=e.firstElementChild;t;){if(dl(t))return tu[t.getAttribute(Gc)];var n=this._getFirstInnerZone(t);if(n)return n;t=t.nextElementSibling}return null},t.prototype._moveFocus=function(e,t,n,r){void 0===r&&(r=!0);var o=this._activeElement,i=-1,a=void 0,l=!1,s=this.props.direction===Wc.bidirectional;if(!o||!this._root.current)return!1;if(this._isElementInput(o)&&!this._shouldInputLoseFocus(o,e))return!1;var c=s?o.getBoundingClientRect():null;do{if(o=e?ll(this._root.current,o):al(this._root.current,o),!s){a=o;break}if(o){var u=t(c,o.getBoundingClientRect());if(-1===u&&-1===i){a=o;break}if(u>-1&&(-1===i||u<i)&&(i=u,a=o),i>=0&&u<0)break}}while(o);if(a&&a!==this._activeElement)l=!0,this.focusElement(a);else if(this.props.isCircularNavigation&&r)return e?this.focusElement(ll(this._root.current,this._root.current.firstElementChild,!0)):this.focusElement(al(this._root.current,this._root.current.lastElementChild,!0,!0,!0));return l},t.prototype._moveFocusDown=function(){var e=this,t=-1,n=this._focusAlignment.left||this._focusAlignment.x||0;return!!this._moveFocus(!0,function(r,o){var i=-1,a=Math.floor(o.top),l=Math.floor(r.bottom);return a<l?e._shouldWrapFocus(e._activeElement,Zc)?Jc:Qc:((-1===t&&a>=l||a===t)&&(t=a,i=n>=o.left&&n<=o.left+o.width?0:Math.abs(o.left+o.width/2-n)),i)})&&(this._setFocusAlignment(this._activeElement,!1,!0),!0)},t.prototype._moveFocusUp=function(){var e=this,t=-1,n=this._focusAlignment.left||this._focusAlignment.x||0;return!!this._moveFocus(!1,function(r,o){var i=-1,a=Math.floor(o.bottom),l=Math.floor(o.top),s=Math.floor(r.top);return a>s?e._shouldWrapFocus(e._activeElement,Zc)?Jc:Qc:((-1===t&&a<=s||l===t)&&(t=l,i=n>=o.left&&n<=o.left+o.width?0:Math.abs(o.left+o.width/2-n)),i)})&&(this._setFocusAlignment(this._activeElement,!1,!0),!0)},t.prototype._moveFocusLeft=function(e){var t=this,n=this._shouldWrapFocus(this._activeElement,$c);return!!this._moveFocus((0,ba.jI)(e),function(r,o){var i=-1;return((0,ba.jI)(e)?parseFloat(o.top.toFixed(3))<parseFloat(r.bottom.toFixed(3)):parseFloat(o.bottom.toFixed(3))>parseFloat(r.top.toFixed(3)))&&o.right<=r.right&&t.props.direction!==Wc.vertical?i=r.right-o.right:n||(i=Qc),i},void 0,n)&&(this._setFocusAlignment(this._activeElement,!0,!1),!0)},t.prototype._moveFocusRight=function(e){var t=this,n=this._shouldWrapFocus(this._activeElement,$c);return!!this._moveFocus(!(0,ba.jI)(e),function(r,o){var i=-1;return((0,ba.jI)(e)?parseFloat(o.bottom.toFixed(3))>parseFloat(r.top.toFixed(3)):parseFloat(o.top.toFixed(3))<parseFloat(r.bottom.toFixed(3)))&&o.left>=r.left&&t.props.direction!==Wc.vertical?i=o.left-r.left:n||(i=Qc),i},void 0,n)&&(this._setFocusAlignment(this._activeElement,!0,!1),!0)},t.prototype._moveFocusPaging=function(e,t){void 0===t&&(t=!0);var n=this._activeElement;if(!n||!this._root.current)return!1;if(this._isElementInput(n)&&!this._shouldInputLoseFocus(n,e))return!1;var r=kl(n);if(!r)return!1;var o=-1,i=void 0,a=-1,l=-1,s=r.clientHeight,c=n.getBoundingClientRect();do{if(n=e?ll(this._root.current,n):al(this._root.current,n)){var u=n.getBoundingClientRect(),d=Math.floor(u.top),h=Math.floor(c.bottom),p=Math.floor(u.bottom),f=Math.floor(c.top),g=this._getHorizontalDistanceFromCenter(e,c,u);if(e&&d>h+s||!e&&p<f-s)break;g>-1&&(e&&d>a?(a=d,o=g,i=n):!e&&p<l?(l=p,o=g,i=n):(-1===o||g<=o)&&(o=g,i=n))}}while(n);var v=!1;if(i&&i!==this._activeElement)v=!0,this.focusElement(i),this._setFocusAlignment(i,!1,!0);else if(this.props.isCircularNavigation&&t)return e?this.focusElement(ll(this._root.current,this._root.current.firstElementChild,!0)):this.focusElement(al(this._root.current,this._root.current.lastElementChild,!0,!0,!0));return v},t.prototype._setFocusAlignment=function(e,t,n){if(this.props.direction===Wc.bidirectional&&(!this._focusAlignment||t||n)){var r=e.getBoundingClientRect(),o=r.left+r.width/2,i=r.top+r.height/2;this._focusAlignment||(this._focusAlignment={left:o,top:i}),t&&(this._focusAlignment.left=o),n&&(this._focusAlignment.top=i)}},t.prototype._isImmediateDescendantOfZone=function(e){return this._getOwnerZone(e)===this._root.current},t.prototype._getOwnerZone=function(e){for(var t=nl(e,ou);t&&t!==this._root.current&&t!==this._getDocument().body;){if(dl(t))return t;t=nl(t,ou)}return t},t.prototype._updateTabIndexes=function(e){!this._activeElement&&this.props.defaultTabbableElement&&"function"==typeof this.props.defaultTabbableElement&&(this._activeElement=this.props.defaultTabbableElement(this._root.current)),!e&&this._root.current&&(this._defaultFocusElement=null,e=this._root.current,this._activeElement&&!ol(e,this._activeElement)&&(this._activeElement=null)),this._activeElement&&!ul(this._activeElement,void 0,this._inShadowRoot)&&(this._activeElement=null);for(var t=e&&e.children,n=0;t&&n<t.length;n++){var r=t[n];dl(r)?"true"===r.getAttribute(qc)&&(this._isInnerZone||(this._activeElement||this._defaultFocusElement)&&this._activeElement!==r?"-1"!==r.getAttribute(Kc)&&r.setAttribute(Kc,"-1"):(this._defaultFocusElement=r,"0"!==r.getAttribute(Kc)&&r.setAttribute(Kc,"0"))):(r.getAttribute&&"false"===r.getAttribute(qc)&&r.setAttribute(Kc,"-1"),ul(r,void 0,this._inShadowRoot)?this.props.disabled?r.setAttribute(Kc,"-1"):this._isInnerZone||(this._activeElement||this._defaultFocusElement)&&this._activeElement!==r?"-1"!==r.getAttribute(Kc)&&r.setAttribute(Kc,"-1"):(this._defaultFocusElement=r,"0"!==r.getAttribute(Kc)&&r.setAttribute(Kc,"0")):"svg"===r.tagName&&"false"!==r.getAttribute("focusable")&&r.setAttribute("focusable","false")),this._updateTabIndexes(r)}},t.prototype._isContentEditableElement=function(e){return e&&"true"===e.getAttribute("contenteditable")},t.prototype._isElementInput=function(e){return!(!e||!e.tagName||"input"!==e.tagName.toLowerCase()&&"textarea"!==e.tagName.toLowerCase())},t.prototype._shouldInputLoseFocus=function(e,t){if(!this._processingTabKey&&e&&e.type&&ru.indexOf(e.type.toLowerCase())>-1){var n=e.selectionStart,r=n!==e.selectionEnd,o=e.value,i=e.readOnly;if(r||n>0&&!t&&!i||n!==o.length&&t&&!i||this.props.handleTabKey&&(!this.props.shouldInputLoseFocusOnArrowKey||!this.props.shouldInputLoseFocusOnArrowKey(e)))return!1}return!0},t.prototype._shouldWrapFocus=function(e,t){return!this.props.checkForNoWrap||function(e,t,n){return"true"!==function(e,t,n){var r=rl(e,function(e){return e.hasAttribute(t)},n);return r&&r.getAttribute(t)}(e,t,null!=n?n:(0,Ha.Y)())}(e,t)},t.prototype._portalContainsElement=function(e){return e&&!!this._root.current&&Uc(e,this._root.current)},t.prototype._getDocument=function(){return(0,Ha.Y)(this._root.current)},t.defaultProps={isCircularNavigation:!1,direction:Wc.bidirectional,shouldRaiseClicks:!0,"data-tabster":'{"uncontrolled": {}}'},t.contextType=oc,t}(o.Component);function au(e){return e}var lu=1e-6;function su(e){return"translate("+e+",0)"}function cu(e){return"translate(0,"+e+")"}function uu(e){return t=>+e(t)}function du(e,t){return t=Math.max(0,e.bandwidth()-2*t)/2,e.round()&&(t=Math.round(t)),n=>+e(n)+t}function hu(){return!this.__axis}function pu(e,t){var n=[],r=null,o=null,i=6,a=6,l=3,s="undefined"!=typeof window&&window.devicePixelRatio>1?0:.5,c=1===e||4===e?-1:1,u=4===e||2===e?"x":"y",d=1===e||3===e?su:cu;function h(h){var p=null==r?t.ticks?t.ticks.apply(t,n):t.domain():r,f=null==o?t.tickFormat?t.tickFormat.apply(t,n):au:o,g=Math.max(i,0)+l,v=t.range(),m=+v[0]+s,y=+v[v.length-1]+s,_=(t.bandwidth?du:uu)(t.copy(),s),x=h.selection?h.selection():h,b=x.selectAll(".domain").data([null]),C=x.selectAll(".tick").data(p,t).order(),k=C.exit(),w=C.enter().append("g").attr("class","tick"),E=C.select("line"),S=C.select("text");b=b.merge(b.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),C=C.merge(w),E=E.merge(w.append("line").attr("stroke","currentColor").attr(u+"2",c*i)),S=S.merge(w.append("text").attr("fill","currentColor").attr(u,c*g).attr("dy",1===e?"0em":3===e?"0.71em":"0.32em")),h!==x&&(b=b.transition(h),C=C.transition(h),E=E.transition(h),S=S.transition(h),k=k.transition(h).attr("opacity",lu).attr("transform",function(e){return isFinite(e=_(e))?d(e+s):this.getAttribute("transform")}),w.attr("opacity",lu).attr("transform",function(e){var t=this.parentNode.__axis;return d((t&&isFinite(t=t(e))?t:_(e))+s)})),k.remove(),b.attr("d",4===e||2===e?a?"M"+c*a+","+m+"H"+s+"V"+y+"H"+c*a:"M"+s+","+m+"V"+y:a?"M"+m+","+c*a+"V"+s+"H"+y+"V"+c*a:"M"+m+","+s+"H"+y),C.attr("opacity",1).attr("transform",function(e){return d(_(e)+s)}),E.attr(u+"2",c*i),S.attr(u,c*g).text(f),x.filter(hu).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",2===e?"start":4===e?"end":"middle"),x.each(function(){this.__axis=_})}return h.scale=function(e){return arguments.length?(t=e,h):t},h.ticks=function(){return n=Array.from(arguments),h},h.tickArguments=function(e){return arguments.length?(n=null==e?[]:Array.from(e),h):n.slice()},h.tickValues=function(e){return arguments.length?(r=null==e?null:Array.from(e),h):r&&r.slice()},h.tickFormat=function(e){return arguments.length?(o=e,h):o},h.tickSize=function(e){return arguments.length?(i=a=+e,h):i},h.tickSizeInner=function(e){return arguments.length?(i=+e,h):i},h.tickSizeOuter=function(e){return arguments.length?(a=+e,h):a},h.tickPadding=function(e){return arguments.length?(l=+e,h):l},h.offset=function(e){return arguments.length?(s=+e,h):s},h}function fu(e){return pu(2,e)}function gu(e){return pu(3,e)}function vu(e){return pu(4,e)}function mu(e,t){var n=0;if(void 0===t)for(var r of e)(r=+r)&&(n+=r);else{var o=-1;for(var i of e)(i=+t(i,++o,e))&&(n+=i)}return n}function yu(e,t){var n=0,r=0;if(void 0===t)for(var o of e)null!=o&&(o=+o)>=o&&(++n,r+=o);else{var i=-1;for(var a of e)null!=(a=t(a,++i,e))&&(a=+a)>=a&&(++n,r+=a)}if(n)return r/n}function _u(e,t){return(null==e||!(e>=e))-(null==t||!(t>=t))||(e<t?-1:e>t?1:0)}function xu(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0,o=arguments.length>4?arguments[4]:void 0;if(t=Math.floor(t),n=Math.floor(Math.max(0,n)),r=Math.floor(Math.min(e.length-1,r)),!(n<=t&&t<=r))return e;for(o=void 0===o?_u:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ut;if(e===Ut)return _u;if("function"!=typeof e)throw new TypeError("compare is not a function");return(t,n)=>{var r=e(t,n);return r||0===r?r:(0===e(n,n))-(0===e(t,t))}}(o);r>n;){if(r-n>600){var i=r-n+1,a=t-n+1,l=Math.log(i),s=.5*Math.exp(2*l/3),c=.5*Math.sqrt(l*s*(i-s)/i)*(a-i/2<0?-1:1);xu(e,t,Math.max(n,Math.floor(t-a*s/i+c)),Math.min(r,Math.floor(t+(i-a)*s/i+c)),o)}var u=e[t],d=n,h=r;for(bu(e,n,t),o(e[r],u)>0&&bu(e,n,r);d<h;){for(bu(e,d,h),++d,--h;o(e[d],u)<0;)++d;for(;o(e[h],u)>0;)--h}0===o(e[n],u)?bu(e,n,h):bu(e,++h,r),h<=t&&(n=h+1),t<=h&&(r=h-1)}return e}function bu(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function Cu(e,t){return function(e,t,n){if(e=Float64Array.from(function*(e,t){if(void 0===t)for(var n of e)null!=n&&(n=+n)>=n&&(yield n);else{var r=-1;for(var o of e)null!=(o=t(o,++r,e))&&(o=+o)>=o&&(yield o)}}(e,n)),(r=e.length)&&!isNaN(t=+t)){if(t<=0||r<2)return pe(e);if(t>=1)return he(e);var r,o=(r-1)*t,i=Math.floor(o),a=he(xu(e,i).subarray(0,i+1));return a+(pe(e.subarray(i+1))-a)*(o-i)}}(e,.5,t)}function ku(e){return Math.log(e)}function wu(e){return Math.exp(e)}function Eu(e){return-Math.log(-e)}function Su(e){return-Math.exp(-e)}function Tu(e){return isFinite(e)?+("1e"+e):e<0?0:e}function Du(e){return(t,n)=>-e(-t,n)}function Mu(){var e=function(e){var t,n,r=e(ku,wu),o=r.domain,i=10;function a(){return t=function(e){return e===Math.E?Math.log:10===e&&Math.log10||2===e&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}(i),n=function(e){return 10===e?Tu:e===Math.E?Math.exp:t=>Math.pow(e,t)}(i),o()[0]<0?(t=Du(t),n=Du(n),e(Eu,Su)):e(ku,wu),r}return r.base=function(e){return arguments.length?(i=+e,a()):i},r.domain=function(e){return arguments.length?(o(e),a()):o()},r.ticks=e=>{var r=o(),a=r[0],l=r[r.length-1],s=l<a;s&&([a,l]=[l,a]);var c,u,d=t(a),h=t(l),p=null==e?10:+e,f=[];if(!(i%1)&&h-d<p){if(d=Math.floor(d),h=Math.ceil(h),a>0){for(;d<=h;++d)for(c=1;c<i;++c)if(!((u=d<0?c/n(-d):c*n(d))<a)){if(u>l)break;f.push(u)}}else for(;d<=h;++d)for(c=i-1;c>=1;--c)if(!((u=d>0?c/n(-d):c*n(d))<a)){if(u>l)break;f.push(u)}2*f.length<p&&(f=Wt(a,l,p))}else f=Wt(d,h,Math.min(h-d,p)).map(n);return s?f.reverse():f},r.tickFormat=(e,o)=>{if(null==e&&(e=10),null==o&&(o=10===i?"s":","),"function"!=typeof o&&(i%1||null!=(o=ar(o)).precision||(o.trim=!0),o=fr(o)),e===1/0)return o;var a=Math.max(1,i*e/r.ticks().length);return e=>{var r=e/n(Math.round(t(e)));return r*i<i-.5&&(r*=i),r<=a?o(e):""}},r.nice=()=>o(sa(o(),{floor:e=>n(Math.floor(t(e))),ceil:e=>n(Math.ceil(t(e)))})),r}(tr()).domain([1,10]);return e.copy=()=>er(e,Mu()).base(e.base()),rr.apply(e,arguments),e}function Au(e){var t=/[1-9]([0]+$)|\.([0-9]*)/.exec(String(e));return t?t[1]?-t[1].length:t[2]?t[2].length:0:0}function Lu(e,t,n){void 0===n&&(n=10);var r=Math.pow(n,t);return Math.round(e*r)/r}function Pu(e){this._context=e}function Iu(e){var t,n,r=e.length-1,o=new Array(r),i=new Array(r),a=new Array(r);for(o[0]=0,i[0]=2,a[0]=e[0]+2*e[1],t=1;t<r-1;++t)o[t]=1,i[t]=4,a[t]=4*e[t]+2*e[t+1];for(o[r-1]=2,i[r-1]=7,a[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=o[t]/i[t-1],i[t]-=n,a[t]-=n*a[t-1];for(o[r-1]=a[r-1]/i[r-1],t=r-2;t>=0;--t)o[t]=(a[t]-o[t+1])/i[t];for(i[r-1]=(e[r]+o[r-1])/2,t=0;t<r-1;++t)i[t]=2*e[t+1]-o[t+1];return[o,i]}function Nu(e){return new Pu(e)}function Ou(e,t){this._context=e,this._t=t}function Fu(e){return new Ou(e,.5)}function Ru(e){return new Ou(e,0)}function Vu(e){return new Ou(e,1)}Pu.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),2===n)this._context.lineTo(e[1],t[1]);else for(var r=Iu(e),o=Iu(t),i=0,a=1;a<n;++i,++a)this._context.bezierCurveTo(r[0][i],o[0][i],r[1][i],o[1][i],e[a],t[a]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}},Ou.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}}this._x=e,this._y=t}};var Bu,Hu,zu,Wu,Yu=n(794),ju=e=>!isNaN(parseFloat(e))&&isFinite(e),Uu=e=>null==e||"number"==typeof e&&!isFinite(e);function Xu(e,t){void 0===t&&(t=!1);var n=gr(".2~",e);Math.abs(e)<1?n=fr(".2~g"):t&&Math.abs(e)>=1e3&&(n=gr(".1~",e));var r=n(e);return Math.abs(e)>=1e9?r.replace("G","B"):r}function qu(e,t,n,r,o){var i=e.domainNRangeValues,a=e.showRoundOffXTickValues,l=void 0===a||a,s=e.xAxistickSize,c=void 0===s?6:s,u=e.tickPadding,d=void 0===u?10:u,h=e.xAxisCount,p=e.xAxisElement,f=e.hideTickOverlap,g=e.calcMaxLabelWidth,v=e.tickStep,m=e.tick0,y=e.tickText,_=kd(o).domain([i.dStartValue,i.dEndValue]).range([i.rStartValue,i.rEndValue]);l&&_.nice();var x=null!=h?h:6,b=function(e,n,o){if(t.tickValues&&y&&void 0!==y[n])return y[n];if(t.tickFormat)return fr(t.tickFormat)(e);var i="number"==typeof e?e:e.valueOf();return""===(null==o?void 0:o(i))?"":(0,Yu.c$)(i,r)};if(f&&void 0===h){var C=g(_.ticks().map(function(e,t){return b(e,t)}))+20,k=_.range(),w=k[0],E=k[1];x=Math.min(Math.max(1,Math.floor(Math.abs(E-w)/C)),10)}var S,T=gu(_).tickSize(c).tickPadding(d).ticks(x).tickFormat(function(e,t){return b(e,t,_.tickFormat(x))});[Hu.HorizontalBarChartWithAxis,Hu.GanttChart].includes(n)&&T.tickSizeInner(-(e.containerHeight-e.margins.top)),t.tickValues?S=t.tickValues:v&&(S=Md(o,v,m,_.domain())),S&&T.tickValues(S),p&&Rt(p).call(T).selectAll("text").attr("aria-hidden","true");var D=(null!=S?S:_.ticks(x)).map(T.tickFormat());return{xScale:_,tickValues:D}}function Gu(e,t,n,r,o,i,a,l){var s;void 0===o&&(o=!1),void 0===i&&(i=!1),void 0===a&&(a=!1);var c=e.yMinMaxValues,u=void 0===c?{startValue:0,endValue:0}:c,d=e.yAxisElement,h=void 0===d?null:d,p=e.yMaxValue,f=void 0===p?0:p,g=e.yMinValue,v=void 0===g?0:g,m=e.containerHeight,y=e.containerWidth,_=e.margins,x=e.tickPadding,b=void 0===x?12:x,C=e.maxOfYVal,k=void 0===C?0:C,w=e.yAxisTickFormat,E=e.yAxisTickCount,S=void 0===E?4:E,T=e.eventAnnotationProps,D=e.eventLabelHeight,M=e.tickValues,A=e.tickStep,L=e.tick0,P=e.tickText,I=k||u.endValue||0,N=I>f?I:f,O=i?Math.min(u.startValue||0,v||0):u.startValue<v?0:v,F=function(e,t,n,r,o){if(o)return function(e,t,n){var r,o,i=e<0&&e===t?0:t,a=function(e,t,n){for(var r;;){var o=Yt(e,t,n);if(o===r||0===o||!isFinite(o))return[e,t];o>0?(e=Math.floor(e/o)*o,t=Math.ceil(t/o)*o):o<0&&(e=Math.ceil(e*o)/o,t=Math.floor(t*o)/o),r=o}}(e>=0&&e===t?0:e,i,n),l=Wt(a[0],a[a.length-1],n);return l[l.length-1]>i&&(r=i,o=(0,Yu.Di)(r),Math.log10(o)%1==0)&&l.pop(),l}(t,e,n);var i=r||(e-t)/n>=1?Math.ceil((e-t)/n):(e-t)/n,a=[t<0&&e>=0?0:t];if(a[0]===t&&a.push(t+i),t<0&&e>=0){for(;a[a.length-1]>t;)a.push(a[a.length-1]-i);a.reverse()}for(;a[a.length-1]<e;)a.push(a[a.length-1]+i);return a}(N,O,S,r,a),R=[i?F[0]:O,F[F.length-1]];if("log"===l){var V=u.startValue,B=u.endValue;v>0&&(V=Math.min(V,v)),f>0&&(B=Math.max(B,f)),R=[V,B]}var H,z=kd(l).domain(R).range([m-_.bottom,_.top+(T?D:0)]),W=(!t&&o||t&&!o?fu(z):vu(z)).tickPadding(b).tickSizeInner(-(y-_.left-_.right));return M?H=M:A&&(H=Md(l,A,L,z.domain())),H?W.tickValues(H):"log"!==l&&W.tickValues(F),W.tickFormat(function(e,t){return function(e,t,n){if(M&&P&&void 0!==P[t])return P[t];if("function"==typeof w)return w(e,t);if("string"==typeof w)return fr(w)(e);var r="number"==typeof e?e:e.valueOf();return""===(null==n?void 0:n(r))?"":function(e){return Xu(e)}(r)}(e,t,z.tickFormat(S))}),h&&Rt(h).call(W).selectAll("text").attr("aria-hidden","true"),n.yAxisDomainValues=z.domain(),n.yAxisTickText=(null!==(s=W.tickValues())&&void 0!==s?s:z.ticks(S)).map(W.tickFormat()),z}!function(e){e[e.AreaChart=0]="AreaChart",e[e.LineChart=1]="LineChart",e[e.VerticalBarChart=2]="VerticalBarChart",e[e.VerticalStackedBarChart=3]="VerticalStackedBarChart",e[e.GroupedVerticalBarChart=4]="GroupedVerticalBarChart",e[e.HeatMapChart=5]="HeatMapChart",e[e.HorizontalBarChartWithAxis=6]="HorizontalBarChartWithAxis",e[e.ScatterChart=7]="ScatterChart",e[e.GanttChart=8]="GanttChart"}(Hu||(Hu={})),function(e){e[e.NumericAxis=0]="NumericAxis",e[e.DateAxis=1]="DateAxis",e[e.StringAxis=2]="StringAxis"}(zu||(zu={})),function(e){e[e.NumericAxis=0]="NumericAxis",e[e.DateAxis=1]="DateAxis",e[e.StringAxis=2]="StringAxis"}(Wu||(Wu={}));var Ku=function(e,t,n,r,o,i){var a,l=e.containerHeight,s=e.tickPadding,c=void 0===s?12:s,u=e.margins,d=e.yAxisTickFormat,h=e.yAxisElement,p=e.yAxisPadding,f=void 0===p?0:p,g=e.containerWidth,v=e.tickValues,m=e.tickText,y=_a().domain(t).range([l-u.bottom,u.top]).padding(f);i===Hu.VerticalStackedBarChart&&y.paddingInner(1).paddingOuter(0);var _=n?fu(y):vu(y),x=null!==(a=v)&&void 0!==a?a:t,b=_.tickPadding(c).tickValues(x).tickFormat(function(e,t){return v&&m&&void 0!==m[t]?m[t]:"function"==typeof d?d(e,t):e}).tickSize(0);return i===Hu.VerticalStackedBarChart&&_.tickSizeInner(-(g-u.left-u.right)),h&&Rt(h).call(b).selectAll("text"),r.yAxisTickText=b.tickValues().map(b.tickFormat()),y};function Zu(e){var t=[];e.forEach(function(e){var n=e.data.filter(function(e){return!e.hideCallout}).map(function(t){return(0,de.Cl)((0,de.Cl)({},t),{legend:e.legend,color:e.color,index:e.index})});t=t.concat(n)});var n={};return t.forEach(function(e){var t=e.x instanceof Date?e.x.getTime():e.x;t in n?n[t].push({legend:e.legend,y:e.y,color:e.color,xAxisCalloutData:e.xAxisCalloutData,yAxisCalloutData:e.yAxisCalloutData,callOutAccessibilityData:e.callOutAccessibilityData,index:e.index}):n[t]=[{legend:e.legend,y:e.y,color:e.color,xAxisCalloutData:e.xAxisCalloutData,yAxisCalloutData:e.yAxisCalloutData,callOutAccessibilityData:e.callOutAccessibilityData,index:e.index}]}),n}var $u=function(e,t,n){var r=Rt("#".concat(t));if(r.text(e),!r.node())return!1;for(var o=!1,i=r.node().getComputedTextLength();i>n&&e.length>0;)e=e.slice(0,-1),r.text(e+"..."),o=!0,i=r.node().getComputedTextLength();return o},Ju=function(e,t){void 0===t&&(t="none");var n=0,r=document.createElement("canvas").getContext("2d");if(r){var o=document.querySelector(t);if(o){var i=window.getComputedStyle(o,null),a=i.getPropertyValue("font-weight"),l=i.getPropertyValue("font-size"),s=i.getPropertyValue("font-family");r.font="".concat(a," ").concat(l," ").concat(s)}else r.font='600 10px "Segoe UI"';e.forEach(function(e){n=Math.max(r.measureText(e.toString()).width,n)})}return n};function Qu(e){var t=e.tooltipCls,n=e.axis,r=e.id;if(null===n)return null;for(var o=Rt("body").append("div").attr("id",r).attr("class",t).style("opacity",0),i=n.selectAll("#BaseSpan")._groups[0],a=i&&Object.keys(i).length,l=[],s=0;s<a;s++){var c=i[s].dataset&&Object.values(i[s].dataset)[0];l.push(c)}var u=n.selectAll(".tick")._groups[0],d=u&&Object.keys(u).length,h=function(e){Rt(u[e]).on("mouseover",function(t,n){o.style("opacity",.9),o.text(l[e]).style("left",t.pageX+"px").style("top",t.pageY-28+"px")}).on("mouseout",function(e){o.style("opacity",0)})};for(s=0;s<d;s++)h(s)}function ed(e){var t=!1;return e&&e.length>0&&e.forEach(function(e){e.data.length>0&&(t=e.data[0].x instanceof Date)}),t}function td(e,t,n,r,o,i){var a=bd(e),l=Td(e,o),s=l[0],c=l[1];if(i){var u=wd(s,c,o);s-=u.start,c+=u.end}var d=t.left,h=n-t.right;return r?{dStartValue:a?1:c,dEndValue:a?-1:s,rStartValue:d,rEndValue:h}:{dStartValue:a?-1:s,dEndValue:a?1:c,rStartValue:d,rEndValue:h}}function nd(e,t,n,r,o,i,a,l){var s,c,u;if(void 0===o&&(o=[]),[Hu.AreaChart,Hu.LineChart,Hu.ScatterChart].includes(i)){if(c=(s=Td(e))[0],u=s[1],c=pe((0,de.fX)((0,de.fX)([],o,!0),[c],!1)),u=he((0,de.fX)((0,de.fX)([],o,!0),[u],!1)),l||i===Hu.ScatterChart){var d=wd(c.getTime(),u.getTime());c=new Date(c.getTime()-d.start),u=new Date(u.getTime()+d.end)}}else c=pe(e,function(e){return e.x}),u=he(e,function(e){return e.x});var h=t.left,p=n-t.right;return r?{dStartValue:u,dEndValue:c,rStartValue:h,rEndValue:p}:{dStartValue:c,dEndValue:u,rStartValue:h,rEndValue:p}}function rd(e,t,n,r){var o=[];return e.forEach(function(e){!n==!e.useSecondaryYScale&&e.data.forEach(function(e){Ed(e.y,r)&&o.push(e.y)})}),{startValue:pe(o),endValue:he(o)}}function od(e,t,n){var r=[];return e.forEach(function(e){n||r.push(e.y),void 0!==e.lineData&&!n==!e.lineData.useSecondaryYScale&&r.push(e.lineData.y)}),{startValue:pe(r),endValue:he(r)}}var id,ad,ld=function(e,t){if(t)switch(typeof e){case"string":return zu.StringAxis;case"number":return zu.NumericAxis;default:return zu.DateAxis}else switch(typeof e){case"string":return Wu.StringAxis;case"number":return Wu.NumericAxis;default:return Wu.DateAxis}};!function(e){e[e.circle=0]="circle",e[e.square=1]="square",e[e.triangle=2]="triangle",e[e.diamond=3]="diamond",e[e.pyramid=4]="pyramid",e[e.hexagon=5]="hexagon",e[e.pentagon=6]="pentagon",e[e.octagon=7]="octagon"}(id||(id={})),function(e){e[e.dottedLine=0]="dottedLine"}(ad||(ad={}));var sd=((Bu={})[id.circle]={widthRatio:1},Bu[id.square]={widthRatio:1},Bu[id.triangle]={widthRatio:1},Bu[id.diamond]={widthRatio:1},Bu[id.pyramid]={widthRatio:1},Bu[id.hexagon]={widthRatio:2},Bu[id.pentagon]={widthRatio:1.168},Bu[id.octagon]={widthRatio:2.414},Bu),cd=function(e,t,n){return void 0===t&&(t="text"),void 0===n&&(n=!0),{role:t,"data-is-focusable":n,"aria-label":(e=null!=e?e:{}).ariaLabel,"aria-labelledby":e.ariaLabelledBy,"aria-describedby":e.ariaDescribedBy}};function ud(e){return Xu(e,!0)}var dd=function(e,t,n,r){var o;return void 0===n&&(n=16),o="auto"===e||"histogram"===r?n:"number"==typeof e?e:Math.min(n,16),"number"==typeof t&&(o=Math.min(o,t)),Math.max(o,1)},hd=function(e,t,n){void 0===n&&(n=0);var r="number"==typeof e?e:"number"==typeof t?t:n;return Math.max(0,Math.min(r,1))},pd=function(e,t){return"number"==typeof e||"number"==typeof t};function fd(e){return void 0===e&&(e={}),e.dangerouslySetInnerHTML,(0,de.Tt)(e,["dangerouslySetInnerHTML"])}function gd(e,t){if(e===t)return!0;if(!e&&!t)return!0;if(!e||!t||e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function vd(e,t,n){var r=getComputedStyle(t);Array.isArray(e)?e.forEach(function(e){Rt(n).style(e,r.getPropertyValue(e))}):Object.entries(e).forEach(function(e){var t=e[0],o=e[1];Rt(n).style(o,r.getPropertyValue(t))})}var md={position:"absolute",visibility:"hidden",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},yd=Ta("measurement_span_");function _d(e,t){if(void 0===t&&(t=me),"function"==typeof e)return e;switch(e){case"linear":return me;case"natural":return Nu;case"step":return Fu;case"stepAfter":return Vu;case"stepBefore":return Ru;default:return t}}var xd=/(category|total|sum|min|max|mean|median) (ascending|descending)/;function bd(e){return e.some(function(e){var t;return"string"==typeof(null===(t=e.lineOptions)||void 0===t?void 0:t.mode)&&"scatterpolar"===e.lineOptions.mode})}var Cd,kd=function(e){return"log"===e?Mu():yr()},wd=function(e,t,n){if("log"===n)return{start:.5*e,end:t};var r=.1*(t-e);return{start:r,end:r}},Ed=function(e,t){return"number"!=typeof e||"log"!==t||e>0},Sd=function(e,t){return!Uu(e)&&!Uu(t)},Td=function(e,t){var n=function(e){return Ed(e.x,t)};return[pe(e,function(e){return pe(e.data.filter(n),function(e){return e.x})}),he(e,function(e){return he(e.data.filter(n),function(e){return e.x})})]},Dd=function(e,t,n){for(var r=pe(n),o=he(n),i=Math.max(Au(e),Au(t)),a=Math.ceil(Lu((r-e)/t,i)),l=Math.floor(Lu((o-e)/t,i)),s=[],c=a;c<=l;c++)s.push(Lu(e+c*t,i));return s},Md=function(e,t,n,r){var o="number"==typeof n?n:0;if("log"!==e){if("number"==typeof t&&t>0)return Dd(o,t,r)}else{if("number"==typeof t&&t>0)return Dd(o,t,r.map(function(e){return Math.log10(e)})).map(function(e){return Math.pow(10,e)});if("string"==typeof t){var i=t[0],a=ju(t.slice(1))?Number(t.slice(1)):0;if("L"===i&&a>0)return Dd(o,a,r)}}},Ad=function(e,t,n,r){var o=t instanceof Date?t:new Date("2000-01-01");if("number"==typeof e&&e>0)return Dd(+o,e,n.map(function(e){return+e})).map(function(e){return new Date(e)});if("string"==typeof e){var i=e[0],a=ju(e.slice(1))?Number(e.slice(1)):0;if("M"===i&&a>0&&a===Math.round(a))return function(e,t,n,r){for(var o=+pe(n),i=+he(n),a=function(e){return r?e.getUTCMonth():e.getMonth()},l=function(e,t){return r?new Date(e.setUTCMonth(t)):new Date(e.setMonth(t))},s=0,c=new Date(+e);+c>o;)c=l(c,a(c)-t),s-=t;for(var u=a(e),d=[],h=s;;h+=t){var p=l(new Date(+e),u+h);if(a(p)!==((u+h)%12+12)%12&&(p=r?new Date(p.setUTCDate(0)):new Date(p.setDate(0))),+p>i)break;+p>=o&&d.push(p)}return d}(o,a,n,r)}},Ld=function(e,t){if(null!==t){var n=t instanceof Date?t.getTime():t;if(e[n])return{x:t,values:e[n]}}},Pd=((Cd={})["".concat(id[id.circle])]="M1 6 A5 5 0 1 0  12 6 M1 6 A5 5 0 0 1  12 6",Cd["".concat(id[id.square])]="M1 1 L12 1 L12 12  L1 12 L1 1 Z",Cd["".concat(id[id.triangle])]="M6 10L8.74228e-07 -1.04907e-06L12 0L6 10Z",Cd["".concat(id[id.pyramid])]="M6 10L8.74228e-07 -1.04907e-06L12 0L6 10Z",Cd["".concat(id[id.diamond])]="M2 2 L10 2 L10 10  L2 10 L2 2 Z",Cd["".concat(id[id.hexagon])]="M9 0H3L0 5L3 10H9L12 5L9 0Z",Cd["".concat(id[id.pentagon])]="M6.06061 0L0 4.21277L2.30303 11H9.69697L12 4.21277L6.06061 0Z",Cd["".concat(id[id.octagon])]="M7.08333 0H2.91667L0 2.91667V7.08333L2.91667 10H7.08333L10 7.08333V2.91667L7.08333 0Z",Cd["".concat(ad[ad.dottedLine])]="M0 6 H3 M5 6 H8 M10 6 H13",Cd),Id=function(e){var t=e.svgProps,n=e.pathProps,r=e.shape,i=e.classNameForNonSvg;return-1===Object.keys(Pd).indexOf(r)?o.createElement("div",{className:i}):o.createElement("svg",(0,de.Cl)({width:14,height:14,viewBox:"-1 -1 14 14"},fd(t),{transform:"rotate(".concat(r===id[id.diamond]?45:r===id[id.pyramid]?180:0,", 0, 0)")}),o.createElement("path",(0,de.Cl)({d:Pd[r]},fd(n))))};function Nd(e){return Rt(Et(e).call(document.documentElement))}function Od(e,t){return(0,de.sH)(this,arguments,void 0,function(e,t,n,r){var o,i,a,l,s;return void 0===n&&(n=!1),void 0===r&&(r={}),(0,de.YH)(this,function(c){switch(c.label){case 0:if(0===e.length&&!t)throw new Error("No charts or legends to export");return[4,Promise.all(e.map(function(e){return new Promise(function(t){var r=function(e,t){if(!e)throw new Error("Chart container is not defined");var n=e.querySelector("svg");if(!n)throw new Error("SVG not found");for(var r=Rt(n.cloneNode(!0)).attr("width",null).attr("height",null).attr("viewBox",null),o=n.getElementsByTagName("*"),i=r.node().getElementsByTagName("*"),a=["text"],l=["table","thead","tbody","tr","th","td"],s=0;s<o.length;s++){var c=o[s].tagName.toLowerCase();a.includes(c)||l.includes(c)?vd((0,de.fX)((0,de.fX)([],Fd,!0),Rd,!0),o[s],i[s]):vd(Fd,o[s],i[s])}o=null,i=null;var u=n.querySelectorAll("foreignObject"),d=r.node().querySelectorAll("foreignObject");u.forEach(function(e,t){var n=d[t];if(n){var r=e.firstElementChild,o=n.firstElementChild;r&&o&&vd(Vd,r,o);var i=e.querySelectorAll("*"),a=n.querySelectorAll("*");i.forEach(function(e,t){var n=a[t];n&&vd(Vd,e,n)})}});var h=e.querySelector('[data-chart-annotation-svg="true"]'),p=null;if(h){p=h.cloneNode(!0),vd(Fd,h,p);var f=h.getElementsByTagName("*"),g=p.getElementsByTagName("*");for(s=0;s<f.length;s++){var v=f[s],m=g[s],y=(c=v.tagName.toLowerCase(),v instanceof SVGElement),_=v instanceof HTMLElement;y&&vd("text"===c?(0,de.fX)((0,de.fX)([],Fd,!0),Rd,!0):Fd,v,m),_&&vd(Vd,v,m),"foreignobject"===c&&vd(Bd,v,m)}}var x=n.getBoundingClientRect(),b=x.width,C=x.height;r.attr("width",b).attr("height",C).attr("viewBox","0 0 ".concat(b," ").concat(C)).attr("direction",t?"rtl":"ltr"),p&&(r.selectAll('[data-chart-annotation-layer="true"]').remove(),Rt(p).attr("x",0).attr("y",0).attr("width",b).attr("height",C),r.append(function(){return p}));var k={node:r.node(),width:b,height:C};return r=null,k}(e.container,n);t({dataUrl:Wd(r.node),width:r.width,height:r.height})})}))];case 1:return o=c.sent(),i=[],e.forEach(function(e,t){var n=e.row||0,r=e.col||0;i[n]||(i[n]=[]),i[n][r]=o[t]}),t&&(a=0,i.forEach(function(e){var t=0;e.forEach(function(e){t+=e.width}),a=Math.max(a,t)}),(l=t(a,n)).node&&(s=Wd(l.node),i.push([{dataUrl:s,width:l.width,height:l.height}]))),[2,zd(i,r)]}})})}var Fd=["display","fill","fill-opacity","opacity","stroke","stroke-width","transform","border-collapse"],Rd=["font-family","font-size","font-weight","text-anchor","background-color","color","padding","text-align","border"],Vd=["align-items","background","background-color","border","border-radius","box-shadow","box-sizing","color","column-gap","display","flex","flex-direction","font-family","font-size","font-style","font-weight","gap","height","justify-content","letter-spacing","line-height","margin","max-height","max-width","min-height","min-width","opacity","overflow","padding","pointer-events","position","row-gap","text-align","text-decoration","text-transform","top","right","bottom","left","visibility","white-space","width","z-index"],Bd=["overflow","pointer-events"],Hd={color:"fill","font-family":"font-family","font-size":"font-size","font-weight":"font-weight"};function zd(e){return(0,de.sH)(this,arguments,void 0,function(e,t){var n,r,o,i,a,l,s,c,u,d;return void 0===t&&(t={}),(0,de.YH)(this,function(h){switch(h.label){case 0:if(n=0,r=0,o=e.map(function(e){var t=0,o=0,i=e.map(function(e){var n=(0,de.Cl)((0,de.Cl)({},e),{x:t,y:r});return t+=e.width,o=Math.max(o,e.height),n});return n=Math.max(n,t),r+=o,i}).flat(),i=t.scale||1,a=t.width||n,l=t.height||r,n*=s=i*a/n,r*=c=i*l/r,(u=document.createElement("canvas")).width=n,u.height=r,!(d=u.getContext("2d")))throw new Error("Canvas context is null");return d.fillStyle=t.background||"transparent",d.fillRect(0,0,n,r),[4,Promise.all(o.map(function(e){return new Promise(function(t,n){var r=new Image;r.onload=function(){d.drawImage(r,s*e.x,c*e.y,s*e.width,c*e.height),t()},r.onerror=n,r.src=e.dataUrl})}))];case 1:return h.sent(),[2,u.toDataURL("image/png")]}})})}function Wd(e){if(!e)throw new Error("SVG node is null");var t=(new XMLSerializer).serializeToString(e);return"data:image/svg+xml;base64,"+btoa(function(e){for(var t,n,r="",o=e.length,i=0;i<o;){if("%"===(t=e.charAt(i++)))if("u"===e.charAt(i)){if(n=e.slice(i+1,i+5),Ud.exec(n)){r+=String.fromCharCode(parseInt(n,16)),i+=5;continue}}else if(n=e.slice(i,i+2),jd.exec(n)){r+=String.fromCharCode(parseInt(n,16)),i+=2;continue}r+=t}return r}(encodeURIComponent(t)))}var Yd,jd=/^[\da-f]{2}$/i,Ud=/^[\da-f]{4}$/i,Xd=(0,xa.Z)(),qd=function(e){function t(t){var n,r,i,a,l=e.call(this,t)||this;l._isLegendSelected=!1,l.toSVG=function(e,t){return void 0===t&&(t=!1),function(e,t,n,r){if(0===e.length)return{node:null,width:0,height:0};for(var o=n.selectedLegends,i=n.centerLegends,a=n.textClassName,l=n.isRTL,s=Nd("svg:g"),c=i?0:12,u=8,d=[],h=[],p=[],f=0===Object.keys(o).length,g=function(n){var g,v,m,y,_=(g=e[n].title,v=a,m=r,(y=document.getElementById(yd))||((y=document.createElement("span")).setAttribute("id",yd),y.setAttribute("aria-hidden","true"),m?m.appendChild(y):document.body.appendChild(y)),y.setAttribute("class",v),Object.assign(y.style,md),y.textContent="".concat(g),y),x=29+_.getBoundingClientRect().width+8,b=s.append("g");d.push({elem:b,width:x}),c+x>t&&d.length>1&&(d.pop(),h.push(d),p.push(c),d=[{elem:b,width:x}],c=i?0:12,u+=32);var C=o[e[n].title]||f;b.append("rect").attr("x",c+(l?x-8-13:8)).attr("y",u+8).attr("width",13).attr("height",13).style("fill",C?e[n].color:"transparent").style("stroke-width",1).style("stroke",e[n].color),b.append("text").attr("x",c+(l?x-29:29)).attr("y",u+8).attr("dominant-baseline","hanging").style("opacity",C?1:.67).text(e[n].title).call(function(e){return vd(Hd,_,e.node())}),c+=x},v=0;v<e.length;v++)g(v);if(h.push(d),p.push(c),u+=32,i)h.forEach(function(e,n){var r=Math.max((t-p[n])/2,0),o=p[n],i=0;e.forEach(function(e){var t=r+(l?o-e.width-i:0);e.elem.attr("transform","translate(".concat(t,", 0)")),o-=e.width,i+=e.width})});else if(l){var m=Math.max.apply(Math,(0,de.fX)([t],p,!1));h.forEach(function(e){var t=m-12,n=12;e.forEach(function(e){var r=t-e.width-n;e.elem.attr("transform","translate(".concat(r,", 0)")),t-=e.width,n+=e.width})})}var y=Math.max.apply(Math,(0,de.fX)([t],p,!1)),_=u,x=Nd("svg").attr("width",y).attr("height",_).attr("viewBox","0 0 ".concat(y," ").concat(_));return x.append(function(){return s.node()}),{node:x.node(),width:y,height:_}}(l.props.legends,e,{selectedLegends:l.state.selectedLegends,centerLegends:!!l.props.centerLegends,textClassName:l._classNames.text,isRTL:t},l._rootElem)},l._onRenderData=function(e){var t=l.props,n=t.overflowProps,r=t.allowFocusOnLegends,i=void 0===r||r,a=t.canSelectMultipleLegends,s=void 0!==a&&a,c={root:{justifyContent:l.props.centerLegends?"center":"unset",flexWrap:l.props.enabledWrapLines?"wrap":"nowrap"}};return o.createElement(iu,(0,de.Cl)({},i&&{role:"listbox","aria-label":"Legends","aria-multiselectable":s}),o.createElement(jc,(0,de.Cl)({items:e.primary,overflowItems:e.overflow,onRenderItem:l._renderButton,onRenderOverflowButton:l._renderOverflowItems},n,{styles:(0,de.Cl)((0,de.Cl)({},c),null==n?void 0:n.styles)})))},l._onReduceData=function(e){if(0!==e.primary.length){var t=(0,de.fX)((0,de.fX)([],e.primary.slice(-1),!0),e.overflow,!0);return{primary:e.primary.slice(0,-1),overflow:t}}},l._onGrowData=function(e){if(0!==e.overflow.length){var t=e.overflow.slice(1);return{primary:(0,de.fX)((0,de.fX)([],e.primary,!0),e.overflow.slice(0,1),!0),overflow:t}}},l._getNewSelectedLegendsForMultiselect=function(e){var t=(0,de.Cl)({},l.state.selectedLegends);return t[e.title]?delete t[e.title]:(t[e.title]=!0,Object.keys(t).length===l.props.legends.length&&(t={})),t},l._getNewSelectedLegendsForSingleSelect=function(e){var t;return l.state.selectedLegends[e.title]?{}:((t={})[e.title]=!0,t)},l._onClick=function(e,t){var n,r,o,i=l.props.canSelectMultipleLegends,a=void 0!==i&&i?l._getNewSelectedLegendsForMultiselect(e):l._getNewSelectedLegendsForSingleSelect(e);l.setState({selectedLegends:a}),null===(r=(n=l.props).onChange)||void 0===r||r.call(n,Object.keys(a),t,e),null===(o=e.action)||void 0===o||o.call(e)},l._onRenderCompactCard=function(e){var t=l.props,n=t.allowFocusOnLegends,r=void 0===n||n,i=t.className,a=t.styles,s=t.theme,c=t.canSelectMultipleLegends,u=void 0!==c&&c,d=[],h=Xd(a,{theme:s,className:i});return e.renderData.forEach(function(e,t){var n=l._renderButton(e,t,!0);d.push(n)}),o.createElement(iu,(0,de.Cl)({},r&&{role:"listbox","aria-label":"Legends","aria-multiselectable":u},{direction:Wc.vertical,handleTabKey:1,isCircularNavigation:!0},l.props.focusZonePropsInHoverCard,{className:h.hoverCardRoot}),d)},l._renderOverflowItems=function(e){var t=l.props.allowFocusOnLegends,n=void 0===t||t,r=[];e.forEach(function(e,t){r.push({key:t.toString(),name:e.title,onClick:e.action})});var i={renderData:e},a=l.props,s=a.theme,c=a.className,u=a.styles,d=a.overflowText,h=Xd(u,{theme:s,className:c}),p={onRenderPlainCard:l._onRenderCompactCard,renderData:i},f=d||"more";return o.createElement(wc,{type:ja.plain,plainCardProps:p,instantOpenOnClick:!0,onCardHide:function(){l.setState({isHoverCardVisible:!1});var t=Sc(e,function(e){return e.title===l.state.activeLegend});t&&(l.setState({activeLegend:""}),t.onMouseOutAction&&t.onMouseOutAction())},setInitialFocus:!0,trapFocus:!0,onCardVisible:l._hoverCardVisible,styles:h.subComponentStyles.hoverCardStyles,cardDismissDelay:300,target:l._hoverCardRef},o.createElement("div",{role:"option"},o.createElement("div",(0,de.Cl)({className:h.overflowIndicationTextStyle,ref:function(e){l._hoverCardRef=e}},n&&{role:"button","aria-expanded":l.state.isHoverCardVisible,"aria-label":"".concat(r.length," ").concat(f)},{"data-is-focusable":n}),r.length," ",f)))},l._hoverCardVisible=function(){l.setState({isHoverCardVisible:!0})},l._onHoverOverLegend=function(e){e.hoverAction&&(l.setState({activeLegend:e.title}),e.hoverAction())},l._onLeave=function(e){e.onMouseOutAction&&(l.setState({activeLegend:""}),e.onMouseOutAction())},l._renderButton=function(e,t,n){var r=l.props.allowFocusOnLegends,i=void 0===r||r,a={title:e.title,color:e.color,shape:e.shape,action:e.action,hoverAction:e.hoverAction,onMouseOutAction:e.onMouseOutAction,stripePattern:e.stripePattern,isLineLegendInBarChart:e.isLineLegendInBarChart,opacity:e.opacity},s=l._getColor(a.title,a.color),c=l.props,u=c.theme,d=c.className,h=c.styles,p=Xd(h,{theme:u,className:d,colorOnSelectedState:s,borderColor:a.color,overflow:n,stripePattern:a.stripePattern,isLineLegendInBarChart:a.isLineLegendInBarChart,opacity:a.opacity}),f=function(){l._onHoverOverLegend(a)},g=function(){l._onLeave(a)},v=l._getShape(p,a,s);return o.createElement("button",(0,de.Cl)({},i&&{"aria-selected":!!l.state.selectedLegends[a.title],role:"option","aria-label":"".concat(a.title),"aria-setsize":e["aria-setsize"],"aria-posinset":e["aria-posinset"]},e.nativeButtonProps&&(0,de.Cl)({},e.nativeButtonProps),{key:t,className:p.legend,onClick:function(e){l._onClick(a,e)},onMouseOver:f,onMouseOut:g,onFocus:f,onBlur:g,"data-is-focusable":i}),v,o.createElement("div",{className:p.text},a.title))};var s=null!==(r=t.selectedLegends)&&void 0!==r?r:t.defaultSelectedLegends,c=null!==(i=t.selectedLegend)&&void 0!==i?i:t.defaultSelectedLegend,u={};return t.canSelectMultipleLegends?u=(null===(a=null!=s?s:[])||void 0===a?void 0:a.reduce(function(e,t){var n;return(0,de.Cl)(((n={})[t]=!0,n),e)},{}))||{}:c&&((n={})[c]=!0,u=n),l.state={activeLegend:"",isHoverCardVisible:!1,selectedLegends:u},l}return(0,de.C6)(t,e),t.getDerivedStateFromProps=function(e,t){var n,r=e.selectedLegend,o=e.selectedLegends;return e.canSelectMultipleLegends&&void 0!==o?(0,de.Cl)((0,de.Cl)({},t),{selectedLegends:o.reduce(function(e,t){var n;return(0,de.Cl)(((n={})[t]=!0,n),e)},{})}):e.canSelectMultipleLegends||void 0===r?t:(0,de.Cl)((0,de.Cl)({},t),{selectedLegends:(n={},n[r]=!0,n)})},t.prototype.render=function(){var e=this,t=this.props,n=t.theme,r=t.className,i=t.styles;this._classNames=Xd(i,{theme:n,className:r}),this._isLegendSelected=Object.keys(this.state.selectedLegends).length>0;var a=this._generateData();return o.createElement("div",{className:this._classNames.root,ref:function(t){e._rootElem=t}},this.props.enabledWrapLines?this._onRenderData(a):o.createElement(Oc,{data:a,onReduceData:this._onReduceData,onRenderData:this._onRenderData,onGrowData:this._onGrowData}))},t.prototype._generateData=function(){var e=this,t=this.props,n=t.allowFocusOnLegends,r=void 0===n||n,o=t.shape;return{primary:this.props.legends.map(function(t,n){return(0,de.Cl)((0,de.Cl)({},r&&{nativeButtonProps:Qa(t,$a,["title"]),"aria-setsize":e.props.legends.length,"aria-posinset":n+1}),{title:t.title,action:t.action,hoverAction:t.hoverAction,onMouseOutAction:t.onMouseOutAction,color:t.color,shape:o||t.shape,stripePattern:t.stripePattern,isLineLegendInBarChart:t.isLineLegendInBarChart,opacity:t.opacity,key:n})}),overflow:[]}},t.prototype._getShape=function(e,t,n){var r={className:e.shape},i={fill:n,strokeWidth:2,stroke:t.color};return o.createElement(Id,{svgProps:r,pathProps:i,shape:t.shape,classNameForNonSvg:e.rect})},t.prototype._getColor=function(e,t){var n=this.props.theme;return this._isLegendSelected?this.state.selectedLegends[e]?t:n.semanticColors.buttonBackground:this.state.activeLegend===e||""===this.state.activeLegend?t:n.semanticColors.buttonBackground},t}(o.Component),Gd=(0,ue.I)(qd,function(e){var t,n,r=e.className,o=e.theme,i=e.isLineLegendInBarChart,a=void 0!==i&&i,l=o,s=l.palette,c=l.fonts,u={inset:void 0,position:void 0,highContrastStyle:{outlineColor:o.semanticColors.focusBorder},borderColor:"transparent",outlineColor:void 0};return{root:[{whiteSpace:"nowrap",width:"100%",alignItems:"center",margin:"-8px 0 0 -8px"},r],legend:[(0,Fa.gm)(o,u),{display:"flex",alignItems:"center",cursor:"pointer",border:"none",padding:"".concat(8,"px"),background:"none",textTransform:"capitalize"}],rect:{selectors:(t={},t[Fa.up]={content:"linear-gradient(to right, ".concat(e.colorOnSelectedState,", ").concat(e.colorOnSelectedState,")"),opacity:e.colorOnSelectedState===o.semanticColors.buttonBackground?"0.6":""},t),width:"".concat(12,"px"),height:a?"4px":"".concat(12,"px"),backgroundColor:e.stripePattern?"":e.colorOnSelectedState,marginRight:"".concat(8,"px"),border:"".concat(1,"px solid"),borderColor:e.borderColor?e.borderColor:null==o?void 0:o.semanticColors.buttonBorder,content:e.stripePattern?"repeating-linear-gradient(135deg, transparent, transparent 3px, ".concat(e.colorOnSelectedState," 1px, ").concat(e.colorOnSelectedState," 4px)"):""},shape:[{marginRight:"".concat(8,"px")}],triangle:{width:"0",height:"0",borderLeft:"6px solid transparent",borderRight:"6px solid transparent",borderTop:"10.4px solid",borderTopColor:e.colorOnSelectedState,marginRight:"8px",opacity:e.colorOnSelectedState===o.semanticColors.buttonBackground?"0.6":e.opacity?e.opacity:"",selectors:(n={},n[Fa.up]={border:"0px",height:"10.4px",width:"10.4px",clipPath:"polygon(50% 100%, 0 0, 100% 0)",backgroundImage:"linear-gradient(to right, ".concat(e.colorOnSelectedState,", ").concat(e.colorOnSelectedState,")")},n)},text:(0,de.Cl)((0,de.Cl)({},c.small),{lineHeight:"16px",color:null==o?void 0:o.semanticColors.bodyText,opacity:e.colorOnSelectedState===o.semanticColors.buttonBackground?"".concat(.67):""}),hoverChange:{width:"12px",height:"12px",backgroundColor:o.semanticColors.buttonBackground,marginRight:"8px",border:"1px solid",borderColor:e.borderColor?e.borderColor:s.black},overflowIndicationTextStyle:[(0,Fa.gm)(o,u),(0,de.Cl)((0,de.Cl)({cursor:"pointer",color:null==o?void 0:o.semanticColors.bodyText},c.small),{lineHeight:"16px",padding:"".concat(8,"px")})],hoverCardRoot:{padding:"8px",position:"relative",overflowY:"auto",maxHeight:"300px"},subComponentStyles:{hoverCardStyles:{host:[(0,Fa.gm)(o,u)]}}}});!function(e){e[e.zero=0]="zero",e[e.medium=1]="medium",e[e.long=2]="long"}(Yd||(Yd={}));var Kd=(0,xa.Z)(),Zd=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._onRenderContent=function(e){return"string"==typeof e.content?o.createElement("p",{className:t._classNames.subText},e.content):o.createElement("div",{className:t._classNames.subText},e.content)},t}return(0,de.C6)(t,e),t.prototype.render=function(){var e=this.props,t=e.className,n=e.calloutProps,r=e.directionalHint,i=e.directionalHintForRTL,a=e.styles,l=e.id,s=e.maxWidth,c=e.onRenderContent,u=void 0===c?this._onRenderContent:c,d=e.targetElement,h=e.theme;return this._classNames=Kd(a,{theme:h,className:t||n&&n.className,beakWidth:n&&n.isBeakVisible?n.beakWidth:0,gapSpace:n&&n.gapSpace,maxWidth:s}),o.createElement(rc,(0,de.Cl)({target:d,directionalHint:r,directionalHintForRTL:i},n,Qa(this.props,Ja,["id"]),{className:this._classNames.root}),o.createElement("div",{className:this._classNames.content,id:l,onFocus:this.props.onFocus,onMouseEnter:this.props.onMouseEnter,onMouseLeave:this.props.onMouseLeave},u(this.props,this._onRenderContent)))},t.defaultProps={directionalHint:1,maxWidth:"364px",calloutProps:{isBeakVisible:!0,beakWidth:16,gapSpace:0,setInitialFocus:!0,doNotLayer:!1}},t}(o.Component),$d=(0,ue.I)(Zd,function(e){var t=e.className,n=e.beakWidth,r=void 0===n?16:n,o=e.gapSpace,i=void 0===o?0:o,a=e.maxWidth,l=e.theme,s=l.semanticColors,c=l.fonts,u=l.effects,d=-(Math.sqrt(r*r/2)+i)+1/window.devicePixelRatio;return{root:["ms-Tooltip",l.fonts.medium,Fa.lw.fadeIn200,{background:s.menuBackground,boxShadow:u.elevation8,padding:"8px",maxWidth:a,selectors:{":after":{content:"''",position:"absolute",bottom:d,left:d,right:d,top:d,zIndex:0}}},t],content:["ms-Tooltip-content",c.small,{position:"relative",zIndex:1,color:s.menuItemText,wordWrap:"break-word",overflowWrap:"break-word",overflow:"hidden"}],subText:["ms-Tooltip-subtext",{fontSize:"inherit",fontWeight:"inherit",color:"inherit",margin:0}]}},void 0,{scope:"Tooltip"}),Jd=function(e){function t(n){var r=e.call(this,n)||this;return r._tooltipHost=o.createRef(),r._tooltipHostId=Ta("tooltip-host"),r.show=function(){r._toggleTooltip(!0)},r.dismiss=function(){r._hideTooltip()},r._measureText=function(){if(r._tooltipHost.current&&"function"==typeof r._tooltipHost.current.getBBox){var e=r._tooltipHost.current.getBBox();r.setState({textX:e.x,textY:e.y,textWidth:e.width,textHeight:e.height})}},r._getTargetElement=function(){if(r._tooltipHost.current)return r._tooltipHost.current},r._onTooltipFocus=function(e){r._ignoreNextFocusEvent?r._ignoreNextFocusEvent=!1:r._onTooltipMouseEnter(e)},r._onTooltipBlur=function(e){r._ignoreNextFocusEvent=(null===document||void 0===document?void 0:document.activeElement)===e.target,r._dismissTimerId=r._async.setTimeout(function(){r._hideTooltip()},0)},r._onTooltipMouseEnter=function(e){var n=r.props.delay;if(t._currentVisibleTooltip&&t._currentVisibleTooltip!==r&&t._currentVisibleTooltip.dismiss(),t._currentVisibleTooltip=r,r.state.isOverflowing&&(!e.target||!Uc(e.target,r._getTargetElement())))if(r._clearDismissTimer(),r._clearOpenTimer(),n!==Yd.zero){var o=r._getDelayTime(n);r._openTimerId=r._async.setTimeout(function(){r._toggleTooltip(!0)},o)}else r._toggleTooltip(!0)},r._onTooltipMouseLeave=function(e){var n=r.props.closeDelay;r._clearDismissTimer(),r._clearOpenTimer(),n?r._dismissTimerId=r._async.setTimeout(function(){r._toggleTooltip(!1)},n):r._toggleTooltip(!1),t._currentVisibleTooltip===r&&(t._currentVisibleTooltip=void 0)},r._onTooltipKeyDown=function(e){(e.which===Va||e.ctrlKey)&&r.state.isTooltipVisible&&(r._hideTooltip(),e.stopPropagation())},r._clearDismissTimer=function(){r._async.clearTimeout(r._dismissTimerId)},r._clearOpenTimer=function(){r._async.clearTimeout(r._openTimerId)},r._hideTooltip=function(){r._clearOpenTimer(),r._clearDismissTimer(),r._toggleTooltip(!1)},r._toggleTooltip=function(e){r.state.isTooltipVisible!==e&&r.setState({isTooltipVisible:e})},r._getDelayTime=function(e){switch(e){case Yd.medium:return 300;case Yd.long:return 500;default:return 0}},r._wrapContent=function(){var e=r.props,t=e.content,n=e.wrapContent,o=e.maxWidth,i=void 0===o?Number.POSITIVE_INFINITY:o,a=e.maxHeight,l=!1;t&&n&&n(t,r._tooltipHostId,i,a)&&(l=!0),r.state.isOverflowing!==l&&r.setState({isOverflowing:l})},r.state={isTooltipVisible:!1,isOverflowing:!1},r._async=new Ba(r),r}return(0,de.C6)(t,e),t.prototype.render=function(){var e=this.props,t=e.content,n=e.tooltipProps,r=e.textProps,i=e.shouldReceiveFocus,a=void 0===i||i,l=e.showBackground,s=void 0!==l&&l,c=this.state,u=c.isTooltipVisible,d=c.textWidth,h=c.textHeight,p=(0,de.Cl)({content:t,targetElement:this._getTargetElement(),calloutProps:{onDismiss:this._hideTooltip,onMouseEnter:this._onTooltipMouseEnter,onMouseLeave:this._onTooltipMouseLeave},onMouseEnter:this._onTooltipMouseEnter,onMouseLeave:this._onTooltipMouseLeave},n),f=!!this.props.isTooltipVisibleProp&&this.state.isOverflowing&&!!t||u&&!!t,g=("number"==typeof(null==r?void 0:r.x)?r.x:0)-(null!=d?d:0)/2-3,v=("number"==typeof(null==r?void 0:r.y)?r.y:0)-(null!=h?h:0)/2-6;return o.createElement(o.Fragment,null,s&&o.createElement("rect",{x:g,y:v,width:(null!=d?d:0)+6,height:(null!=h?h:0)+3,transform:null==r?void 0:r.transform,className:this.props.className}),o.createElement("text",(0,de.Cl)({},r,{id:this._tooltipHostId,ref:this._tooltipHost,onFocusCapture:this._onTooltipFocus,onBlurCapture:this._onTooltipBlur,onMouseEnter:this._onTooltipMouseEnter,onMouseLeave:this._onTooltipMouseLeave,onKeyDown:this._onTooltipKeyDown,"data-is-focusable":a&&this.state.isOverflowing}),t),f&&o.createElement($d,(0,de.Cl)({},p)))},t.prototype.componentDidMount=function(){this._wrapContent(),this._measureText()},t.prototype.componentDidUpdate=function(e){this.props.maxWidth===e.maxWidth&&this.props.maxHeight===e.maxHeight||(this._wrapContent(),this._measureText())},t.prototype.componentWillUnmount=function(){t._currentVisibleTooltip&&t._currentVisibleTooltip===this&&(t._currentVisibleTooltip=void 0),this._async.dispose()},t.defaultProps={delay:Yd.medium},t}(o.Component),Qd=function(e,t){if(e){var n=mn(e);return n?(n.opacity=Math.max(0,Math.min(1,t)),n.toString()):e}},eh=function(e){var t=e.theme,n=e.className,r=function(e){return Qd(e.semanticColors.bodyBackground,.8)}(t),o=t.semanticColors.bodyText,i=t.semanticColors.bodyDivider;return{root:[{position:"absolute",top:0,left:0,right:0,bottom:0,width:"100%",height:"100%",pointerEvents:"none",overflow:"visible",zIndex:1},n],annotation:[t.fonts.small,{position:"absolute",pointerEvents:"none",display:"flex",alignItems:"center",justifyContent:"center",textAlign:"center",backgroundColor:r,color:o,padding:"4px 8px",borderRadius:4,boxShadow:t.effects.elevation4,border:"1px solid ".concat(i),whiteSpace:"pre-wrap",zIndex:2}],connectorLayer:[{position:"absolute",top:0,left:0,width:"100%",height:"100%",pointerEvents:"none",overflow:"visible"}],measurement:[{position:"absolute",visibility:"hidden",pointerEvents:"none"}],annotationContent:[{width:"100%",height:"100%",pointerEvents:"none"}],annotationForeignObject:[{overflow:"visible",pointerEvents:"none"}],annotationContentInteractive:[{pointerEvents:"auto"}],annotationForeignObjectInteractive:[{pointerEvents:"auto"}],connectorGroup:[{pointerEvents:"none"}]}},th=(0,xa.Z)(),nh="<".codePointAt(0),rh=">".codePointAt(0),oh=function(e,t){var n,r;return null!==(r=null!==(n=e.id)&&void 0!==n?n:"string"==typeof e.text||"number"==typeof e.text?String(e.text):void 0)&&void 0!==r?r:"annotation-".concat(t)},ih=function(e,t){if(0!==t.length){var n=e[e.length-1];n&&"text"===n.type?n.content+=t:e.push({type:"text",content:t})}},ah=function(e){return e.map(function(e){return"text"===e.type?e.content:"br"===e.type?"<br />":"<".concat(e.tag,">").concat(ah(e.children),"</").concat(e.tag,">")}).join("")},lh=function(e){return e.map(function(e){return"text"===e.type?e.content:"br"===e.type?"\n":lh(e.children)}).join("")},sh=function(e,t){return e.map(function(e,n){var r="".concat(t,"-").concat(n);if("text"===e.type)return o.createElement(o.Fragment,{key:r},e.content);if("br"===e.type)return o.createElement("br",{key:r});var i="b"===e.tag?"strong":"em";return o.createElement.apply(o,(0,de.fX)([i,{key:r}],sh(e.children,r),!1))})},ch=function(e,t){var n,r=sh(e,t);return r.length<=1?null!==(n=r[0])&&void 0!==n?n:null:r},uh=function(e,t){var n=null==e?void 0:e(t);if("number"==typeof n&&!Number.isNaN(n))return e&&"function"==typeof e.bandwidth?n+e.bandwidth()/2:n},dh=function(e,t,n){return Math.max(t,Math.min(n,e))},hh=o.memo(function(e){var t=e.annotations,n=e.theme,r=e.context,i=e.className,a=th(eh,{theme:n,className:i}),l=o.useMemo(function(){return Ta("chart-annotation")},[]),s=o.useState({}),c=s[0],u=s[1],d=o.useMemo(function(){return(null!=t?t:[]).map(function(e,t){return{annotation:e,key:oh(e,t)}})},[t]);o.useEffect(function(){u(function(e){if(0===d.length)return 0===Object.keys(e).length?e:{};var t={};if(d.forEach(function(n){var r=n.key;e[r]&&(t[r]=e[r])}),Object.keys(t).length===Object.keys(e).length){for(var n=!0,r=0,o=Object.keys(t);r<o.length;r++){var i=o[r];if(t[i]!==e[i]){n=!1;break}}if(n)return e}return t})},[d]);var h=o.useCallback(function(e,t,n,r){u(function(o){var i,a=o[e];return a&&a.signature===r&&Math.abs(a.width-t)<.5&&Math.abs(a.height-n)<.5||0===t&&0===n?o:(0,de.Cl)((0,de.Cl)({},o),((i={})[e]={width:t,height:n,signature:r},i))})},[]),p=[],f=[],g=[];if(d.forEach(function(e){var t,i,l,s,u,d,v,m,y,_,x,b,C,k,w,E,S,T,D,M,A,L,P,I,N,O,F,R,V,B,H,z,W,Y,j,U,X,q=e.annotation,G=e.key,K=function(e,t){var n,r,o=e.coordinates,i=e.layout;if(o){var a=null!==(n=null==i?void 0:i.offsetX)&&void 0!==n?n:0,l=null!==(r=null==i?void 0:i.offsetY)&&void 0!==r?r:0,s={x:0,y:0};switch(o.type){case"data":var c=o.x,u=o.y,d=o.yAxis,h=void 0===d?"primary":d,p=t.xScale,f="secondary"===h?t.yScaleSecondary:t.yScalePrimary;if(!p||!f)return;var g=uh(p,c instanceof Date?c.getTime():c),v=uh(f,u instanceof Date?u.getTime():u);if("number"!=typeof g||"number"!=typeof v)return;s.x=g,s.y=v;break;case"relative":if("number"!=typeof o.x||"number"!=typeof o.y)return;s.x=t.plotRect.x+t.plotRect.width*o.x,s.y=t.plotRect.y+t.plotRect.height*o.y;break;case"pixel":if("number"!=typeof o.x||"number"!=typeof o.y)return;s.x=t.plotRect.x+o.x,s.y=t.plotRect.y+o.y;break;default:return}var m=s.x+a,y=s.y+l;return(null==i?void 0:i.clipToBounds)&&(m=dh(m,t.plotRect.x,t.plotRect.x+t.plotRect.width),y=dh(y,t.plotRect.y,t.plotRect.y+t.plotRect.height)),{anchor:s,point:{x:m,y}}}}(q,r);if(K){var Z=function(e){var t,n;if(!e)return[];for(var r,o=function(e){var t={amp:"&",quot:'"',apos:"'",nbsp:""},n=e.replace(/&(#x?[0-9a-f]+|#\d+|[a-z][\w-]*);/gi,function(e,n){var r,o=n.toLowerCase();if("lt"===o||"gt"===o)return"&".concat(o,";");if(o.startsWith("#")){var i="x"===o[1],a=o.slice(i?2:1),l=Number.parseInt(a,i?16:10);return Number.isNaN(l)?e:l===nh?"&lt;":l===rh?"&gt;":String.fromCodePoint(l)}return null!==(r=t[o])&&void 0!==r?r:e});return n.replace(/&lt;([^;]+)&gt;/gi,function(e,t){switch(t.trim().replace(/\s+/g," ").toLowerCase()){case"b":return"<b>";case"/b":return"</b>";case"i":return"<i>";case"/i":return"</i>";case"br":case"br/":case"br /":return"<br />";default:return e}})}(e),i=[],a=[{node:null}],l=function(){var e,t;return null!==(t=null===(e=a[a.length-1].node)||void 0===e?void 0:e.children)&&void 0!==t?t:i},s=/<\/?([a-z]+)\s*\/?\s*>/gi,c=0;null!==(r=s.exec(o));){var u=r[0],d=r[1].toLowerCase(),h=u.startsWith("</"),p=/\/\s*>$/.test(u);if(ih(l(),o.slice(c,r.index)),c=r.index+u.length,"br"!==d||h)if("b"!==d&&"i"!==d||p)ih(l(),u);else if(h){var f=a[a.length-1].node;a.length>1&&(null==f?void 0:f.tag)===d?a.pop():ih(l(),u)}else{if(a.length-1>=5){ih(l(),u);continue}var g={type:"element",tag:d,children:[]};l().push(g),a.push({node:g})}else l().push({type:"br"})}for(ih(l(),o.slice(c));a.length>1;)if(g=a.pop().node){var v=null!==(n=null===(t=a[a.length-1].node)||void 0===t?void 0:t.children)&&void 0!==n?n:i;if(v[v.length-1]===g)v.pop();else{var m=v.indexOf(g);-1!==m&&v.splice(m,1)}ih(v,"<".concat(g.tag,">").concat(ah(g.children),"</").concat(g.tag,">"))}return i}(void 0===q.text||null===q.text?"":String(q.text)),$=JSON.stringify(Z),J=lh(Z),Q=q.layout,ee=null!==(t=null==Q?void 0:Q.align)&&void 0!==t?t:"center",te=null!==(i=null==Q?void 0:Q.verticalAlign)&&void 0!==i?i:"middle",ne=null!==(s=null===(l=q.style)||void 0===l?void 0:l.opacity)&&void 0!==s?s:.8,re=null!==(d=null===(u=q.style)||void 0===u?void 0:u.backgroundColor)&&void 0!==d?d:n.semanticColors.bodyBackground,oe=void 0!==(null===(v=q.style)||void 0===v?void 0:v.backgroundColor)||void 0!==(null===(m=q.style)||void 0===m?void 0:m.opacity),ie=(0,de.Cl)((0,de.Cl)({maxWidth:null==Q?void 0:Q.maxWidth},oe&&{backgroundColor:Qd(re,ne)}),{borderColor:null===(y=q.style)||void 0===y?void 0:y.borderColor,borderWidth:null===(_=q.style)||void 0===_?void 0:_.borderWidth,borderStyle:null!==(b=null===(x=q.style)||void 0===x?void 0:x.borderStyle)&&void 0!==b?b:(null===(C=q.style)||void 0===C?void 0:C.borderColor)?"solid":void 0,borderRadius:null===(k=q.style)||void 0===k?void 0:k.borderRadius,padding:null===(w=q.style)||void 0===w?void 0:w.padding,boxShadow:null===(E=q.style)||void 0===E?void 0:E.boxShadow}),ae={color:null===(S=q.style)||void 0===S?void 0:S.textColor,fontSize:null===(T=q.style)||void 0===T?void 0:T.fontSize,fontWeight:null===(D=q.style)||void 0===D?void 0:D.fontWeight,opacity:1};"number"!=typeof(null===(M=q.style)||void 0===M?void 0:M.rotation)||Number.isNaN(q.style.rotation)||(ie.transform="rotate(".concat(q.style.rotation,"deg)"),ie.transformOrigin="50% 50%");var le=function(e,t,n,r,o){return JSON.stringify({annotationContentSignature:e,containerStyle:t,contentStyle:n,layoutClassName:null!=r?r:"",styleClassName:null!=o?o:""})}($,ie,ae,null==Q?void 0:Q.className,null===(A=q.style)||void 0===A?void 0:A.className),se=c[G],ce=(null==se?void 0:se.signature)===le,ue=ce?se:void 0,he=Math.max(null!==(P=null!==(L=null==ue?void 0:ue.width)&&void 0!==L?L:null==Q?void 0:Q.maxWidth)&&void 0!==P?P:180,1),pe=Math.max(null!==(I=null==ue?void 0:ue.height)&&void 0!==I?I:60,1),fe="center"===ee?-he/2:"end"===ee?-he:0,ge="middle"===te?-pe/2:"bottom"===te?-pe:0,ve=K.point.x+fe,me=K.point.y+ge,ye=!1!==(null==Q?void 0:Q.clipToBounds),_e=ye?r.plotRect.x:0,xe=ye?r.plotRect.y:0,be=ye?r.plotRect.width:null!==(N=r.svgRect.width)&&void 0!==N?N:0,Ce=ye?r.plotRect.height:null!==(O=r.svgRect.height)&&void 0!==O?O:0,ke=be>0?_e+be-he:ve,we=Ce>0?xe+Ce-pe:me,Ee=be>0?dh(ve,_e,Math.max(_e,ke)):ve,Se=Ce>0?dh(me,xe,Math.max(xe,we)):me,Te={x:Ee-fe,y:Se-ge};if(q.connector){var De=null!==(F=q.connector.startPadding)&&void 0!==F?F:12,Me=null!==(R=q.connector.endPadding)&&void 0!==R?R:0,Ae=Math.max(De+Me+6,De),Le=Te.x-K.anchor.x,Pe=Te.y-K.anchor.y;if((Be=Math.sqrt(Le*Le+Pe*Pe))<Ae){var Ie={x:0,y:-1},Ne=0===Be?Ie.x:Le/Be,Oe=0===Be?Ie.y:Pe/Be,Fe=K.anchor.x+Ne*Ae+fe,Re=K.anchor.y+Oe*Ae+ge;Te={x:(Ee=Fe=be>0?dh(Fe,_e,Math.max(_e,ke)):Fe)-fe,y:(Se=Re=Ce>0?dh(Re,xe,Math.max(xe,we)):Re)-ge}}}var Ve=(0,de.Cl)({position:"absolute",left:Ee,top:Se,pointerEvents:"none",visibility:"hidden"},ie);if(ce||f.push(o.createElement("div",{key:"".concat(G,"-measurement"),ref:function(e){if(e){var t=e.getBoundingClientRect();0===t.width&&0===t.height||h(G,t.width,t.height,le)}},className:ml(a.annotation,a.measurement,null==Q?void 0:Q.className,null===(V=q.style)||void 0===V?void 0:V.className),style:Ve,"aria-hidden":!0,"data-annotation-key":G,"data-chart-annotation-measurement":"true"},o.createElement("div",{className:ml(a.annotationContent,null==Q?void 0:Q.className,null===(B=q.style)||void 0===B?void 0:B.className),style:ae},ch(Z,"".concat(G,"-measurement"))))),p.push(o.createElement("foreignObject",{key:"".concat(G,"-annotation"),x:Ee,y:Se,width:he,height:pe,className:ml(a.annotationForeignObject),"data-annotation-key":G},o.createElement("div",{className:ml(a.annotation,null==Q?void 0:Q.className,null===(H=q.style)||void 0===H?void 0:H.className),style:ie,"data-annotation-key":G},o.createElement("div",{className:ml(a.annotationContent,null===(z=q.style)||void 0===z?void 0:z.className),style:ae,role:null!==(Y=null===(W=q.accessibility)||void 0===W?void 0:W.role)&&void 0!==Y?Y:"note","aria-label":null!==(U=null===(j=q.accessibility)||void 0===j?void 0:j.ariaLabel)&&void 0!==U?U:J||void 0,"aria-describedby":null===(X=q.accessibility)||void 0===X?void 0:X.ariaDescribedBy,"data-chart-annotation":"true","data-annotation-key":G},ch(Z,"".concat(G,"-content")))))),q.connector){var Be,He=q.connector,ze=He.startPadding,We=(De=void 0===ze?12:ze,He.endPadding),Ye=(Me=void 0===We?0:We,He.strokeColor),je=void 0===Ye?function(e){return e.palette.neutralPrimary}(n):Ye,Ue=He.strokeWidth,Xe=void 0===Ue?2:Ue,qe=He.dashArray,Ge=He.arrow,Ke=void 0===Ge?"end":Ge,Ze=(Le=K.anchor.x-Te.x,Pe=K.anchor.y-Te.y,Ne=Le/(Be=Math.sqrt(Le*Le+Pe*Pe)||1),Oe=Pe/Be,Math.max(1,Math.min(he,pe))),$e=De>0?1.25*De:24,Je=.6*Be,Qe=dh(.35*Ze,6,Math.min(24,$e,Je)),et=dh(Xe,1,Qe/2),tt={x:Te.x+Ne*De,y:Te.y+Oe*De},nt={x:K.anchor.x-Ne*Me,y:K.anchor.y-Oe*Me};g.push({key:"".concat(G,"-connector"),start:tt,end:nt,strokeColor:je,strokeWidth:Xe,dashArray:qe,arrow:Ke,markerSize:Qe,markerStrokeWidth:et})}}}),0===p.length&&0===g.length)return null;var v=r.svgRect.width||1,m=r.svgRect.height||1,y=[],_=function(e,t,n,r){var i="".concat(l,"-").concat(t,"-").concat(y.length),a=n/2,s="end"===t?n:0,c="M0 0 L ".concat(n," ").concat(a," L0 ").concat(n," Z"),u="M ".concat(n," 0 L0 ").concat(a," L ").concat(n," ").concat(n," Z"),d="end"===t?c:u;return y.push(o.createElement("marker",{key:i,id:i,markerWidth:n,markerHeight:n,viewBox:"0 0 ".concat(n," ").concat(n),refX:s,refY:a,orient:"auto",markerUnits:"userSpaceOnUse"},o.createElement("path",{d,fill:e,stroke:e,strokeWidth:r,strokeLinecap:"round",strokeLinejoin:"round"}))),i},x=g.map(function(e){var t,n;return"start"!==e.arrow&&"both"!==e.arrow||(t=_(e.strokeColor,"start",e.markerSize,e.markerStrokeWidth)),"end"!==e.arrow&&"both"!==e.arrow||(n=_(e.strokeColor,"end",e.markerSize,e.markerStrokeWidth)),o.createElement("line",{key:e.key,x1:e.start.x,y1:e.start.y,x2:e.end.x,y2:e.end.y,stroke:e.strokeColor,strokeWidth:e.strokeWidth,strokeDasharray:e.dashArray,strokeLinecap:"round",markerStart:t?"url(#".concat(t,")"):void 0,markerEnd:n?"url(#".concat(n,")"):void 0})}),b=g.length>0||p.length>0;return o.createElement("div",{className:a.root,role:"presentation","data-chart-annotation-layer":"true"},b&&o.createElement("svg",{className:a.connectorLayer,width:"100%",height:"100%",viewBox:"0 0 ".concat(v," ").concat(m),preserveAspectRatio:"none","data-chart-annotation-svg":"true"},y.length>0&&o.createElement("defs",null,y),x.length>0&&o.createElement("g",{"aria-hidden":"true",className:a.connectorGroup},x),p),f)});hh.displayName="ChartAnnotationLayer";var ph,fh,gh,vh=(0,xa.Z)(),mh=o.lazy(function(){return Promise.resolve().then(n.bind(n,497)).then(function(e){return{default:e.ChartHoverCard}})}),yh=function(e){function t(t){var n=e.call(this,t)||this;return n.minLegendContainerHeight=32,n._isRtl=(0,ba.jI)(),n._isFirstRender=!0,n._removalValueForTextTuncate=0,n._yAxisTickText=[],n.isIntegralDataset=!0,n.calculateMaxYAxisLabelLength=function(e){return Ju(n._yAxisTickText.map(function(e){return t=e,n.props.showYAxisLablesTooltip?function(e,t,n){return void 0===n&&(n="..."),e.length<=t?e:e.slice(0,t)+n}(t,n.props.noOfCharsToTruncate||4):t;var t}),".".concat(e," text"))},n._multiValueCallout=function(e){var t=n._yValueHoverSubCountsExists(e.YValueHover);return o.createElement("div",{className:n._classNames.calloutContentRoot},o.createElement("div",{className:n._classNames.calloutDateTimeContainer,style:t?{marginBottom:"11px"}:{}},o.createElement("div",(0,de.Cl)({className:n._classNames.calloutContentX},cd(e.xAxisCalloutAccessibilityData,"text",!1)),(0,Yu.c$)(e.hoverXValue,n.props.culture,n.props.useUTC))),o.createElement("div",{className:n._classNames.calloutInfoContainer,style:t?{display:"flex"}:{}},e.YValueHover&&e.YValueHover.map(function(e,r,i){var a=r+1===i.length,l=e.shouldDrawBorderBottom,s=void 0!==l&&l;return o.createElement("div",(0,de.Cl)({},cd(e.callOutAccessibilityData,"text",!1),{key:"callout-content-".concat(r),style:t?(0,de.Cl)({display:"inline-block"},s&&{borderBottom:"1px solid ".concat(n.props.theme.semanticColors.menuDivider),paddingBottom:"10px"}):(0,de.Cl)({},s&&{borderBottom:"1px solid ".concat(n.props.theme.semanticColors.menuDivider),paddingBottom:"10px"})}),n._getCalloutContent(e,r,t,a))}),!!e.descriptionMessage&&o.createElement("div",{className:n._classNames.descriptionMessage},e.descriptionMessage)))},n._getData=function(e,t,r){n.props.getGraphData&&n.props.getGraphData(e,t,n.state.containerHeight-n._removalValueForTextTuncate,n.state.containerWidth,n.xAxisElement,n.yAxisElement,r)},n._onChartLeave=function(){n.props.onChartMouseLeave&&n.props.onChartMouseLeave()},n._calculateChartMinWidth=function(){var e=n._calcMaxLabelWidthWithTransform(n._tickValues)+10,t=n.margins.left+n.margins.right+e*(n._tickValues.length-1);return[Hu.GroupedVerticalBarChart,Hu.VerticalBarChart,Hu.VerticalStackedBarChart].includes(n.props.chartType)&&(t+=16),t},n._getChartDescription=function(){return(n.props.chartTitle||"Chart. ")+n._getAxisTitle("X",n.props.xAxisTitle,n.props.xAxisType)+n._getAxisTitle("Y",n.props.yAxisTitle,n.props.yAxisType||Wu.NumericAxis)+(n.props.secondaryYScaleOptions?n._getAxisTitle("secondary Y",n.props.secondaryYAxistitle,Wu.NumericAxis):"")},n._getAxisTitle=function(e,t,n){return"The ".concat(e," axis displays ")+(t||(n===zu.StringAxis||n===Wu.StringAxis?"categories":n===zu.DateAxis||n===Wu.DateAxis?"time":"values"))+". "},n._calcMaxLabelWidthWithTransform=function(e){if(!n.props.wrapXAxisLables&&n.props.rotateXAxisLables&&n.props.xAxisType===zu.StringAxis){var t=Ju(e,".".concat(n._classNames.xAxis," text"));return Math.ceil(t*Math.cos(Math.PI/4))}if(n.props.showXAxisLablesTooltip){var r=e.map(function(e){var t=n.props.noOfCharsToTruncate||4;return e.toString().length>t?"".concat(e.toString().slice(0,t),"..."):e}),o=Ju(r,".".concat(n._classNames.xAxis," text"));return Math.ceil(o)}if(n.props.wrapXAxisLables){var i=[];e.forEach(function(e){i.push.apply(i,e.toString().split(/\s+/))});var a=Ju(i,".".concat(n._classNames.xAxis," text"));return Math.max(Math.ceil(a),10)}var l=Ju(e,".".concat(n._classNames.xAxis," text"));return Math.ceil(l)},n._transformXAxisLabels=function(){var e,t,r;if(n._removalValueForTextTuncate=0,n.props.wrapXAxisLables||n.props.showXAxisLablesTooltip){var o=void 0;n.props.xAxisType===zu.StringAxis&&(o=((null===(e=n.props.datasetForXAxisDomain)||void 0===e?void 0:e.length)||0)>1?n._xScale.step():n.state.containerWidth);var i={node:n.xAxisElement,xAxis:n._xScale,showXAxisLablesTooltip:n.props.showXAxisLablesTooltip||!1,noOfCharsToTruncate:n.props.noOfCharsToTruncate||4,width:o};n._removalValueForTextTuncate=null!==(t=function(e){var t=e.node,n=e.xAxis,r=e.noOfCharsToTruncate,o=e.showXAxisLablesTooltip,i=e.width,a=void 0===i?10:i;if(null!==t){var l=Rt(t).call(n),s=0,c=1;if(l.selectAll(".tick text").each(function(){var e=Rt(this),t=e.text(),n="".concat(e.text().slice(0,r),"..."),i=e.text().length,l=e.text().split(/\s+/).reverse(),s="",u=[],d=0,h=e.attr("y"),p=parseFloat(e.attr("dy")),f=e.text(null).append("tspan").attr("x",0).attr("y",h).attr("id","BaseSpan").attr("dy",p+"em").attr("data-",t);if(o&&i>r)f=e.append("tspan").attr("id","showDots").attr("x",0).attr("y",h).attr("dy",p+"em").text(n);else if(o&&i<=r)f=e.append("tspan").attr("id","LessLength").attr("x",0).attr("y",h).attr("dy",p+"em").text(t);else for(;s=l.pop();)u.push(s),f.text(u.join(" ")),f.node().getComputedTextLength()>a&&u.length>1&&(u.pop(),f.text(u.join(" ")),u=[s],f=e.append("tspan").attr("id","WordBreakId").attr("x",0).attr("y",h).attr("dy",1.1*++d+p+"em").text(s));c=Math.max(c,d+1)}),!o){var u=12,d=document.getElementById("WordBreakId"),h=d&&d.getBoundingClientRect(),p=h&&h.height;p>u&&(u=p),s=(c-1)*u}return s>0?s:0}}(i))&&void 0!==t?t:0}if(!n.props.wrapXAxisLables&&n.props.rotateXAxisLables&&n.props.xAxisType===zu.StringAxis){var a=null!==(r=function(e){var t=e.node,n=e.xAxis;if(null!==t&&null!==n){var r=0,o=[];Rt(t).call(n).selectAll(".tick").each(function(){var e=this.getAttribute("transform");if(-1===(null==e?void 0:e.indexOf("rotate"))){var t=e.substring(e.indexOf("(")+1,e.indexOf(")")).split(",");2===t.length&&(o.push(t[0]),this.setAttribute("transform","translate(".concat(t[0],",0)rotate(-45)")))}var n=this.getBoundingClientRect(),i=n&&n.height;i>r&&(r=i)});var i=0;return Rt(t).call(n).selectAll(".tick").each(function(){o.length>i&&(this.setAttribute("transform","translate(".concat(o[i],",").concat(r/2,")rotate(-45)")),i+=1)}),Math.floor(r/1.414)}}({node:n.xAxisElement,xAxis:n._xScale}))&&void 0!==r?r:0;n._removalValueForTextTuncate=a+n.margins.bottom}},n._calcMargins=function(){var e=n._getDefaultMargins();return e=n._applyTitleMargins(e),e=n._applyAnnotationMargins(e),n._isRtl&&(e=n._swapRtlMargins(e)),(0,de.Cl)((0,de.Cl)({},e),n.props.margins)},n._getDefaultMargins=function(){return{top:20,bottom:35,left:Math.max(40,n.state.startFromX+20),right:n.props.secondaryYScaleOptions?40:20}},n._applyTitleMargins=function(e){var t=(0,de.Cl)({},e);return void 0!==n.props.xAxisTitle&&""!==n.props.xAxisTitle&&(t.bottom+=20),void 0!==n.props.yAxisTitle&&""!==n.props.yAxisTitle&&(t.left+=24),void 0!==n.props.secondaryYAxistitle&&""!==n.props.secondaryYAxistitle&&(t.right+=24),t},n._applyAnnotationMargins=function(e){var t=(0,de.Cl)({},e);return void 0!==n.props.xAxisAnnotation&&""!==n.props.xAxisAnnotation&&(t.top+=20),void 0===n.props.yAxisAnnotation||""===n.props.yAxisAnnotation||void 0!==n.props.secondaryYAxistitle&&""!==n.props.secondaryYAxistitle||(t.right+=24),t},n._swapRtlMargins=function(e){return(0,de.Cl)((0,de.Cl)({},e),{left:e.right,right:e.left})},n.state={containerHeight:0,containerWidth:0,_width:n.props.width||600,_height:n.props.height||350,startFromX:0},n.idForGraph=Ta("chart_"),n.idForDefaultTabbableElement=Ta("defaultTabbableElement_"),n._tooltipId=Ta("tooltip_"),n}return(0,de.C6)(t,e),t.prototype.componentDidMount=function(){if(this._fitParentContainer(),this.props.showYAxisLables){var e=this.calculateMaxYAxisLabelLength(this._classNames.yAxis);this.state.startFromX!==e&&this.setState({startFromX:e})}else 0!==this.state.startFromX&&this.setState({startFromX:0});this.isIntegralDataset=!this.props.points.some(function(e){return e.y%1!=0})},t.prototype.componentWillUnmount=function(){cancelAnimationFrame(this._reqID)},t.prototype.componentDidUpdate=function(e){if(e.height===this.props.height&&e.width===this.props.width||this._fitParentContainer(),this.props.showYAxisLables){var t=this.calculateMaxYAxisLabelLength(this._classNames.yAxis);this.state.startFromX!==t&&this.setState({startFromX:t})}else 0!==this.state.startFromX&&this.setState({startFromX:0});e.points!==this.props.points&&(this.isIntegralDataset=!this.props.points.some(function(e){return e.y%1!=0}))},t.prototype.render=function(){var e,t,n,r,i,a,l,s,c,u,d=this,h=this.props,p=h.calloutProps,f=h.points,g=h.chartType,v=h.chartHoverProps,m=h.svgFocusZoneProps,y=h.svgProps,_=h.culture,x=h.dateLocalizeOptions,b=h.timeFormatLocale,C=h.customDateTimeFormatter;this.props.parentRef&&this._fitParentContainer(),this.margins=this._calcMargins(),this.props.getmargins&&this.props.getmargins(this.margins),this._classNames=vh(this.props.styles,{theme:this.props.theme,width:this.state._width,height:this.state._height,className:this.props.className,isRtl:this._isRtl,enableReflow:this.props.enableReflow});var k,w,E,S,T,D,M,A=null,L=null;if(this.props.enableFirstRenderOptimization&&this.chartContainer||!this.props.enableFirstRenderOptimization){this._isFirstRender=!1;var P=(0,de.Cl)({domainNRangeValues:this.props.getDomainNRangeValues(f,this.props.getDomainMargins?this.props.getDomainMargins(this.state.containerWidth):this.margins,this.state.containerWidth,g,this._isRtl,this.props.xAxisType,this.props.barwidth,this.props.tickValues),containerHeight:this.state.containerHeight-this._removalValueForTextTuncate,margins:this.margins,xAxisElement:this.xAxisElement,showRoundOffXTickValues:null===(i=this.props.showRoundOffXTickValues)||void 0===i||i,xAxisCount:this.props.xAxisTickCount,xAxistickSize:this.props.xAxistickSize,tickPadding:this.props.tickPadding||this.props.showXAxisLablesTooltip?5:10,xAxisPadding:this.props.xAxisPadding,xAxisInnerPadding:this.props.xAxisInnerPadding,xAxisOuterPadding:this.props.xAxisOuterPadding,containerWidth:this.state.containerWidth,hideTickOverlap:this.props.hideTickOverlap,calcMaxLabelWidth:this._calcMaxLabelWidthWithTransform},this.props.xAxis),I=void 0,N=void 0;switch(this.props.xAxisType){case zu.NumericAxis:I=(e=qu(P,this.props.tickParams,this.props.chartType,_,this.props.xScaleType)).xScale,N=e.tickValues;break;case zu.DateAxis:I=(t=function(e,t,n,r,o,i,a,l){var s=e.domainNRangeValues,c=e.xAxisElement,u=e.tickPadding,d=void 0===u?6:u,h=e.xAxistickSize,p=void 0===h?6:h,f=e.xAxisCount,g=e.calcMaxLabelWidth,v=e.tickStep,m=e.tick0,y=e.tickText,_=a?pa():ha();_.domain([s.dStartValue,s.dEndValue]).range([s.rStartValue,s.rEndValue]).nice();var x=null!=f?f:6,b=100,C=-1,k=o?zo(o):void 0;_.ticks().forEach(function(e){var t=function(e,t){var n,r=Mr,o=t?Lr:Ar,i=t?Ir:Pr,a=t?Or:Nr,l=t?eo:Qr,s=t?Xr:Vr,c=t?no:to,u=[{formatLevel:0,condition:function(e){return r(e)<e}},{formatLevel:1,condition:function(e){return o(e)<e}},{formatLevel:2,condition:function(e){return i(e)<e}},{formatLevel:3,condition:function(e){return a(e)<e}},{formatLevel:4,condition:function(e){return l(e)<e&&s(e)<e}},{formatLevel:5,condition:function(e){return l(e)<e}},{formatLevel:6,condition:function(e){return c(e)<e}},{formatLevel:7,condition:function(){return!0}}].find(function(t){return(0,t.condition)(e)});return null!==(n=null==u?void 0:u.formatLevel)&&void 0!==n?n:7}(e,a);t>C&&(C=t),t<b&&(b=t)});var w=null!=r?r:(0,Yu.c2)(b,C),E=function(e,t,n,r){var o="%c",i="%a %d, %X",a="%b %d, %X",l="%-I:%M %p",s="%b %d, %-I:%M %p",c="%b %d, %-I %p",u="%b %d";return(n?r?n.utcFormat:n.format:r?jo:Yo)([[".%L",":%S.%L","%M:%S.%L","%-I:%M:%S.%L %p",i,a,a,o],[o,":%S","%-I:%M:%S","%X",i,a,a,o],[o,o,l,l,"%a %d, %-I:%M %p",s,s,"%x, %-I:%M %p"],[o,o,o,"%-I %p","%a %d, %-I %p",c,c,"%x, %-I %p"],[o,o,o,o,"%a %d",u,u,"%x"],[o,o,o,o,o,u,u,"%x"],[o,o,o,o,o,o,"%B","%b %Y"],[o,o,o,o,o,o,o,"%Y"]][e][t])}(b,C,k,a),S=function(e,r){return t.tickValues&&y&&void 0!==y[r]?y[r]:i?i(e):o?E(e):void 0===n&&t.tickFormat?a?jo(t.tickFormat)(e):Yo(t.tickFormat)(e):(0,Yu.Yn)(e,n,a,!1,w)},T=g(_.ticks().map(S))+40,D=_.range(),M=D[0],A=D[1],L=Math.min(Math.max(1,Math.floor(Math.abs(A-M)/T)),10);x=Math.min(L,null!=f?f:x);var P,I=gu(_).tickSize(p).tickPadding(d).ticks(x).tickFormat(S);[Hu.GanttChart].includes(l)&&I.tickSizeInner(-(e.containerHeight-e.margins.top)),t.tickValues?P=t.tickValues:v&&(P=Ad(v,m,_.domain(),a)),P&&I.tickValues(P),c&&Rt(c).call(I).selectAll("text").attr("aria-hidden","true");var N=(null!=P?P:_.ticks(x)).map(I.tickFormat());return{xScale:_,tickValues:N}}(P,this.props.tickParams,_,x,b,C,this.props.useUTC,this.props.chartType)).xScale,N=t.tickValues;break;case zu.StringAxis:n=function(e,t,n){var r,o=e.domainNRangeValues,i=e.xAxistickSize,a=void 0===i?6:i,l=e.tickPadding,s=void 0===l?10:l,c=e.xAxisPadding,u=void 0===c?.1:c,d=e.xAxisInnerPadding,h=e.xAxisOuterPadding,p=e.containerWidth,f=e.hideTickOverlap,g=e.calcMaxLabelWidth,v=e.tickText,m=_a().domain(n).range([o.rStartValue,o.rEndValue]).paddingInner(void 0!==d?d:u).paddingOuter(void 0!==h?h:u),y=null!==(r=t.tickValues)&&void 0!==r?r:n;if(f){var _=[],x=y.map(function(e){return g([e])}),b=0,C=p,k=1,w=m.range();w[1]-w[0]<0&&(b=p,C=0,k=-1);for(var E=y.length-1;E>=0;E--){var S=m(y[E]);k*(S-k*x[E]/2-b)>=0&&k*(S+k*x[E]/2-C)<=0&&(_.push(y[E]),C=S-k*(x[E]/2+10))}y=_=_.reverse()}var T=gu(m).tickSize(a).tickPadding(s).tickValues(y).tickFormat(function(e,n){return t.tickValues&&v&&void 0!==v[n]?v[n]:e});return e.xAxisElement&&Rt(e.xAxisElement).call(T).selectAll("text").attr("aria-hidden","true"),{xScale:m,tickValues:y}}(P,this.props.tickParams,this.props.datasetForXAxisDomain),I=n.xScale,N=n.tickValues;break;default:I=(r=qu(P,this.props.tickParams,this.props.chartType,_,this.props.xScaleType)).xScale,N=r.tickValues}this._xScale=I,this._tickValues=N,this._transformXAxisLabels();var O=(0,de.Cl)({margins:this.props.getYDomainMargins?this.props.getYDomainMargins(this.state.containerHeight):this.margins,containerWidth:this.state.containerWidth,containerHeight:this.state.containerHeight-this._removalValueForTextTuncate,yAxisElement:this.yAxisElement,yAxisTickFormat:this.props.yAxisTickFormat,yAxisTickCount:this.props.yAxisTickCount,yMinValue:this.props.yMinValue||0,yMaxValue:this.props.yMaxValue||0,tickPadding:10,maxOfYVal:this.props.maxOfYVal,yMinMaxValues:this.props.getMinMaxOfYAxis(f,this.props.yAxisType),yAxisPadding:this.props.yAxisPadding||0,tickValues:this.props.yAxisTickValues},this.props.yAxis),F={yAxisDomainValues:[],yAxisTickText:[]};if(this.props.yAxisType&&this.props.yAxisType===Wu.StringAxis)k=this.props.createStringYAxis(O,this.props.stringDatasetForYAxisDomain,this._isRtl,F,this.props.barwidth,this.props.chartType);else{if(null===(a=this.props)||void 0===a?void 0:a.secondaryYScaleOptions){var R={margins:this.margins,containerWidth:this.state.containerWidth,containerHeight:this.state.containerHeight-this._removalValueForTextTuncate,yAxisElement:this.yAxisElementSecondary,yAxisTickFormat:this.props.yAxisTickFormat,yAxisTickCount:this.props.yAxisTickCount,yMinValue:(null===(l=this.props.secondaryYScaleOptions)||void 0===l?void 0:l.yMinValue)||0,yMaxValue:null!==(c=null===(s=this.props.secondaryYScaleOptions)||void 0===s?void 0:s.yMaxValue)&&void 0!==c?c:100,tickPadding:10,yMinMaxValues:this.props.getMinMaxOfYAxis(f,this.props.yAxisType,!0),yAxisPadding:this.props.yAxisPadding};w=this.props.createYAxis(R,this._isRtl,F,this.isIntegralDataset,!0,this.props.supportNegativeData,this.props.roundedTicks,this.props.secondaryYScaleType)}k=this.props.createYAxis(O,this._isRtl,F,this.isIntegralDataset,!1,this.props.supportNegativeData,this.props.roundedTicks,this.props.yScaleType)}if(this._yAxisTickText=F.yAxisTickText,this.props.getAxisData&&this.props.getAxisData(F),!this.props.showYAxisLablesTooltip)try{document.getElementById(this._tooltipId)&&document.getElementById(this._tooltipId).remove()}catch(e){}if(this.props.showYAxisLablesTooltip){k&&(E=this.yAxisElement,S=k,T=this.props.noOfCharsToTruncate||4,D=this.props.showYAxisLablesTooltip||!1,M=this._isRtl,null!==E&&Rt(E).call(S).selectAll(".tick text").each(function(){var e=Rt(this),t=e.text(),n=M?"...".concat(e.text().slice(0,T)):"".concat(e.text().slice(0,T),"..."),r=e.text().length,o=e.attr("y"),i=e.attr("x"),a=parseFloat(e.attr("dy"));e.text(null).append("tspan").attr("x",i).attr("y",o).attr("id","BaseSpan").attr("dy",a+"em").attr("data-",t),D&&r>T?e.append("tspan").attr("id","showDots").attr("x",i).attr("y",o).attr("dy",a+"em").attr("dx","0em").text(n):e.append("tspan").attr("id","LessLength").attr("x",i).attr("y",o).attr("dx","0em").text(t)}));var V=Rt(this.yAxisElement).call(k);try{document.getElementById(this._tooltipId)&&document.getElementById(this._tooltipId).remove()}catch(e){}var B={tooltipCls:this._classNames.tooltip,id:this._tooltipId,axis:V};V&&Qu(B)}this._getData(I,k,w),L=this.props.children((0,de.Cl)((0,de.Cl)({},this.state),{xScale:I,yScalePrimary:k,yScaleSecondary:w})),!this.props.hideTooltip&&p.isCalloutVisible&&(A=this._generateCallout(p,v))}var H,z={width:this.state.containerWidth,height:this.state.containerHeight},W=Math.max(0,z.width-this.margins.left-this.margins.right),Y=Math.max(0,z.height-this.margins.top-this.margins.bottom-this._removalValueForTextTuncate),j={x:this.margins.left,y:this.margins.top,width:W,height:Y},U=null!==(u=this.props.annotations)&&void 0!==u?u:[],X=U.length>0,q=X?{plotRect:j,svgRect:z,isRtl:this._isRtl,xScale:this._xScale,yScalePrimary:k,yScaleSecondary:w}:void 0;H=this.props.focusZoneDirection===Wc.vertical||this.props.focusZoneDirection?this.props.focusZoneDirection:Wc.horizontal;var G=z.width-this.margins.left-this.margins.right-16,K=z.height-this.margins.bottom-this.margins.top-this._removalValueForTextTuncate-16,Z=this.margins.top+8+K/2,$=this._isRtl?z.width-8:16,J=this._isRtl?16:z.width-8,Q={wrapContent:$u,theme:this.props.theme,showBackground:!0,className:this._classNames.svgTooltip};return o.createElement("div",{id:this.idForGraph,className:this._classNames.root,ref:function(e){d.chartContainer=e},onMouseLeave:this._onChartLeave},!this._isFirstRender&&o.createElement("div",{id:this.idForDefaultTabbableElement}),o.createElement(iu,(0,de.Cl)({direction:H,className:this._classNames.chartWrapper,defaultTabbableElement:"#".concat(this.idForDefaultTabbableElement)},m),this._isFirstRender&&o.createElement("div",{id:this.idForDefaultTabbableElement}),o.createElement("svg",(0,de.Cl)({width:z.width,height:z.height,role:"region","aria-label":this._getChartDescription(),style:{display:"block"},className:this._classNames.chart},fd(y)),o.createElement("g",{ref:function(e){d.xAxisElement=e},id:"xAxisGElement".concat(this.idForGraph),transform:"translate(0, ".concat(z.height-this.margins.bottom-this._removalValueForTextTuncate,")"),className:this._classNames.xAxis}),void 0!==this.props.xAxisTitle&&""!==this.props.xAxisTitle&&o.createElement(Jd,(0,de.Cl)({content:this.props.xAxisTitle,textProps:{x:this.margins.left+8+G/2,y:z.height-8,className:this._classNames.axisTitle,textAnchor:"middle","aria-hidden":!0},maxWidth:G},Q)),void 0!==this.props.xAxisAnnotation&&""!==this.props.xAxisAnnotation&&o.createElement(Jd,(0,de.Cl)({content:this.props.xAxisAnnotation,textProps:{x:this.margins.left+8+G/2,y:12,className:this._classNames.axisAnnotation,textAnchor:"middle","aria-hidden":!0},maxWidth:G},Q)),o.createElement("g",{ref:function(e){d.yAxisElement=e},id:"yAxisGElement".concat(this.idForGraph),transform:"translate(".concat(this._isRtl?z.width-this.margins.right:this.margins.left,", 0)"),className:this._classNames.yAxis}),this.props.secondaryYScaleOptions&&o.createElement("g",null,o.createElement("g",{ref:function(e){d.yAxisElementSecondary=e},id:"yAxisGElementSecondary".concat(this.idForGraph),transform:"translate(".concat(this._isRtl?this.margins.left:z.width-this.margins.right,", 0)"),className:this._classNames.yAxis}),void 0!==this.props.secondaryYAxistitle&&""!==this.props.secondaryYAxistitle&&o.createElement(Jd,(0,de.Cl)({content:this.props.secondaryYAxistitle,textProps:{x:J,y:Z,textAnchor:"middle",transform:"rotate(-90, ".concat(J,", ").concat(Z,")"),className:this._classNames.axisTitle,"aria-hidden":!0},maxWidth:K},Q))),L,void 0!==this.props.yAxisTitle&&""!==this.props.yAxisTitle&&o.createElement(Jd,(0,de.Cl)({content:this.props.yAxisTitle,textProps:{x:$,y:Z,textAnchor:"middle",transform:"rotate(-90, ".concat($,", ").concat(Z,")"),className:this._classNames.axisTitle,"aria-hidden":!0},maxWidth:K},Q)),void 0!==this.props.yAxisAnnotation&&""!==this.props.yAxisAnnotation&&(void 0===this.props.secondaryYAxistitle||""===this.props.secondaryYAxistitle)&&o.createElement(Jd,(0,de.Cl)({content:this.props.yAxisAnnotation,textProps:{x:J,y:Z,textAnchor:"middle",transform:"rotate(-90, ".concat(J,", ").concat(Z,")"),className:this._classNames.axisAnnotation,"aria-hidden":!0},maxWidth:K},Q))),X&&q&&o.createElement(hh,{annotations:U,context:q,theme:this.props.theme,className:this._classNames.annotationLayer})),!this.props.hideLegend&&o.createElement("div",{ref:function(e){d.legendContainer=e},className:this._classNames.legendContainer},this.props.legendBars),A&&o.createElement(o.Suspense,{fallback:o.createElement("div",null,"Loading...")},A))},t.prototype._generateCallout=function(e,t){return o.createElement(rc,(0,de.Cl)({hidden:!(!this.props.hideTooltip&&e.isCalloutVisible),shouldUpdateWhenHidden:!0},e),this.props.customizedCallout&&this.props.customizedCallout,!this.props.customizedCallout&&this.props.isCalloutForStack&&this._multiValueCallout(e),!this.props.customizedCallout&&!this.props.isCalloutForStack&&o.createElement(mh,(0,de.Cl)({XValue:e.XValue,Legend:e.legend,YValue:e.YValue,color:e.color,culture:this.props.culture},t)))},t.prototype._yValueHoverSubCountsExists=function(e){return!!e&&e.some(function(e){return e.yAxisCalloutData&&"string"!=typeof e.yAxisCalloutData})},t.prototype._getCalloutContent=function(e,t,n,r){var i,a=r?{}:{marginRight:"16px"},l=void 0!==e.index&&-1!==e.index,s=vh(this.props.styles,{theme:this.props.theme,width:this.state._width,height:this.state._height,className:this.props.className,isRtl:this._isRtl,lineColor:e.color,toDrawShape:l}),c=this.props,u=c.culture,d=c.useUTC,h=(0,Yu.c$)(e.y,u,d);if(e.yAxisCalloutData&&"string"!=typeof e.yAxisCalloutData){var p=e.yAxisCalloutData;return o.createElement("div",{style:a},o.createElement("div",{className:"ms-fontWeight-semibold",style:{fontSize:"12pt"}},e.legend," (",h,")"),Object.keys(p).map(function(e){return o.createElement("div",{key:e,className:s.calloutBlockContainer},o.createElement("div",{className:s.calloutlegendText},(0,Yu.c$)(e,u,d)),o.createElement("div",{className:s.calloutContentY},(0,Yu.c$)(p[e],u,d)))}))}return o.createElement("div",{style:n?a:{}},n&&o.createElement("div",{className:"ms-fontWeight-semibold",style:{fontSize:"12pt"}},e.legend," (",h,")"),o.createElement("div",{id:"".concat(t,"_").concat(e.y),className:s.calloutBlockContainer},l&&o.createElement(Id,{svgProps:{className:s.shapeStyles},pathProps:{fill:e.color},shape:id[e.index%Object.keys(sd).length]}),o.createElement("div",null,o.createElement("div",{className:s.calloutlegendText}," ",e.legend),o.createElement("div",{className:s.calloutContentY},(0,Yu.c$)(e.yAxisCalloutData?e.yAxisCalloutData:null!==(i=e.y)&&void 0!==i?i:e.data,u,d)))))},t.prototype._fitParentContainer=function(){var e=this,t=this.state,n=t.containerWidth,r=t.containerHeight;this._reqID=requestAnimationFrame(function(){var t;if(e.props.hideLegend)t=0;else{var o=e.legendContainer&&getComputedStyle(e.legendContainer);t=(e.legendContainer&&e.legendContainer.getBoundingClientRect().height||e.minLegendContainerHeight)+parseFloat(o&&o.marginTop||"0")+parseFloat(o&&o.marginBottom||"0")}if(e.props.parentRef||e.chartContainer){var i=e.props.parentRef?e.props.parentRef:e.chartContainer,a=e.props.enableReflow&&!e._isFirstRender?Math.max(i.getBoundingClientRect().width,e._calculateChartMinWidth()):i.getBoundingClientRect().width,l=i.getBoundingClientRect().height>t?i.getBoundingClientRect().height:350;(n!==a||r!==l-t)&&e.setState({containerWidth:a,containerHeight:l-t})}})},t}(o.Component);!function(e){e.shade30="#004578",e.shade20="#005a9e",e.shade10="#106ebe",e.primary="#0078d4",e.tint10="#2b88d8",e.tint20="#c7e0f4",e.tint30="#deecf9",e.tint40="#eff6fc"}(ph||(ph={})),function(e){e.black="#000000",e.gray220="#11100f",e.gray210="#161514",e.gray200="#1b1a19",e.gray190="#201f1e",e.gray180="#252423",e.gray170="#292827",e.gray160="#323130",e.gray150="#3b3a39",e.gray140="#484644",e.gray130="#605e5c",e.gray120="#797775",e.gray110="#8a8886",e.gray100="#979593",e.gray90="#a19f9d",e.gray80="#b3b0ad",e.gray70="#bebbb8",e.gray60="#c8c6c4",e.gray50="#d2d0ce",e.gray40="#e1dfdd",e.gray30="#edebe9",e.gray20="#f3f2f1",e.gray10="#faf9f8",e.white="#ffffff"}(fh||(fh={})),function(e){e.pinkRed10="#750b1c",e.red20="#a4262c",e.red10="#d13438",e.redOrange20="#603d30",e.redOrange10="#da3b01",e.orange30="#8e562e",e.orange20="#ca5010",e.orange10="#ffaa44",e.yellow10="#fce100",e.orangeYellow20="#986f0b",e.orangeYellow10="#c19c00",e.yellowGreen10="#8cbd18",e.green20="#0b6a0b",e.green10="#498205",e.greenCyan10="#00ad56",e.cyan40="#005e50",e.cyan30="#005b70",e.cyan20="#038387",e.cyan10="#00b7c3",e.cyanBlue20="#004e8c",e.cyanBlue10="#0078d4",e.blue10="#4f6bed",e.blueMagenta40="#373277",e.blueMagenta30="#5c2e91",e.blueMagenta20="#8764b8",e.blueMagenta10="#8378de",e.magenta20="#881798",e.magenta10="#c239b3",e.magentaPink20="#9b0062",e.magentaPink10="#e3008c",e.gray40="#393939",e.gray30="#7a7574",e.gray20="#69797e",e.gray10="#a0aeb2"}(gh||(gh={}));var _h,xh=function(e){return(0,de.Cl)((0,de.Cl)({},e.fonts.medium),{display:"flex",flexDirection:"column",padding:"8px",position:"absolute",textAlign:"center",top:"0px",background:e.semanticColors.bodyBackground,borderRadius:"2px",pointerEvents:"none",color:e.semanticColors.bodyText})},bh=function(e,t){var n;return[t,(n={textAlign:"center",fontWeight:Fa.BO.semibold,fontStyle:"normal",lineHeight:Fa.s.medium,color:fh.gray160,fill:e.semanticColors.bodyText},n[Fa.up]={fill:"CanvasText"},n)]},Ch=function(e){var t;return{fontSize:Fa.s.small,fontWeight:Fa.BO.semibold,fill:e.palette.neutralPrimary,selectors:(t={},t[Fa.up]={fill:"CanvasText"},t)}},kh=function(e){var t;return{fontSize:Fa.s.medium,fill:e.semanticColors.bodyText,textAnchor:"middle",selectors:(t={},t[Fa.up]={fill:"CanvasText"},t)}},wh=function(){var e,t=(0,Ca.z)();return!!(null===(e=null==t?void 0:t.navigator)||void 0===e?void 0:e.userAgent)&&t.navigator.userAgent.indexOf("rv:11.0")>-1}(),Eh=(0,ue.I)(yh,function(e){var t,n,r,o,i,a,l,s,c,u=e.className,d=e.theme,h=e.isRtl,p=e.shouldHighlight,f=e.href,g=e.lineColor,v=void 0===g?"transparent":g,m=e.toDrawShape,y=e.enableReflow,_=d.fonts;return{root:[d.fonts.medium,{display:"flex",width:"100%",height:"100%",flexDirection:"column",overflow:"hidden"},u],chartWrapper:(0,de.Cl)({position:"relative"},y?{overflow:"auto"}:{}),plotContainer:{position:"relative",width:"100%",height:"100%"},axisTitle:bh(d,d.fonts.xSmall),axisAnnotation:bh(d,d.fonts.small),xAxis:{selectors:{text:[d.fonts.tiny,{fill:d.semanticColors.bodyText,fontWeight:"600",selectors:(t={},t[Fa.up]={fill:"CanvasText"},t)}],line:{opacity:.2,stroke:d.semanticColors.bodyText,width:"1px",selectors:(n={},n[Fa.up]={opacity:.1,stroke:"CanvasText"},n)},path:{display:"none"}}},yAxis:{selectors:{text:[d.fonts.tiny,{fill:d.semanticColors.bodyText,fontWeight:"600",selectors:(r={},r[Fa.up]={fill:"CanvasText"},r)}],path:{display:"none"},line:{opacity:.2,stroke:d.semanticColors.bodyText,selectors:(o={},o[Fa.up]={opacity:.1,stroke:"CanvasText"},o)},g:[h&&!wh&&{textAnchor:"end"}]}},opacityChangeOnHover:{opacity:p?"":"0.1",cursor:f?"pointer":"default"},legendContainer:[{marginTop:"8px",marginLeft:"20px"}],calloutContentRoot:[{display:"grid",overflow:"hidden",padding:"11px 16px 10px 16px",backgroundColor:d.semanticColors.bodyBackground,backgroundBlendMode:"normal, luminosity"}],calloutDateTimeContainer:{display:"flex",flexDirection:"row",justifyContent:"space-between"},calloutContentX:[(0,de.Cl)((0,de.Cl)({},_.small),{lineHeight:"16px",opacity:"0.85",color:d.semanticColors.bodySubtext})],calloutBlockContainer:[d.fonts.mediumPlus,{marginTop:"13px",color:d.semanticColors.bodyText},!m&&{selectors:(i={},i[Fa.up]={forcedColorAdjust:"none"},i),borderLeft:"4px solid ".concat(v),paddingLeft:"8px"},m&&{display:"flex"}],shapeStyles:{marginRight:"8px"},calloutlegendText:(0,de.Cl)((0,de.Cl)({},_.small),{lineHeight:"16px",selectors:(a={},a[Fa.up]={color:"CanvasText"},a),color:d.semanticColors.bodySubtext}),calloutContentY:[(0,de.Cl)((0,de.Cl)({},_.mediumPlus),{fontWeight:"bold",lineHeight:"22px",selectors:(l={},l[Fa.up]={color:"CanvasText"},l)})],descriptionMessage:[d.fonts.small,{selectors:(s={},s[Fa.up]={color:"CanvasText"},s),color:d.semanticColors.bodyText,marginTop:"10px",paddingTop:"10px",borderTop:"1px solid ".concat(d.semanticColors.menuDivider)}],tooltip:xh(d),svgTooltip:(c={fill:d.semanticColors.bodyBackground},c[Fa.up]={fill:"Canvas"},c),annotationLayer:{pointerEvents:"none"}}}),Sh=Object.values({1:[["#4760D5","#637CEF"],["#4F6BED","#637CEF"]],2:[["#795AA6","#9373C0"],["#8764B8","#A083C9"]],3:[["#159195","#2AA0A4"],["#159195","#2AA0A4"]],4:[["#B146C2","#C36BD1"],["#B146C2","#C36BD1"]],5:[["#3487C7","#3A96DD"],["#3487C7","#3A96DD"]],6:[["#0E7A0B","#13A10E"],["#11910D","#27AC22"]],7:[["#E61C99","#EE5FB7"],["#E61C99","#EE5FB7"]],8:[["#CA5010","#D77440"],["#CA5010","#D77440"]],9:[["#57811B","#689920"],["#57811B","#689920"]],10:[["#937700","#AE8C00"],["#937700","#AE8C00"]]}),Th=(Object.values({gradient1:"default.1",gradient2:"default.2",gradient3:"default.3",gradient4:"default.4",gradient5:"default.5",gradient6:"default.6",gradient7:"default.7",gradient8:"default.8",gradient9:"default.9",gradient10:"default.10",gradient1Ext:"extended.1",gradient2Ext:"extended.2",gradient3Ext:"extended.3",gradient4Ext:"extended.4",gradient5Ext:"extended.5",gradient6Ext:"extended.6",gradient7Ext:"extended.7",gradient8Ext:"extended.8",gradient9Ext:"extended.9",gradient10Ext:"extended.10",success:"semantic.success",highSuccess:"semantic.highSuccess",warning:"semantic.warning",error:"semantic.error",highError:"semantic.highError",disabled:"semantic.disabled"}),function(e,t){if(0===e.length)return["",""];var n=Number(t);return n<e.length?e[n]:e[0]}),Dh=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=!1);var r=Sh[(e+t)%Sh.length];return Th(r,n)},Mh=function(e,t,n){return void 0===n&&(n=0),e-(t.left||0)-(t.right||0)-2*n},Ah=function(e,t){return e+t/(1-t)*(e-1)},Lh=function(e,t,n){return e*Ah(t,n)};!function(e){e.show="visibility",e.hide="hidden"}(_h||(_h={}));var Ph,Ih,Nh=(0,xa.Z)(),Oh=function(e){function t(t){var n,r=e.call(this,t)||this;return r._isRtl=(0,ba.jI)(),r.toImage=function(e){var t,n;return Od([{container:null===(t=r._cartesianChartRef.current)||void 0===t?void 0:t.chartContainer}],r.props.hideLegend||null===(n=r._legendsRef.current)||void 0===n?void 0:n.toSVG,r._isRtl,e)},r._getDomainNRangeValues=function(e,t,n,r,o,i,a,l){var s;return s=i===zu.NumericAxis?function(e,t,n,r){var o=he(e,function(e){return e.x}),i=pe(e,function(e){return e.x}),a=t.left,l=n-t.right;return r?{dStartValue:o,dEndValue:i,rStartValue:a,rEndValue:l}:{dStartValue:i,dEndValue:o,rStartValue:a,rEndValue:l}}(e,t,n,o):i===zu.DateAxis?nd(e,t,n,o,l,r):function(e,t,n){var r=e.left,o=t-e.right;return n?{dStartValue:0,dEndValue:0,rStartValue:o,rEndValue:r}:{dStartValue:0,dEndValue:0,rStartValue:r,rEndValue:o}}(t,n,o),s},r._createLine=function(e,t,n,i,a){var l;void 0===n&&(n=0),void 0===i&&(i=0);var s=r._xAxisType===zu.StringAxis,c=r._getScales(n,i).xBarScale,u=r._createColors(),d=r.props.theme,h=r.props,p=h.data,f=h.lineLegendColor,g=void 0===f?d.palette.yellow:f,v=h.lineLegendText,m=[],y=[];p&&p.forEach(function(e,t){var n;e.lineData&&e.lineData.y&&m.push({x:e.x,y:e.lineData.y,useSecondaryYScale:null!==(n=e.lineData.useSecondaryYScale)&&void 0!==n&&n,point:e,index:t})});var _=De().x(function(t){return s?c(t.x)+.5*c.bandwidth():e(t.x)}).y(function(e){return e.useSecondaryYScale&&a?a(e.y):t(e.y)}),x=!(!r._legendHighlighted(v)&&!r._noLegendHighlighted()),b=(null===(l=r.props.lineOptions)||void 0===l?void 0:l.lineBorderWidth)?Number.parseFloat(r.props.lineOptions.lineBorderWidth.toString()):0;b>0&&y.push(o.createElement("path",{key:Ta("_VBC_line_"),id:Ta("_VBC_line_"),opacity:x?1:.1,d:_(m),fill:"transparent",strokeLinecap:"square",strokeWidth:3+2*b,stroke:d.semanticColors.bodyBackground})),y.push(o.createElement("path",{key:Ta("_VBC_line_"),id:Ta("_VBC_line_"),opacity:x?1:.1,d:_(m),fill:"transparent",strokeLinecap:"square",strokeWidth:3,stroke:g}));var C=m.map(function(n,i){var l,d={refElement:null};return o.createElement("circle",{key:i,id:Ta("_VBC_point_"),cx:s?c(n.x)+.5*c.bandwidth():e(n.x),cy:n.useSecondaryYScale&&a?a(n.y):t(n.y),onMouseOver:r._legendHighlighted(v)?r._lineHover.bind(r,n.point):r._onBarHover.bind(r,n.point,u(n.y)),onMouseOut:r._onBarLeave,r:r._getCircleVisibilityAndRadius(n.x,v).radius,stroke:g,fill:r.props.theme.semanticColors.bodyBackground,strokeWidth:3,visibility:r._getCircleVisibilityAndRadius(n.x,v).visibility,onClick:null===(l=n.point.lineData)||void 0===l?void 0:l.onClick,"data-is-focusable":r._legendHighlighted(v),ref:function(e){d.refElement=e},onFocus:r._lineFocus.bind(r,n.point,d),onBlur:r._handleChartMouseLeave})});return o.createElement(o.Fragment,null,y,C)},r._getCircleVisibilityAndRadius=function(e,t){var n=r.state.activeXdataPoint;return r._noLegendHighlighted()?{visibility:n===e?_h.show:_h.hide,radius:8}:e===n&&r._legendHighlighted(t)?{visibility:_h.show,radius:8}:r._legendHighlighted(t)?{visibility:_h.show,radius:.3}:{visibility:_h.hide,radius:0}},r._checkForLine=function(){return r.props.data.some(function(e){var t;return void 0!==(null===(t=null==e?void 0:e.lineData)||void 0===t?void 0:t.y)})},r._getMargins=function(e){r.margins=e},r._renderContentForBothLineAndBars=function(e){var t=r._getCalloutContentForLineAndBar(e),n=t.YValueHover,i=t.hoverXValue,a=n.map(function(e,t){return o.createElement(Oa.ChartHoverCard,(0,de.Cl)({key:t,Legend:e.legend},0===t&&{XValue:"".concat(i||e.data)},{color:e.color,YValue:e.data||e.y,culture:r.props.culture}))});return o.createElement(o.Fragment,null,a)},r._renderContentForOnlyBars=function(e){var t=r.props.useSingleColor,n=void 0!==t&&t;return o.createElement(o.Fragment,null,o.createElement(Oa.ChartHoverCard,{XValue:e.xAxisCalloutData||e.x,Legend:e.legend,YValue:e.yAxisCalloutData||e.y,color:!n&&e.color?e.color:r._createColors()(e.y),culture:r.props.culture}))},r._renderCallout=function(e){return e?r._isHavingLine?r._renderContentForBothLineAndBars(e):r._renderContentForOnlyBars(e):null},r._getCustomizedCallout=function(){return r.props.onRenderCalloutPerDataPoint?r.props.onRenderCalloutPerDataPoint(r.state.dataPointCalloutProps,r._renderCallout):null},r._getGraphData=function(e,t,n,o,i){return r._bars=r._xAxisType===zu.NumericAxis?r._createNumericBars(n,o,i):r._xAxisType===zu.DateAxis?r._createDateBars(n,o,i):r._createStringBars(n,o,i)},r._refCallback=function(e,t){r._refArray.push({index:t,refElement:e})},r._getCalloutContentForLineAndBar=function(e){var t,n,o,i,a,l=[],s=r.props,c=s.theme,u=s.useSingleColor,d=void 0!==u&&u,h=s.enableGradient,p=r.props,f=p.data,g=p.lineLegendText,v=p.lineLegendColor,m=void 0===v?c.palette.yellow:v,y=f.filter(function(t){return t.x===e.x}),_=f.indexOf(y[0]),x=d?r._createColors()(1):y[0].color?y[0].color:r._createColors()(y[0].y);r._isHavingLine&&void 0!==(null===(t=y[0].lineData)||void 0===t?void 0:t.y)&&(r._legendHighlighted(g)||r._noLegendHighlighted())&&l.push({legend:g,color:m,y:null===(n=y[0].lineData)||void 0===n?void 0:n.y,data:null===(o=y[0].lineData)||void 0===o?void 0:o.yAxisCalloutData,yAxisCalloutData:null===(i=y[0].lineData)||void 0===i?void 0:i.yAxisCalloutData}),(r._legendHighlighted(y[0].legend)||r._noLegendHighlighted())&&l.push({legend:y[0].legend,y:y[0].y,color:h?d?Dh(0,0)[0]:(null===(a=y[0].gradient)||void 0===a?void 0:a[0])||Dh(_,0)[0]:x,data:y[0].yAxisCalloutData,yAxisCalloutData:y[0].yAxisCalloutData});var b=e.x instanceof Date?(0,Yu.Yn)(e.x,r.props.culture,r.props.useUTC):e.x.toString();return{YValueHover:l,hoverXValue:e.xAxisCalloutData||b}},r._onBarLeave=function(){},r._handleChartMouseLeave=function(){r._calloutAnchorPoint=null,r.setState({isCalloutVisible:!1,activeXdataPoint:null,YValueHover:[],hoverXValue:""})},r._onBarFocus=function(e,t,n){var o=r._getCalloutContentForLineAndBar(e),i=o.YValueHover,a=o.hoverXValue;r._refArray.forEach(function(o,l){o.index===e.legend&&t===l&&r.setState({refSelected:o.refElement,isCalloutVisible:r._noLegendHighlighted()||r._legendHighlighted(e.legend),calloutLegend:e.legend,dataForHoverCard:e.y,color:e.color||n,xCalloutValue:e.xAxisCalloutData||(e.x instanceof Date?(0,Yu.Yn)(e.x,r.props.culture,r.props.useUTC):e.x.toString()),yCalloutValue:e.yAxisCalloutData,dataPointCalloutProps:e,activeXdataPoint:e.x,YValueHover:i,hoverXValue:a,callOutAccessibilityData:e.callOutAccessibilityData})})},r._lineHover=function(e,t){t.persist(),r._lineHoverFocus(e,t)},r._lineFocus=function(e,t){t.refElement&&r._lineHoverFocus(e,t.refElement)},r._lineHoverFocus=function(e,t){var n=r.props.theme,o=r.props,i=o.lineLegendText,a=void 0===i?"":i,l=o.lineLegendColor,s=void 0===l?n.palette.yellow:l;r.setState({refSelected:t,isCalloutVisible:!0,calloutLegend:a,dataForHoverCard:e.lineData.y,color:s,xCalloutValue:e.xAxisCalloutData||(e.x instanceof Date?(0,Yu.Yn)(e.x,r.props.culture,r.props.useUTC):e.x.toString()),yCalloutValue:e.lineData.yAxisCalloutData,dataPointCalloutProps:e,activeXdataPoint:e.x})},r._getScales=function(e,t){var n,o=yr().domain([r.props.supportNegativeData?r._yMin:0,r._yMax]).range([0,e-r.margins.bottom-r.margins.top]);if(r._xAxisType===zu.NumericAxis){var i=he(r._points,function(e){return e.x}),a=pe(r._points,function(e){return e.x});n=yr().domain(r._isRtl?[i,a]:[a,i]).range([r.margins.left+r._domainMargin,t-r.margins.right-r._domainMargin]),pd(r.props.xAxisInnerPadding,r.props.xAxisPadding)||"histogram"===r.props.mode||n.nice()}else if(r._xAxisType===zu.DateAxis){var l=pe(r._points,function(e){return e.x}),s=he(r._points,function(e){return e.x});(n=r.props.useUTC?pa():ha()).domain([l,s]).range(r._isRtl?[t-r.margins.right-r._domainMargin,r.margins.left+r._domainMargin]:[r.margins.left+r._domainMargin,t-r.margins.right-r._domainMargin])}else n=_a().domain(r._xAxisLabels).range(r._isRtl?[t-r.margins.right-r._domainMargin,r.margins.left+r._domainMargin]:[r.margins.left+r._domainMargin,t-r.margins.right-r._domainMargin]).paddingInner(r._xAxisInnerPadding).paddingOuter(r._xAxisOuterPadding);return{xBarScale:n,yBarScale:o}},r._closeCallout=function(){r.setState({isCalloutVisible:!1})},r._getLegendData=function(e,t){var n=r.props,i=n.theme,a=n.useSingleColor,l=r.props,s=l.lineLegendText,c=l.lineLegendColor,u=void 0===c?i.palette.yellow:c,d=[],h={};if(e.forEach(function(e,t){var n,o,l,s=a?r._createColors()(1):e.color;if(r.props.enableGradient){var c=Math.max((null===(n=r.props.data)||void 0===n?void 0:n.findIndex(function(t){return t.legend===e.legend}))||0,0);s=(null===(o=e.gradient)||void 0===o?void 0:o[0])||Dh(c,0,null==i?void 0:i.isInverted)[0],a&&(s=Dh(0,0,null===(l=r.props.theme)||void 0===l?void 0:l.isInverted)[0])}h[e.legend]=s}),Object.entries(h).forEach(function(e){var t=e[0],n=e[1],o={title:t,color:n,hoverAction:function(){r._handleChartMouseLeave(),r._onLegendHover(t)},onMouseOutAction:function(){r._onLegendLeave()}};d.push(o)}),r._isHavingLine&&s&&u){var p={title:s,color:u,hoverAction:function(){r._handleChartMouseLeave(),r._onLegendHover(s)},onMouseOutAction:function(){r._onLegendLeave()},isLineLegendInBarChart:!0};d.unshift(p)}return o.createElement(Gd,(0,de.Cl)({legends:d,enabledWrapLines:r.props.enabledLegendsWrapLines,overflowProps:r.props.legendsOverflowProps,focusZonePropsInHoverCard:r.props.focusZonePropsForLegendsInHoverCard,overflowText:r.props.legendsOverflowText},r.props.legendProps,{onChange:r._onLegendSelectionChange.bind(r),ref:r._legendsRef}))},r._getAxisData=function(e){if(e&&e.yAxisDomainValues.length){var t=e.yAxisDomainValues;r._yMax=Math.max(t[t.length-1],r.props.yMaxValue||0),r._yMin=Math.min(t[0],r.props.yMinValue||0)}},r._legendHighlighted=function(e){return r._getHighlightedLegend().includes(e)},r._noLegendHighlighted=function(){return 0===r._getHighlightedLegend().length},r._getAriaLabel=function(e){var t,n,o,i=e.xAxisCalloutData?e.xAxisCalloutData:e.x instanceof Date?(0,Yu.Yn)(e.x,r.props.culture,r.props.useUTC):e.x,a=e.legend,l=e.yAxisCalloutData||e.y,s=r.props.lineLegendText||"Line",c=(null===(t=e.lineData)||void 0===t?void 0:t.yAxisCalloutData)||(null===(n=e.lineData)||void 0===n?void 0:n.y);return(null===(o=e.callOutAccessibilityData)||void 0===o?void 0:o.ariaLabel)||"".concat(i,". ")+(a?"".concat(a,", "):"")+"".concat(l,".")+(void 0!==c?" ".concat(s,", ").concat(c,"."):"")},r._getDomainMargins=function(e){var t;r._domainMargin=8;var n={};null===(t=r.props.data)||void 0===t||t.forEach(function(e){e.x instanceof Date?n[e.x.getTime()]=e.x:n[e.x]=e.x});var o=Object.values(n),i=Mh(e,r.margins,8);if(r._xAxisType===zu.StringAxis){if(pd(r.props.xAxisOuterPadding,r.props.xAxisPadding))r._domainMargin=0;else if("auto"!==r.props.barWidth&&"histogram"!==r.props.mode)r._barWidth=dd(r.props.barWidth,r.props.maxBarWidth),i>=(d=Lh(r._barWidth,o.length,r._xAxisInnerPadding))&&(r._domainMargin=8+(i-d)/2);else if(["plotly","histogram"].includes(r.props.mode)&&o.length>1){var a=function(e,t,n){return e/Ah(t,n)}(i,o.length,r._xAxisInnerPadding),l=dd(r.props.barWidth,r.props.maxBarWidth,a,r.props.mode),s=(i-(d=Lh(l,o.length,r._xAxisInnerPadding)))/2,c=Number.POSITIVE_INFINITY;if("histogram"!==r.props.mode){var u=Ju(o)+20;c=(i-(d=(o.length-r._xAxisInnerPadding)*u))/2}r._domainMargin=8+Math.max(0,Math.min(s,c))}}else{if("histogram"===r.props.mode){l=r.props.maxBarWidth;var d=Lh(l,o.length,r._xAxisInnerPadding);r._domainMargin+=Math.max(0,(i-d)/2)}r._barWidth=dd(r.props.barWidth,r.props.maxBarWidth,function(e,t,n){var r=function(e){if(!(e.length<2)){e=e.sort(function(e,t){return e instanceof Date?e.getTime()-t.getTime():e-t});for(var t=Number.MAX_VALUE,n=1;n<e.length;n++){var r=e[n]instanceof Date?e[n].getTime()-e[n-1].getTime():e[n]-e[n-1];t=Math.min(t,r)}return[t,e[0]instanceof Date?e[e.length-1].getTime()-e[0].getTime():e[e.length-1]-e[0]]}}(e);if(!r||0===r[1])return 16;var o=r[0],i=r[1];return Math.floor(t*o*(1-n)/(i+o*(1-n)))}(o,Mh(e,r.margins,r._domainMargin),r._xAxisInnerPadding),r.props.mode),r._domainMargin+=r._barWidth/2}return(0,de.Cl)((0,de.Cl)({},r.margins),{left:r.margins.left+r._domainMargin,right:r.margins.right+r._domainMargin})},r._getChartTitle=function(){var e=r.props,t=e.chartTitle,n=e.data;return(t?"".concat(t,". "):"")+"Vertical bar chart with ".concat((null==n?void 0:n.length)||0," bars")+(r._isHavingLine?" and 1 line":"")+". "},r._getOrderedXAxisLabels=function(){return r._xAxisType!==zu.StringAxis?[]:function(e,t){if(Array.isArray(t)){var n=[],r=new Set;return t.forEach(function(t){e[t]&&!r.has(t)&&(n.push(t),r.add(t))}),Object.keys(e).forEach(function(e){r.has(e)||n.push(e)}),n}var o=null==t?void 0:t.match(xd);if(o){var i=o[1],a=o[2];if("category"===i){var l=Object.keys(e).sort();return"descending"===a?l.reverse():l}var s={min:pe,max:he,sum:mu,total:mu,mean:yu,median:Cu},c=[];return Object.keys(e).forEach(function(t){c.push([t,s[i](e[t])||0])}),c.sort("descending"===a?function(e,t){return t[1]-e[1]}:function(e,t){return e[1]-t[1]}),c.map(function(e){return e[0]})}return Object.keys(e)}(r._mapCategoryToValues(),r.props.xAxisCategoryOrder)},r._mapCategoryToValues=function(){var e={};return r._points.forEach(function(t){var n=t.x;e[n]||(e[n]=[]),e[n].push(t.y),t.lineData&&e[n].push(t.lineData.y)}),e},Aa(r),r.state={color:"",dataForHoverCard:0,isCalloutVisible:!1,refSelected:null,selectedLegends:(null===(n=t.legendProps)||void 0===n?void 0:n.selectedLegends)||[],activeLegend:void 0,xCalloutValue:"",yCalloutValue:"",activeXdataPoint:null,YValueHover:[],hoverXValue:"",calloutLegend:""},r._isHavingLine=r._checkForLine(),r._calloutId=Ta("callout"),r._tooltipId=Ta("VCTooltipID_"),r._refArray=[],r._emptyChartId=Ta("_VBC_empty"),r._domainMargin=8,r._cartesianChartRef=o.createRef(),r._legendsRef=o.createRef(),r}return(0,de.C6)(t,e),t.prototype.componentDidUpdate=function(e){var t,n,r;gd(null===(t=e.legendProps)||void 0===t?void 0:t.selectedLegends,null===(n=this.props.legendProps)||void 0===n?void 0:n.selectedLegends)||this.setState({selectedLegends:(null===(r=this.props.legendProps)||void 0===r?void 0:r.selectedLegends)||[]})},t.prototype.render=function(){var e=this;this._adjustProps(),this._xAxisLabels=this._getOrderedXAxisLabels(),this._yMax=Math.max(he(this._points,function(e){return e.y}),this.props.yMaxValue||0),this._yMin=Math.min(pe(this._points,function(e){return e.y}),this.props.yMinValue||0);var t=this._getLegendData(this._points,this.props.theme.palette);this._classNames=Nh(this.props.styles,{theme:this.props.theme,legendColor:this.state.color});var n=(0,de.Cl)((0,de.Cl)((0,de.Cl)((0,de.Cl)({isCalloutVisible:this.state.isCalloutVisible,directionalHint:3,id:"toolTip".concat(this._calloutId),target:this.state.refSelected,isBeakVisible:!1},this._isHavingLine&&{YValueHover:this.state.YValueHover,hoverXValue:this.state.hoverXValue}),{gapSpace:15,color:this.state.color,legend:this.state.calloutLegend,XValue:this.state.xCalloutValue,YValue:this.state.yCalloutValue?this.state.yCalloutValue:this.state.dataForHoverCard,onDismiss:this._closeCallout,preventDismissOnLostFocus:!0}),this.props.calloutProps),cd(this.state.callOutAccessibilityData)),r={tickValues:this.props.tickValues,tickFormat:this.props.tickFormat};return this._isChartEmpty()?o.createElement("div",{id:this._emptyChartId,role:"alert",style:{opacity:"0"},"aria-label":"Graph has no data to display"}):o.createElement(Eh,(0,de.Cl)({},this.props,{chartTitle:this._getChartTitle(),points:this._points,supportNegativeData:this.props.supportNegativeData,chartType:Hu.VerticalBarChart,xAxisType:this._xAxisType,createYAxis:Gu,calloutProps:n,tickParams:r},this._isHavingLine&&(this._noLegendHighlighted()||this._getHighlightedLegend().length>1)&&{isCalloutForStack:!0},{legendBars:t,datasetForXAxisDomain:this._xAxisLabels,barwidth:this._barWidth,focusZoneDirection:Wc.horizontal,customizedCallout:this._getCustomizedCallout(),createStringYAxis:Ku,getmargins:this._getMargins,getMinMaxOfYAxis:od,getGraphData:this._getGraphData,getDomainNRangeValues:this._getDomainNRangeValues,getAxisData:this._getAxisData,onChartMouseLeave:this._handleChartMouseLeave,getDomainMargins:this._getDomainMargins},this._xAxisType===zu.StringAxis&&{xAxisInnerPadding:this._xAxisInnerPadding,xAxisOuterPadding:this._xAxisOuterPadding},{ref:this._cartesianChartRef,showRoundOffXTickValues:!pd(this.props.xAxisInnerPadding,this.props.xAxisPadding)&&"histogram"!==this.props.mode,children:function(t){return o.createElement(o.Fragment,null,o.createElement("g",null,e._bars),e._isHavingLine&&o.createElement("g",null,e._createLine(t.xScale,t.yScalePrimary,t.containerHeight,t.containerWidth,t.yScaleSecondary)))}}))},Object.defineProperty(t.prototype,"chartContainer",{get:function(){var e;return(null===(e=this._cartesianChartRef.current)||void 0===e?void 0:e.chartContainer)||null},enumerable:!1,configurable:!0}),t.prototype._adjustProps=function(){this._xAxisType=this.props.data&&this.props.data.length>0?ld(this.props.data[0].x,!0):zu.StringAxis,this._points=this.props.data||[],this._barWidth=dd(this.props.barWidth,this.props.maxBarWidth,void 0,this.props.mode);var e=this.props.theme.palette;this._colors=this.props.colors||[e.blueLight,e.blue,e.blueMid,e.blueDark],this._isHavingLine=this._checkForLine(),this._xAxisInnerPadding="histogram"===this.props.mode?0:hd(this.props.xAxisInnerPadding,this.props.xAxisPadding,this._xAxisType===zu.StringAxis?2/3:.5),this._xAxisOuterPadding=hd(this.props.xAxisOuterPadding,this.props.xAxisPadding,0)},t.prototype._createColors=function(){var e=this,t=this._colors.length<=1?1:1/(this._colors.length-1),n=this.props.useSingleColor;if(void 0!==n&&n)return function(t){var n=e.props,r=n.theme,o=n.colors;return o&&o.length>0?o[0]:r.palette.blueLight};for(var r=[],o=0;o<this._colors.length;o++)r.push(t*o*this._yMax);return yr().domain(r).range(this._colors)},t.prototype._onBarHover=function(e,t,n){n.persist();var r=this._getCalloutContentForLineAndBar(e),o=r.YValueHover,i=r.hoverXValue;this._calloutAnchorPoint!==e&&(this._calloutAnchorPoint=e,this.setState({refSelected:n,isCalloutVisible:this._noLegendHighlighted()||this._legendHighlighted(e.legend),dataForHoverCard:e.y,calloutLegend:e.legend,color:e.color||t,xCalloutValue:e.xAxisCalloutData||(e.x instanceof Date?(0,Yu.Yn)(e.x,this.props.culture,this.props.useUTC):e.x.toString()),yCalloutValue:e.yAxisCalloutData,dataPointCalloutProps:e,activeXdataPoint:this._noLegendHighlighted()||this._legendHighlighted(e.legend)?e.x:null,YValueHover:o,hoverXValue:i,callOutAccessibilityData:e.callOutAccessibilityData}))},t.prototype._calculateMinBarHeight=function(e,t,n,r){var o=t<0?Math.abs(e-n):Math.max(Math.abs(t-n),Math.abs(e-n));return Math.ceil(r(o)/100)},t.prototype._createNumericBars=function(e,t,n){var r=this,i=this.props.useSingleColor,a=void 0!==i&&i,l=this._getScales(e,t),s=l.xBarScale,c=l.yBarScale,u=this._createColors(),d=this._yMax<0?this._yMax:0,h=this._points.map(function(t,n){var i,l,h,p,f,g,v=!(!r._legendHighlighted(t.legend)&&!r._noLegendHighlighted());r._classNames=Nh(r.props.styles,{theme:r.props.theme,legendColor:r.state.color,shouldHighlight:v});var m=c(t.y)-c(d),y=m<0;m=Math.abs(m);var _=r._calculateMinBarHeight(r._yMin,r._yMax,d,c),x=m;if(0===m||y&&!r.props.supportNegativeData)return o.createElement(o.Fragment,{key:t.x}," ");m<=_&&(x=_);var b=s(t.x)-r._barWidth/2,C=e-r.margins.bottom-(y?-1*x:x)-c(d),k=e-r.margins.bottom-c(d),w=t.color&&!a?t.color:u(t.y),E=w;r.props.enableGradient&&(w=(null===(i=t.gradient)||void 0===i?void 0:i[0])||Dh(n,0,null===(l=r.props.theme)||void 0===l?void 0:l.isInverted)[0],E=(null===(h=t.gradient)||void 0===h?void 0:h[1])||Dh(n,0,null===(p=r.props.theme)||void 0===p?void 0:p.isInverted)[1],a&&(w=Dh(0,0,null===(f=r.props.theme)||void 0===f?void 0:f.isInverted)[0],E=Dh(0,0,null===(g=r.props.theme)||void 0===g?void 0:g.isInverted)[1]),r._points[n].color=w);var S=Ta("VBC_Gradient")+"_".concat(n,"_").concat(w);return o.createElement("g",{key:"".concat(t.x,"_").concat(n)},r.props.enableGradient&&o.createElement("defs",null,o.createElement("linearGradient",{id:S,x1:"0%",y1:"100%",x2:"0%",y2:"0%"},o.createElement("stop",{offset:"0",stopColor:w}),o.createElement("stop",{offset:"100%",stopColor:E}))),o.createElement("rect",{id:Ta("_VBC_bar_"),x:b,className:r._classNames.opacityChangeOnHover,y:y?k:C,width:r._barWidth,"data-is-focusable":!r.props.hideTooltip&&v,height:x,ref:function(e){r._refCallback(e,t.legend)},onClick:t.onClick,onMouseOver:r._onBarHover.bind(r,t,w),"aria-label":r._getAriaLabel(t),role:"img",onMouseLeave:r._onBarLeave,onFocus:r._onBarFocus.bind(r,t,n,w),onBlur:r._onBarLeave,fill:r.props.enableGradient?"url(#".concat(S,")"):w,rx:r.props.roundCorners?3:0}),r._renderBarLabel(b,C,t.y,t.legend,y))});if(!this.props.showXAxisLablesTooltip)try{document.getElementById(this._tooltipId)&&document.getElementById(this._tooltipId).remove()}catch(e){}if(!this.props.wrapXAxisLables&&this.props.showXAxisLablesTooltip){var p=Rt(n).call(s);try{document.getElementById(this._tooltipId)&&document.getElementById(this._tooltipId).remove()}catch(e){}var f={tooltipCls:this._classNames.tooltip,id:this._tooltipId,axis:p};p&&Qu(f)}return h},t.prototype._createStringBars=function(e,t,n){var r=this,i=this.props.useSingleColor,a=void 0!==i&&i,l=this._getScales(e,t),s=l.xBarScale,c=l.yBarScale,u=this._createColors(),d=this._yMax<0?this._yMax:0,h=this._points.map(function(t,n){var i,l,h,p,f,g,v=r._legendHighlighted(t.legend)||r._noLegendHighlighted();r._classNames=Nh(r.props.styles,{theme:r.props.theme,shouldHighlight:v});var m=c(t.y)-c(d),y=m<0;m=Math.abs(m);var _=r._calculateMinBarHeight(r._yMin,r._yMax,d,c),x=m;if(0===m||y&&!r.props.supportNegativeData)return o.createElement(o.Fragment,{key:t.x}," ");m<=_&&(x=_);var b=s(t.x),C=e-r.margins.bottom-(y?-1*x:x)-c(d),k=e-r.margins.bottom-c(d);r._barWidth=dd(r.props.barWidth,r.props.maxBarWidth,s.bandwidth(),r.props.mode);var w=t.color?t.color:u(t.y),E=w;r.props.enableGradient&&(w=(null===(i=t.gradient)||void 0===i?void 0:i[0])||Dh(n,0,null===(l=r.props.theme)||void 0===l?void 0:l.isInverted)[0],E=(null===(h=t.gradient)||void 0===h?void 0:h[1])||Dh(n,0,null===(p=r.props.theme)||void 0===p?void 0:p.isInverted)[1],a&&(w=Dh(0,0,null===(f=r.props.theme)||void 0===f?void 0:f.isInverted)[0],E=Dh(0,0,null===(g=r.props.theme)||void 0===g?void 0:g.isInverted)[1]),r._points[n].color=w);var S=Ta("VBC_Gradient")+"_".concat(n,"_").concat(w);return o.createElement("g",{key:t.x instanceof Date?"".concat(t.x.getTime(),"_").concat(n):"".concat(t.x,"_").concat(n),transform:"translate(".concat(.5*(s.bandwidth()-r._barWidth),", 0)")},r.props.enableGradient&&o.createElement("defs",null,o.createElement("linearGradient",{id:S,x1:"0%",y1:"100%",x2:"0%",y2:"0%"},o.createElement("stop",{offset:"0",stopColor:w}),o.createElement("stop",{offset:"100%",stopColor:E}))),o.createElement("rect",{id:Ta("_VBC_bar_"),x:b,className:r._classNames.opacityChangeOnHover,y:y?k:C,width:r._barWidth,height:x,"aria-label":r._getAriaLabel(t),role:"img",ref:function(e){r._refCallback(e,t.legend)},onClick:t.onClick,onMouseOver:r._onBarHover.bind(r,t,w),onMouseLeave:r._onBarLeave,onBlur:r._onBarLeave,"data-is-focusable":!r.props.hideTooltip&&v,onFocus:r._onBarFocus.bind(r,t,n,w),fill:r.props.enableGradient?"url(#".concat(S,")"):w,rx:r.props.roundCorners?3:0}),r._renderBarLabel(b,C,t.y,t.legend,y))});if(!this.props.showXAxisLablesTooltip)try{document.getElementById(this._tooltipId)&&document.getElementById(this._tooltipId).remove()}catch(e){}if(!this.props.wrapXAxisLables&&this.props.showXAxisLablesTooltip){var p=Rt(n).call(s);try{document.getElementById(this._tooltipId)&&document.getElementById(this._tooltipId).remove()}catch(e){}var f={tooltipCls:this._classNames.tooltip,id:this._tooltipId,axis:p,showTooltip:this.props.showXAxisLablesTooltip};p&&Qu(f)}return h},t.prototype._createDateBars=function(e,t,n){var r=this,i=this.props.useSingleColor,a=void 0!==i&&i,l=this._getScales(e,t),s=l.xBarScale,c=l.yBarScale,u=this._createColors(),d=this._yMax<0?this._yMax:0,h=this._points.map(function(t,n){var i,l,h,p,f,g,v=!(!r._legendHighlighted(t.legend)&&!r._noLegendHighlighted());r._classNames=Nh(r.props.styles,{theme:r.props.theme,legendColor:r.state.color,shouldHighlight:v});var m=c(t.y)-c(d),y=m<0;m=Math.abs(m);var _=r._calculateMinBarHeight(r._yMin,r._yMax,d,c),x=m;if(0===m||y&&!r.props.supportNegativeData)return o.createElement(o.Fragment,{key:t.x}," ");m<=_&&(x=_);var b=s(t.x)-r._barWidth/2,C=e-r.margins.bottom-(y?-1*x:x)-c(d),k=e-r.margins.bottom-c(d),w=t.color&&!a?t.color:u(t.y),E=w;r.props.enableGradient&&(w=(null===(i=t.gradient)||void 0===i?void 0:i[0])||Dh(n,0,null===(l=r.props.theme)||void 0===l?void 0:l.isInverted)[0],E=(null===(h=t.gradient)||void 0===h?void 0:h[1])||Dh(n,0,null===(p=r.props.theme)||void 0===p?void 0:p.isInverted)[1],a&&(w=Dh(0,0,null===(f=r.props.theme)||void 0===f?void 0:f.isInverted)[0],E=Dh(0,0,null===(g=r.props.theme)||void 0===g?void 0:g.isInverted)[1]),r._points[n].color=w);var S=Ta("VBC_Gradient")+"_".concat(n,"_").concat(w);return o.createElement("g",{key:t.x instanceof Date?"".concat(t.x.getTime(),"_").concat(n):"".concat(t.x,"_").concat(n)},r.props.enableGradient&&o.createElement("defs",null,o.createElement("linearGradient",{id:S,x1:"0%",y1:"100%",x2:"0%",y2:"0%"},o.createElement("stop",{offset:"0",stopColor:w}),o.createElement("stop",{offset:"100%",stopColor:E}))),o.createElement("rect",{id:Ta("_VBC_bar_"),x:b,className:r._classNames.opacityChangeOnHover,y:y?k:C,width:r._barWidth,"data-is-focusable":!r.props.hideTooltip&&v,height:x,ref:function(e){r._refCallback(e,t.legend)},onClick:t.onClick,onMouseOver:r._onBarHover.bind(r,t,w),"aria-label":r._getAriaLabel(t),role:"img",onMouseLeave:r._onBarLeave,onFocus:r._onBarFocus.bind(r,t,n,w),onBlur:r._onBarLeave,fill:r.props.enableGradient?"url(#".concat(S,")"):w,rx:r.props.roundCorners?3:0}),r._renderBarLabel(b,C,t.y,t.legend,y))});if(!this.props.showXAxisLablesTooltip)try{document.getElementById(this._tooltipId)&&document.getElementById(this._tooltipId).remove()}catch(e){}if(!this.props.wrapXAxisLables&&this.props.showXAxisLablesTooltip){var p=Rt(n).call(s);try{document.getElementById(this._tooltipId)&&document.getElementById(this._tooltipId).remove()}catch(e){}var f={tooltipCls:this._classNames.tooltip,id:this._tooltipId,axis:p};p&&Qu(f)}return h},t.prototype._onLegendHover=function(e){this.setState({activeLegend:e})},t.prototype._onLegendLeave=function(){this.setState({activeLegend:void 0})},t.prototype._onLegendSelectionChange=function(e,t,n){var r,o;(null===(r=this.props.legendProps)||void 0===r?void 0:r.canSelectMultipleLegends)?this.setState({selectedLegends:e}):this.setState({selectedLegends:e.slice(-1)}),(null===(o=this.props.legendProps)||void 0===o?void 0:o.onChange)&&this.props.legendProps.onChange(e,t,n)},t.prototype._getHighlightedLegend=function(){return this.state.selectedLegends.length>0?this.state.selectedLegends:this.state.activeLegend?[this.state.activeLegend]:[]},t.prototype._renderBarLabel=function(e,t,n,r,i){return this.props.hideLabels||this._barWidth<16||!this._legendHighlighted(r)&&!this._noLegendHighlighted()?null:o.createElement("text",{x:e+this._barWidth/2,y:i?t+12:t-6,textAnchor:"middle",className:this._classNames.barLabel,"aria-hidden":!0},"function"==typeof this.props.yAxisTickFormat?this.props.yAxisTickFormat(n):ud(n))},t.prototype._isChartEmpty=function(){return 0===this._points.length||this._points.every(function(e){return 0===e.y})&&!this._isHavingLine},t.defaultProps={maxBarWidth:24,useUTC:!0,xAxisCategoryOrder:"default"},t}(o.Component),Fh=(0,ue.I)(Oh,function(e){var t=e.shouldHighlight,n=e.theme;return{opacityChangeOnHover:{opacity:t?"":"0.1"},xAxisTicks:[],yAxisTicks:[{transform:"scaleX(-1)"}],yAxisDomain:[{transform:"scaleX(-1)"}],tooltip:xh(n),barLabel:Ch(n)}});function Rh(e){return function(e){return e.clientWidth<e.scrollWidth}(e)||function(e){return e.clientHeight<e.scrollHeight}(e)}!function(e){e.PartToWhole="part-to-whole",e.AbsoluteScale="absolute-scale"}(Ph||(Ph={})),function(e){e[e.Parent=0]="Parent",e[e.Self=1]="Self"}(Ih||(Ih={}));var Vh=(0,xa.Z)(),Bh=function(e){function t(n){var r=e.call(this,n)||this;return r._tooltipHost=o.createRef(),r._defaultTooltipId=Ta("tooltip"),r.show=function(){r._toggleTooltip(!0)},r.dismiss=function(){r._hideTooltip()},r._getTargetElement=function(){if(r._tooltipHost.current){var e=r.props.overflowMode;if(void 0!==e)switch(e){case Ih.Parent:return r._tooltipHost.current.parentElement;case Ih.Self:return r._tooltipHost.current}return r._tooltipHost.current}},r._onTooltipFocus=function(e){r._ignoreNextFocusEvent?r._ignoreNextFocusEvent=!1:r._onTooltipMouseEnter(e)},r._onTooltipContentFocus=function(e){t._currentVisibleTooltip&&t._currentVisibleTooltip!==r&&t._currentVisibleTooltip.dismiss(),t._currentVisibleTooltip=r,r._clearDismissTimer(),r._clearOpenTimer()},r._onTooltipBlur=function(e){var t;r._ignoreNextFocusEvent=(null===(t=hs(r.context))||void 0===t?void 0:t.activeElement)===e.target,r._dismissTimerId=r._async.setTimeout(function(){r._hideTooltip()},0)},r._onTooltipMouseEnter=function(e){var n=r.props,o=n.overflowMode,i=n.delay,a=hs(r.context);if(t._currentVisibleTooltip&&t._currentVisibleTooltip!==r&&t._currentVisibleTooltip.dismiss(),t._currentVisibleTooltip=r,void 0!==o){var l=r._getTargetElement();if(l&&!Rh(l))return}if(!e.target||!Uc(e.target,r._getTargetElement(),a))if(r._clearDismissTimer(),r._clearOpenTimer(),i!==Yd.zero){var s=r._getDelayTime(i);r._openTimerId=r._async.setTimeout(function(){r._toggleTooltip(!0)},s)}else r._toggleTooltip(!0)},r._onTooltipMouseLeave=function(e){var n=r.props.closeDelay;r._clearDismissTimer(),r._clearOpenTimer(),n?r._dismissTimerId=r._async.setTimeout(function(){r._toggleTooltip(!1)},n):r._toggleTooltip(!1),t._currentVisibleTooltip===r&&(t._currentVisibleTooltip=void 0)},r._onTooltipKeyDown=function(e){(e.which===Va||e.ctrlKey)&&r.state.isTooltipVisible&&(r._hideTooltip(),e.stopPropagation())},r._clearDismissTimer=function(){r._async.clearTimeout(r._dismissTimerId)},r._clearOpenTimer=function(){r._async.clearTimeout(r._openTimerId)},r._hideTooltip=function(){r._clearOpenTimer(),r._clearDismissTimer(),r._toggleTooltip(!1)},r._toggleTooltip=function(e){r.state.isTooltipVisible!==e&&r.setState({isTooltipVisible:e},function(){return r.props.onTooltipToggle&&r.props.onTooltipToggle(e)})},r._getDelayTime=function(e){switch(e){case Yd.medium:return 300;case Yd.long:return 500;default:return 0}},Aa(r),r.state={isAriaPlaceholderRendered:!1,isTooltipVisible:!1},r}return(0,de.C6)(t,e),t.prototype.render=function(){var e=this.props,t=e.calloutProps,n=e.children,r=e.content,i=e.directionalHint,a=e.directionalHintForRTL,l=e.hostClassName,s=e.id,c=e.setAriaDescribedBy,u=void 0===c||c,d=e.tooltipProps,h=e.styles,p=e.theme;this._classNames=Vh(h,{theme:p,className:l});var f=this.state.isTooltipVisible,g=s||this._defaultTooltipId,v=(0,de.Cl)((0,de.Cl)({id:"".concat(g,"--tooltip"),content:r,targetElement:this._getTargetElement(),directionalHint:i,directionalHintForRTL:a,calloutProps:za({},t,{onDismiss:this._hideTooltip,onFocus:this._onTooltipContentFocus,onMouseEnter:this._onTooltipMouseEnter,onMouseLeave:this._onTooltipMouseLeave}),onMouseEnter:this._onTooltipMouseEnter,onMouseLeave:this._onTooltipMouseLeave},Qa(this.props,Ja,["id"])),d),m=(null==d?void 0:d.onRenderContent)?d.onRenderContent(v,function(e){return(null==e?void 0:e.content)?o.createElement(o.Fragment,null,e.content):null}):r,y=f&&!!m,_=u&&f&&m?g:void 0;return o.createElement("div",{className:this._classNames.root,ref:this._tooltipHost,onFocusCapture:this._onTooltipFocus,onBlurCapture:this._onTooltipBlur,onMouseEnter:this._onTooltipMouseEnter,onMouseLeave:this._onTooltipMouseLeave,onKeyDown:this._onTooltipKeyDown,role:"none","aria-describedby":_},n,y&&o.createElement($d,(0,de.Cl)({},v)),o.createElement("div",{hidden:!0,id:g,style:Fa.dX},m))},t.prototype.componentDidMount=function(){this._async=new Ba(this)},t.prototype.componentWillUnmount=function(){t._currentVisibleTooltip&&t._currentVisibleTooltip===this&&(t._currentVisibleTooltip=void 0),this._async.dispose()},t.defaultProps={delay:Yd.medium},t.contextType=os,t}(o.Component),Hh={root:"ms-TooltipHost",ariaPlaceholder:"ms-TooltipHost-aria-placeholder"},zh=(0,ue.I)(Bh,function(e){var t=e.className,n=e.theme;return{root:[(0,Fa.Km)(Hh,n).root,{display:"inline"},t]}},void 0,{scope:"TooltipHost"}),Wh=function(e){function t(t){var n=e.call(this,t)||this;return n._tooltipChild=o.createRef(),n._checkTextOverflow=function(){var e=n._getTargetElement(),t=!!e&&Rh(e);t!==n.state.textOverflow&&n.setState({textOverflow:t})},n._getTargetElement=function(){if(n._tooltipChild.current&&n._tooltipChild.current.parentElement)return n._tooltipChild.current.parentElement},n.state={textOverflow:!1},n._async=new Ba(n),n}return(0,de.C6)(t,e),t.prototype.render=function(){var e=this.props,t=e.className,n=e.content,r=e.accessibilityData;return o.createElement(zh,{overflowMode:Ih.Self,hostClassName:t,content:n},o.createElement("span",(0,de.Cl)({},cd(r),{ref:this._tooltipChild,"data-is-focusable":this.state.textOverflow}),n))},t.prototype.componentDidMount=function(){var e=this._getTargetElement();window.ResizeObserver&&e&&(this._resizeObserver=new ResizeObserver(this._async.debounce(this._checkTextOverflow,500)),this._resizeObserver.observe(e))},t.prototype.componentWillUnmount=function(){var e;null===(e=this._resizeObserver)||void 0===e||e.disconnect(),this._async.dispose()},t}(o.Component),Yh=(0,xa.Z)(),jh=function(e){function t(t){var n=e.call(this,t)||this;return n._isRTL=(0,ba.jI)(),n._handleChartMouseLeave=function(){n._calloutAnchorPoint=null,n.state.isCalloutVisible&&n.setState({isCalloutVisible:!1,hoverValue:"",refSelected:null,lineColor:"",legend:""})},n._adjustProps=function(){n._barHeight=n.props.barHeight||12,n._classNames=Yh(n.props.styles,{theme:n.props.theme,width:n.props.width,className:n.props.className,barHeight:n._barHeight,color:n.state.lineColor,variant:n.props.variant,hideLabels:n.props.hideLabels})},n._getChartDataText=function(e){return n.props.barChartCustomData?o.createElement("div",{role:"text"},n.props.barChartCustomData(e)):n._getDefaultTextData(e)},n._closeCallout=function(){n.setState({isCalloutVisible:!1})},n._getAriaLabel=function(e){var t,n=e.xAxisCalloutData||e.legend,r=e.data,o=e.yAxisCalloutData||(e.horizontalBarChartdata?"".concat(e.horizontalBarChartdata.x,"/").concat(e.horizontalBarChartdata.y):0);return(null===(t=e.callOutAccessibilityData)||void 0===t?void 0:t.ariaLabel)||(n?"".concat(n,", "):"")+"".concat(o,".")+(r?"with benchmark at "+"".concat(r,", "):"")},n.state={isCalloutVisible:!1,hoverValue:"",lineColor:"",legend:"",refSelected:null,color:"",xCalloutValue:"",yCalloutValue:"",barSpacingInPercent:0},n._refArray=[],n._uniqLineText="_HorizontalLine_"+Math.random().toString(36).substring(7),n._hoverOff=n._hoverOff.bind(n),n._calloutId=Ta("callout"),n._emptyChartId=Ta("_HBC_empty"),n.barChartSvgRef=o.createRef(),n}return(0,de.C6)(t,e),t.prototype.componentDidMount=function(){var e,t=(null===(e=this.barChartSvgRef.current)||void 0===e?void 0:e.getBoundingClientRect().width)||0;if(t){var n=3/t*100;this.setState({barSpacingInPercent:n})}},t.prototype.render=function(){var e=this,t=this.props,n=t.data,r=t.theme;this._adjustProps();var i=r.palette,a=0;return this._isChartEmpty()?o.createElement("div",{id:this._emptyChartId,role:"alert",style:{opacity:"0"},"aria-label":"Graph has no data to display"}):o.createElement("div",{className:this._classNames.root,onMouseLeave:this._handleChartMouseLeave},n.map(function(t,n){a=t.chartData&&t.chartData[0]&&t.chartData[0].horizontalBarChartdata.x?t.chartData[0].horizontalBarChartdata.x:0,t.chartData[1]={legend:"",horizontalBarChartdata:{x:t.chartData[0].horizontalBarChartdata.y-a,y:t.chartData[0].horizontalBarChartdata.y},color:i.neutralLight};var r=e.props.variant===Ph.AbsoluteScale?null:e._getChartDataText(t),l=e._createBars(t,i,n),s=e._uniqLineText+"_"+n,c=Yh(e.props.styles,{theme:e.props.theme,width:e.props.width,showTriangle:!!t.chartData[0].data,variant:e.props.variant});return o.createElement("div",{key:n},o.createElement("div",{className:c.items},o.createElement(iu,{direction:Wc.horizontal},o.createElement("div",{className:e._classNames.chartTitle},t.chartTitle&&o.createElement(Wh,{className:e._classNames.chartTitleLeft,content:t.chartTitle,accessibilityData:t.chartTitleAccessibilityData}),r)),t.chartData[0].data&&e._createBenchmark(t),o.createElement(iu,{direction:Wc.horizontal,className:e._classNames.chartWrapper},o.createElement("svg",{ref:e.barChartSvgRef,className:e._classNames.chart,"aria-label":t.chartTitle},o.createElement("g",{id:s,key:s,ref:function(n){e._refCallback(n,t.chartData[0].legend)},onClick:function(){var e=t.chartData[0];e&&e.onClick&&e.onClick()}},l)))))}),o.createElement(rc,(0,de.Cl)({target:this.state.refSelected,coverTarget:!0,isBeakVisible:!1,gapSpace:30,hidden:!(!this.props.hideTooltip&&this.state.isCalloutVisible),directionalHint:3,id:this._calloutId,onDismiss:this._closeCallout,preventDismissOnLostFocus:!0},this.props.calloutProps,cd(this.state.callOutAccessibilityData)),o.createElement(o.Fragment,null,this.props.onRenderCalloutPerHorizontalBar?this.props.onRenderCalloutPerHorizontalBar(this.state.barCalloutProps):o.createElement(Oa.ChartHoverCard,{Legend:this.state.xCalloutValue?this.state.xCalloutValue:this.state.legend,YValue:this.state.yCalloutValue?this.state.yCalloutValue:this.state.hoverValue,color:this.state.lineColor,culture:this.props.culture}))))},t.prototype._refCallback=function(e,t){this._refArray.push({index:t,refElement:e})},t.prototype._hoverOn=function(e,t){var n,r,o,i;if((!this.state.isCalloutVisible||this.state.legend!==t.legend)&&this._calloutAnchorPoint!==t){var a=Sc(this._refArray,function(e){return e.index===t.legend});this._calloutAnchorPoint=t;var l=t.color;if(this.props.enableGradient){var s=Math.max((null===(r=null===(n=this.props.data)||void 0===n?void 0:n.map(function(e){return e.chartData}))||void 0===r?void 0:r.findIndex(function(e){return(null==e?void 0:e[0].data)===t.data&&(null==e?void 0:e[0].legend)===t.legend}))||0,0);l=(null===(o=t.gradient)||void 0===o?void 0:o[0])||Dh(s,0,null===(i=this.props.theme)||void 0===i?void 0:i.isInverted)[0]}this.setState({isCalloutVisible:!0,hoverValue:e,lineColor:l,legend:t.legend,refSelected:a.refElement,xCalloutValue:t.xAxisCalloutData,yCalloutValue:t.yAxisCalloutData,barCalloutProps:t,callOutAccessibilityData:t.callOutAccessibilityData})}},t.prototype._hoverOff=function(){},t.prototype._getDefaultTextData=function(e){var t=this.props.culture,n=this.props.chartDataMode||"default",r=e.chartData[0],i=r.horizontalBarChartdata.x,a=r.horizontalBarChartdata.y,l=cd(e.chartDataAccessibilityData,"text",!1);switch(n){case"default":return o.createElement("div",(0,de.Cl)({className:this._classNames.chartTitleRight},l),(0,Yu.c$)(i,t));case"fraction":return o.createElement("div",(0,de.Cl)({},l),o.createElement("span",{className:this._classNames.chartTitleRight},(0,Yu.c$)(i,t)),o.createElement("span",{className:this._classNames.chartDataTextDenominator}," / "+(0,Yu.c$)(a,t)));case"percentage":var s="".concat((0,Yu.c$)(Math.round(i/a*100),t),"%");return o.createElement("div",(0,de.Cl)({className:this._classNames.chartTitleRight},l),s)}},t.prototype._createBenchmark=function(e){var t=e.chartData[0].horizontalBarChartdata.y,n=e.chartData[0].data,r={left:"calc("+Math.round((n||0)/t*100)+"% - 4px)"};return o.createElement("div",{className:this._classNames.benchmarkContainer},o.createElement("div",{className:this._classNames.triangle,style:r}))},t.prototype._createBars=function(e,t,n){var r,i=this,a=(null===(r=e.chartData)||void 0===r?void 0:r.reduce(function(e,t){return e+((t.data||0)>0?1:0)},0))||1,l=this.state.barSpacingInPercent*(a-1),s=[t.blueLight,t.blue,t.blueMid,t.red,t.black],c=[],u=e.chartData.reduce(function(e,t){return e+(t.horizontalBarChartdata.x?t.horizontalBarChartdata.x:0)},0),d=0,h=0,p=0;e.chartData.map(function(e,t){var n=e.horizontalBarChartdata.x?e.horizontalBarChartdata.x:0;return(h=n/u*100)<0?h=0:h<1&&0!==h&&(h=1),p+=h});var f=0!==p?(p-l)/100:1,g=e.chartData.map(function(t,r){var a,l,p,g,v=t.color?t.color:s[Math.floor(4*Math.random()+1)],m=v;i.props.enableGradient&&1!==r&&(v=(null===(a=t.gradient)||void 0===a?void 0:a[0])||Dh(n,0,null===(l=i.props.theme)||void 0===l?void 0:l.isInverted)[0],m=(null===(p=t.gradient)||void 0===p?void 0:p[1])||Dh(n,0,null===(g=i.props.theme)||void 0===g?void 0:g.isInverted)[1]);var y=t.horizontalBarChartdata.x?t.horizontalBarChartdata.x:0;r>0&&(d+=h),(h=y/u*100)<0?h=0:h<1&&0!==h?h=1/f:h/=f,c.push(d);var _=t.horizontalBarChartdata.x;if(1===r&&i.props.variant===Ph.AbsoluteScale){if(i.props.hideLabels)return o.createElement("text",{key:r});var x=e.chartData[0].horizontalBarChartdata.x;return o.createElement("text",{key:r,x:"".concat(i._isRTL?100-c[r]:c[r],"%"),y:i._barHeight/2,dominantBaseline:"central",transform:"translate(".concat(i._isRTL?-4:4,")"),className:i._classNames.barLabel,"aria-hidden":!0},ud(x))}var b=Ta("HBC_Gradient")+"_".concat(n,"_").concat(r);return o.createElement(o.Fragment,{key:r},i.props.enableGradient&&o.createElement("defs",null,o.createElement("linearGradient",{id:b},o.createElement("stop",{offset:"0",stopColor:v}),o.createElement("stop",{offset:"100%",stopColor:m}))),o.createElement("rect",{key:r,x:"".concat(i._isRTL?100-c[r]-h-r*i.state.barSpacingInPercent:c[r]+r*i.state.barSpacingInPercent,"%"),y:0,rx:i.props.roundCorners?3:0,"data-is-focusable":""!==t.legend,width:h+"%",height:i._barHeight,fill:i.props.enableGradient?"url(#".concat(b,")"):v,onMouseOver:""!==t.legend?i._hoverOn.bind(i,_,t):void 0,onFocus:""!==t.legend?i._hoverOn.bind(i,_,t):void 0,role:"img","aria-label":i._getAriaLabel(t),onBlur:i._hoverOff,onMouseLeave:i._hoverOff,className:i._classNames.barWrapper}))});return g},t.prototype._isChartEmpty=function(){return!(this.props.data&&this.props.data.length>0)},t}(o.Component),Uh=(0,ue.I)(jh,function(e){var t,n=e.className,r=e.theme,o=e.width,i=e.barHeight,a=e.showTriangle,l=e.variant,s=e.hideLabels,c=r.palette;return{root:[{display:"flex",flexDirection:"column",width:o||"100%"},n],items:{marginBottom:a||l===Ph.AbsoluteScale?"16px":"10px"},chart:{width:"100%",height:i||12,display:"block",overflow:"visible"},barWrapper:{},chartTitle:(0,de.Cl)((0,de.Cl)({},r.fonts.small),{display:"flex",justifyContent:"space-between"}),chartTitleLeft:{textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",display:"block",color:r.palette.neutralPrimary,marginBottom:l===Ph.AbsoluteScale?"4px":"5px"},chartTitleRight:{fontSize:Fa.s.medium,fontWeight:Fa.BO.semibold,color:r.palette.neutralPrimary},chartDataTextDenominator:{fontSize:Fa.s.medium,color:r.palette.neutralPrimary},benchmarkContainer:{position:"relative",height:"7px",marginTop:"-3px",marginBottom:"-1px"},triangle:{width:"0",height:"0",borderLeft:"4px solid transparent",borderRight:"4px solid transparent",borderTop:"7px solid",borderTopColor:c.blue,marginBottom:"4px",position:"absolute"},barLabel:(0,de.Cl)((0,de.Cl)({},r.fonts.small),{fontWeight:Fa.BO.semibold,fill:r.palette.neutralPrimary,selectors:(t={},t[Fa.up]={fill:"CanvasText"},t)}),chartWrapper:{paddingRight:l!==Ph.AbsoluteScale||s?0:40}}}),Xh=(0,a.makeStyles)({container:{display:"flex",flexDirection:"column",height:"100%",width:"100%",minHeight:"200px"},title:{marginBottom:"2px",fontWeight:a.tokens.fontWeightSemibold,color:a.tokens.colorNeutralForeground1},chartWrapper:{flex:1,position:"relative",minHeight:"150px"},placeholder:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",color:a.tokens.colorNeutralForeground3}}),qh=e=>{var{data:t,title:n,orientation:r="vertical",showLabels:i=!0,showLegend:l=!1,onDrillInteraction:s,drillField:c,height:u=300,responsive:d=!0}=e,h=Xh(),p=(0,o.useRef)(null),[f,g]=(0,o.useState)(400);(0,o.useEffect)(()=>{if(d&&p.current){var e=new ResizeObserver(e=>{for(var t of e)g(t.contentRect.width)});return e.observe(p.current),()=>e.disconnect()}},[d]);var v=e=>{s&&c&&s({field:c,operator:"eq",value:e.fieldValue,label:e.label})};if(!t||0===t.length)return o.createElement("div",{className:h.container},n&&o.createElement(a.Text,{className:h.title},n),o.createElement("div",{className:h.placeholder},o.createElement(a.Text,null,"No data available")));var m=[a.tokens.colorBrandBackground,a.tokens.colorPaletteBlueBorderActive,a.tokens.colorPaletteTealBorderActive,a.tokens.colorPaletteGreenBorderActive,a.tokens.colorPaletteYellowBorderActive,a.tokens.colorPaletteDarkOrangeBorderActive,a.tokens.colorPaletteRedBorderActive,a.tokens.colorPalettePurpleBorderActive],y=t.map((e,t)=>({x:e.label,y:e.value,color:e.color||m[t%m.length],legend:e.label,xAxisCalloutData:e.label,yAxisCalloutData:e.value.toString(),onClick:()=>v(e)})),_=t.map((e,t)=>({x:e.value,y:e.label,color:e.color||m[t%m.length],legend:e.label,xAxisCalloutData:e.value.toString(),yAxisCalloutData:e.label,onClick:()=>v(e)})),x={chartTitle:n};return o.createElement("div",{className:h.container,ref:p},n&&o.createElement(a.Text,{className:h.title},n),o.createElement("div",{className:h.chartWrapper},"vertical"===r?o.createElement(Fh,Object.assign({data:y,width:d?f:void 0,height:u,hideLegend:!l,hideTooltip:!1,barWidth:32,yAxisTickCount:5},x)):o.createElement(Uh,{data:_.map(e=>({chartTitle:String(e.y),chartData:[{legend:e.legend||"",horizontalBarChartdata:{x:e.x,y:0},color:e.color,onClick:e.onClick}]}))})))};function Gh(e,t){if(e=function(e){for(var t;t=e.sourceEvent;)e=t;return e}(e),void 0===t&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,[(r=r.matrixTransform(t.getScreenCTM().inverse())).x,r.y]}if(t.getBoundingClientRect){var o=t.getBoundingClientRect();return[e.clientX-o.left-t.clientLeft,e.clientY-o.top-t.clientTop]}}return[e.pageX,e.pageY]}var Kh=(0,Ds.J5)(function(e){return(0,Ds.J5)(function(t){var n=(0,Ds.J5)(function(e){return function(n){return t(n,e)}});return function(r,o){return e(r,o?n(o):t)}})});function Zh(e,t){return Kh(e)(t)}var $h=function(e){if(void 0===e)return 0;var t=0;return"scrollTop"in e?t=e.scrollTop:"scrollY"in e&&(t=e.scrollY),Math.ceil(t)},Jh=function(e,t){"scrollTop"in e?e.scrollTop=t:"scrollY"in e&&e.scrollTo(e.scrollX,t)},Qh="spacer-",ep=1/3,tp={top:-1,bottom:-1,left:-1,right:-1,width:0,height:0},np=function(e){return e.getBoundingClientRect()},rp=np,op=np,ip=function(e){function t(t){var n=e.call(this,t)||this;return n._root=o.createRef(),n._surface=o.createRef(),n._pageRefs={},n._getDerivedStateFromProps=function(e,t){return e.items!==n.props.items||e.renderCount!==n.props.renderCount||e.startIndex!==n.props.startIndex||e.version!==n.props.version||!t.hasMounted&&n.props.renderEarly&&(0,Zs.S)()?(n._resetRequiredWindows(),n._requiredRect=null,n._measureVersion++,n._invalidatePageCache(),n._updatePages(e,t)):t},n._onRenderRoot=function(e){var t=e.rootRef,n=e.surfaceElement,r=e.divProps;return o.createElement("div",(0,de.Cl)({ref:t},r),n)},n._onRenderSurface=function(e){var t=e.surfaceRef,n=e.pageElements,r=e.divProps;return o.createElement("div",(0,de.Cl)({ref:t},r),n)},n._onRenderPage=function(e,t){for(var r,i=n.props,a=i.onRenderCell,l=i.onRenderCellConditional,s=i.role,c=e.page,u=c.items,d=void 0===u?[]:u,h=c.startIndex,p=(0,de.Tt)(e,["page"]),f=void 0===s?"listitem":"presentation",g=[],v=0;v<d.length;v++){var m=h+v,y=d[v],_=n.props.getKey?n.props.getKey(y,m):y&&y.key;null==_&&(_=m);var x=null!=l?l:a,b=null!==(r=null==x?void 0:x(y,m,n.props.ignoreScrollingState?void 0:n.state.isScrolling))&&void 0!==r?r:null;l&&!b||g.push(o.createElement("div",{role:f,className:"ms-List-cell",key:_,"data-list-index":m,"data-automationid":"ListCell"},b))}return o.createElement("div",(0,de.Cl)({},p),g)},Aa(n),n.state={pages:[],isScrolling:!1,getDerivedStateFromProps:n._getDerivedStateFromProps,hasMounted:!1},n._estimatedPageHeight=0,n._totalEstimates=0,n._requiredWindowsAhead=0,n._requiredWindowsBehind=0,n._measureVersion=0,n._cachedPageHeights={},n._estimatedPageHeight=0,n._focusedIndex=-1,n._pageCache={},n}return(0,de.C6)(t,e),t.getDerivedStateFromProps=function(e,t){return t.getDerivedStateFromProps(e,t)},Object.defineProperty(t.prototype,"pageRefs",{get:function(){return this._pageRefs},enumerable:!1,configurable:!0}),t.prototype.scrollToIndex=function(e,t,n){void 0===n&&(n=0);for(var r=this.props.startIndex,o=r+this._getRenderCount(),i=this._allowedRect,a=0,l=1,s=r;s<o;s+=l){var c=this._getPageSpecification(this.props,s,i),u=c.height;if(l=c.itemCount,s<=e&&s+l>e){if(t&&this._scrollElement){for(var d=op(this._scrollElement),h=$h(this._scrollElement),p={top:h,bottom:h+d.height},f=e-s,g=0;g<f;++g)a+=t(s+g);var v=a+t(e);switch(n){case 1:return void Jh(this._scrollElement,a);case 2:return void Jh(this._scrollElement,v-d.height);case 3:return void Jh(this._scrollElement,(a+v-d.height)/2)}if(a>=p.top&&v<=p.bottom)return;a<p.top||v>p.bottom&&(a=v-d.height)}return void(this._scrollElement&&Jh(this._scrollElement,a))}a+=u}},t.prototype.getStartItemIndexInView=function(e){for(var t=0,n=this.state.pages||[];t<n.length;t++){var r=n[t];if(!r.isSpacer&&(this._scrollTop||0)>=r.top&&(this._scrollTop||0)<=r.top+r.height){if(!e){var o=Math.floor(r.height/r.itemCount);return r.startIndex+Math.floor((this._scrollTop-r.top)/o)}for(var i=0,a=r.startIndex;a<r.startIndex+r.itemCount;a++){if(o=e(a),r.top+i<=this._scrollTop&&this._scrollTop<r.top+i+o)return a;i+=o}}}return 0},t.prototype.componentDidMount=function(){this._async=new Ba(this),this._events=new Ua(this),this._onAsyncScrollDebounced=this._async.debounce(this._onAsyncScroll,100,{leading:!1,maxWait:500}),this._onAsyncIdleDebounced=this._async.debounce(this._onAsyncIdle,200,{leading:!1}),this._onAsyncResizeDebounced=this._async.debounce(this._onAsyncResize,16,{leading:!1}),this._onScrollingDoneDebounced=this._async.debounce(this._onScrollingDone,500,{leading:!1}),this._scrollElement=kl(this._root.current),this._scrollTop=0,this.setState((0,de.Cl)((0,de.Cl)({},this._updatePages(this.props,this.state)),{hasMounted:!0})),this._measureVersion++;var e=function(e){var t;return null!==(t=null==e?void 0:e.window)&&void 0!==t?t:"undefined"!=typeof window?window:void 0}(this.context);this._events.on(e,"resize",this._onAsyncResizeDebounced),this._root.current&&this._events.on(this._root.current,"focus",this._onFocus,!0),this._scrollElement&&(this._events.on(this._scrollElement,"scroll",this._onScroll),this._events.on(this._scrollElement,"scroll",this._onAsyncScrollDebounced))},t.prototype.componentDidUpdate=function(e,t){var n=this.props,r=this.state;this.state.pagesVersion!==t.pagesVersion&&(n.getPageHeight?this._onAsyncIdleDebounced():this._updatePageMeasurements(r.pages)?(this._materializedRect=null,this._hasCompletedFirstRender?this._onAsyncScrollDebounced():(this._hasCompletedFirstRender=!0,this.setState(this._updatePages(n,r)))):this._onAsyncIdleDebounced(),n.onPagesUpdated&&n.onPagesUpdated(r.pages))},t.prototype.componentWillUnmount=function(){var e,t;null===(e=this._async)||void 0===e||e.dispose(),null===(t=this._events)||void 0===t||t.dispose(),delete this._scrollElement},t.prototype.shouldComponentUpdate=function(e,t){var n=this.state.pages,r=t.pages,o=!1;if(!t.isScrolling&&this.state.isScrolling)return!0;if(e.version!==this.props.version)return!0;if(e.className!==this.props.className)return!0;if(e.items===this.props.items&&n.length===r.length)for(var i=0;i<n.length;i++){var a=n[i],l=r[i];if(a.key!==l.key||a.itemCount!==l.itemCount){o=!0;break}}else o=!0;return o},t.prototype.forceUpdate=function(){this._invalidatePageCache(),this._updateRenderRects(this.props,this.state,!0),this.setState(this._updatePages(this.props,this.state)),this._measureVersion++,e.prototype.forceUpdate.call(this)},t.prototype.getTotalListHeight=function(){return this._surfaceRect.height},t.prototype.render=function(){for(var e=this.props,t=e.className,n=e.role,r=void 0===n?"list":n,o=e.onRenderSurface,i=e.onRenderRoot,a=this.state.pages,l=void 0===a?[]:a,s=[],c=Qa(this.props,Ja),u=0,d=l;u<d.length;u++){var h=d[u];s.push(this._renderPage(h))}var p=o?Zh(o,this._onRenderSurface):this._onRenderSurface;return(i?Zh(i,this._onRenderRoot):this._onRenderRoot)({rootRef:this._root,pages:l,surfaceElement:p({surfaceRef:this._surface,pages:l,pageElements:s,divProps:{role:"presentation",className:"ms-List-surface"}}),divProps:(0,de.Cl)((0,de.Cl)({},c),{className:ml("ms-List",t),role:s.length>0?r:void 0,"aria-label":s.length>0?c["aria-label"]:void 0})})},t.prototype._shouldVirtualize=function(e){void 0===e&&(e=this.props);var t=e.onShouldVirtualize;return!t||t(e)},t.prototype._invalidatePageCache=function(){this._pageCache={}},t.prototype._renderPage=function(e){var t,n=this,r=this.props.usePageCache;if(r&&(t=this._pageCache[e.key])&&t.pageElement)return t.pageElement;var o=this._getPageStyle(e),i=this.props.onRenderPage,a=(void 0===i?this._onRenderPage:i)({page:e,className:"ms-List-page",key:e.key,ref:function(t){n._pageRefs[e.key]=t},style:o,role:"presentation"},this._onRenderPage);return r&&0===e.startIndex&&(this._pageCache[e.key]={page:e,pageElement:a}),a},t.prototype._getPageStyle=function(e){var t=this.props.getPageStyle;return(0,de.Cl)((0,de.Cl)({},t?t(e):{}),e.items?{}:{height:e.height})},t.prototype._onFocus=function(e){for(var t=e.target;t!==this._surface.current;){var n=t.getAttribute("data-list-index");if(n){this._focusedIndex=Number(n);break}t=nl(t)}},t.prototype._onScroll=function(){this.state.isScrolling||this.props.ignoreScrollingState||this.setState({isScrolling:!0}),this._resetRequiredWindows(),this._onScrollingDoneDebounced()},t.prototype._resetRequiredWindows=function(){this._requiredWindowsAhead=0,this._requiredWindowsBehind=0},t.prototype._onAsyncScroll=function(){var e,t;this._updateRenderRects(this.props,this.state),this._materializedRect&&(e=this._requiredRect,t=this._materializedRect,e.top>=t.top&&e.left>=t.left&&e.bottom<=t.bottom&&e.right<=t.right)||this.setState(this._updatePages(this.props,this.state))},t.prototype._onAsyncIdle=function(){var e=this.props,t=e.renderedWindowsAhead,n=e.renderedWindowsBehind,r=this._requiredWindowsAhead,o=this._requiredWindowsBehind,i=Math.min(t,r+1),a=Math.min(n,o+1);i===r&&a===o||(this._requiredWindowsAhead=i,this._requiredWindowsBehind=a,this._updateRenderRects(this.props,this.state),this.setState(this._updatePages(this.props,this.state))),(t>i||n>a)&&this._onAsyncIdleDebounced()},t.prototype._onScrollingDone=function(){this.props.ignoreScrollingState||(this.setState({isScrolling:!1}),this._onAsyncIdle())},t.prototype._onAsyncResize=function(){this.forceUpdate()},t.prototype._updatePages=function(e,t){this._requiredRect||this._updateRenderRects(e,t);var n=this._buildPages(e,t),r=t.pages;return this._notifyPageChanges(r,n.pages,this.props),(0,de.Cl)((0,de.Cl)((0,de.Cl)({},t),n),{pagesVersion:{}})},t.prototype._notifyPageChanges=function(e,t,n){var r=n.onPageAdded,o=n.onPageRemoved;if(r||o){for(var i={},a=0,l=e;a<l.length;a++)(u=l[a]).items&&(i[u.startIndex]=u);for(var s=0,c=t;s<c.length;s++){var u;(u=c[s]).items&&(i[u.startIndex]?delete i[u.startIndex]:this._onPageAdded(u))}for(var d in i)i.hasOwnProperty(d)&&this._onPageRemoved(i[d])}},t.prototype._updatePageMeasurements=function(e){var t=!1;if(!this._shouldVirtualize())return t;for(var n=0;n<e.length;n++){var r=e[n];r.items&&(t=this._measurePage(r)||t)}return t},t.prototype._measurePage=function(e){var t=!1,n=this._pageRefs[e.key],r=this._cachedPageHeights[e.startIndex];if(n&&this._shouldVirtualize()&&(!r||r.measureVersion!==this._measureVersion)){var o={width:n.clientWidth,height:n.clientHeight};(o.height||o.width)&&(t=e.height!==o.height,e.height=o.height,this._cachedPageHeights[e.startIndex]={height:o.height,measureVersion:this._measureVersion},this._estimatedPageHeight=Math.round((this._estimatedPageHeight*this._totalEstimates+o.height)/(this._totalEstimates+1)),this._totalEstimates++)}return t},t.prototype._onPageAdded=function(e){var t=this.props.onPageAdded;t&&t(e)},t.prototype._onPageRemoved=function(e){var t=this.props.onPageRemoved;t&&t(e)},t.prototype._buildPages=function(e,t){var n=e.renderCount,r=e.items,o=e.startIndex,i=e.getPageHeight;n=this._getRenderCount(e);for(var a=(0,de.Cl)({},tp),l=[],s=1,c=0,u=null,d=this._focusedIndex,h=o+n,p=this._shouldVirtualize(e),f=0===this._estimatedPageHeight&&!i,g=this._allowedRect,v=function(n){var i=m._getPageSpecification(e,n,g),v=i.height,y=i.data,_=i.key;s=i.itemCount;var x,b,C=c+v-1,k=Ec(t.pages,function(e){return!!e.items&&e.startIndex===n})>-1,w=!g||C>=g.top&&c<=g.bottom,E=!m._requiredRect||C>=m._requiredRect.top&&c<=m._requiredRect.bottom;if(!f&&(E||w&&k)||!p||d>=n&&d<n+s||n===o){u&&(l.push(u),u=null);var S=Math.min(s,h-n),T=m._createPage(_,r.slice(n,n+S),n,void 0,void 0,y);T.top=c,T.height=v,m._visibleRect&&m._visibleRect.bottom&&(T.isVisible=C>=m._visibleRect.top&&c<=m._visibleRect.bottom),l.push(T),E&&m._allowedRect&&(x=a,b={top:c,bottom:C,height:v,left:g.left,right:g.right,width:g.width},x.top=b.top<x.top||-1===x.top?b.top:x.top,x.left=b.left<x.left||-1===x.left?b.left:x.left,x.bottom=b.bottom>x.bottom||-1===x.bottom?b.bottom:x.bottom,x.right=b.right>x.right||-1===x.right?b.right:x.right,x.width=x.right-x.left+1,x.height=x.bottom-x.top+1)}else u||(u=m._createPage(Qh+n,void 0,n,0,void 0,y,!0)),u.height=(u.height||0)+(C-c)+1,u.itemCount+=s;if(c+=C-c+1,f&&p)return"break"},m=this,y=o;y<h&&"break"!==v(y);y+=s);return u&&(u.key=Qh+"end",l.push(u)),this._materializedRect=a,(0,de.Cl)((0,de.Cl)({},t),{pages:l,measureVersion:this._measureVersion})},t.prototype._getPageSpecification=function(e,t,n){var r=e.getPageSpecification;if(r){var o=r(t,n,e.items),i=o.itemCount,a=void 0===i?this._getItemCountForPage(t,n):i,l=o.height;return{itemCount:a,height:void 0===l?this._getPageHeight(t,n,a):l,data:o.data,key:o.key}}return{itemCount:a=this._getItemCountForPage(t,n),height:this._getPageHeight(t,n,a)}},t.prototype._getPageHeight=function(e,t,n){if(this.props.getPageHeight)return this.props.getPageHeight(e,t,n,this.props.items);var r=this._cachedPageHeights[e];return r?r.height:this._estimatedPageHeight||30},t.prototype._getItemCountForPage=function(e,t){return(this.props.getItemCountForPage?this.props.getItemCountForPage(e,t):10)||10},t.prototype._createPage=function(e,t,n,r,o,i,a){void 0===n&&(n=-1),void 0===r&&(r=t?t.length:0),void 0===o&&(o={}),e=e||"page-"+n;var l=this._pageCache[e];return l&&l.page?l.page:{key:e,startIndex:n,itemCount:r,items:t,style:o,top:0,height:0,data:i,isSpacer:a||!1}},t.prototype._getRenderCount=function(e){var t=e||this.props,n=t.items,r=t.startIndex,o=t.renderCount;return void 0===o?n?n.length-r:0:o},t.prototype._updateRenderRects=function(e,t,n){var r=e.renderedWindowsAhead,o=e.renderedWindowsBehind,i=t.pages;if(this._shouldVirtualize(e)){var a=this._surfaceRect||(0,de.Cl)({},tp),l=function(e){if(void 0===e)return 0;var t=0;return"scrollHeight"in e?t=e.scrollHeight:"document"in e&&(t=e.document.documentElement.scrollHeight),t}(this._scrollElement),s=$h(this._scrollElement);this._surface.current&&(n||!i||!this._surfaceRect||!l||l!==this._scrollHeight||Math.abs(this._scrollTop-s)>this._estimatedPageHeight*ep)&&(a=this._surfaceRect=rp(this._surface.current),this._scrollTop=s),!n&&l&&l===this._scrollHeight||this._measureVersion++,this._scrollHeight=l||0;var c=Math.max(0,-a.top),u=(0,Ca.z)(this._root.current),d={top:c,left:a.left,bottom:c+u.innerHeight,right:a.right,width:a.width,height:u.innerHeight};this._requiredRect=ap(d,this._requiredWindowsBehind,this._requiredWindowsAhead),this._allowedRect=ap(d,o,r),this._visibleRect=d}},t.defaultProps={startIndex:0,onRenderCell:function(e,t,n){return o.createElement(o.Fragment,null,e&&e.name||"")},onRenderCellConditional:void 0,renderedWindowsAhead:2,renderedWindowsBehind:2},t.contextType=os,t}(o.Component);function ap(e,t,n){var r=e.top-t*e.height,o=e.height+(t+n)*e.height;return{top:r,bottom:r+o,height:o,left:e.left,right:e.right,width:e.width}}var lp=function(e){var t=o.useRef(null);o.useEffect(function(){if(t.current){var n=Rt(t.current),r=e.text.split(/\s+/),o=[],i=n.append("tspan"),a=0;return r.forEach(function(t){o.push(t),i.text(o.join(" "));var r=i.node();r&&r.getComputedTextLength()>e.width&&o.length>1&&(a++,o.pop(),i.text(o.join(" ")),o=[t],i=n.append("tspan").text(t).attr("dy",e.lineHeight).attr("x",e.x))}),n.attr("dy",-a*e.lineHeight),function(){n.selectAll("tspan").remove()}}}),e.lineHeight;var n=(0,de.Tt)(e,["lineHeight"]);return o.createElement("text",(0,de.Cl)({ref:t},fd(n)))},sp={1:["#637cef"],2:["#e3008c"],3:["#2aa0a4"],4:["#9373c0"],5:["#13a10e"],6:["#3a96dd"],7:["#ca5010"],8:["#57811b"],9:["#b146c2"],10:["#ae8c00"],11:["#3c51b4","#93a4f4"],12:["#ad006a","#ee5fb7"],13:["#026467","#4cb4b7"],14:["#674c8c","#a083c9"],15:["#0e7a0b","#27ac22"],16:["#2c72a8","#4fa1e1"],17:["#9a3d0c","#d77440"],18:["#405f14","#73aa24"],19:["#863593","#c36bd1"],20:["#6d5700","#d0b232"],21:["#4f6bed"],22:["#ea38a6"],23:["#038387"],24:["#8764b8"],25:["#11910d"],26:["#3487c7"],27:["#d06228"],28:["#689920"],29:["#ba58c9"],30:["#937700","#c19c00"],31:["#2c3c85","#c8d1fa"],32:["#7f004e","#f7adda"],33:["#02494c","#9bd9db"],34:["#4c3867","#b29ad4"],35:["#0b5a08","#a7e3a5"],36:["#20547c","#83bdeb"],37:["#712d09","#df8e64"],38:["#23330b","#a4cc6c"],39:["#63276d","#cf87da"],40:["#3a2f00","#dac157"]},cp={qualitative:sp,semantic:{info:["#015cda"],disabled:["#dbdbdb","#4d4d4d"],highError:["#6e0811","#cc2635"],error:["#c50f1f","#dc626d"],warning:["#f7630c","#f87528"],success:["#107c10","#54b054"],highSuccess:["#094509","#218c21"]}},up=Object.values(sp),dp=Object.values({color1:"qualitative.1",color2:"qualitative.2",color3:"qualitative.3",color4:"qualitative.4",color5:"qualitative.5",color6:"qualitative.6",color7:"qualitative.7",color8:"qualitative.8",color9:"qualitative.9",color10:"qualitative.10",color11:"qualitative.11",color12:"qualitative.12",color13:"qualitative.13",color14:"qualitative.14",color15:"qualitative.15",color16:"qualitative.16",color17:"qualitative.17",color18:"qualitative.18",color19:"qualitative.19",color20:"qualitative.20",color21:"qualitative.21",color22:"qualitative.22",color23:"qualitative.23",color24:"qualitative.24",color25:"qualitative.25",color26:"qualitative.26",color27:"qualitative.27",color28:"qualitative.28",color29:"qualitative.29",color30:"qualitative.30",color31:"qualitative.31",color32:"qualitative.32",color33:"qualitative.33",color34:"qualitative.34",color35:"qualitative.35",color36:"qualitative.36",color37:"qualitative.37",color38:"qualitative.38",color39:"qualitative.39",color40:"qualitative.40",info:"semantic.info",disabled:"semantic.disabled",highError:"semantic.highError",error:"semantic.error",warning:"semantic.warning",success:"semantic.success",highSuccess:"semantic.highSuccess"}),hp=function(e,t){if(0===e.length)return"";var n=Number(t);return n<e.length?e[n]:e[0]},pp=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=!1);var r=up[(e+t)%up.length];return hp(r,n)},fp=function(e,t){if(void 0===t&&(t=!1),dp.indexOf(e)>=0){var n=e.split("."),r=n[0],o=n[1],i=cp[r][o];return hp(i,t)}return e},gp=function(e){var t,n,r,i=o.useRef(null),a=o.useState(!1),l=a[0],s=a[1],c=null;if(l){var u=e.labelDef.aggregatedIdx.map(function(t){return e.lineDefs[t].onRenderCard}).filter(function(e){return!!e});u.length>0&&(c=o.createElement(rc,{target:i.current,onDismiss:function(){return s(!1)},setInitialFocus:!0,role:"dialog"},o.createElement(iu,{isCircularNavigation:!0,direction:Wc.vertical},o.createElement(ip,{items:u,role:"alert","aria-roledescription":" ",onRenderCell:function(e){return o.createElement("div",{"data-is-focusable":!0},e&&e())}}))))}var d=e.textColor?fp(e.textColor,null===(t=e.theme)||void 0===t?void 0:t.isInverted):null===(n=e.theme)||void 0===n?void 0:n.semanticColors.messageText;return r=1===e.labelDef.aggregatedIdx.length?e.lineDefs[e.labelDef.aggregatedIdx[0]].event:e.mergedLabel(e.labelDef.aggregatedIdx.length),o.createElement(o.Fragment,null,o.createElement("g",{ref:i,onClick:function(){return s(!0)},"data-is-focusable":!0,style:{cursor:"pointer"},role:"button"},o.createElement(lp,{text:r,x:e.labelDef.x,y:e.textY,width:e.textWidth,lineHeight:e.textLineHeight,textAnchor:e.labelDef.anchor,fontSize:e.textFontSize,fill:d})),c)},vp=function(e){var t,n,r=e.labelWidth?e.labelWidth:105,i=e.chartYTop-20,a=i+7,l=e.scale.range(),s=e.events.map(function(t){return(0,de.Cl)((0,de.Cl)({},t),{x:e.scale(t.date)})});s.sort(function(e,t){return+e.date-+t.date});var c=e.strokeColor?fp(e.strokeColor,null===(t=e.theme)||void 0===t?void 0:t.isInverted):null===(n=e.theme)||void 0===n?void 0:n.palette.black,u=function(e,t){for(var n=[],r=[],o=0,i=e;o<i.length;o++){var a=i[o],l=t(a);-1===n.indexOf(l)&&(r.push(a),n.push(l))}return r}(s,function(e){return e.date.toString()}).map(function(t,n){return o.createElement("line",{key:n,x1:t.x,x2:t.x,y1:a,y2:e.chartYBottom,stroke:c,strokeDasharray:"8"})}),d=function(e,t,n,r){var o=function(r,o){if(o===e.length)return[];var a=e[o].x,l=a-t;return a<r?[]:o===e.length-1?r<l?[{x:a,anchor:"end",aggregatedIdx:[o]}]:a+t<n?[{x:a,anchor:"start",aggregatedIdx:[o]}]:[]:i(o,r<l?"end":"start")},i=function(r,i){var a="end"===i?e[r].x:e[r].x+t,l=Ec(e,function(e){return e.x>a&&(e.x-t>=a||e.x+t<n)},r+1);-1===l&&(l=e.length);for(var s=[],c=r;c<l;c++)s.push(c);var u=o(a,l);return u.unshift({x:e[r].x,anchor:i,aggregatedIdx:s}),u};return o(r,0)}(s,r+5,l[1],l[0]).map(function(t,n){return o.createElement(gp,{key:n,theme:e.theme,lineDefs:s,labelDef:t,textY:i,textWidth:r,textLineHeight:18,textFontSize:"10pt",textColor:e.labelColor,mergedLabel:e.mergedLabel})});return o.createElement(o.Fragment,null,u,d)};var mp,yp=(0,xa.Z)();!function(e){e[e.hoverSize=11]="hoverSize",e[e.invisibleSize=1]="invisibleSize"}(mp||(mp={}));var _p=qt(function(e){return e.x}).left,xp=function(e){function t(t){var n,r,i,a,l,s=e.call(this,t)||this;return s._xAxisScale="",s._yScalePrimary="",s.eventLabelHeight=36,s._isRTL=(0,ba.jI)(),s._hasMarkersMode=!1,s._isXAxisDateType=!1,s._isScatterPolar=!1,s.toImage=function(e){var t,n;return Od([{container:null===(t=s._cartesianChartRef.current)||void 0===t?void 0:t.chartContainer}],s.props.hideLegend||null===(n=s._legendsRef.current)||void 0===n?void 0:n.toSVG,s._isRTL,e)},s._getDomainNRangeValues=function(e,t,n,r,o,i,a,l){return i===zu.NumericAxis?td(e,t,n,o,s.props.xScaleType,s._hasMarkersMode):i===zu.DateAxis?nd(e,t,n,o,l,r,0,s._hasMarkersMode):{dStartValue:0,dEndValue:0,rStartValue:0,rEndValue:0}},s._injectIndexPropertyInLineChartData=function(e,t){var n;void 0===t&&(t=!1);var r=s.props.allowMultipleShapesForPoints,o=void 0!==r&&r,i=t?null==e?void 0:e.filter(function(e){var t,n,r;return(null===(n=null===(t=s.props.legendProps)||void 0===t?void 0:t.selectedLegends)||void 0===n?void 0:n.includes(e.legend))||(null===(r=s.props.legendProps)||void 0===r?void 0:r.selectedLegend)===e.legend}):e;return s._hasMarkersMode=null!==(n=null==i?void 0:i.some(function(e){var t,n,r;return null===(r=null===(n=null===(t=e.lineOptions)||void 0===t?void 0:t.mode)||void 0===n?void 0:n.includes)||void 0===r?void 0:r.call(n,"markers")}))&&void 0!==n&&n,s._isScatterPolar=bd(i),i?i.map(function(e,t){var n,r,i;return i=void 0===e.color?pp(t,0,null===(n=s.props.theme)||void 0===n?void 0:n.isInverted):fp(e.color,null===(r=s.props.theme)||void 0===r?void 0:r.isInverted),(0,de.Cl)((0,de.Cl)({},e),{index:o?t:-1,color:i})}):[]},s._getCustomizedCallout=function(){return s.props.onRenderCalloutPerStack?s.props.onRenderCalloutPerStack(s.state.stackCalloutProps):s.props.onRenderCalloutPerDataPoint?s.props.onRenderCalloutPerDataPoint(s.state.dataPointCalloutProps):null},s._getNumericMinMaxOfY=function(e,t,n){var r=rd(e,0,n,n?s.props.secondaryYScaleType:s.props.yScaleType),o=r.startValue,i=r.endValue,a={start:0,end:0};return s._hasMarkersMode&&(a=wd(o,i,n?s.props.secondaryYScaleType:s.props.yScaleType)),{startValue:o-a.start,endValue:i+a.end}},s._getMargins=function(e){s.margins=e},s._initializeLineChartData=function(e,t,n,r,o,i,a){s._xAxisScale=e,s._yScalePrimary=t,s._yScaleSecondary=a,s._renderedColorFillBars=s.props.colorFillBars?s._createColorFillBars(n):[],s.lines=s._createLines(o,n)},s._handleSingleLegendSelectionAction=function(e){s.state.selectedLegend===e.legend?(s.setState({selectedLegend:""}),s._handleLegendClick(e,null)):(s.setState({selectedLegend:e.legend}),s._handleLegendClick(e,e.legend))},s._onHoverCardHide=function(){s.setState({selectedLegendPoints:[],selectedColorBarLegend:[],isSelectedLegend:!1})},s._closeCallout=function(){s.setState({isCalloutVisible:!1})},s._getBoxWidthOfShape=function(e,t,n){var r=s.props,o=r.allowMultipleShapesForPoints,i=void 0!==o&&o,a=r.strokeWidth,l=void 0===a?4:a,c=s.state.activePoint;return i?c===e?mp.hoverSize:1===t||n?2.5*l:mp.invisibleSize:c===e?mp.hoverSize:mp.invisibleSize},s._getPath=function(e,t,n,r,o,i){var a=s.props.allowMultipleShapesForPoints,l=void 0!==a&&a,c=s._getBoxWidthOfShape(n,r,o),u=l?i%Object.keys(sd).length:0,d=sd[u].widthRatio;return function(e,t,n,r){return["M".concat(e-n/2," ").concat(t,"\n     A").concat(n/2," ").concat(n/2," 0 1 0 ").concat(e+n/2," ").concat(t,"\n     M").concat(e-n/2," ").concat(t,"\n     A ").concat(n/2," ").concat(n/2," 0 1 1 ").concat(e+n/2," ").concat(t,"\n     "),"M".concat(e-n/2," ").concat(t-n/2,"\n     L").concat(e+n/2," ").concat(t-n/2,"\n     L").concat(e+n/2," ").concat(t+n/2,"\n     L").concat(e-n/2," ").concat(t+n/2,"\n     Z"),"M".concat(e-n/2," ").concat(t-.2886*n,"\n     H ").concat(e+n/2,"\n     L").concat(e," ").concat(t+.5774*n," Z"),"M".concat(e," ").concat(t-n/2,"\n     L").concat(e+n/2," ").concat(t,"\n     L").concat(e," ").concat(t+n/2,"\n     L").concat(e-n/2," ").concat(t,"\n     Z"),"M".concat(e," ").concat(t-.5774*n,"\n     L").concat(e+n/2," ").concat(t+.2886*n,"\n     L").concat(e-n/2," ").concat(t+.2886*n," Z"),"M".concat(e-.5*n," ").concat(t-.866*n,"\n     L").concat(e+.5*n," ").concat(t-.866*n,"\n     L").concat(e+n," ").concat(t,"\n     L").concat(e+.5*n," ").concat(t+.866*n,"\n     L").concat(e-.5*n," ").concat(t+.866*n,"\n     L").concat(e-n," ").concat(t,"\n     Z"),"M".concat(e," ").concat(t-.851*n,"\n     L").concat(e+.6884*n," ").concat(t-.2633*n,"\n     L").concat(e+.5001*n," ").concat(t+.6884*n,"\n     L").concat(e-.5001*n," ").concat(t+.6884*n,"\n     L").concat(e-.6884*n," ").concat(t-.2633*n,"\n     Z"),"M".concat(e-.5001*n," ").concat(t-1.207*n,"\n     L").concat(e+.5001*n," ").concat(t-1.207*n,"\n     L").concat(e+1.207*n," ").concat(t-.5001*n,"\n     L").concat(e+1.207*n," ").concat(t+.5001*n,"\n     L").concat(e+.5001*n," ").concat(t+1.207*n,"\n     L").concat(e-.5001*n," ").concat(t+1.207*n,"\n     L").concat(e-1.207*n," ").concat(t+.5001*n,"\n     L").concat(e-1.207*n," ").concat(t-.5001*n,"\n     Z")][r]}(e,t,c=d>1?c/d:c,u)},s._getPointFill=function(e,t,n,r){var o=s.state.activePoint,i=s.props,a=i.theme;return i.allowMultipleShapesForPoints,o===t?a.semanticColors.bodyBackground:e},s._createColorFillBars=function(e){var t,n=[];s.state.isSelectedLegend?s._colorFillBars=s.state.selectedColorBarLegend:s._colorFillBars=s.props.colorFillBars;for(var r=rd(s._points),i=0;i<s._colorFillBars.length;i++){var a=s._colorFillBars[i],l=Ta("string"==typeof a.legend?a.legend.replace(/\W/g,""):""),c=fp(a.color,null===(t=s.props.theme)||void 0===t?void 0:t.isInverted);a.applyPattern&&n.push(s._getStripePattern(c,i));for(var u=0;u<a.data.length;u++){var d=a.data[u].startX,h=a.data[u].endX,p=s._legendHighlighted(a.legend)||s._noLegendHighlighted()||s.state.isSelectedLegend?s._getColorFillBarOpacity(a):.1;n.push(o.createElement("rect",{fill:a.applyPattern?"url(#".concat(s._colorFillBarPatternId,"_").concat(i,")"):c,fillOpacity:p,x:s._isRTL?s._xAxisScale(h):s._xAxisScale(d),y:s._yScalePrimary(r.endValue)-3,width:Math.abs(s._xAxisScale(h)-s._xAxisScale(d)),height:s._yScalePrimary(s.props.yMinValue||0)-s._yScalePrimary(r.endValue)+3,key:"".concat(l).concat(u)}))}}return n},s._getStripePattern=function(e,t){return o.createElement("pattern",{id:"".concat(s._colorFillBarPatternId,"_").concat(t),width:16,height:16,key:"".concat(s._colorFillBarPatternId,"_").concat(t),patternUnits:"userSpaceOnUse"},o.createElement("path",{d:"M-4,4 l8,-8 M0,16 l16,-16 M12,20 l8,-8",stroke:e,strokeWidth:1.25}))},s._checkInGap=function(e,t,n){for(var r=n,o=!1;r<t.length&&e>t[r].endIndex;)r++;return r<t.length&&e>t[r].startIndex&&e<=t[r].endIndex&&(o=!0),{isInGap:o,gapIndex:r}},s._onMouseOverLargeDataset=function(e,t,n,r){r.persist();var o=s.props.data.lineChartData,i=s._xAxisScale.invert(Gh(r)[0],document.getElementById(s._rectId)),a=_p(o[e].data,i),l=o[e].data[a-1],c=o[e].data[a],u=null,d=null;if(void 0===l&&void 0!==c)u=c.x,d=a;else if(void 0!==l&&void 0===c)u=l.x,d=a-1;else{var h=void 0,p=void 0,f=void 0;switch(ld(o[e].data[0].x,!0)){case zu.DateAxis:h=new Date(i).getTime(),p=l.x.getTime(),f=c.x.getTime(),u=Math.abs(h-p)>Math.abs(h-f)?c.x:l.x,d=Math.abs(h-p)>Math.abs(h-f)?a:a-1;break;case zu.NumericAxis:h=i,p=l.x,f=c.x,u=Math.abs(h-p)>Math.abs(h-f)?c.x:l.x,d=Math.abs(h-p)>Math.abs(h-f)?a:a-1}}var g=o[e].data[d],v=g.xAxisCalloutData,m=g.xAxisCalloutAccessibilityData,y=u instanceof Date?(0,Yu.Yn)(u,s.props.culture,s.props.useUTC):u,_=Ld(s._calloutPoints,u),x=o[e].data[d],b=null===s.state.nearestCircleToHighlight||null!==s.state.nearestCircleToHighlight&&null!==x&&(s.state.nearestCircleToHighlight.x!==x.x||s.state.nearestCircleToHighlight.y!==x.y);_&&b&&(s._uniqueCallOutID="#".concat(s._staticHighlightCircle,"_").concat(e),Rt("#".concat(s._staticHighlightCircle,"_").concat(e)).attr("cx","".concat(s._xAxisScale(x.x))).attr("cy","".concat(n(x.y))).attr("visibility","visibility"),Rt("#".concat(s._verticalLine)).attr("transform",function(){return"translate(".concat(s._xAxisScale(x.x),", ").concat(n(x.y),")")}).attr("visibility","visibility").attr("y2","".concat(t-n(x.y))),s.setState({nearestCircleToHighlight:x,isCalloutVisible:!0,refSelected:"#".concat(s._staticHighlightCircle,"_").concat(e),stackCalloutProps:_,YValueHover:_.values,dataPointCalloutProps:_,hoverXValue:v||y,xAxisCalloutAccessibilityData:m,activePoint:"",activeLine:e})),_||s.setState({isCalloutVisible:!1,nearestCircleToHighlight:x,activePoint:"",activeLine:e})},s._handleFocus=function(e,t,n,r,o){s._uniqueCallOutID=r;var i=t instanceof Date?(0,Yu.Yn)(t,s.props.culture,s.props.useUTC):t,a=Ld(s._calloutPoints,t);if(a){var l=s;Rt("#".concat(s._verticalLine)).attr("transform",function(){return"translate(".concat(l._xAxisScale(t),", 0)")}).attr("visibility","visibility"),s._refArray.forEach(function(t){t.index===e&&s.setState({isCalloutVisible:!0,refSelected:t.refElement,hoverXValue:n||""+i,YValueHover:a.values,stackCalloutProps:a,dataPointCalloutProps:a,activePoint:r,xAxisCalloutAccessibilityData:o})})}else s.setState({activePoint:r})},s._handleHover=function(e,t,n,r,o,i,a,l,c,u){u.persist();var d=e instanceof Date?(0,Yu.Yn)(e,s.props.culture,s.props.useUTC):e,h=s,p=Ld(s._calloutPoints,e),f=void 0;if(!1===s.props.isCalloutForStack&&(null==p?void 0:p.values)){var g=Sc(p.values,function(e){return(null==e?void 0:e.y)===t});g&&(f={x:e,values:[g]})}p?(Rt("#".concat(s._verticalLine)).attr("transform",function(){return"translate(".concat(h._xAxisScale(e),", ").concat(a(t),")")}).attr("visibility","visibility").attr("y2","".concat(n-a(t))),s._uniqueCallOutID!==o&&(s._uniqueCallOutID=o,s.setState({isCalloutVisible:!0,refSelected:"#".concat(o),hoverXValue:r||""+d,YValueHover:p.values,YValue:t,legendVal:l,lineColor:c,stackCalloutProps:p,dataPointCalloutProps:f,activePoint:o,xAxisCalloutAccessibilityData:i,nearestCircleToHighlight:null,activeLine:null}))):s.setState({activePoint:o,nearestCircleToHighlight:null,activeLine:null})},s._getClickHandler=function(e){return e?{onClick:e}:{}},s._handleMouseOut=function(){Rt("#".concat(s._verticalLine)).attr("visibility","hidden")},s._handleChartMouseLeave=function(){s._uniqueCallOutID=null,s.setState({isCalloutVisible:!1,activePoint:"",activeLine:null})},s._handleLegendClick=function(e,t){e.onLegendClick&&e.onLegendClick(t)},s._handleMultipleLineLegendSelectionAction=function(e){var t,n=s.state.selectedLegendPoints.reduce(function(t,n,r){return t>-1||n.legend!==e.legend?t:r},-1);t=-1===n?(0,de.fX)((0,de.fX)([],s.state.selectedLegendPoints,!0),[e],!1):s.state.selectedLegendPoints.slice(0,n).concat(s.state.selectedLegendPoints.slice(n+1)),s.props.data&&t.length===s.props.data.lineChartData.length&&(s.props.colorFillBars&&s.props.colorFillBars.length===s.state.selectedColorBarLegend.length||!s.props.colorFillBars)?s._clearMultipleLegendSelections():t.length||s.state.selectedColorBarLegend.length?s.setState({selectedLegendPoints:t,isSelectedLegend:!0}):s._clearMultipleLegendSelections();var r=t.map(function(e){return e.legend});s._handleLegendClick(e,r)},s._handleMultipleColorFillBarLegendSelectionAction=function(e){var t,n=s.state.selectedColorBarLegend.reduce(function(t,n,r){return t>-1||n.legend!==e.legend?t:r},-1);(t=-1===n?(0,de.fX)((0,de.fX)([],s.state.selectedColorBarLegend,!0),[e],!1):s.state.selectedColorBarLegend.slice(0,n).concat(s.state.selectedColorBarLegend.slice(n+1))).length===(s.props.colorFillBars&&s.props.colorFillBars.length)&&(s.props.data&&s.props.data.lineChartData.length===s.state.selectedLegendPoints.length||!s.props.data)?s._clearMultipleLegendSelections():t.length||s.state.selectedLegendPoints.length?s.setState({selectedColorBarLegend:t,isSelectedLegend:!0}):s._clearMultipleLegendSelections();var r=t.map(function(e){return e.legend});s._handleLegendClick(e,r)},s._clearMultipleLegendSelections=function(){s.setState({selectedColorBarLegend:[],selectedLegendPoints:[],isSelectedLegend:!1})},s._legendHighlighted=function(e){return s.state.selectedLegend===e||""===s.state.selectedLegend&&s.state.activeLegend===e},s._noLegendHighlighted=function(){return""===s.state.selectedLegend&&""===s.state.activeLegend},s._getColorFillBarOpacity=function(e){return e.applyPattern?1:.4},s._getAriaLabel=function(e,t){var n,r=s._points[e],o=r.data[t],i=o.x instanceof Date?(0,Yu.Yn)(o.x,s.props.culture,s.props.useUTC):o.x,a=o.xAxisCalloutData||i,l=r.legend,c=o.yAxisCalloutData||o.y;return(null===(n=o.callOutAccessibilityData)||void 0===n?void 0:n.ariaLabel)||"".concat(a,". ").concat(l,", ").concat(c,".")},s._getChartTitle=function(){var e=s.props.data,t=e.chartTitle,n=e.lineChartData;return(t?"".concat(t,". "):"")+"Line chart with ".concat((null==n?void 0:n.length)||0," lines. ")},Aa(s),s.state={hoverXValue:"",activeLegend:"",YValueHover:[],YValue:"",legendVal:"",refSelected:"",selectedLegend:null!==(r=null===(n=t.legendProps)||void 0===n?void 0:n.selectedLegend)&&void 0!==r?r:"",isCalloutVisible:!1,selectedLegendPoints:s._injectIndexPropertyInLineChartData(s.props.data.lineChartData,!0),selectedColorBarLegend:[],isSelectedLegend:(null!==(l=null===(a=null===(i=s.props.legendProps)||void 0===i?void 0:i.selectedLegends)||void 0===a?void 0:a.length)&&void 0!==l?l:0)>0,activePoint:"",nearestCircleToHighlight:null,activeLine:null},s._refArray=[],s._points=s._injectIndexPropertyInLineChartData(s.props.data.lineChartData),s._colorFillBars=[],s._calloutPoints=Zu(s._points)||{},s._circleId=Ta("circle"),s._lineId=Ta("lineID"),s._borderId=Ta("borderID"),s._verticalLine=Ta("verticalLine"),s._colorFillBarPatternId=Ta("colorFillBarPattern"),s._tooltipId=Ta("LineChartTooltipId_"),s._rectId=Ta("containerRectLD"),s._staticHighlightCircle=Ta("staticHighlightCircle"),s._createLegendsMemoized=(0,Ds.J9)(function(e){return s._createLegends(e)}),s._firstRenderOptimization=!0,s._emptyChartId=Ta("_LineChart_empty"),s._cartesianChartRef=o.createRef(),s._legendsRef=o.createRef(),t.eventAnnotationProps&&t.eventAnnotationProps.labelHeight&&(s.eventLabelHeight=t.eventAnnotationProps.labelHeight),s}return(0,de.C6)(t,e),t.prototype.componentDidUpdate=function(e){var t,n,r,o,i,a,l,s,c;(null===(t=e.legendProps)||void 0===t?void 0:t.selectedLegend)===(null===(n=this.props.legendProps)||void 0===n?void 0:n.selectedLegend)&&gd(null===(r=e.legendProps)||void 0===r?void 0:r.selectedLegends,null===(o=this.props.legendProps)||void 0===o?void 0:o.selectedLegends)||this.setState({selectedLegend:null!==(a=null===(i=this.props.legendProps)||void 0===i?void 0:i.selectedLegend)&&void 0!==a?a:"",selectedLegendPoints:this._injectIndexPropertyInLineChartData(this.props.data.lineChartData,!0),isSelectedLegend:(null!==(c=null===(s=null===(l=this.props.legendProps)||void 0===l?void 0:l.selectedLegends)||void 0===s?void 0:s.length)&&void 0!==c?c:0)>0}),e.height===this.props.height&&e.width===this.props.width&&e.data===this.props.data||(this._points=this._injectIndexPropertyInLineChartData(this.props.data.lineChartData),this._calloutPoints=Zu(this._points)||{})},t.prototype.render=function(){var e=this,t=this.props,n=t.tickValues,r=t.tickFormat,i=t.eventAnnotationProps,a=t.legendProps,l=t.data;this._points=this._injectIndexPropertyInLineChartData(l.lineChartData),this._isXAxisDateType=ed(this._points);var s=this._points;a&&a.canSelectMultipleLegends&&(s=this.state.selectedLegendPoints.length>=1?this.state.selectedLegendPoints:this._points,this._calloutPoints=Zu(s));var c=null;this.props.hideLegend||(c=this._createLegendsMemoized(this._points));var u=(0,de.Cl)({isCalloutVisible:this.state.isCalloutVisible,directionalHint:3,YValueHover:this.state.YValueHover,hoverXValue:this.state.hoverXValue,YValue:this.state.YValue,legend:this.state.legendVal,color:this.state.lineColor,XValue:this.state.hoverXValue,id:"toolTip".concat(this._uniqueCallOutID),target:this.state.refSelected,isBeakVisible:!1,gapSpace:15,onDismiss:this._closeCallout,preventDismissOnEvent:function(){return!0},hidden:!(!this.props.hideTooltip&&this.state.isCalloutVisible),descriptionMessage:this.props.getCalloutDescriptionMessage&&this.state.stackCalloutProps?this.props.getCalloutDescriptionMessage(this.state.stackCalloutProps):void 0,"data-is-focusable":!0,xAxisCalloutAccessibilityData:this.state.xAxisCalloutAccessibilityData},this.props.calloutProps),d={tickValues:n,tickFormat:r};return this._isChartEmpty()?o.createElement("div",{id:this._emptyChartId,role:"alert",style:{opacity:"0"},"aria-label":"Graph has no data to display"}):o.createElement(Eh,(0,de.Cl)({},this.props,{chartTitle:this._getChartTitle(),points:s,chartType:Hu.LineChart,calloutProps:u,tickParams:d,legendBars:c,createYAxis:Gu,getmargins:this._getMargins,getMinMaxOfYAxis:this._getNumericMinMaxOfY,getGraphData:this._initializeLineChartData,xAxisType:this._isXAxisDateType?zu.DateAxis:zu.NumericAxis},this._isScatterPolar?{yMaxValue:1,yMinValue:-1}:{},{customizedCallout:this._getCustomizedCallout(),getDomainNRangeValues:this._getDomainNRangeValues,createStringYAxis:Ku,onChartMouseLeave:this._handleChartMouseLeave,enableFirstRenderOptimization:this.props.enablePerfOptimization&&this._firstRenderOptimization,ref:this._cartesianChartRef,children:function(t){return e._xAxisScale=t.xScale,e._yScalePrimary=t.yScalePrimary,e._yScaleSecondary=t.yScaleSecondary,o.createElement(o.Fragment,null,o.createElement("g",null,o.createElement("line",{x1:0,y1:0,x2:0,y2:t.containerHeight,stroke:"#323130",id:e._verticalLine,visibility:"hidden",strokeDasharray:"5,5"}),e.props.optimizeLargeData?o.createElement("rect",{id:e._rectId,width:t.containerWidth,height:t.containerHeight,fill:"transparent"}):o.createElement(o.Fragment,null),o.createElement("g",null,e._renderedColorFillBars,e.lines),i&&o.createElement(vp,(0,de.Cl)({theme:e.props.theme},i,{scale:t.xScale,chartYTop:e.margins.top+e.eventLabelHeight,chartYBottom:t.containerHeight-35}))))}}))},Object.defineProperty(t.prototype,"chartContainer",{get:function(){var e;return(null===(e=this._cartesianChartRef.current)||void 0===e?void 0:e.chartContainer)||null},enumerable:!1,configurable:!0}),t.prototype._createLegends=function(e){var t=this,n=this.props,r=n.legendProps,i=n.allowMultipleShapesForPoints,a=void 0!==i&&i,l=!(!r||!r.canSelectMultipleLegends),s={};e.forEach(function(e){e.legend&&(s[e.legend]||(s[e.legend]=[]),s[e.legend].push(e))});var c=Object.entries(s).map(function(e){var n=e[0],r=e[1],o=r[0];return(0,de.Cl)((0,de.Cl)({title:n,color:o.color,action:function(){l?r.forEach(function(e){return t._handleMultipleLineLegendSelectionAction(e)}):r.forEach(function(e){return t._handleSingleLegendSelectionAction(e)})},onMouseOutAction:function(){t.setState({activeLegend:""})},hoverAction:function(){t._handleChartMouseLeave(),t.setState({activeLegend:n})}},o.legendShape&&{shape:o.legendShape}),a&&{shape:id[o.index%Object.keys(sd).length]})}),u=this.props.colorFillBars?this.props.colorFillBars.map(function(e,n){var r,o=e.legend,i=fp(e.color,null===(r=t.props.theme)||void 0===r?void 0:r.isInverted);return{title:o,color:i,action:function(){l?t._handleMultipleColorFillBarLegendSelectionAction(e):t._handleSingleLegendSelectionAction(e)},onMouseOutAction:function(){t.setState({activeLegend:""})},hoverAction:function(){t._handleChartMouseLeave(),t.setState({activeLegend:o})},opacity:t._getColorFillBarOpacity(e),stripePattern:e.applyPattern}}):[];return o.createElement(Gd,(0,de.Cl)({legends:(0,de.fX)((0,de.fX)([],c,!0),u,!0),enabledWrapLines:this.props.enabledLegendsWrapLines,overflowProps:this.props.legendsOverflowProps,focusZonePropsInHoverCard:this.props.focusZonePropsForLegendsInHoverCard,overflowText:this.props.legendsOverflowText},l&&{onLegendHoverCardLeave:this._onHoverCardHide},this.props.legendProps,{ref:this._legendsRef}))},t.prototype._createLines=function(e,t){var n,r,i,a,l,s,c,u,d,h,p,f,g,v,m,y,_,x,b,C,k,w,E,S,T,D,M,A,L,P,I,N,O,F,R,V,B,H,z,W,Y,j,U,X,q,G,K,Z,$,J,Q,ee,te=this,ne=[];this.state.isSelectedLegend?this._points=this.state.selectedLegendPoints:this._points=this._injectIndexPropertyInLineChartData(this.props.data.lineChartData);for(var re=he(this._points,function(e){return he(e.data,function(e){return e.markerSize})}),oe=yp(this.props.styles,{theme:this.props.theme}),ie=function(e){var ie=[],le=[],se=[],ce=ae._points[e].legend,ue=ae._points[e].color,he=ae.state.activePoint,pe=ae.props.theme,fe=t-ae.margins.bottom+6,ge=!(!ae._points[e].useSecondaryYScale||!ae._yScaleSecondary),ve=ge?ae._yScaleSecondary:ae._yScalePrimary,me=ae._hasMarkersMode?function(e){var t=e.data,n=e.xScale,r=e.yScalePrimary,o=e.yScaleSecondary,i=e.useSecondaryYScale,a=e.xScaleType,l=e.yScaleType,s=e.secondaryYScaleType,c=Td(t,a),u=c[0],d=c[1],h=wd(+u,+d,a),p=u instanceof Date?new Date(+u-h.start):u-h.start,f=d instanceof Date?new Date(+d+h.end):d+h.end,g=Math.min(Math.abs(n(u)-n(p)),Math.abs(n(f)-n(d))),v=i?s:l,m=rd(t,0,i,v),y=m.startValue,_=m.endValue,x=wd(y,_,v),b=y-x.start,C=_+x.end,k=i?o:r,w=Math.min(Math.abs(k(b)-k(y)),Math.abs(k(_)-k(C)));return Math.min(g,w)}({data:ae._points,xScale:ae._xAxisScale,yScalePrimary:ae._yScalePrimary,yScaleSecondary:ae._yScaleSecondary,useSecondaryYScale:ge,xScaleType:ae.props.xScaleType,yScaleType:ae.props.yScaleType,secondaryYScaleType:ae.props.secondaryYScaleType}):0;if(1===ae._points[e].data.length){var ye=ae._points[e].data[0],_e=ye.x,xe=ye.y,be=ye.xAxisCalloutData,Ce=ye.xAxisCalloutAccessibilityData,ke=ae._xAxisScale(_e),we=ve(xe);if(Sd(ke,we)){var Ee="".concat(ae._circleId,"_").concat(e),Se=ae._legendHighlighted(ce)||ae._noLegendHighlighted()||ae.state.isSelectedLegend,Te=ae._points[e].data[0].markerSize,Me=null===(r=null===(n=ae._points[e].lineOptions)||void 0===n?void 0:n.mode)||void 0===r?void 0:r.includes("text"),Ae=ae._points[e].data[0].text;se.push(o.createElement(o.Fragment,{key:"".concat(Ee,"_fragment")},o.createElement("circle",(0,de.Cl)({id:Ee,key:Ee,r:Te?Te*me/re:he===Ee?5.5:3.5,cx:ke,cy:we,fill:he===Ee?pe.semanticColors.bodyBackground:ue,opacity:Se?1:.1,onMouseOver:ae._handleHover.bind(ae,_e,xe,fe,be,Ee,Ce,ve,ce,ue),onMouseMove:ae._handleHover.bind(ae,_e,xe,fe,be,Ee,Ce,ve,ce,ue),onMouseOut:ae._handleMouseOut,strokeWidth:he===Ee?4:0,stroke:he===Ee?ue:"",role:"img","aria-label":ae._getAriaLabel(e,0),"data-is-focusable":Se,ref:function(e){te._refCallback(e,Ee)},onFocus:function(){return te._handleFocus(Ee,_e,be,Ee,Ce)},onBlur:ae._handleMouseOut},ae._getClickHandler(ae._points[e].data[0].onDataPointClick))),!ae._isScatterPolar&&Me&&Ae&&o.createElement("text",{key:"".concat(Ee,"-label"),x:ke,y:we+Math.max(Te?Te*me/re:3.5,4)+12,className:oe.markerLabel,opacity:Se?1:.1},Ae)))}}var Le=0,Pe=null!==(a=null===(i=ae._points[e].gaps)||void 0===i?void 0:i.sort(function(e,t){return e.startIndex-t.startIndex}))&&void 0!==a?a:[],Ie=null===(l=ae._points[e].lineOptions)||void 0===l?void 0:l.curve;if((ae.props.optimizeLargeData||Ie)&&ae._points[e].data.length>1){for(var Ne=De().x(function(e){return te._xAxisScale(e[0])}).y(function(e){return ve(e[1])}).curve(_d(Ie)).defined(function(e){return Sd(te._xAxisScale(e[0]),ve(e[1]))}),Oe="".concat(ae._lineId,"_").concat(e),Fe="".concat(ae._borderId,"_").concat(e),Re=(null===(s=ae._points[e].lineOptions)||void 0===s?void 0:s.strokeWidth)||ae.props.strokeWidth||4,Ve=ae._legendHighlighted(ce)||ae._noLegendHighlighted()||ae.state.isSelectedLegend,Be=[],He=0;He<ae._points[e].data.length;He++)Be.push([ae._points[e].data[He].x instanceof Date?ae._points[e].data[He].x.getTime():ae._points[e].data[He].x,ae._points[e].data[He].y]);var ze=null===(c=ae._points[e].lineOptions)||void 0===c?void 0:c.mode,We="markers"!==ze;if(We&&Ve){var Ye=(null===(u=ae._points[e].lineOptions)||void 0===u?void 0:u.lineBorderWidth)?Number.parseFloat(ae._points[e].lineOptions.lineBorderWidth.toString()):0;Ye>0&&le.push(o.createElement("path",{id:Fe,key:Fe,d:Ne(Be),fill:"transparent",strokeLinecap:null!==(h=null===(d=ae._points[e].lineOptions)||void 0===d?void 0:d.strokeLinecap)&&void 0!==h?h:"round",strokeWidth:Number.parseFloat(Re.toString())+Ye,stroke:(null===(p=ae._points[e].lineOptions)||void 0===p?void 0:p.lineBorderColor)||pe.semanticColors.bodyBackground,opacity:1})),ie.push(o.createElement("path",(0,de.Cl)({id:Oe,key:Oe,d:Ne(Be),fill:"transparent","data-is-focusable":!0,stroke:ue,strokeWidth:Re,strokeLinecap:null!==(g=null===(f=ae._points[e].lineOptions)||void 0===f?void 0:f.strokeLinecap)&&void 0!==g?g:"round",strokeDasharray:null===(v=ae._points[e].lineOptions)||void 0===v?void 0:v.strokeDasharray,onMouseMove:ae._onMouseOverLargeDataset.bind(ae,e,fe,ve),onMouseOver:ae._onMouseOverLargeDataset.bind(ae,e,fe,ve),onMouseOut:ae._handleMouseOut},ae._getClickHandler(ae._points[e].onLineClick),{opacity:1})))}else We&&ie.push(o.createElement("path",{id:Oe,key:Oe,d:Ne(Be),fill:"transparent","data-is-focusable":!1,stroke:ue,strokeWidth:Re,strokeLinecap:null!==(y=null===(m=ae._points[e].lineOptions)||void 0===m?void 0:m.strokeLinecap)&&void 0!==y?y:"round",strokeDasharray:null===(_=ae._points[e].lineOptions)||void 0===_?void 0:_.strokeDasharray,opacity:.1}));var je=null!==ae.state.activeLine&&ae.state.activeLine===e;if(se.push(o.createElement("circle",{id:"".concat(ae._staticHighlightCircle,"_").concat(e),key:"".concat(ae._staticHighlightCircle,"_").concat(e),r:5.5,cx:0,cy:0,fill:pe.semanticColors.bodyBackground,strokeWidth:4,stroke:ue,visibility:je?"visibility":"hidden",onMouseMove:ae._onMouseOverLargeDataset.bind(ae,e,fe,ve),onMouseOver:ae._onMouseOverLargeDataset.bind(ae,e,fe,ve),onMouseOut:ae._handleMouseOut})),null==ze?void 0:ze.includes("markers"))for(He=0;He<ae._points[e].data.length;He++){var Ue=ae._points[e].data[He],Xe=Ue.x,qe=Ue.y;if(ke=ae._xAxisScale(Xe),we=ve(qe),Sd(ke,we)){var Ge=ae._points[e].data[He].markerSize,Ke=null===(x=ae._points[e].data[He])||void 0===x?void 0:x.markerColor;se.push(o.createElement("circle",{key:"".concat(ae._circleId,"_").concat(e,"_").concat(He,"_marker"),r:Ge?Ge*me*.3/re:he===ae._circleId?5.5:3.5,cx:ke,cy:we,fill:he===ae._circleId?pe.semanticColors.bodyBackground:Ke||(null===(b=ae._points[e])||void 0===b?void 0:b.color)||ue,stroke:Ke||ue,strokeWidth:1,opacity:Ve?1:.1,onMouseMove:ae._onMouseOverLargeDataset.bind(ae,e,fe,ve),onMouseOver:ae._onMouseOverLargeDataset.bind(ae,e,fe,ve),onMouseOut:ae._handleMouseOut}))}}}else if(!ae.props.optimizeLargeData)for(var Ze=function(t){var n=ae._checkInGap(t,Pe,Le),r=n.isInGap;Le=n.gapIndex;var i="".concat(ae._lineId,"_").concat(e,"_").concat(t),a="".concat(ae._borderId,"_").concat(e,"_").concat(t),l="".concat(ae._circleId,"_").concat(e,"_").concat(t),s=ae._points[e].data[t-1],c=s.x,u=s.y,d=s.xAxisCalloutData,h=s.xAxisCalloutAccessibilityData,p=ae._points[e].data[t],f=p.x,g=p.y,v=ae._xAxisScale(c),m=ve(u),y=ae._xAxisScale(f),_=ve(g),x=(null===(C=ae._points[e].lineOptions)||void 0===C?void 0:C.strokeWidth)||ae.props.strokeWidth||4,b=ae._legendHighlighted(ce)||ae._noLegendHighlighted()||ae.state.isSelectedLegend,Q=ae._points[e].hideNonActiveDots&&he!==l,ee=null===(w=null===(k=ae._points[e].lineOptions)||void 0===k?void 0:k.mode)||void 0===w?void 0:w.includes("text"),ne=ae._points[e].data[t-1].text,ge=ae._points[e].data[t-1].markerSize;if(Sd(v,m)){var ye=ae._getPath(v,m,l,t,!1,ae._points[e].index);se.push((null===(S=null===(E=ae._points[e].lineOptions)||void 0===E?void 0:E.mode)||void 0===S?void 0:S.includes("markers"))||ee?o.createElement(o.Fragment,null,o.createElement("circle",(0,de.Cl)({id:l,key:l,r:ge?ge*me/re:4,cx:v,cy:m,"data-is-focusable":b,onMouseOver:ae._handleHover.bind(ae,c,u,fe,d,l,h,ve,ce,ue),onMouseMove:ae._handleHover.bind(ae,c,u,fe,d,l,h,ve,ce,ue),onMouseOut:ae._handleMouseOut,onFocus:function(){return te._handleFocus(i,c,d,l,h)},onBlur:ae._handleMouseOut},ae._getClickHandler(ae._points[e].data[t-1].onDataPointClick),{opacity:b&&!Q?1:.01,fill:(null===(T=ae._points[e].data[t-1])||void 0===T?void 0:T.markerColor)||ae._getPointFill(ue,l,t,!1),stroke:(null===(D=ae._points[e].data[t-1])||void 0===D?void 0:D.markerColor)||ue,strokeWidth:x,role:"img","aria-label":null!==(M=ae._points[e].data[t-1].text)&&void 0!==M?M:ae._getAriaLabel(e,t-1)})),!ae._isScatterPolar&&ee&&ne&&o.createElement("text",{key:"".concat(l,"-label"),x:v,y:m+Math.max(ge?ge*me/re:4,4)+12,className:oe.markerLabel,opacity:b&&!Q?1:.01},ne)):o.createElement("path",(0,de.Cl)({id:l,key:l,d:ye,"data-is-focusable":b,onMouseOver:ae._handleHover.bind(ae,c,u,fe,d,l,h,ve,ce,ue),onMouseMove:ae._handleHover.bind(ae,c,u,fe,d,l,h,ve,ce,ue),onMouseOut:ae._handleMouseOut,onFocus:function(){return te._handleFocus(i,c,d,l,h)},onBlur:ae._handleMouseOut},ae._getClickHandler(ae._points[e].data[t-1].onDataPointClick),{opacity:b&&!Q?1:.01,fill:(null===(A=ae._points[e].data[t-1])||void 0===A?void 0:A.markerColor)||ae._getPointFill(ue,l,t,!1),stroke:(null===(L=ae._points[e].data[t-1])||void 0===L?void 0:L.markerColor)||ue,strokeWidth:x,role:"img","aria-label":ae._getAriaLabel(e,t-1)})))}if(t+1===ae._points[e].data.length){var _e="".concat(l).concat(t,"L"),xe="".concat(l).concat(t,"D"),be=ae._points[e].hideNonActiveDots&&he!==_e,Ce=ae._points[e].data[t],ke=Ce.xAxisCalloutData,we=Ce.xAxisCalloutAccessibilityData;ge=ae._points[e].data[t].markerSize;var Ee=null===(I=null===(P=ae._points[e].lineOptions)||void 0===P?void 0:P.mode)||void 0===I?void 0:I.includes("text"),Se=ae._points[e].data[t].text;Sd(y,_)&&(ye=ae._getPath(y,_,_e,t,!0,ae._points[e].index),se.push(o.createElement(o.Fragment,{key:"".concat(_e,"_container")},(null===(O=null===(N=ae._points[e].lineOptions)||void 0===N?void 0:N.mode)||void 0===O?void 0:O.includes("markers"))||Ee?o.createElement(o.Fragment,null,o.createElement("circle",(0,de.Cl)({id:_e,key:_e,r:ge?ge*me/re:4,cx:y,cy:_,"data-is-focusable":b,onMouseOver:ae._handleHover.bind(ae,f,g,fe,ke,_e,we,ve,ce,ue),onMouseMove:ae._handleHover.bind(ae,f,g,fe,ke,_e,we,ve,ce,ue),onMouseOut:ae._handleMouseOut,onFocus:function(){return te._handleFocus(i,f,ke,_e,we)},onBlur:ae._handleMouseOut},ae._getClickHandler(ae._points[e].data[t].onDataPointClick),{opacity:b&&!be?1:.01,fill:ae._getPointFill(ue,_e,t,!0),stroke:ue,strokeWidth:x,role:"img","aria-label":null!==(F=ae._points[e].data[t].text)&&void 0!==F?F:ae._getAriaLabel(e,t)})),!ae._isScatterPolar&&Ee&&Se&&o.createElement("text",{key:"".concat(_e,"-label"),x:y,y:_+Math.max(ge?ge*me/re:4,4)+12,className:oe.markerLabel,opacity:b&&!Q?1:.01},ne)):o.createElement("path",(0,de.Cl)({id:_e,key:_e,d:ye,"data-is-focusable":b,onMouseOver:ae._handleHover.bind(ae,f,g,fe,ke,_e,we,ve,ce,ue),onMouseMove:ae._handleHover.bind(ae,f,g,fe,ke,_e,we,ve,ce,ue),onMouseOut:ae._handleMouseOut,onFocus:function(){return te._handleFocus(i,f,ke,_e,we)},onBlur:ae._handleMouseOut},ae._getClickHandler(ae._points[e].data[t].onDataPointClick),{opacity:b&&!be?1:.01,fill:(null===(R=ae._points[e].data[t])||void 0===R?void 0:R.markerColor)||ae._getPointFill(ue,_e,t,!0),stroke:(null===(V=ae._points[e].data[t])||void 0===V?void 0:V.markerColor)||ue,strokeWidth:x,role:"img","aria-label":ae._getAriaLabel(e,t)})),o.createElement("circle",{id:xe,key:xe,r:8,cx:y,cy:_,opacity:0,width:0,onMouseOver:ae._handleHover.bind(ae,f,g,fe,ke,_e,we,ve,ce,ue),onMouseMove:ae._handleHover.bind(ae,f,g,fe,ke,_e,we,ve,ce,ue),onMouseOut:ae._handleMouseOut,strokeWidth:0,focusable:!1,onBlur:ae._handleMouseOut}))))}if(Sd(v,m)&&Sd(y,_)&&(!ae._hasMarkersMode||(null===(H=null===(B=ae._points[e].lineOptions)||void 0===B?void 0:B.mode)||void 0===H?void 0:H.includes("lines"))))if(b){if(!r){var Te=(null===(z=ae._points[e].lineOptions)||void 0===z?void 0:z.lineBorderWidth)?Number.parseFloat(ae._points[e].lineOptions.lineBorderWidth.toString()):0;Te>0&&le.push(o.createElement("line",{id:a,key:a,x1:v,y1:m,x2:y,y2:_,strokeLinecap:null!==(Y=null===(W=ae._points[e].lineOptions)||void 0===W?void 0:W.strokeLinecap)&&void 0!==Y?Y:"round",strokeWidth:Number.parseFloat(x.toString())+Te,stroke:(null===(j=ae._points[e].lineOptions)||void 0===j?void 0:j.lineBorderColor)||pe.semanticColors.bodyBackground,opacity:1})),ie.push(o.createElement("line",(0,de.Cl)({id:i,key:i,x1:v,y1:m,x2:y,y2:_,strokeWidth:x,ref:function(e){te._refCallback(e,i)},onMouseOver:ae._handleHover.bind(ae,c,u,fe,d,l,h,ve,ce,ue),onMouseMove:ae._handleHover.bind(ae,c,u,fe,d,l,h,ve,ce,ue),onMouseOut:ae._handleMouseOut,stroke:ue,strokeLinecap:null!==(X=null===(U=ae._points[e].lineOptions)||void 0===U?void 0:U.strokeLinecap)&&void 0!==X?X:"round",strokeDasharray:null===(q=ae._points[e].lineOptions)||void 0===q?void 0:q.strokeDasharray,strokeDashoffset:null===(G=ae._points[e].lineOptions)||void 0===G?void 0:G.strokeDashoffset,opacity:1},ae._getClickHandler(ae._points[e].onLineClick))))}}else r||ie.push(o.createElement("line",{id:i,key:i,x1:v,y1:m,x2:y,y2:_,strokeWidth:x,stroke:ue,strokeLinecap:null!==(Z=null===(K=ae._points[e].lineOptions)||void 0===K?void 0:K.strokeLinecap)&&void 0!==Z?Z:"round",strokeDasharray:null===($=ae._points[e].lineOptions)||void 0===$?void 0:$.strokeDasharray,strokeDashoffset:null===(J=ae._points[e].lineOptions)||void 0===J?void 0:J.strokeDashoffset,opacity:.1}))},$e=1;$e<ae._points[e].data.length;$e++)Ze($e);var Je=null===(Q=ae._points[e].lineOptions)||void 0===Q?void 0:Q.fill,Qe=ae._legendHighlighted(ce)||ae._noLegendHighlighted()||ae.state.isSelectedLegend;if("toself"===Je&&ae._points[e].data.length>=3&&Qe&&ae._isScatterPolar){var et=function(e){return te._xAxisScale((e.x,Date,e.x))},tt=De().x(function(e){return et(e)}).y(function(e){return ve(e.y)}).curve(_d(Ie)).defined(function(e){return Sd(et(e),ve(e.y))})(ae._points[e].data);tt&&ie.push(o.createElement("path",{key:"scatterpolar_fill_".concat(e),d:"".concat(tt,"Z"),fill:ue,fillOpacity:.5,stroke:ue,strokeWidth:2,strokeOpacity:.8,pointerEvents:"none"}))}ae._isScatterPolar&&se.push.apply(se,function(e){var t,n,r=e.xAxisScale,i=e.yAxisScale,a=e.className,l=e.lineOptions,s=e.minPixelGap,c=void 0===s?40:s,u=function(e){return e?{originXOffset:e.originXOffset,direction:"clockwise"===e.direction||"counterclockwise"===e.direction?e.direction:void 0,rotation:e.rotation,axisLabel:Array.isArray(e.axisLabel)?e.axisLabel:void 0}:void 0}(l),d=null!==(t=null==u?void 0:u.axisLabel)&&void 0!==t?t:[],h=[],p=[],f=d.length,g="clockwise"===(null==u?void 0:u.direction)?-1:1,v=(null!==(n=null==u?void 0:u.rotation)&&void 0!==n?n:0)*Math.PI/180;return d.forEach(function(e,t){var n=v+g*(2*Math.PI/f)*t,l=(null==u?void 0:u.originXOffset)||0,s=r(.7*Math.cos(n)-l/2),d=i(.7*Math.sin(n)),m=p.every(function(e){return Math.sqrt(Math.pow(s-e.x,2)+Math.pow(d-e.y,2))>=c});(0===h.length||m)&&(h.push(o.createElement("text",{key:"scatterpolar-label-".concat(e),x:s,y:d,className:a,textAnchor:"middle",alignmentBaseline:"middle",opacity:1},e)),p.push({x:s,y:d}))}),h}({xAxisScale:ae._xAxisScale,yAxisScale:ve,className:oe.markerLabel||"",lineOptions:null===(ee=ae._points[e])||void 0===ee?void 0:ee.lineOptions})),ne.push(o.createElement("g",{key:"line_".concat(e),role:"region","aria-label":"".concat(ce,", line ").concat(e+1," of ").concat(ae._points.length," with ").concat(ae._points[e].data.length," data points.")},le,ie,se))},ae=this,le=this._points.length-1;le>=0;le--)ie(le);if(!this.props.showXAxisLablesTooltip)try{document.getElementById(this._tooltipId)&&document.getElementById(this._tooltipId).remove()}catch(e){}if(!this.props.wrapXAxisLables&&this.props.showXAxisLablesTooltip){var se=Rt(e).call(this._xAxisScale);try{document.getElementById(this._tooltipId)&&document.getElementById(this._tooltipId).remove()}catch(e){}var ce={tooltipCls:oe.tooltip,id:this._tooltipId,axis:se};se&&Qu(ce)}return ne},t.prototype._refCallback=function(e,t){this._refArray.push({index:t,refElement:e})},t.prototype._isChartEmpty=function(){return!(this.props.data&&this.props.data.lineChartData&&this.props.data.lineChartData.length>0&&this.props.data.lineChartData.filter(function(e){return e.data.length}).length>0)},t.defaultProps={enableReflow:!0,useUTC:!0,isCalloutForStack:!0},t}(o.Component),bp=(0,ue.I)(xp,function(e){return{tooltip:xh(e.theme),markerLabel:kh(e.theme)}});function Cp(e,t){if((o=e.length)>1)for(var n,r,o,i=1,a=e[t[0]],l=a.length;i<o;++i)for(r=a,a=e[t[i]],n=0;n<l;++n)a[n][1]+=a[n][0]=isNaN(r[n][1])?r[n][0]:r[n][1]}function kp(e){for(var t=e.length,n=new Array(t);--t>=0;)n[t]=t;return n}function wp(e,t){return e[t]}function Ep(e){var t=[];return t.key=e,t}function Sp(e){return e<0?-1:1}function Tp(e,t,n){var r=e._x1-e._x0,o=t-e._x1,i=(e._y1-e._y0)/(r||o<0&&-0),a=(n-e._y1)/(o||r<0&&-0),l=(i*o+a*r)/(r+o);return(Sp(i)+Sp(a))*Math.min(Math.abs(i),Math.abs(a),.5*Math.abs(l))||0}function Dp(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function Mp(e,t,n){var r=e._x0,o=e._y0,i=e._x1,a=e._y1,l=(i-r)/3;e._context.bezierCurveTo(r+l,o+l*t,i-l,a-l*n,i,a)}function Ap(e){this._context=e}function Lp(e){this._context=e}function Pp(e){return new Ap(e)}Ap.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Mp(this,this._t0,Dp(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(t=+t,(e=+e)!==this._x1||t!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,Mp(this,Dp(this,n=Tp(this,e,t)),n);break;default:Mp(this,this._t0,n=Tp(this,e,t))}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}},(function(e){this._context=new Lp(e)}.prototype=Object.create(Ap.prototype)).point=function(e,t){Ap.prototype.point.call(this,t,e)},Lp.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,o,i){this._context.bezierCurveTo(t,e,r,n,i,o)}};var Ip,Np=(0,xa.Z)(),Op=qt(function(e){return e.x}).left;!function(e){e.show="visibility",e.hide="hidden"}(Ip||(Ip={}));var Fp=function(e){function t(t){var n,r=e.call(this,t)||this;return r._containsSecondaryYAxis=!1,r._hasDuplicateXValues=!1,r._hasMissingXValues=!1,r.toImage=function(e){var t,n;return Od([{container:null===(t=r._cartesianChartRef.current)||void 0===t?void 0:t.chartContainer}],r.props.hideLegend||null===(n=r._legendsRef.current)||void 0===n?void 0:n.toSVG,(0,ba.jI)(),e)},r._getMinMaxOfYAxis=function(e,t,n){return rd(e,0,n)},r._getDomainNRangeValues=function(e,t,n,r,o,i,a,l){return i===zu.NumericAxis?td(e,t,n,o):i===zu.DateAxis?nd(e,t,n,o,l,r):{dStartValue:0,dEndValue:0,rStartValue:0,rEndValue:0}},r._getMargins=function(e){r.margins=e},r._onRectMouseMove=function(e){e.persist();var t=r.props.data.lineChartData,n=r._xAxisRectScale.invert(Gh(e)[0],document.getElementById(r._rectId)),o=Op(t[0].data,n),i=t[0].data[o-1],a=t[0].data[o],l=null,s=null,c=t[0].data.length>0?ld(t[0].data[0].x,!0):null;if(void 0===i&&void 0!==a)l=a.x,s=o;else if(void 0!==i&&void 0===a)l=i.x,s=o-1;else{var u=void 0,d=void 0,h=void 0;switch(c){case zu.DateAxis:u=new Date(n).getTime(),d=i.x.getTime(),h=a.x.getTime(),l=Math.abs(u-d)>Math.abs(u-h)?a.x:i.x,s=Math.abs(u-d)>Math.abs(u-h)?o:o-1;break;case zu.NumericAxis:u=n,d=i.x,h=a.x,l=Math.abs(u-d)>Math.abs(u-h)?a.x:i.x,s=Math.abs(u-d)>Math.abs(u-h)?o:o-1}}var p=t[0].data[s],f=p.xAxisCalloutData,g=p.xAxisCalloutAccessibilityData,v=l instanceof Date?(0,Yu.Yn)(l,r.props.culture,r.props.useUTC):l,m=Ld(r._calloutPoints,l),y=c===zu.DateAxis?l.getTime():l,_=r.state.nearestCircleToHighlight!==y;if(m&&_&&!r.state.isShowCalloutPending){var x=r._getFilteredLegendValues(m.values);r.setState({nearestCircleToHighlight:y,isCalloutVisible:!1,isShowCalloutPending:!0,lineXValue:r._xAxisRectScale(l),displayOfLine:Ip.show,isCircleClicked:!1,stackCalloutProps:(0,de.Cl)((0,de.Cl)({},m),{values:x}),YValueHover:x,dataPointCalloutProps:(0,de.Cl)((0,de.Cl)({},m),{values:x}),hoverXValue:f||v,xAxisCalloutAccessibilityData:g,activePoint:""})}m||r.setState({isCalloutVisible:!1,nearestCircleToHighlight:y,displayOfLine:Ip.hide,isCircleClicked:!1})},r._onRectMouseOut=function(){},r._handleChartMouseLeave=function(){r.setState({refSelected:null,isCalloutVisible:!1,nearestCircleToHighlight:null,lineXValue:0,displayOfLine:Ip.hide,isCircleClicked:!1,stackCalloutProps:void 0,dataPointCalloutProps:void 0,hoverXValue:void 0,YValueHover:[]})},r._getDataPoints=function(e,t){var n,o=[],i=0;if(r._shouldFillToZeroY())e.forEach(function(e,n){var r=[];t.forEach(function(t){r.push({values:[0,t[e]],xVal:t.xVal}),t[e]>i&&(i=t[e])}),o.push(r)});else{var a=function(){var e=ge([]),t=kp,n=Cp,r=wp;function o(o){var i,a,l=Array.from(e.apply(this,arguments),Ep),s=l.length,c=-1;for(var u of o)for(i=0,++c;i<s;++i)(l[i][c]=[0,+r(u,l[i].key,c,o)]).data=u;for(i=0,a=fe(t(l));i<s;++i)l[a[i]].index=i;return n(l,a),l}return o.keys=function(t){return arguments.length?(e="function"==typeof t?t:ge(Array.from(t)),o):e},o.value=function(e){return arguments.length?(r="function"==typeof e?e:ge(+e),o):r},o.order=function(e){return arguments.length?(t=null==e?kp:"function"==typeof e?e:ge(Array.from(e)),o):t},o.offset=function(e){return arguments.length?(n=null==e?Cp:e,o):n},o}().keys(e)(t);i=he(a[a.length-1],function(e){return e[1]}),a.forEach(function(e){var t=[];e.forEach(function(e){t.push({values:e,xVal:e.data.xVal})}),o.push(t)})}return r._isMultiStackChart=!!((null===(n=r.props.legendProps)||void 0===n?void 0:n.selectedLegends)?(null==o?void 0:o.length)>=1:(null==o?void 0:o.length)>1),{renderData:o,maxOfYVal:r._containsSecondaryYAxis?rd(r.props.data.lineChartData).endValue:i}},r._createDataSet=function(e){if(r.props.enablePerfOptimization&&r._enableComputationOptimization&&!r._hasDuplicateXValues){var t=[],n=[],o=[],i=[],a=Zu(e);e&&e.length&&e.forEach(function(e){o.push(e.color),i.push(e.opacity||1),t.push.apply(t,e.data)});var l={};t.forEach(function(e){var t=e.x instanceof Date?e.x.toLocaleString():e.x;l[t]?l[t].push(e):l[t]=[e]}),Object.keys(l).forEach(function(e){var t=l[e],r={};t.forEach(function(e,t){r.xVal=e.x,r["chart".concat(t)]=e.y}),n.push(r)});for(var s=n&&Object.keys(n[0]).length,c=[],u=0;u<s-1;u++){var d="chart".concat(u);c.push(d)}var h=r._getDataPoints(c,n);return{colors:o,opacity:i,keys:c,data:h,calloutPoints:a}}var p=[],f=[],g=[],v=[],m=(a=Zu(e),h={},c=[],0);if(e&&e.length&&e.forEach(function(e){r._hasDuplicateXValues&&!e.legend&&(e.legend="chart".concat(m),++m),e.data.forEach(function(t){t.legend=e.legend}),g.push(e.color),v.push(e.opacity||1),p.push.apply(p,e.data)}),r._hasDuplicateXValues){var y=r._createDatasetForXCoordinateWithMultipleYValues(p);h=r._getDataPoints(y.keys,y.filteredDataSet)}else{for(var _=p,x=function(){var e=_[0].x instanceof Date?_[0].x.toLocaleString():_[0].x,t=_.filter(function(t){return(t.x instanceof Date?t.x.toLocaleString():t.x)===e}),n={};t.forEach(function(e,t){n.xVal=e.x,n["chart".concat(t)]=e.y}),f.push(n);var r=_[0].x instanceof Date?_[0].x.toLocaleString():_[0].x;_=_.filter(function(e){return(e.x instanceof Date?e.x.toLocaleString():e.x)!==r})};_.length;)x();for(s=f&&Object.keys(f[0]).length,u=0;u<s-1;u++)d="chart".concat(u),c.push(d);h=r._getDataPoints(c,f)}return{colors:g,opacity:v,keys:c,data:h,calloutPoints:a}},r._createDatasetForXCoordinateWithMultipleYValues=function(e){var t=[],n={};e.forEach(function(e){var t=e.x instanceof Date?e.x.toLocaleString():e.x;n[t]||(n[t]=[]),n[t].push(e)}),Object.keys(n).forEach(function(e){var r=n[e];r.forEach(function(e,n){var o={xVal:r[0].x};o[e.legend?e.legend:"chart".concat(n)]=e.y,t.push(o)})});var r=[];t.forEach(function(e){Object.keys(e).forEach(function(e){"xVal"===e||r.includes(e)||r.push(e)})}),t.forEach(function(e){r.forEach(function(t){e[t]||(e[t]=0)})});var o=t.filter(function(e){return r.some(function(t){return 0!==e[t]})});return{keys:Array.from(new Set(o.flatMap(function(e){return Object.keys(e).filter(function(e){return"xVal"!==e})}))),filteredDataSet:o}},r._getCustomizedCallout=function(){return r.props.onRenderCalloutPerStack?r.props.onRenderCalloutPerStack(r.state.stackCalloutProps):r.props.onRenderCalloutPerDataPoint?r.props.onRenderCalloutPerDataPoint(r.state.dataPointCalloutProps):null},r._getGraphData=function(e,t,n,o,i,a,l){r._chart=r._drawGraph(n,e,t,l,i)},r._getLegendData=function(e){var t=[];return e.forEach(function(e){var n=e.color;if(!(t.filter(function(t){return t.title===e.legend&&t.color===n}).length>0)){var o={title:e.legend,color:n,hoverAction:function(){r._handleChartMouseLeave(),r._onLegendHover(e.legend)},onMouseOutAction:function(){r._onLegendLeave()}};t.push(o)}}),o.createElement(Gd,(0,de.Cl)({legends:t,overflowProps:r.props.legendsOverflowProps,enabledWrapLines:r.props.enabledLegendsWrapLines,focusZonePropsInHoverCard:r.props.focusZonePropsForLegendsInHoverCard},r.props.legendProps,{onChange:r._onLegendSelectionChange.bind(r),ref:r._legendsRef}))},r._onDataPointClick=function(e){e&&e(),r.setState({isCircleClicked:!0})},r._getOpacity=function(e){return r._isMultiStackChart?r._legendHighlighted(e)||r._noLegendHighlighted()?.7:.1:.7},r._getLineOpacity=function(e){if(r._isMultiStackChart){var t=.3;return r.state.isCalloutVisible&&(t=1),r._noLegendHighlighted()||(t=r._legendHighlighted(e)?0:.1),t}return 1},r._updateCircleFillColor=function(e,t,n){var o=t;return r.state.nearestCircleToHighlight!==e&&r.state.activePoint!==n||(r._highlightedCircleId=n,r.state.isCircleClicked||(o=r.props.theme.semanticColors.bodyBackground)),o},r._drawGraph=function(e,t,n,i,a){var l,s=r._addDefaultColors(r.props.data.lineChartData),c=r.props.data,u=c.pointOptions,d=c.pointLineOptions,h=[];r._data.forEach(function(e,a){var l,c,u,d,p,f,g,v,m,y,_,x,b=(null===(l=s[a])||void 0===l?void 0:l.useSecondaryYScale)&&i?i:n,C=_d(null===(u=null===(c=s[a])||void 0===c?void 0:c.lineOptions)||void 0===u?void 0:u.curve,Pp),k=function(e,t,n){var r=null,o=ge(!0),i=null,a=me,l=null,s=Ee(c);function c(c){var u,d,h,p,f,g=(c=fe(c)).length,v=!1,m=new Array(g),y=new Array(g);for(null==i&&(l=a(f=s())),u=0;u<=g;++u){if(!(u<g&&o(p=c[u],u,c))===v)if(v=!v)d=u,l.areaStart(),l.lineStart();else{for(l.lineEnd(),l.lineStart(),h=u-1;h>=d;--h)l.point(m[h],y[h]);l.lineEnd(),l.areaEnd()}v&&(m[u]=+e(p,u,c),y[u]=+t(p,u,c),l.point(r?+r(p,u,c):m[u],n?+n(p,u,c):y[u]))}if(f)return l=null,f+""||null}function u(){return De().defined(o).curve(a).context(i)}return e="function"==typeof e?e:void 0===e?Se:ge(+e),t="function"==typeof t?t:ge(void 0===t?0:+t),n="function"==typeof n?n:void 0===n?Te:ge(+n),c.x=function(t){return arguments.length?(e="function"==typeof t?t:ge(+t),r=null,c):e},c.x0=function(t){return arguments.length?(e="function"==typeof t?t:ge(+t),c):e},c.x1=function(e){return arguments.length?(r=null==e?null:"function"==typeof e?e:ge(+e),c):r},c.y=function(e){return arguments.length?(t="function"==typeof e?e:ge(+e),n=null,c):t},c.y0=function(e){return arguments.length?(t="function"==typeof e?e:ge(+e),c):t},c.y1=function(e){return arguments.length?(n=null==e?null:"function"==typeof e?e:ge(+e),c):n},c.lineX0=c.lineY0=function(){return u().x(e).y(t)},c.lineY1=function(){return u().x(e).y(n)},c.lineX1=function(){return u().x(r).y(t)},c.defined=function(e){return arguments.length?(o="function"==typeof e?e:ge(!!e),c):o},c.curve=function(e){return arguments.length?(a=e,null!=i&&(l=a(i)),c):a},c.context=function(e){return arguments.length?(null==e?i=l=null:l=a(i=e),c):i},c}().x(function(e){return t(e.xVal)}).y0(function(e){return b(e.values[0])}).y1(function(e){return b(e.values[1])}).curve(C),w=De().x(function(e){return t(e.xVal)}).y(function(e){return b(e.values[1])}).curve(C),E=r._shouldFillToZeroY()?.8:r._opacity[a];h.push(o.createElement(o.Fragment,{key:"".concat(a,"-graph-").concat(r._uniqueIdForGraph)},r.props.enableGradient&&o.createElement("defs",null,o.createElement("linearGradient",{id:"gradient_".concat(a),x1:"0%",x2:"0%",y1:"0%",y2:"100%"},o.createElement("stop",{offset:"0",stopColor:r._colors[a]}),o.createElement("stop",{offset:"100%",stopColor:"transparent"}))),o.createElement("path",{id:"".concat(a,"-line-").concat(r._uniqueIdForGraph),d:w(e),fill:"transparent",strokeWidth:null!==(f=null===(p=null===(d=s[a])||void 0===d?void 0:d.lineOptions)||void 0===p?void 0:p.strokeWidth)&&void 0!==f?f:3,stroke:r._colors[a],opacity:r._getLineOpacity(s[a].legend),onMouseMove:r._onRectMouseMove,onMouseOut:r._onRectMouseOut,onMouseOver:r._onRectMouseMove,strokeDasharray:null===(v=null===(g=s[a])||void 0===g?void 0:g.lineOptions)||void 0===v?void 0:v.strokeDasharray,strokeDashoffset:null===(y=null===(m=s[a])||void 0===m?void 0:m.lineOptions)||void 0===y?void 0:y.strokeDashoffset,strokeLinecap:null===(x=null===(_=s[a])||void 0===_?void 0:_.lineOptions)||void 0===x?void 0:x.strokeLinecap}),1===e.length?o.createElement("circle",{id:"".concat(a,"-graph-").concat(r._uniqueIdForGraph),cx:t(e[0].xVal),cy:b(e[0].values[1]),r:6,stroke:r._colors[a],strokeWidth:3,fill:r._colors[a],opacity:E,fillOpacity:r._getOpacity(s[a].legend),onMouseMove:r._onRectMouseMove,onMouseOut:r._onRectMouseOut,onMouseOver:r._onRectMouseMove}):o.createElement("path",(0,de.Cl)({id:"".concat(a,"-graph-").concat(r._uniqueIdForGraph),d:k(e),fill:r.props.enableGradient?"url(#gradient_".concat(a,")"):r._colors[a],opacity:E,fillOpacity:r._getOpacity(s[a].legend),onMouseMove:r._onRectMouseMove,onMouseOut:r._onRectMouseOut,onMouseOver:r._onRectMouseMove},r.props.optimizeLargeData&&{"data-is-focusable":r._legendHighlighted(s[a].legend)||r._noLegendHighlighted(),role:"img","aria-label":"".concat(s[a].legend,", series ").concat(a+1," of ").concat(s.length," with ").concat(s[a].data.length," data points.")}))))});var p=u&&u.r?Number(u.r):8;r._data.forEach(function(e,a){var c;if(s.length!==a){var d=(null===(c=s[a])||void 0===c?void 0:c.useSecondaryYScale)&&i?i:n;r.props.optimizeLargeData&&1!==e.length?e.forEach(function(e,n){var i=e.xVal instanceof Date?e.xVal.getTime():e.xVal;if(r.state.nearestCircleToHighlight===i){var c="".concat(r._circleId,"_").concat(a*r._data[0].length+n);l=s[a].color;var f=s[a].legend;h.push(o.createElement("circle",(0,de.Cl)({key:c,id:c,cx:t(e.xVal),cy:d(e.values[1]),stroke:l,strokeWidth:3,fill:r._updateCircleFillColor(i,l,c),onMouseOut:r._onRectMouseOut,onMouseOver:r._onRectMouseMove},r._getOnClickHandler(s,a,n),fd(u),{r:r._getCircleRadius(i,p,c,f)})))}}):h.push(o.createElement("g",{key:"".concat(a,"-dots-").concat(r._uniqueIdForGraph),clipPath:"url(#clip)",role:"region","aria-label":"".concat(s[a].legend,", series ").concat(a+1," of ").concat(s.length," with ").concat(s[a].data.length," data points.")},e.map(function(e,n){var i="".concat(r._circleId,"_").concat(a*r._data[0].length+n),c=e.xVal instanceof Date?e.xVal.getTime():e.xVal;l=s[a].color;var h=s[a].legend;return o.createElement("circle",(0,de.Cl)({key:i,id:i,"data-is-focusable":r._legendHighlighted(s[a].legend)||r._noLegendHighlighted(),cx:t(e.xVal),cy:d(e.values[1]),stroke:l,strokeWidth:3,fill:r._updateCircleFillColor(c,l,i),onMouseOut:r._onRectMouseOut,onMouseOver:r._onRectMouseMove},r._getOnClickHandler(s,a,n),{onFocus:function(){return r._handleFocus(a,n,i)},onBlur:r._handleBlur},fd(u),{r:r._getCircleRadius(c,p,i,h),role:"img","aria-label":!r._hasDuplicateXValues&&!r._hasMissingXValues&&r._getAriaLabel(a,n)||void 0}))})))}}),h.push(o.createElement("line",(0,de.Cl)({id:r._verticalLineId,key:r._verticalLineId,x1:r.state.lineXValue,y1:0,x2:r.state.lineXValue,y2:e,strokeWidth:1,strokeDasharray:5.5,stroke:l,opacity:.5,visibility:r.state.displayOfLine},fd(d))));var f=Np(r.props.styles,{theme:r.props.theme});if(!r.props.showXAxisLablesTooltip)try{document.getElementById(r._tooltipId)&&document.getElementById(r._tooltipId).remove()}catch(e){}if(!r.props.wrapXAxisLables&&r.props.showXAxisLablesTooltip){var g=Rt(a).call(t);try{document.getElementById(r._tooltipId)&&document.getElementById(r._tooltipId).remove()}catch(e){}var v={tooltipCls:f.tooltip,id:r._tooltipId,axis:g};g&&Qu(v)}return h},r._getOnClickHandler=function(e,t,n){return!r._hasDuplicateXValues&&!r._hasMissingXValues&&{onClick:r._onDataPointClick.bind(r,e[t].data[n].onDataPointClick)}},r._getCircleRadius=function(e,t,n,o){var i=r.state,a=i.isCircleClicked,l=i.nearestCircleToHighlight,s=i.activePoint;return r._noLegendHighlighted()||r._legendHighlighted(o)?a&&l===e?1:l===e||s===n?t:0:0},r._closeCallout=function(){r.setState({isCalloutVisible:!1})},r._legendHighlighted=function(e){return r._getHighlightedLegend().includes(e)},r._noLegendHighlighted=function(){return 0===r._getHighlightedLegend().length},r._addDefaultColors=function(e){if(r._hasMissingXValues){var t=new Set;e&&e.forEach(function(e){e.data.forEach(function(e){var n=e.x instanceof Date?e.x.toLocaleString():e.x;t.add(n)})}),e&&e.forEach(function(e){t.forEach(function(t){e.data.find(function(e){return e.x instanceof Date?e.x.toLocaleString()===t:e.x===t})||e.data.push({x:"string"==typeof t?new Date(t):t,y:0,legend:e.legend})}),e.data.sort(function(e,t){var n=e.x instanceof Date?e.x.getTime():e.x,r=t.x instanceof Date?t.x.getTime():t.x;return n<r?-1:n>r?1:0})})}return e?e.map(function(e,t){var n,o,i;return i=void 0===e.color?pp(t,0,null===(n=r.props.theme)||void 0===n?void 0:n.isInverted):fp(e.color,null===(o=r.props.theme)||void 0===o?void 0:o.isInverted),(0,de.Cl)((0,de.Cl)({},e),{color:i})}):[]},r._handleFocus=function(e,t,n){var o=r.props.data.lineChartData[e].data[t],i=o.x,a=o.y,l=o.xAxisCalloutData,s=i instanceof Date?(0,Yu.Yn)(i,r.props.culture,r.props.useUTC):i,c=Ld(r._calloutPoints,i);if(c){c.values=c.values.filter(function(e){return e.y===a});var u=r._getFilteredLegendValues(c.values);r.setState({refSelected:"#".concat(n),isCalloutVisible:!0,hoverXValue:l||s,YValueHover:u,stackCalloutProps:(0,de.Cl)((0,de.Cl)({},c),{values:u}),dataPointCalloutProps:(0,de.Cl)((0,de.Cl)({},c),{values:u}),activePoint:n})}},r._getFilteredLegendValues=function(e){return r._noLegendHighlighted()?e:e.filter(function(e){return r._legendHighlighted(e.legend)})},r._handleBlur=function(){r.setState({refSelected:null,isCalloutVisible:!1,hoverXValue:void 0,YValueHover:[],stackCalloutProps:void 0,dataPointCalloutProps:void 0,activePoint:""})},r._getChartTitle=function(){var e=r.props.data,t=e.chartTitle,n=e.lineChartData;return(t?"".concat(t,". "):"")+"Area chart with ".concat((null==n?void 0:n.length)||0," data series. ")},Aa(r),r._createSet=(0,Ds.J9)(r._createDataSet),r.state={selectedLegends:(null===(n=t.legendProps)||void 0===n?void 0:n.selectedLegends)||[],activeLegend:void 0,hoverXValue:"",isCalloutVisible:!1,refSelected:null,YValueHover:[],lineXValue:0,displayOfLine:Ip.hide,isCircleClicked:!1,nearestCircleToHighlight:null,isShowCalloutPending:!1,activePoint:""},r._hasMissingXValues=r._containsMissingXValues(),r._uniqueIdForGraph=Ta("areaChart_"),r._verticalLineId=Ta("verticalLine_"),r._circleId=Ta("circle"),r._rectId=Ta("rectangle"),r._tooltipId=Ta("AreaChartTooltipID"),r._enableComputationOptimization=!0,r._firstRenderOptimization=!0,r._emptyChartId=Ta("_AreaChart_empty"),r._cartesianChartRef=o.createRef(),r._legendsRef=o.createRef(),r}return(0,de.C6)(t,e),t.prototype.componentDidUpdate=function(e){var t,n,r;gd(null===(t=e.legendProps)||void 0===t?void 0:t.selectedLegends,null===(n=this.props.legendProps)||void 0===n?void 0:n.selectedLegends)||this.setState({selectedLegends:(null===(r=this.props.legendProps)||void 0===r?void 0:r.selectedLegends)||[]}),this.state.isShowCalloutPending&&this.setState({refSelected:"#".concat(this._highlightedCircleId),isCalloutVisible:!0,isShowCalloutPending:!1})},t.prototype.render=function(){var e=this;if(!this._isChartEmpty()){var t=this.props.data.lineChartData,n=this._addDefaultColors(t);this._hasDuplicateXValues=this._xCoordinateContainsMultipleY(),this._containsSecondaryYAxis=!!this.props.secondaryYScaleOptions&&n.some(function(e){return e.useSecondaryYScale});var r=this._createSet(n),i=r.colors,a=r.opacity,l=r.data,s=r.calloutPoints;this._calloutPoints=s;var c=ed(n);this._colors=i,this._opacity=a,this._data=l.renderData;var u=this._getLegendData(n),d={tickValues:this.props.tickValues,tickFormat:this.props.tickFormat},h=(0,de.Cl)({target:this.state.refSelected,isCalloutVisible:this.state.isCalloutVisible&&!this._hasDuplicateXValues&&!this._hasMissingXValues,directionalHint:3,YValueHover:this.state.YValueHover,hoverXValue:this.state.hoverXValue,id:"toolTip".concat(this._uniqueCallOutID),gapSpace:15,isBeakVisible:!1,onDismiss:this._closeCallout,"data-is-focusable":!0,xAxisCalloutAccessibilityData:this.state.xAxisCalloutAccessibilityData},this.props.calloutProps);return o.createElement(Eh,(0,de.Cl)({},this.props,{chartTitle:this._getChartTitle(),points:n,chartType:Hu.AreaChart,calloutProps:h,legendBars:u,createYAxis:Gu,isCalloutForStack:!0,xAxisType:c?zu.DateAxis:zu.NumericAxis,tickParams:d,maxOfYVal:l.maxOfYVal,getGraphData:this._getGraphData,getDomainNRangeValues:this._getDomainNRangeValues,createStringYAxis:Ku,getmargins:this._getMargins,getMinMaxOfYAxis:this._getMinMaxOfYAxis,customizedCallout:this._getCustomizedCallout(),onChartMouseLeave:this._handleChartMouseLeave,enableFirstRenderOptimization:this.props.enablePerfOptimization&&this._firstRenderOptimization,ref:this._cartesianChartRef,children:function(t){e._xAxisRectScale=t.xScale;var n=e._xAxisRectScale.ticks(),r=e._xAxisRectScale(n[n.length-1]),i=t.containerHeight-e.margins.top;return o.createElement(o.Fragment,null,o.createElement("g",null,o.createElement("rect",{id:e._rectId,width:r,height:i,fill:"transparent",onMouseMove:e._onRectMouseMove,onMouseOut:e._onRectMouseOut,onMouseOver:e._onRectMouseMove})),o.createElement("g",null,e._chart))}}))}return o.createElement("div",{id:this._emptyChartId,role:"alert",style:{opacity:"0"},"aria-label":"Graph has no data to display"})},Object.defineProperty(t.prototype,"chartContainer",{get:function(){var e;return(null===(e=this._cartesianChartRef.current)||void 0===e?void 0:e.chartContainer)||null},enumerable:!1,configurable:!0}),t.prototype._onLegendHover=function(e){this.setState({activeLegend:e})},t.prototype._onLegendLeave=function(){this.setState({activeLegend:void 0})},t.prototype._onLegendSelectionChange=function(e,t,n){var r,o;(null===(r=this.props.legendProps)||void 0===r?void 0:r.canSelectMultipleLegends)?this.setState({selectedLegends:e}):this.setState({selectedLegends:e.slice(-1)}),(null===(o=this.props.legendProps)||void 0===o?void 0:o.onChange)&&this.props.legendProps.onChange(e,t,n)},t.prototype._getHighlightedLegend=function(){return this.state.selectedLegends.length>0?this.state.selectedLegends:this.state.activeLegend?[this.state.activeLegend]:[]},t.prototype._getAriaLabel=function(e,t){var n,r=this.props.data.lineChartData[e],o=r.data[t],i=o.x instanceof Date?(0,Yu.Yn)(o.x,this.props.culture,this.props.useUTC):o.x,a=o.xAxisCalloutData||i,l=r.legend,s=o.yAxisCalloutData||o.y;return(null===(n=o.callOutAccessibilityData)||void 0===n?void 0:n.ariaLabel)||"".concat(a,". ").concat(l,", ").concat(s,".")},t.prototype._isChartEmpty=function(){return!(this.props.data&&this.props.data.lineChartData&&this.props.data.lineChartData.length>0&&0===this.props.data.lineChartData.filter(function(e){return 0===e.data.length}).length)},t.prototype._xCoordinateContainsMultipleY=function(){var e=this.props.data.lineChartData;if(!e)return!1;for(var t=0,n=e;t<n.length;t++)for(var r={},o=0,i=n[t].data;o<i.length;o++){var a=i[o],l=a.x instanceof Date?a.x.toLocaleString():a.x;if(r[l]||(r[l]=[]),r[l].push(a.y),r[l].length>1)return!0}return!1},t.prototype._containsMissingXValues=function(){var e=this.props.data.lineChartData;if(!e)return!1;var t=new Set;e.forEach(function(e){e.data.forEach(function(e){var n=e.x instanceof Date?e.x.toLocaleString():e.x;t.add(n)})});var n=!1;return e.forEach(function(e){t.forEach(function(t){e.data.find(function(e){return e.x instanceof Date?e.x.toLocaleString()===t:e.x===t})||(n=!0)})}),n},t.prototype._shouldFillToZeroY=function(){return"tozeroy"===this.props.mode||this._containsSecondaryYAxis},t.defaultProps={useUTC:!0},t}(o.Component),Rp=(0,ue.I)(Fp,function(e){return{tooltip:xh(e.theme)}}),Vp=(0,a.makeStyles)({container:{display:"flex",flexDirection:"column",height:"100%",width:"100%",minHeight:"200px"},title:{marginBottom:a.tokens.spacingVerticalS,fontWeight:a.tokens.fontWeightSemibold,color:a.tokens.colorNeutralForeground1},chartWrapper:{flex:1,position:"relative",minHeight:"150px"},placeholder:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",color:a.tokens.colorNeutralForeground3}}),Bp=e=>{var{data:t,title:n,variant:r="line",showLabels:i=!1,showLegend:l=!1,onDrillInteraction:s,drillField:c,height:u=300,responsive:d=!0,lineColor:h}=e,p=Vp(),f=(0,o.useRef)(null),[g,v]=(0,o.useState)(400);if((0,o.useEffect)(()=>{if(d&&f.current){var e=new ResizeObserver(e=>{for(var t of e)v(t.contentRect.width)});return e.observe(f.current),()=>e.disconnect()}},[d]),!t||0===t.length)return o.createElement("div",{className:p.container},n&&o.createElement(a.Text,{className:p.title},n),o.createElement("div",{className:p.placeholder},o.createElement(a.Text,null,"No data available")));var m=h||a.tokens.colorBrandBackground,y=[{legend:n||"Data",data:t.map((e,t)=>({x:t,y:e.value,xAxisCalloutData:e.label,onDataPointClick:()=>{return t=e,void(s&&c&&s({field:c,operator:"eq",value:t.fieldValue,label:t.label}));var t}})),color:m}],_={chartTitle:n};return o.createElement("div",{className:p.container,ref:f},n&&o.createElement(a.Text,{className:p.title},n),o.createElement("div",{className:p.chartWrapper},"line"===r?o.createElement(bp,Object.assign({data:{lineChartData:y},width:d?g:void 0,height:u,hideLegend:!l,hideTooltip:!1},_)):o.createElement(Rp,Object.assign({data:{lineChartData:y},width:d?g:void 0,height:u,hideLegend:!l,hideTooltip:!1},_))))};function Hp(e,t){return t<e?-1:t>e?1:t>=e?0:NaN}function zp(e){return e}var Wp=Math.abs,Yp=Math.atan2,jp=Math.cos,Up=Math.max,Xp=Math.min,qp=Math.sin,Gp=Math.sqrt,Kp=1e-12,Zp=Math.PI,$p=Zp/2,Jp=2*Zp;function Qp(e){return e>=1?$p:e<=-1?-$p:Math.asin(e)}function ef(){var e=zp,t=Hp,n=null,r=ge(0),o=ge(Jp),i=ge(0);function a(a){var l,s,c,u,d,h=(a=fe(a)).length,p=0,f=new Array(h),g=new Array(h),v=+r.apply(this,arguments),m=Math.min(Jp,Math.max(-Jp,o.apply(this,arguments)-v)),y=Math.min(Math.abs(m)/h,i.apply(this,arguments)),_=y*(m<0?-1:1);for(l=0;l<h;++l)(d=g[f[l]=l]=+e(a[l],l,a))>0&&(p+=d);for(null!=t?f.sort(function(e,n){return t(g[e],g[n])}):null!=n&&f.sort(function(e,t){return n(a[e],a[t])}),l=0,c=p?(m-h*_)/p:0;l<h;++l,v=u)s=f[l],u=v+((d=g[s])>0?d*c:0)+_,g[s]={data:a[s],index:l,value:d,startAngle:v,endAngle:u,padAngle:y};return g}return a.value=function(t){return arguments.length?(e="function"==typeof t?t:ge(+t),a):e},a.sortValues=function(e){return arguments.length?(t=e,n=null,a):t},a.sort=function(e){return arguments.length?(n=e,t=null,a):n},a.startAngle=function(e){return arguments.length?(r="function"==typeof e?e:ge(+e),a):r},a.endAngle=function(e){return arguments.length?(o="function"==typeof e?e:ge(+e),a):o},a.padAngle=function(e){return arguments.length?(i="function"==typeof e?e:ge(+e),a):i},a}function tf(e){return e.innerRadius}function nf(e){return e.outerRadius}function rf(e){return e.startAngle}function of(e){return e.endAngle}function af(e){return e&&e.padAngle}function lf(e,t,n,r,o,i,a){var l=e-n,s=t-r,c=(a?i:-i)/Gp(l*l+s*s),u=c*s,d=-c*l,h=e+u,p=t+d,f=n+u,g=r+d,v=(h+f)/2,m=(p+g)/2,y=f-h,_=g-p,x=y*y+_*_,b=o-i,C=h*g-f*p,k=(_<0?-1:1)*Gp(Up(0,b*b*x-C*C)),w=(C*_-y*k)/x,E=(-C*y-_*k)/x,S=(C*_+y*k)/x,T=(-C*y+_*k)/x,D=w-v,M=E-m,A=S-v,L=T-m;return D*D+M*M>A*A+L*L&&(w=S,E=T),{cx:w,cy:E,x01:-u,y01:-d,x11:w*(o/b-1),y11:E*(o/b-1)}}function sf(){var e=tf,t=nf,n=ge(0),r=null,o=rf,i=of,a=af,l=null,s=Ee(c);function c(){var c,u,d,h=+e.apply(this,arguments),p=+t.apply(this,arguments),f=o.apply(this,arguments)-$p,g=i.apply(this,arguments)-$p,v=Wp(g-f),m=g>f;if(l||(l=c=s()),p<h&&(u=p,p=h,h=u),p>Kp)if(v>Jp-Kp)l.moveTo(p*jp(f),p*qp(f)),l.arc(0,0,p,f,g,!m),h>Kp&&(l.moveTo(h*jp(g),h*qp(g)),l.arc(0,0,h,g,f,m));else{var y,_,x=f,b=g,C=f,k=g,w=v,E=v,S=a.apply(this,arguments)/2,T=S>Kp&&(r?+r.apply(this,arguments):Gp(h*h+p*p)),D=Xp(Wp(p-h)/2,+n.apply(this,arguments)),M=D,A=D;if(T>Kp){var L=Qp(T/h*qp(S)),P=Qp(T/p*qp(S));(w-=2*L)>Kp?(C+=L*=m?1:-1,k-=L):(w=0,C=k=(f+g)/2),(E-=2*P)>Kp?(x+=P*=m?1:-1,b-=P):(E=0,x=b=(f+g)/2)}var I=p*jp(x),N=p*qp(x),O=h*jp(k),F=h*qp(k);if(D>Kp){var R,V=p*jp(b),B=p*qp(b),H=h*jp(C),z=h*qp(C);if(v<Zp)if(R=function(e,t,n,r,o,i,a,l){var s=n-e,c=r-t,u=a-o,d=l-i,h=d*s-u*c;if(!(h*h<Kp))return[e+(h=(u*(t-i)-d*(e-o))/h)*s,t+h*c]}(I,N,H,z,V,B,O,F)){var W=I-R[0],Y=N-R[1],j=V-R[0],U=B-R[1],X=1/qp(((d=(W*j+Y*U)/(Gp(W*W+Y*Y)*Gp(j*j+U*U)))>1?0:d<-1?Zp:Math.acos(d))/2),q=Gp(R[0]*R[0]+R[1]*R[1]);M=Xp(D,(h-q)/(X-1)),A=Xp(D,(p-q)/(X+1))}else M=A=0}E>Kp?A>Kp?(y=lf(H,z,I,N,p,A,m),_=lf(V,B,O,F,p,A,m),l.moveTo(y.cx+y.x01,y.cy+y.y01),A<D?l.arc(y.cx,y.cy,A,Yp(y.y01,y.x01),Yp(_.y01,_.x01),!m):(l.arc(y.cx,y.cy,A,Yp(y.y01,y.x01),Yp(y.y11,y.x11),!m),l.arc(0,0,p,Yp(y.cy+y.y11,y.cx+y.x11),Yp(_.cy+_.y11,_.cx+_.x11),!m),l.arc(_.cx,_.cy,A,Yp(_.y11,_.x11),Yp(_.y01,_.x01),!m))):(l.moveTo(I,N),l.arc(0,0,p,x,b,!m)):l.moveTo(I,N),h>Kp&&w>Kp?M>Kp?(y=lf(O,F,V,B,h,-M,m),_=lf(I,N,H,z,h,-M,m),l.lineTo(y.cx+y.x01,y.cy+y.y01),M<D?l.arc(y.cx,y.cy,M,Yp(y.y01,y.x01),Yp(_.y01,_.x01),!m):(l.arc(y.cx,y.cy,M,Yp(y.y01,y.x01),Yp(y.y11,y.x11),!m),l.arc(0,0,h,Yp(y.cy+y.y11,y.cx+y.x11),Yp(_.cy+_.y11,_.cx+_.x11),m),l.arc(_.cx,_.cy,M,Yp(_.y11,_.x11),Yp(_.y01,_.x01),!m))):l.arc(0,0,h,k,C,m):l.lineTo(O,F)}else l.moveTo(0,0);if(l.closePath(),c)return l=null,c+""||null}return c.centroid=function(){var n=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,r=(+o.apply(this,arguments)+ +i.apply(this,arguments))/2-Zp/2;return[jp(r)*n,qp(r)*n]},c.innerRadius=function(t){return arguments.length?(e="function"==typeof t?t:ge(+t),c):e},c.outerRadius=function(e){return arguments.length?(t="function"==typeof e?e:ge(+e),c):t},c.cornerRadius=function(e){return arguments.length?(n="function"==typeof e?e:ge(+e),c):n},c.padRadius=function(e){return arguments.length?(r=null==e?null:"function"==typeof e?e:ge(+e),c):r},c.startAngle=function(e){return arguments.length?(o="function"==typeof e?e:ge(+e),c):o},c.endAngle=function(e){return arguments.length?(i="function"==typeof e?e:ge(+e),c):i},c.padAngle=function(e){return arguments.length?(a="function"==typeof e?e:ge(+e),c):a},c.context=function(e){return arguments.length?(l=null==e?null:e,c):l},c}var cf=function(e){var t,n=e.solidFill,r=e.gradientFill,o=e.href,i=e.theme,a=e.opacity;return{root:{fill:n,cursor:o?"pointer":"default",stroke:i.semanticColors.bodyBackground,outline:"transparent",selectors:{"::-moz-focus-inner":{border:"0"}},opacity:a},gradientArc:{width:"100%",height:"100%",background:r,opacity:a},focusRing:{stroke:i.semanticColors.focusBorder,strokeWidth:4,fill:"transparent"},arcLabel:{fontSize:Fa.s.small,fontWeight:Fa.BO.semibold,fill:i.palette.neutralPrimary,selectors:(t={},t[Fa.up]={fill:"CanvasText"},t)}}},uf=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={},t.currentRef=o.createRef(),t._isRTL=(0,ba.jI)(),t._hoverOff=function(){t.props.hoverLeaveCallback()},t._onBlur=function(){t.props.onBlurCallback()},t._getAriaLabel=function(){var e,n=t.props.data.data,r=n.xAxisCalloutData||n.legend,o=n.yAxisCalloutData||n.data||0;return(null===(e=n.callOutAccessibilityData)||void 0===e?void 0:e.ariaLabel)||(r?"".concat(r,", "):"")+"".concat(o,".")},t._shouldHighlightArc=function(e){var n=t.props.activeArc;return!n||0===n.length||void 0===e||n.includes(e)},t._renderArcLabel=function(e){var n=t.props,r=n.arc,i=n.data,a=n.innerRadius,l=n.outerRadius,s=n.showLabelsInPercent,c=n.totalValue;if(n.hideLabels||Math.abs(i.endAngle-i.startAngle)<Math.PI/12||!t._shouldHighlightArc(i.data.legend))return null;var u=r.centroid(i),d=u[0],h=u[1],p=Math.sqrt(d*d+h*h),f=Math.max(a,l)+2,g=(i.startAngle+i.endAngle)/2,v=i.value;return o.createElement("text",{x:(0===p?0:d/p)*f,y:(0===p?0:h/p)*f,textAnchor:g>Math.PI!==t._isRTL?"end":"start",dominantBaseline:g>Math.PI/2&&g<3*Math.PI/2?"hanging":"auto",className:e,"aria-hidden":!0},s?fr(".0%")(0===c?0:v/c):ud(v))},t}return(0,de.C6)(t,e),t.getDerivedStateFromProps=function(e){return df(e),null},t.prototype.updateChart=function(e){df(e)},t.prototype.render=function(){var e,t,n,r,i,a,l,s=this.props,c=s.arc,u=s.href,d=s.focusedArcId,h=s.activeArc,p=(0,xa.Z)(),f=this.props.uniqText+("string"==typeof this.props.data.data.legend?this.props.data.data.legend.replace(/\s+/g,""):"")+this.props.data.data.data,g=h&&h.length>0?h.includes(null===(e=this.props.data)||void 0===e?void 0:e.data.legend)?1:.1:1,v=null!==(n=null===(t=this.props.data)||void 0===t?void 0:t.startAngle)&&void 0!==n?n:0,m=(null!==(i=null===(r=this.props.data)||void 0===r?void 0:r.endAngle)&&void 0!==i?i:0)-v,y=this.props.roundCorners?3:0,_=p(cf,{solidFill:this.props.enableGradient?"transparent":this.props.color,gradientFill:"conic-gradient(\n          from ".concat(v,"rad,\n          ").concat(this.props.color,",\n          ").concat(this.props.nextColor," ").concat(m,"rad\n        )"),href:u,theme:this.props.theme,opacity:g}),x=Ta("Arc_clip")+"".concat(this.props.color,"_").concat(this.props.nextColor);return o.createElement("g",{ref:this.currentRef},!!d&&d===f&&o.createElement("path",{id:f+"focusRing",d:c.cornerRadius(y)(this.props.focusData),className:_.focusRing}),o.createElement("path",{id:f,d:c.cornerRadius(y)(this.props.data),onFocus:this._onFocus.bind(this,this.props.data.data,f),className:_.root,"data-is-focusable":this._shouldHighlightArc(this.props.data.data.legend)||0===(null===(a=this.props.activeArc)||void 0===a?void 0:a.length),onMouseOver:this._hoverOn.bind(this,this.props.data.data),onMouseMove:this._hoverOn.bind(this,this.props.data.data),onMouseLeave:this._hoverOff,onBlur:this._onBlur,onClick:u?this._redirectToUrl.bind(this,u):null===(l=this.props.data)||void 0===l?void 0:l.data.onClick,"aria-label":this._getAriaLabel(),role:"img"}),this._renderArcLabel(_.arcLabel),this.props.enableGradient&&o.createElement(o.Fragment,null,o.createElement("clipPath",{id:x},o.createElement("path",{d:c.cornerRadius(y)(this.props.data)})),o.createElement("foreignObject",{x:"-50%",y:"-50%",width:"100%",height:"100%",clipPath:"url(#".concat(x,")")},o.createElement("div",{className:_.gradientArc}))))},t.prototype._onFocus=function(e,t){this.props.onFocusCallback(e,t,this.currentRef.current)},t.prototype._hoverOn=function(e,t){t.persist(),this.props.hoverOnCallback(e,t)},t.prototype._redirectToUrl=function(e){e&&(window.location.href=e)},t.defaultProps={arc:sf()},t}(o.Component);function df(e){e.arc.innerRadius(e.innerRadius),e.arc.outerRadius(e.outerRadius)}var hf=function(e){var t,n=e.theme;return{root:{},insideDonutString:{fontSize:Fa.s.xLargePlus,fontWeight:Fa.BO.semibold,fill:n.semanticColors.bodyText,selectors:(t={},t[Fa.up]={fill:"CanvasText"},t)}}},pf=(0,xa.Z)(),ff=function(e){function t(t){var n=e.call(this,t)||this;return n.arcGenerator=function(e,t,r,i){var a,l,s,c,u=e&&e.data&&e.data.color,d=u;return n.props.enableGradient&&(u=null!==(l=null===(a=n.props.data[t].gradient)||void 0===a?void 0:a[0])&&void 0!==l?l:Dh(t,0,n.props.theme.isInverted)[0],d=null!==(c=null===(s=n.props.data[t].gradient)||void 0===s?void 0:s[1])&&void 0!==c?c:Dh(t,0,n.props.theme.isInverted)[1]),o.createElement(uf,{key:t,data:e,focusData:r,innerRadius:n.props.innerRadius,outerRadius:n.props.outerRadius,color:u,nextColor:d,enableGradient:n.props.enableGradient,roundCorners:n.props.roundCorners,onFocusCallback:n._focusCallback,hoverOnCallback:n._hoverCallback,onBlurCallback:n.props.onBlurCallback,hoverLeaveCallback:n.props.hoverLeaveCallback,uniqText:n.props.uniqText,activeArc:n.props.activeArc,href:i,calloutId:n.props.calloutId,valueInsideDonut:n.props.valueInsideDonut,theme:n.props.theme,focusedArcId:n.props.focusedArcId,showLabelsInPercent:n.props.showLabelsInPercent,totalValue:n._totalValue,hideLabels:n.props.hideLabels})},n._focusCallback=function(e,t,r){n.props.onFocusCallback(e,t,r)},n._computeTotalValue=function(){var e=0;return n.props.data.forEach(function(t){e+=t.data}),e},n._hoverCallback=n._hoverCallback.bind(n),n._pieForFocusRing=ef().sort(null).value(function(e){return e.data}).padAngle(0),n}return(0,de.C6)(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.pie,r=t.data,i=this._pieForFocusRing(r),a=n(r),l="translate(".concat(this.props.width/2,", ").concat(this.props.height/2,")"),s=pf(hf,{theme:this.props.theme});return this._totalValue=this._computeTotalValue(),o.createElement("g",{transform:l},a.map(function(t,n){return e.arcGenerator(t,n,i[n],e.props.href)}),this.props.valueInsideDonut&&o.createElement("text",{y:5,textAnchor:"middle",dominantBaseline:"middle",className:s.insideDonutString},this.props.valueInsideDonut))},t.prototype.componentDidUpdate=function(){var e,t,n;e=pf(hf,{theme:this.props.theme}).insideDonutString,t=2*this.props.innerRadius-5,n=0,function(e){return"string"==typeof e?new Ft([document.querySelectorAll(e)],[document.documentElement]):new Ft([Le(e)],Ot)}(".".concat(e)).each(function(){for(var e=Rt(this),r=e.text().split(/\s+/).reverse(),o="",i=[],a=0,l=e.attr("y"),s=e.text(null).append("tspan").attr("id","WordBreakId-".concat(n,"-").concat(a)).attr("x",0).attr("y",l).attr("dy",1.1*a+++"em");o=r.pop();)i.push(o),s.text(i.join(" ")+" "),s.node().getComputedTextLength()>t&&i.length>1&&(i.pop(),s.text(i.join(" ")+" "),i=[o],s=e.append("tspan").attr("id","WordBreakId-".concat(n,"-").concat(a)).attr("x",0).attr("y",l).attr("dy",1.1*a+++"em").text(o));n+=1})},t.prototype._hoverCallback=function(e,t){this.props.hoverOnCallback(e,t)},t.defaultProps={pie:ef().sort(null).value(function(e){return e.data}).padAngle(.02)},t}(o.Component),gf=(0,xa.Z)(),vf=function(e){function t(t){var n,r=e.call(this,t)||this;return r.toImage=function(e){var t;return Od([{container:r._rootElem}],r.props.hideLegend||null===(t=r._legendsRef.current)||void 0===t?void 0:t.toSVG,(0,ba.jI)(),e)},r._closeCallout=function(){r.setState({showHover:!1})},r._focusCallback=function(e,t,n){r._currentHoverElement=n,r.setState({showHover:r._noLegendsHighlighted()||r._isLegendHighlighted(e.legend),value:e.data.toString(),legend:e.legend,color:e.color,xCalloutValue:e.xAxisCalloutData,yCalloutValue:e.yAxisCalloutData,focusedArcId:t,dataPointCalloutProps:e,callOutAccessibilityData:e.callOutAccessibilityData})},r._hoverCallback=function(e,t){var n,o,i,a;if(r._calloutAnchorPoint!==e){r._calloutAnchorPoint=e,r._currentHoverElement=t;var l=e.color;if(r.props.enableGradient){var s=Math.max((null===(o=null===(n=r.props.data)||void 0===n?void 0:n.chartData)||void 0===o?void 0:o.findIndex(function(t){return t.legend===e.legend}))||0,0);l=(null===(i=e.gradient)||void 0===i?void 0:i[0])||Dh(s,0,null===(a=r.props.theme)||void 0===a?void 0:a.isInverted)[0]}r.setState({showHover:r._noLegendsHighlighted()||r._isLegendHighlighted(e.legend),value:e.data.toString(),legend:e.legend,color:l,xCalloutValue:e.xAxisCalloutData,yCalloutValue:e.yAxisCalloutData,dataPointCalloutProps:e,callOutAccessibilityData:e.callOutAccessibilityData})}},r._onBlur=function(){r.setState({focusedArcId:""})},r._handleChartMouseLeave=function(){r._calloutAnchorPoint=null,r.setState({showHover:!1})},r._isLegendHighlighted=function(e){return r._getHighlightedLegend().includes(e)},r._noLegendsHighlighted=function(){return 0===r._getHighlightedLegend().length},r._addDefaultColors=function(e){return e?e.map(function(e,t){var n,o,i;return i=void 0===e.color?pp(t,0,null===(n=r.props.theme)||void 0===n?void 0:n.isInverted):fp(e.color,null===(o=r.props.theme)||void 0===o?void 0:o.isInverted),(0,de.Cl)((0,de.Cl)({},e),{color:i})}):[]},Aa(r),r.state={showHover:!1,value:"",legend:"",_width:r.props.width||200,_height:r.props.height||200,activeLegend:void 0,color:"",xCalloutValue:"",yCalloutValue:"",focusedArcId:"",selectedLegends:(null===(n=t.legendProps)||void 0===n?void 0:n.selectedLegends)||[]},r._hoverCallback=r._hoverCallback.bind(r),r._focusCallback=r._focusCallback.bind(r),r._hoverLeave=r._hoverLeave.bind(r),r._calloutId=Ta("callout"),r._uniqText=Ta("_Pie_"),r._emptyChartId=Ta("_DonutChart_empty"),r._legendsRef=o.createRef(),r}return(0,de.C6)(t,e),t.getDerivedStateFromProps=function(e,t){var n,r;return e.width&&e.width!==t._width&&(n={_width:e.width}),e.height&&e.height!==t._height&&(r={_height:e.height-40}),(0,de.Cl)((0,de.Cl)({},n),r)},t.prototype.componentDidMount=function(){this._rootElem&&this.setState({_width:this._rootElem.offsetWidth,_height:this._rootElem.offsetHeight-40})},t.prototype.componentDidUpdate=function(e){var t,n,r;gd(null===(t=e.legendProps)||void 0===t?void 0:t.selectedLegends,null===(n=this.props.legendProps)||void 0===n?void 0:n.selectedLegends)||this.setState({selectedLegends:(null===(r=this.props.legendProps)||void 0===r?void 0:r.selectedLegends)||[]})},t.prototype.render=function(){var e=this,t=this.props,n=t.data,r=t.hideLegend,i=void 0!==r&&r,a=this._addDefaultColors(null==n?void 0:n.chartData);this._classNames=gf(this.props.styles,{theme:this.props.theme,color:this.state.color,className:this.props.className});var l=this._createLegends(a.filter(function(e){return e.data>=0})),s=this.props.hideLabels?0:80,c=this.props.hideLabels?0:40,u=Math.min(this.state._width-s,this.state._height-c)/2,d=this._elevateToMinimums(a),h=this.props.innerRadius>1?this._valueInsideDonut(this.props.valueInsideDonut,d):"";return this._isChartEmpty()?o.createElement("div",{id:this._emptyChartId,role:"alert",style:{opacity:"0"},"aria-label":"Graph has no data to display"}):o.createElement("div",{className:this._classNames.root,ref:function(t){e._rootElem=t},onMouseLeave:this._handleChartMouseLeave},this.props.xAxisAnnotation&&o.createElement("text",{className:this._classNames.axisAnnotation,x:this.state._width/2,y:this.state._height-10,textAnchor:"middle"},this.props.xAxisAnnotation),o.createElement(iu,{direction:Wc.horizontal,handleTabKey:1,className:this._classNames.chartWrapper},o.createElement("svg",{className:this._classNames.chart,"aria-label":null==n?void 0:n.chartTitle,ref:function(t){return e._setViewBox(t)},width:this.state._width,height:this.state._height},o.createElement(ff,{width:this.state._width,height:this.state._height,outerRadius:u,innerRadius:this.props.innerRadius,data:d,enableGradient:this.props.enableGradient,roundCorners:this.props.roundCorners,onFocusCallback:this._focusCallback,hoverOnCallback:this._hoverCallback,hoverLeaveCallback:this._hoverLeave,uniqText:this._uniqText,onBlurCallback:this._onBlur,activeArc:this._getHighlightedLegend(),focusedArcId:this.state.focusedArcId||"",href:this.props.href,calloutId:this._calloutId,valueInsideDonut:this._toLocaleString(h),theme:this.props.theme,showLabelsInPercent:this.props.showLabelsInPercent,hideLabels:this.props.hideLabels}))),o.createElement(rc,(0,de.Cl)({target:this._currentHoverElement,alignTargetEdge:!0,isBeakVisible:!1,directionalHint:3,gapSpace:15,hidden:!(!this.props.hideTooltip&&this.state.showHover),id:this._calloutId,onDismiss:this._closeCallout,preventDismissOnLostFocus:!0,shouldUpdateWhenHidden:!0},this.props.calloutProps,cd(this.state.callOutAccessibilityData,"text",!1)),this.props.onRenderCalloutPerDataPoint?this.props.onRenderCalloutPerDataPoint(this.state.dataPointCalloutProps):o.createElement(Oa.ChartHoverCard,{Legend:this.state.xCalloutValue?this.state.xCalloutValue:this.state.legend,YValue:this.state.yCalloutValue?this.state.yCalloutValue:this.state.value,color:this.state.color,culture:this.props.culture})),!i&&o.createElement("div",{className:this._classNames.legendContainer},l))},Object.defineProperty(t.prototype,"chartContainer",{get:function(){return this._rootElem},enumerable:!1,configurable:!0}),t.prototype._elevateToMinimums=function(e){var t=0,n=[];return e.forEach(function(e){t+=e.data}),e.forEach(function(e){n.push(.01*t>e.data&&e.data>0?(0,de.Cl)((0,de.Cl)({},e),{data:.01*t,yAxisCalloutData:void 0===e.yAxisCalloutData?e.data.toLocaleString():e.yAxisCalloutData}):e)}),n},t.prototype._setViewBox=function(e){var t,n;if(null!==e){var r=e.parentElement?e.parentElement.clientWidth:this.state._width,o=e.parentElement&&(null===(t=e.parentElement)||void 0===t?void 0:t.offsetHeight)>this.state._height?null===(n=e.parentElement)||void 0===n?void 0:n.offsetHeight:this.state._height,i="0 0 ".concat(r," ").concat(o);e.setAttribute("viewBox",i)}},t.prototype._createLegends=function(e){var t=this;"sorted"===this.props.order&&e.sort(function(e,t){return t.data-e.data});var n=e.map(function(e,n){var r,o,i=t.props.enableGradient?(null===(r=e.gradient)||void 0===r?void 0:r[0])||Dh(n,0,null===(o=t.props.theme)||void 0===o?void 0:o.isInverted)[0]:e.color;return{title:e.legend,color:i,hoverAction:function(){t._handleChartMouseLeave(),t.setState({activeLegend:e.legend})},onMouseOutAction:function(){t.setState({activeLegend:void 0})}}});return o.createElement(Gd,(0,de.Cl)({legends:n,centerLegends:!0,overflowProps:this.props.legendsOverflowProps,focusZonePropsInHoverCard:this.props.focusZonePropsForLegendsInHoverCard,overflowText:this.props.legendsOverflowText},this.props.legendProps,{onChange:this._onLegendSelectionChange.bind(this),ref:this._legendsRef}))},t.prototype._onLegendSelectionChange=function(e,t,n){var r,o;this.props.legendProps&&(null===(r=this.props.legendProps)||void 0===r?void 0:r.canSelectMultipleLegends)?this.setState({selectedLegends:e}):this.setState({selectedLegends:e.slice(-1)}),(null===(o=this.props.legendProps)||void 0===o?void 0:o.onChange)&&this.props.legendProps.onChange(e,t,n)},t.prototype._hoverLeave=function(){},t.prototype._valueInsideDonut=function(e,t){var n=this,r=this._getHighlightedLegend();if(void 0===e||1!==r.length&&!this.state.showHover){if(r.length>0){var o=0;return t.forEach(function(e){r.includes(e.legend)&&(o+=e.data)}),o}return e}var i=t.find(function(e){return n._isLegendHighlighted(e.legend)});return i?i.yAxisCalloutData?i.yAxisCalloutData:i.data:e},t.prototype._toLocaleString=function(e){var t=(0,Yu.c$)(e,this.props.culture,this.props.useUTC);return t?null==t?void 0:t.toString():e},t.prototype._getHighlightedLegend=function(){return this.state.selectedLegends.length>0?this.state.selectedLegends:this.state.activeLegend?[this.state.activeLegend]:[]},t.prototype._isChartEmpty=function(){return!(this.props.data&&this.props.data.chartData&&this.props.data.chartData.filter(function(e){return e.data>0}).length>0)},t.defaultProps={innerRadius:0,hideLabels:!0},t}(o.Component),mf=(0,ue.I)(vf,function(e){var t=e.className,n=e.theme;return{root:[n.fonts.medium,"ms-DonutChart",{alignItems:"center",display:"flex",flexDirection:"column",width:"100%",height:"100%"},t],chart:{boxSizing:"content-box",overflow:"visible",alignmentAdjust:"center",display:"block"},legendContainer:{paddingTop:"16px",width:"100%"},axisAnnotation:bh(n,n.fonts.small)}}),yf=(0,a.makeStyles)({container:{display:"flex",flexDirection:"column",height:"100%",width:"100%",minHeight:"200px",alignItems:"center"},title:{marginBottom:a.tokens.spacingVerticalS,fontWeight:a.tokens.fontWeightSemibold,color:a.tokens.colorNeutralForeground1,textAlign:"center"},chartWrapper:{flex:1,position:"relative",minHeight:"150px",display:"flex",justifyContent:"center",alignItems:"center"},placeholder:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",color:a.tokens.colorNeutralForeground3}}),_f=e=>{var{data:t,title:n,innerRadius:r=.5,showLegend:i=!0,onDrillInteraction:l,drillField:s,height:c=300,responsive:u=!0,showCenterValue:d=!0,centerLabel:h}=e,p=yf(),f=(0,o.useRef)(null),[g,v]=(0,o.useState)(400);if((0,o.useEffect)(()=>{if(u&&f.current){var e=new ResizeObserver(e=>{for(var t of e)v(t.contentRect.width)});return e.observe(f.current),()=>e.disconnect()}},[u]),!t||0===t.length)return o.createElement("div",{className:p.container},n&&o.createElement(a.Text,{className:p.title},n),o.createElement("div",{className:p.placeholder},o.createElement(a.Text,null,"No data available")));var m=[a.tokens.colorBrandBackground,a.tokens.colorPaletteBlueBorderActive,a.tokens.colorPaletteTealBorderActive,a.tokens.colorPaletteGreenBorderActive,a.tokens.colorPaletteYellowBorderActive,a.tokens.colorPaletteDarkOrangeBorderActive,a.tokens.colorPaletteRedBorderActive,a.tokens.colorPalettePurpleBorderActive],y=t.reduce((e,t)=>e+t.value,0),_=t.map((e,t)=>({legend:e.label,data:e.value,color:e.color||m[t%m.length],onClick:()=>{return t=e,void(l&&s&&l({field:s,operator:"eq",value:t.fieldValue,label:t.label}));var t}})),x={chartTitle:n},b=Math.min(g,c);return o.createElement("div",{className:p.container,ref:f},n&&o.createElement(a.Text,{className:p.title},n),o.createElement("div",{className:p.chartWrapper},o.createElement(mf,Object.assign({data:{chartData:_},width:b,height:b,hideLegend:!i,hideTooltip:!1,innerRadius:r*(b/2),valueInsideDonut:d?h||y.toLocaleString():void 0},x))))},xf=(0,a.makeStyles)({container:{display:"flex",flexDirection:"column",width:"100%",gap:a.tokens.spacingVerticalXS},title:{fontWeight:a.tokens.fontWeightSemibold,color:a.tokens.colorNeutralForeground1,fontSize:a.tokens.fontSizeBase300},barContainer:{display:"flex",width:"100%",borderRadius:a.tokens.borderRadiusMedium,overflow:"hidden",backgroundColor:a.tokens.colorNeutralBackground3},segment:{display:"flex",alignItems:"center",justifyContent:"center",minWidth:"24px",transition:"opacity 0.2s ease-in-out, filter 0.2s ease-in-out",overflow:"hidden"},segmentInteractive:{cursor:"pointer","&:hover":{filter:"brightness(1.1)"},"&:active":{filter:"brightness(0.95)"}},segmentLabel:{color:a.tokens.colorNeutralForegroundOnBrand,fontSize:a.tokens.fontSizeBase100,fontWeight:a.tokens.fontWeightMedium,textShadow:"0 1px 2px rgba(0,0,0,0.3)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",padding:"0 ".concat(a.tokens.spacingHorizontalXS)},legend:{display:"flex",flexWrap:"wrap",gap:a.tokens.spacingHorizontalM,marginTop:a.tokens.spacingVerticalXS},legendItem:{display:"flex",alignItems:"center",gap:a.tokens.spacingHorizontalXXS},legendColor:{width:"12px",height:"12px",borderRadius:a.tokens.borderRadiusSmall},legendText:{fontSize:a.tokens.fontSizeBase200,color:a.tokens.colorNeutralForeground2},placeholder:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",color:a.tokens.colorNeutralForeground3,padding:a.tokens.spacingVerticalM}}),bf=e=>{var{segments:t,title:n,showLabels:r=!0,showCounts:i=!0,onDrillInteraction:l,drillField:s,height:c=32,interactive:u=!0}=e,d=xf(),h=e=>{u&&l&&s&&l({field:s,operator:"eq",value:e.fieldValue,label:e.label})};if(!t||0===t.length)return o.createElement("div",{className:d.container},n&&o.createElement(a.Text,{className:d.title},n),o.createElement("div",{className:d.placeholder},o.createElement(a.Text,null,"No data available")));var p=t.reduce((e,t)=>e+t.value,0),f=[a.tokens.colorPaletteGreenBackground3,a.tokens.colorPaletteYellowBackground3,a.tokens.colorPaletteDarkOrangeBackground3,a.tokens.colorPaletteRedBackground3,a.tokens.colorPaletteBlueBorderActive,a.tokens.colorPalettePurpleBorderActive],g=u&&l&&s;return o.createElement("div",{className:d.container},n&&o.createElement(a.Text,{className:d.title},n),o.createElement("div",{className:d.barContainer,style:{height:c}},t.map((e,t)=>{var n=p>0?e.value/p*100:0,l=e.color||f[t%f.length],s=i?e.value.toString():"".concat(n.toFixed(0),"%");return o.createElement("div",{key:"".concat(e.label,"-").concat(t),className:(0,a.mergeClasses)(d.segment,g&&d.segmentInteractive),style:{width:"".concat(n,"%"),backgroundColor:l},onClick:g?()=>h(e):void 0,onKeyDown:g?t=>((e,t)=>{!u||"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),h(t))})(t,e):void 0,tabIndex:g?0:void 0,role:g?"button":void 0,"aria-label":"".concat(e.label,": ").concat(e.value),title:"".concat(e.label,": ").concat(e.value," (").concat(n.toFixed(1),"%)")},r&&n>8&&o.createElement("span",{className:d.segmentLabel},s))})),o.createElement("div",{className:d.legend},t.map((e,t)=>o.createElement("div",{key:"legend-".concat(e.label,"-").concat(t),className:d.legendItem},o.createElement("div",{className:d.legendColor,style:{backgroundColor:e.color||f[t%f.length]}}),o.createElement("span",{className:d.legendText},e.label,": ",e.value)))))},Cf=j("ChevronLeftRegular","1em",["M12.35 15.85a.5.5 0 0 1-.7 0L6.16 10.4a.55.55 0 0 1 0-.78l5.49-5.46a.5.5 0 1 1 .7.7L7.2 10l5.16 5.15c.2.2.2.5 0 .7Z"]),kf=j("ChevronRightRegular","1em",["M7.65 4.15c.2-.2.5-.2.7 0l5.49 5.46c.21.22.21.57 0 .78l-5.49 5.46a.5.5 0 0 1-.7-.7L12.8 10 7.65 4.85a.5.5 0 0 1 0-.7Z"]),wf=(0,a.makeStyles)({container:{display:"flex",flexDirection:"column",width:"100%",gap:a.tokens.spacingVerticalS},header:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:a.tokens.spacingVerticalXS},title:{fontWeight:a.tokens.fontWeightSemibold,color:a.tokens.colorNeutralForeground1,fontSize:a.tokens.fontSizeBase400},navigation:{display:"flex",alignItems:"center",gap:a.tokens.spacingHorizontalXS},monthLabel:{minWidth:"140px",textAlign:"center",fontWeight:a.tokens.fontWeightMedium,color:a.tokens.colorNeutralForeground1},grid:{display:"grid",gridTemplateColumns:"repeat(7, 1fr)",gap:"2px"},weekdayHeader:{display:"flex",alignItems:"center",justifyContent:"center",padding:a.tokens.spacingVerticalXS,fontSize:a.tokens.fontSizeBase100,fontWeight:a.tokens.fontWeightMedium,color:a.tokens.colorNeutralForeground3,textTransform:"uppercase"},day:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"48px",padding:a.tokens.spacingVerticalXXS,borderRadius:a.tokens.borderRadiusSmall,backgroundColor:a.tokens.colorNeutralBackground1,border:"1px solid ".concat(a.tokens.colorNeutralStroke2),cursor:"default",transition:"background-color 0.15s ease-in-out"},dayInteractive:{cursor:"pointer","&:hover":{backgroundColor:a.tokens.colorNeutralBackground1Hover},"&:active":{backgroundColor:a.tokens.colorNeutralBackground1Pressed}},dayWithEvents:{backgroundColor:a.tokens.colorBrandBackground2,border:"1px solid ".concat(a.tokens.colorBrandStroke1)},dayOutsideMonth:{opacity:.4,backgroundColor:a.tokens.colorNeutralBackground3},dayToday:{border:"2px solid ".concat(a.tokens.colorBrandBackground)},dayNumber:{fontSize:a.tokens.fontSizeBase200,color:a.tokens.colorNeutralForeground1,fontWeight:a.tokens.fontWeightRegular},dayNumberToday:{fontWeight:a.tokens.fontWeightBold,color:a.tokens.colorBrandForeground1},eventBadge:{marginTop:"2px"},placeholder:{display:"flex",alignItems:"center",justifyContent:"center",padding:a.tokens.spacingVerticalL,color:a.tokens.colorNeutralForeground3}}),Ef=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],Sf=["January","February","March","April","May","June","July","August","September","October","November","December"],Tf=e=>{var{events:t,initialMonth:n,title:r,onDrillInteraction:i,drillField:l,showNavigation:s=!0}=e,c=wf(),u=new Date,[d,h]=(0,o.useState)(n||new Date(u.getFullYear(),u.getMonth(),1)),p=(0,o.useMemo)(()=>{var e=new Map;return t.forEach(t=>{var n="".concat(t.date.getFullYear(),"-").concat(t.date.getMonth(),"-").concat(t.date.getDate());e.set(n,t)}),e},[t]),f=(0,o.useMemo)(()=>((e,t)=>{for(var n=new Date(e,t,1),r=new Date(e,t+1,0),o=[],i=n.getDay()-1;i>=0;i--)o.push(new Date(e,t,-i));for(var a=1;a<=r.getDate();a++)o.push(new Date(e,t,a));for(var l=42-o.length,s=1;s<=l;s++)o.push(new Date(e,t+1,s));return o})(d.getFullYear(),d.getMonth()),[d]),g=!!i&&!!l;return o.createElement("div",{className:c.container},o.createElement("div",{className:c.header},r&&o.createElement(a.Text,{className:c.title},r),s&&o.createElement("div",{className:c.navigation},o.createElement(a.Button,{appearance:"subtle",icon:o.createElement(Cf,null),onClick:()=>{h(new Date(d.getFullYear(),d.getMonth()-1,1))},"aria-label":"Previous month"}),o.createElement(a.Text,{className:c.monthLabel},Sf[d.getMonth()]," ",d.getFullYear()),o.createElement(a.Button,{appearance:"subtle",icon:o.createElement(kf,null),onClick:()=>{h(new Date(d.getFullYear(),d.getMonth()+1,1))},"aria-label":"Next month"}))),o.createElement("div",{className:c.grid},Ef.map(e=>o.createElement("div",{key:e,className:c.weekdayHeader},e)),f.map((e,t)=>{var n,r,s="".concat(e.getFullYear(),"-").concat(e.getMonth(),"-").concat(e.getDate()),h=p.get(s),f=e.getMonth()===d.getMonth(),v=(r=u,(n=e).getFullYear()===r.getFullYear()&&n.getMonth()===r.getMonth()&&n.getDate()===r.getDate()),m=h&&h.count>0;return o.createElement("div",{key:"day-".concat(t),className:(0,a.mergeClasses)(c.day,!f&&c.dayOutsideMonth,v&&c.dayToday,m&&c.dayWithEvents,g&&c.dayInteractive),onClick:g?()=>(e=>{if(i&&l){var t=new Date(e.getFullYear(),e.getMonth(),e.getDate()),n=new Date(e.getFullYear(),e.getMonth(),e.getDate(),23,59,59);i({field:l,operator:"between",value:[t.toISOString(),n.toISOString()],label:e.toLocaleDateString()})}})(e):void 0,tabIndex:g?0:void 0,role:g?"button":void 0,"aria-label":"".concat(e.toLocaleDateString()).concat(m?", ".concat(h.count," events"):"")},o.createElement(a.Text,{className:(0,a.mergeClasses)(c.dayNumber,v&&c.dayNumberToday)},e.getDate()),m&&o.createElement(a.Badge,{className:c.eventBadge,size:"small",appearance:"filled",color:"brand"},h.count))})))},Df=(0,a.makeStyles)({container:{display:"flex",flexDirection:"column",width:"100%",gap:a.tokens.spacingVerticalXS},title:{fontWeight:a.tokens.fontWeightSemibold,color:a.tokens.colorNeutralForeground1,fontSize:a.tokens.fontSizeBase300,marginBottom:a.tokens.spacingVerticalXS},tableWrapper:{overflowX:"auto"},table:{minWidth:"100%",tableLayout:"auto"},headerCell:{fontWeight:a.tokens.fontWeightSemibold,fontSize:a.tokens.fontSizeBase200,color:a.tokens.colorNeutralForeground2,backgroundColor:a.tokens.colorNeutralBackground2},row:{cursor:"default"},rowInteractive:{cursor:"pointer","&:hover":{backgroundColor:a.tokens.colorNeutralBackground1Hover},"&:active":{backgroundColor:a.tokens.colorNeutralBackground1Pressed}},rankCell:{width:"40px",textAlign:"center",color:a.tokens.colorNeutralForeground3,fontWeight:a.tokens.fontWeightMedium},valueCell:{textAlign:"right",fontWeight:a.tokens.fontWeightMedium,color:a.tokens.colorNeutralForeground1},cell:{fontSize:a.tokens.fontSizeBase200,padding:"".concat(a.tokens.spacingVerticalXS," ").concat(a.tokens.spacingHorizontalS)},placeholder:{display:"flex",alignItems:"center",justifyContent:"center",padding:a.tokens.spacingVerticalL,color:a.tokens.colorNeutralForeground3}}),Mf=e=>{var{items:t,columns:n,title:r,topN:i=5,showRank:l=!0,onDrillInteraction:s,drillField:c,interactive:u=!0}=e,d=Df(),h=(e,t)=>{var r;u&&s&&c&&s({field:c,operator:"eq",value:e.fieldValue,label:"#".concat(t," - ").concat(e.values[null===(r=n[0])||void 0===r?void 0:r.key]||e.id)})};if(!t||0===t.length)return o.createElement("div",{className:d.container},r&&o.createElement(a.Text,{className:d.title},r),o.createElement("div",{className:d.placeholder},o.createElement(a.Text,null,"No data available")));var p=t.slice(0,i),f=u&&s&&c;return o.createElement("div",{className:d.container},r&&o.createElement(a.Text,{className:d.title},r),o.createElement("div",{className:d.tableWrapper},o.createElement(a.Table,{className:d.table,size:"small"},o.createElement(a.TableHeader,null,o.createElement(a.TableRow,null,l&&o.createElement(a.TableHeaderCell,{className:(0,a.mergeClasses)(d.headerCell,d.rankCell)},"#"),n.map(e=>o.createElement(a.TableHeaderCell,{key:e.key,className:(0,a.mergeClasses)(d.headerCell,e.isValue&&d.valueCell),style:e.width?{width:e.width}:void 0},e.header)))),o.createElement(a.TableBody,null,p.map((e,t)=>{var r,i=t+1;return o.createElement(a.TableRow,{key:e.id,className:(0,a.mergeClasses)(d.row,f&&d.rowInteractive),onClick:f?()=>h(e,i):void 0,onKeyDown:f?t=>((e,t,n)=>{!u||"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),h(t,n))})(t,e,i):void 0,tabIndex:f?0:void 0,"aria-label":"Rank ".concat(i,": ").concat(e.values[null===(r=n[0])||void 0===r?void 0:r.key]||e.id)},l&&o.createElement(a.TableCell,{className:(0,a.mergeClasses)(d.cell,d.rankCell)},i),n.map(t=>{var n;return o.createElement(a.TableCell,{key:t.key,className:(0,a.mergeClasses)(d.cell,t.isValue&&d.valueCell)},o.createElement(a.TableCellLayout,null,null!==(n=e.values[t.key])&&void 0!==n?n:"-"))}))})))))},Af=(0,a.makeStyles)({card:{display:"flex",flexDirection:"row",alignItems:"stretch",cursor:"pointer",minHeight:"80px",overflow:"hidden",padding:"0",":hover":{boxShadow:a.tokens.shadow8}},cardDisabled:{cursor:"default",opacity:.7},dateColumn:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minWidth:"64px",padding:a.tokens.spacingVerticalS,color:a.tokens.colorNeutralForeground1},dateDay:{fontSize:a.tokens.fontSizeHero700,fontWeight:a.tokens.fontWeightBold,lineHeight:a.tokens.lineHeightHero700},dateMonth:{fontSize:a.tokens.fontSizeBase200,fontWeight:a.tokens.fontWeightSemibold,textTransform:"uppercase"},content:{display:"flex",flexDirection:"column",flex:1,padding:a.tokens.spacingVerticalS,paddingLeft:a.tokens.spacingHorizontalM,gap:a.tokens.spacingVerticalXS,overflow:"hidden",justifyContent:"center"},title:{fontWeight:a.tokens.fontWeightSemibold,fontSize:a.tokens.fontSizeBase300,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},description:{fontSize:a.tokens.fontSizeBase200,color:a.tokens.colorNeutralForeground3,overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical"},assignedTo:{fontSize:a.tokens.fontSizeBase200,color:a.tokens.colorNeutralForeground3},badgeColumn:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:a.tokens.spacingHorizontalM,gap:a.tokens.spacingVerticalXXS},badgeLabel:{fontSize:a.tokens.fontSizeBase100,color:a.tokens.colorNeutralForeground3,whiteSpace:"nowrap"},spinnerOverlay:{display:"flex",alignItems:"center",justifyContent:"center",padding:a.tokens.spacingHorizontalM}}),Lf=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],Pf=e=>{var t,n,r=Af(),i=o.useCallback(()=>{e.onClick&&!e.isNavigating&&e.onClick(e.eventId)},[e.onClick,e.isNavigating,e.eventId]),l=o.useCallback(e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),i())},[i]),s=e.eventTypeColor?{backgroundColor:e.eventTypeColor}:{},c=e.dueDate.getDate(),u=Lf[e.dueDate.getMonth()];return o.createElement(a.Card,{className:(0,a.mergeClasses)(r.card,e.isNavigating&&r.cardDisabled),onClick:i,onKeyDown:l,role:"button",tabIndex:0,"aria-label":"".concat(e.eventTypeName,": ").concat(e.eventName,", due ").concat(u," ").concat(c)},o.createElement("div",{className:r.dateColumn,style:s},o.createElement("span",{className:r.dateDay},c),o.createElement("span",{className:r.dateMonth},u)),o.createElement("div",{className:r.content},o.createElement(a.Text,{className:r.title,truncate:!0},e.eventTypeName,": ",e.eventName),e.description&&o.createElement(a.Text,{className:r.description},e.description),e.assignedTo&&o.createElement(a.Text,{className:r.assignedTo},"Assigned To: ",e.assignedTo)),e.isNavigating?o.createElement("div",{className:r.spinnerOverlay},o.createElement(a.Spinner,{size:"tiny"})):o.createElement("div",{className:r.badgeColumn},o.createElement(a.Text,{className:r.badgeLabel},e.isOverdue?"Overdue":"Days Left"),o.createElement(a.Badge,{appearance:"filled",color:(t=e.daysUntilDue,n=e.isOverdue,n?"danger":0===t?"warning":t<=3?"important":"informative"),size:"large"},function(e,t){return t?String(Math.abs(e)):0===e?"Today":String(e)}(e.daysUntilDue,e.isOverdue))))},If=window.location.search.includes("debug=true");function Nf(e,t,n){return"".concat("[VisualHost]"," [").concat(t,"] ").concat(n)}var Of=(e,t,n)=>{If&&(void 0!==n?console.debug(Nf(0,e,t),n):console.debug(Nf(0,e,t)))},Ff=(e,t,n)=>{void 0!==n?console.info(Nf(0,e,t),n):console.info(Nf(0,e,t))},Rf=(e,t,n)=>{void 0!==n?console.warn(Nf(0,e,t),n):console.warn(Nf(0,e,t))},Vf=(e,t,n)=>{void 0!==n?console.error(Nf(0,e,t),n):console.error(Nf(0,e,t))},Bf=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function l(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){e.done?o(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(a,l)}s((r=r.apply(e,t||[])).next())})},Hf=(0,a.makeStyles)({container:{display:"flex",alignItems:"center",justifyContent:"center",width:"100%",minHeight:"80px"},empty:{color:a.tokens.colorNeutralForeground3,textAlign:"center",padding:a.tokens.spacingVerticalM}});var zf=e=>{var{chartDefinition:t,webApi:n,contextRecordId:r,onClickAction:i}=e,l=Hf(),[s,c]=(0,o.useState)(null),[u,d]=(0,o.useState)(!0),[h,p]=(0,o.useState)(null),[f,g]=(0,o.useState)(!1);(0,o.useEffect)(()=>{v()},[t,r]);var v=()=>Bf(void 0,void 0,void 0,function*(){try{d(!0),p(null);var e=r;if(!e)return d(!1),void c(null);var o=t.sprk_entitylogicalname||"sprk_event",i=yield n.retrieveRecord(o,e.replace(/[{}]/g,""),"?$select=".concat("sprk_eventid,sprk_eventname,sprk_name,sprk_duedate,sprk_description,_sprk_assignedtoid_value,_sprk_eventtypeid_value","&$expand=").concat("sprk_eventtype_ref($select=sprk_name,sprk_eventtypecolor)"));c(function(e){var t=e.sprk_duedate?new Date(e.sprk_duedate):new Date,{daysUntilDue:n,isOverdue:r}=function(e){var t=new Date;t.setHours(0,0,0,0);var n=new Date(e);n.setHours(0,0,0,0);var r=n.getTime()-t.getTime(),o=Math.ceil(r/864e5);return{daysUntilDue:o,isOverdue:o<0}}(t),o=e.sprk_eventtype_ref,i=null==o?void 0:o.sprk_eventtypecolor,a=e["_sprk_eventtypeid_value@OData.Community.Display.V1.FormattedValue"]||(null==o?void 0:o.sprk_name)||"Event";return{eventId:e.sprk_eventid||"",eventName:e.sprk_eventname||e.sprk_name||"Untitled Event",eventTypeName:a,dueDate:t,daysUntilDue:n,isOverdue:r,eventTypeColor:i||void 0,description:e.sprk_description,assignedTo:e["_sprk_assignedtoid_value@OData.Community.Display.V1.FormattedValue"]||void 0}}(i))}catch(e){var a=e instanceof Error?e.message:String(e);Vf("DueDateCardVisual","Failed to fetch event data",e),p("Failed to load event: ".concat(a))}finally{d(!1)}});return u?o.createElement("div",{className:l.container},o.createElement(a.Spinner,{size:"small",label:"Loading event..."})):h?o.createElement(a.MessageBar,{intent:"error"},o.createElement(a.MessageBarBody,null,h)):s?o.createElement(Pf,Object.assign({},s,{onClick:i?e=>Bf(void 0,void 0,void 0,function*(){if(i&&!f){g(!0);try{yield i(e,t.sprk_entitylogicalname,s)}finally{g(!1)}}}):void 0,isNavigating:f})):o.createElement("div",{className:l.empty},o.createElement(a.Text,{size:200},"No event data available"))},Wf=j("ChevronRight20Regular","20",["M7.65 4.15c.2-.2.5-.2.7 0l5.49 5.46c.21.22.21.57 0 .78l-5.49 5.46a.5.5 0 0 1-.7-.7L12.8 10 7.65 4.85a.5.5 0 0 1 0-.7Z"]),Yf=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function l(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){e.done?o(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(a,l)}s((r=r.apply(e,t||[])).next())})};class jf extends Error{constructor(e,t){super(e),this.cause=t,this.name="ViewDataError"}}var Uf=new Map;function Xf(e,t,n){var r,o,i=e,a=new Date,l={contextRecordId:(null===(r=t.contextRecordId)||void 0===r?void 0:r.replace(/[{}]/g,""))||"",currentUserId:(null===(o=t.currentUserId)||void 0===o?void 0:o.replace(/[{}]/g,""))||"",currentDate:a.toISOString().split("T")[0],currentDateTime:a.toISOString()};for(var[s,c]of Object.entries(l))c&&(i=i.replace(new RegExp("\\{".concat(s,"\\}"),"g"),c));if(n)try{var u=JSON.parse(n);for(var[d,h]of Object.entries(u))"string"==typeof h&&(i=i.replace(new RegExp("\\{".concat(d,"\\}"),"g"),h))}catch(e){Rf("ViewDataService","Failed to parse fetchXmlParams JSON",{paramMappings:n})}var p=i.match(/\{[a-zA-Z_]+\}/g);return p&&Rf("ViewDataService","Unresolved placeholders in FetchXML",{remaining:p}),i}var qf=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function l(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){e.done?o(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(a,l)}s((r=r.apply(e,t||[])).next())})},Gf=(0,a.makeStyles)({container:{display:"flex",flexDirection:"column",width:"100%",gap:a.tokens.spacingVerticalS},cardList:{display:"flex",flexDirection:"column",gap:a.tokens.spacingVerticalS},viewListLink:{display:"flex",alignItems:"center",justifyContent:"flex-end",gap:a.tokens.spacingHorizontalXS,padding:a.tokens.spacingVerticalXS},loading:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"100px"},empty:{color:a.tokens.colorNeutralForeground3,textAlign:"center",padding:a.tokens.spacingVerticalL}});function Kf(e){var t=e.sprk_duedate?new Date(e.sprk_duedate):new Date,{daysUntilDue:n,isOverdue:r}=function(e){var t=new Date;t.setHours(0,0,0,0);var n=new Date(e);n.setHours(0,0,0,0);var r=n.getTime()-t.getTime(),o=Math.ceil(r/864e5);return{daysUntilDue:o,isOverdue:o<0}}(t),o=e.sprk_eventtype_ref,i=null==o?void 0:o.sprk_eventtypecolor,a=e["_sprk_eventtypeid_value@OData.Community.Display.V1.FormattedValue"]||(null==o?void 0:o.sprk_name)||"Event";return{eventId:e.sprk_eventid||"",eventName:e.sprk_eventname||e.sprk_name||"Untitled Event",eventTypeName:a,dueDate:t,daysUntilDue:n,isOverdue:r,eventTypeColor:i||void 0,description:e.sprk_description,assignedTo:e["_sprk_assignedtoid_value@OData.Community.Display.V1.FormattedValue"]||void 0}}var Zf=e=>{var{chartDefinition:t,webApi:n,contextRecordId:r,onClickAction:i,onViewListClick:l,fetchXmlOverride:s}=e,c=Gf(),[u,d]=(0,o.useState)([]),[h,p]=(0,o.useState)(!0),[f,g]=(0,o.useState)(null),[v,m]=(0,o.useState)(null),y=t.sprk_maxdisplayitems||10,_=!!t.sprk_viewlisttabname;(0,o.useEffect)(()=>{x()},[t,r]);var x=()=>qf(void 0,void 0,void 0,function*(){try{p(!0),g(null);var e={contextRecordId:r||void 0},o=yield function(e){return Yf(this,void 0,void 0,function*(){var t,n,{chartDefinition:r,fetchXmlOverride:o,substitutionParams:i,webApi:a}=e,l=r.sprk_entitylogicalname||"sprk_event";if(null==o?void 0:o.trim()){Ff("ViewDataService","Using PCF fetchXmlOverride",{entityName:l});var s=o;return i&&(s=Xf(s,i,r.sprk_fetchxmlparams)),{source:"pcfOverride",fetchXml:s,entityName:l}}if(null===(t=r.sprk_fetchxmlquery)||void 0===t?void 0:t.trim()){Ff("ViewDataService","Using custom FetchXML from chart definition",{entityName:l});var c=r.sprk_fetchxmlquery;return i&&(c=Xf(c,i,r.sprk_fetchxmlparams)),{source:"customFetchXml",fetchXml:c,entityName:l}}if(null===(n=r.sprk_baseviewid)||void 0===n?void 0:n.trim()){Ff("ViewDataService","Using saved view",{viewId:r.sprk_baseviewid,entityName:l});var{fetchXml:u,entityName:d}=yield function(e,t){return Yf(this,void 0,void 0,function*(){var n=t.replace(/[{}]/g,"").toLowerCase(),r=Uf.get(n);if(r&&Date.now()-r.timestamp<6e5)return Of("ViewDataService","View cache hit for ".concat(n)),{fetchXml:r.fetchXml,entityName:r.entityName};Ff("ViewDataService","Retrieving view definition: ".concat(n));try{var o=yield e.retrieveRecord("savedquery",n,"?$select=fetchxml,returnedtypecode,name"),i=o.fetchxml,a=o.returnedtypecode;if(!i)throw new jf("View ".concat(n," has no FetchXML defined"));return Uf.set(n,{fetchXml:i,entityName:a||"",timestamp:Date.now()}),Ff("ViewDataService","Retrieved view: ".concat(o.name),{entityName:a,fetchXmlLength:i.length}),{fetchXml:i,entityName:a}}catch(e){if(e instanceof jf)throw e;var l=e instanceof Error?e.message:String(e);if(l.includes("does not exist")||l.includes("not found")||l.includes("0x80040217"))throw new jf("View not found: ".concat(n));throw new jf("Failed to retrieve view: ".concat(l),e)}})}(a,r.sprk_baseviewid),h=u;return i&&(h=Xf(h,i,r.sprk_fetchxmlparams)),{source:"view",fetchXml:h,entityName:d||l}}return Ff("ViewDataService","Using direct entity query (no FetchXML source)",{entityName:l}),{source:"directEntity",entityName:l}})}({chartDefinition:t,fetchXmlOverride:s||void 0,substitutionParams:e,webApi:n});if("directEntity"!==o.source&&o.fetchXml){var i=encodeURIComponent(o.fetchXml),a=yield n.retrieveMultipleRecords(o.entityName,"?fetchXml=".concat(i));d(a.entities.map(Kf))}else{var l=t.sprk_entitylogicalname||"sprk_event",c="?$select=".concat("sprk_eventid,sprk_eventname,sprk_name,sprk_duedate,sprk_description,_sprk_assignedtoid_value,_sprk_eventtypeid_value","&$expand=").concat("sprk_eventtype_ref($select=sprk_name,sprk_eventtypecolor)","&$top=").concat(y,"&$orderby=sprk_duedate asc");if(t.sprk_contextfieldname&&r){var u=t.sprk_contextfieldname,h=r.replace(/[{}]/g,"");c+="&$filter=".concat(u," eq '").concat(h,"'")}var f=yield n.retrieveMultipleRecords(l,c);d(f.entities.map(Kf))}}catch(e){var v=e instanceof Error?e.message:String(e);Vf("DueDateCardListVisual","Failed to fetch events",e),g("Failed to load events: ".concat(v))}finally{p(!1)}}),b=(0,o.useCallback)(e=>qf(void 0,void 0,void 0,function*(){if(i&&!v){m(e);try{var n=u.find(t=>t.eventId===e);yield i(e,t.sprk_entitylogicalname,n)}finally{m(null)}}}),[i,v,u,t]);return h?o.createElement("div",{className:c.loading},o.createElement(a.Spinner,{size:"small",label:"Loading events..."})):f?o.createElement(a.MessageBar,{intent:"error"},o.createElement(a.MessageBarBody,null,f)):0===u.length?o.createElement("div",{className:c.empty},o.createElement(a.Text,{size:200},"No upcoming events")):o.createElement("div",{className:c.container},o.createElement("div",{className:c.cardList},u.map(e=>o.createElement(Pf,Object.assign({key:e.eventId},e,{onClick:i?b:void 0,isNavigating:v===e.eventId})))),_&&o.createElement("div",{className:c.viewListLink},o.createElement(a.Link,{onClick:l},"View All ",o.createElement(Wf,null))))},$f=(0,a.makeStyles)({container:{display:"flex",alignItems:"center",justifyContent:"center",width:"100%",height:"100%",minHeight:"150px"},placeholder:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:a.tokens.spacingVerticalM,color:a.tokens.colorNeutralForeground3,textAlign:"center",padding:a.tokens.spacingVerticalL},unknownType:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:a.tokens.spacingVerticalL,gap:a.tokens.spacingVerticalS,color:a.tokens.colorNeutralForeground3}}),Jf=e=>{var{chartDefinition:t,chartData:n,onDrillInteraction:r,height:i=300,webApi:l,contextRecordId:s,onClickAction:c,onViewListClick:u,fetchXmlOverride:d}=e,h=$f(),{sprk_visualtype:p,sprk_name:f,sprk_configurationjson:g,sprk_groupbyfield:v}=t,m=(e=>{if(!e)return{};try{return JSON.parse(e)}catch(e){return{}}})(g);if(!(n&&n.dataPoints&&0!==n.dataPoints.length||p===z.MetricCard||p===z.DueDateCard||p===z.DueDateCardList))return o.createElement("div",{className:h.placeholder},o.createElement(a.Text,{size:400},"No data available"),o.createElement(a.Text,{size:200},(e=>{switch(e){case z.MetricCard:return"Metric Card";case z.BarChart:return"Bar Chart";case z.LineChart:return"Line Chart";case z.AreaChart:return"Area Chart";case z.DonutChart:return"Donut Chart";case z.StatusBar:return"Status Distribution Bar";case z.Calendar:return"Calendar";case z.MiniTable:return"Mini Table";case z.DueDateCard:return"Due Date Card";case z.DueDateCardList:return"Due Date Card List";default:return"Unknown (".concat(e,")")}})(p)," requires data to display"));var y=(null==n?void 0:n.dataPoints)||[],_=v||"";switch(p){case z.MetricCard:var x=y.length>0?y[0].value:(null==n?void 0:n.totalRecords)||0,b=y.length>0?y[0].label:f;return o.createElement("div",{className:h.container},o.createElement(ce,{value:x,label:b,description:t.sprk_description,trend:m.trend,trendValue:m.trendValue,onDrillInteraction:r,drillField:_,drillValue:y.length>0?y[0].fieldValue:null,interactive:!!r,compact:m.compact}));case z.BarChart:return o.createElement(qh,{data:y,title:!1!==m.showTitle?f:void 0,orientation:m.orientation,showLabels:m.showLabels,showLegend:m.showLegend,onDrillInteraction:r,drillField:_,height:i,responsive:!0});case z.LineChart:case z.AreaChart:return o.createElement(Bp,{data:y,title:!1!==m.showTitle?f:void 0,variant:p===z.AreaChart?"area":"line",showLegend:m.showLegend,onDrillInteraction:r,drillField:_,height:i,lineColor:m.lineColor});case z.DonutChart:return o.createElement(_f,{data:y,title:!1!==m.showTitle?f:void 0,innerRadius:m.innerRadius,showCenterValue:m.showCenterValue,centerLabel:m.centerLabel,showLegend:m.showLegend,onDrillInteraction:r,drillField:_,height:i});case z.StatusBar:var C=y.map(e=>({label:e.label,value:e.value,color:e.color,fieldValue:e.fieldValue}));return o.createElement(bf,{segments:C,title:!1!==m.showTitle?f:void 0,showLabels:m.showLabels,showCounts:m.showCounts,onDrillInteraction:r,drillField:_,height:m.barHeight});case z.Calendar:var k=y.map(e=>({date:e.fieldValue instanceof Date?e.fieldValue:"string"==typeof e.fieldValue?new Date(e.fieldValue):new Date,count:e.value,label:e.label,fieldValue:e.fieldValue}));return o.createElement(Tf,{events:k,title:!1!==m.showTitle?f:void 0,onDrillInteraction:r,drillField:_,showNavigation:!1!==m.showNavigation});case z.MiniTable:var w=y.map((e,t)=>({id:"row-".concat(t),values:{label:e.label,value:e.value},fieldValue:e.fieldValue})),E=m.columns;return o.createElement(Mf,{items:w,columns:E||[{key:"label",header:"Name",width:"60%"},{key:"value",header:"Value",width:"40%",isValue:!0}],title:!1!==m.showTitle?f:void 0,onDrillInteraction:r,drillField:_,topN:m.topN,showRank:!1!==m.showRank});case z.DueDateCard:return l?o.createElement(zf,{chartDefinition:t,webApi:l,contextRecordId:s,onClickAction:c}):o.createElement("div",{className:h.placeholder},o.createElement(a.Text,{size:200},"DueDateCard requires WebAPI context"));case z.DueDateCardList:return l?o.createElement(Zf,{chartDefinition:t,webApi:l,contextRecordId:s,onClickAction:c,onViewListClick:u,fetchXmlOverride:d}):o.createElement("div",{className:h.placeholder},o.createElement(a.Text,{size:200},"DueDateCardList requires WebAPI context"));default:return o.createElement("div",{className:h.unknownType},o.createElement(a.Text,{size:400,weight:"semibold"},"Unsupported Visual Type"),o.createElement(a.Text,{size:200},"Visual type ",p," is not yet supported."),o.createElement(a.Text,{size:200},"Supported types: MetricCard, BarChart, LineChart, AreaChart, DonutChart, StatusBar, Calendar, MiniTable, DueDateCard, DueDateCardList"))}};class Qf extends Error{constructor(e){super("Chart definition not found: ".concat(e)),this.name="ConfigurationNotFoundError"}}class eg extends Error{constructor(e,t){super(e),this.cause=t,this.name="ConfigurationLoadError"}}var tg={id:"sprk_chartdefinitionid",name:"sprk_name",visualType:"sprk_visualtype",entityLogicalName:"sprk_entitylogicalname",baseViewId:"sprk_baseviewid",aggregationField:"sprk_aggregationfield",aggregationType:"sprk_aggregationtype",groupByField:"sprk_groupbyfield",optionsJson:"sprk_optionsjson",onClickAction:"sprk_onclickaction",onClickTarget:"sprk_onclicktarget",onClickRecordField:"sprk_onclickrecordfield",contextFieldName:"sprk_contextfieldname",viewListTabName:"sprk_viewlisttabname",maxDisplayItems:"sprk_maxdisplayitems",fetchXmlQuery:"sprk_fetchxmlquery",fetchXmlParams:"sprk_fetchxmlparams"},ng=[tg.id,tg.name,tg.visualType,tg.entityLogicalName,tg.baseViewId,tg.aggregationField,tg.aggregationType,tg.groupByField,tg.optionsJson,tg.onClickAction,tg.onClickTarget,tg.onClickRecordField,tg.contextFieldName,tg.viewListTabName,tg.maxDisplayItems,tg.fetchXmlQuery,tg.fetchXmlParams].join(","),rg=new Map;function og(e){var t="number"==typeof e?e:parseInt(String(e),10);return isNaN(t)?(Rf("ConfigurationLoader","Invalid visual type, defaulting to MetricCard",{value:e}),z.MetricCard):Object.values(z).includes(t)?t:(Rf("ConfigurationLoader","Unknown visual type, defaulting to MetricCard",{value:t}),z.MetricCard)}function ig(e){if(null!=e){var t="number"==typeof e?e:parseInt(String(e),10);if(!isNaN(t))return Object.values(Y).includes(t)?t:void Rf("ConfigurationLoader","Unknown aggregation type",{value:t})}}function ag(e){if(null!=e){var t="number"==typeof e?e:parseInt(String(e),10);if(!isNaN(t))return Object.values(W).includes(t)?t:void Rf("ConfigurationLoader","Unknown click action type",{value:t})}}function lg(e){var t={sprk_chartdefinitionid:e[tg.id],sprk_name:e[tg.name]||"Untitled Chart",sprk_visualtype:og(e[tg.visualType]),sprk_entitylogicalname:e[tg.entityLogicalName],sprk_baseviewid:e[tg.baseViewId],sprk_aggregationfield:e[tg.aggregationField],sprk_aggregationtype:ig(e[tg.aggregationType]),sprk_groupbyfield:e[tg.groupByField],sprk_optionsjson:e[tg.optionsJson],sprk_onclickaction:ag(e[tg.onClickAction]),sprk_onclicktarget:e[tg.onClickTarget],sprk_onclickrecordfield:e[tg.onClickRecordField],sprk_contextfieldname:e[tg.contextFieldName],sprk_viewlisttabname:e[tg.viewListTabName],sprk_maxdisplayitems:e[tg.maxDisplayItems],sprk_fetchxmlquery:e[tg.fetchXmlQuery],sprk_fetchxmlparams:e[tg.fetchXmlParams]};return t.sprk_optionsjson&&function(e){if(!e||""===e.trim())return{};try{var t=JSON.parse(e);return"object"!=typeof t||null===t?(Rf("ConfigurationLoader","optionsJson is not an object",{jsonString:e}),{}):t}catch(t){return Rf("ConfigurationLoader","Failed to parse optionsJson",{jsonString:e,error:t}),{}}}(t.sprk_optionsjson),t}function sg(e,t){return n=this,r=arguments,i=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return function*(){if(!t||""===t.trim())throw new eg("Chart definition ID is required");var r,o=t.replace(/[{}]/g,"").toLowerCase();if(Of("ConfigurationLoader","Loading chart definition: ".concat(o)),!n){var i=rg.get(o);if(i&&(r=i,Date.now()-r.timestamp<3e5))return Of("ConfigurationLoader","Cache hit for ".concat(o)),i.definition}try{var a=lg(yield e.webAPI.retrieveRecord("sprk_chartdefinition",o,"?$select=".concat(ng)));return rg.set(o,{definition:a,timestamp:Date.now()}),Ff("ConfigurationLoader","Loaded chart definition: ".concat(a.sprk_name),{id:o,visualType:a.sprk_visualtype,entity:a.sprk_entitylogicalname}),a}catch(e){var l=e instanceof Error?e.message:String(e);if(l.includes("does not exist")||l.includes("not found")||l.includes("0x80040217"))throw Rf("ConfigurationLoader","Chart definition not found: ".concat(o)),new Qf(o);throw Vf("ConfigurationLoader","Failed to load chart definition: ".concat(o),e),new eg("Failed to load chart definition: ".concat(l),e)}}()},new((o=void 0)||(o=Promise))(function(e,t){function a(e){try{s(i.next(e))}catch(e){t(e)}}function l(e){try{s(i.throw(e))}catch(e){t(e)}}function s(t){t.done?e(t.value):function(e){return e instanceof o?e:new o(function(t){t(e)})}(t.value).then(a,l)}s((i=i.apply(n,r||[])).next())});var n,r,o,i}var cg=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function l(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){e.done?o(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(a,l)}s((r=r.apply(e,t||[])).next())})};class ug extends Error{constructor(e,t){super(e),this.cause=t,this.name="AggregationError"}}var dg=new Map;function hg(e){return null==e?"(Blank)":"boolean"==typeof e?e?"Yes":"No":"object"==typeof e&&"name"in e&&"string"==typeof e.name?e.name:String(e)}function pg(e,t,n){if(0===e.length)return 0;switch(t){case Y.Count:return e.length;case Y.Sum:return function(e,t){return fg(e,t).reduce((e,t)=>e+t,0)}(e,n);case Y.Average:return function(e,t){var n=fg(e,t);return 0===n.length?0:n.reduce((e,t)=>e+t,0)/n.length}(e,n);case Y.Min:return function(e,t){var n=fg(e,t);return 0===n.length?0:Math.min(...n)}(e,n);case Y.Max:return function(e,t){var n=fg(e,t);return 0===n.length?0:Math.max(...n)}(e,n);default:return Rf("DataAggregationService","Unknown aggregation type: ".concat(t)),e.length}}function fg(e,t){if(!t)return Rf("DataAggregationService","No aggregation field specified for numeric aggregation"),[];var n=[];for(var r of e){var o=r[t];if(null!=o){var i="number"==typeof o?o:parseFloat(String(o));isNaN(i)||n.push(i)}}return n}function gg(e,t,n){return cg(this,void 0,void 0,function*(){var r,o=t.sprk_entitylogicalname,i=t.sprk_baseviewid,a=null!==(r=t.sprk_aggregationtype)&&void 0!==r?r:Y.Count,l=t.sprk_aggregationfield,s=t.sprk_groupbyfield;if(!o)throw new ug("Entity name is required for data aggregation");var c,u=function(e){if((null==e?void 0:e.fieldName)&&(null==e?void 0:e.recordId)){var t="".concat(e.fieldName," eq '").concat(e.recordId,"'");return Of("DataAggregationService","Built context filter",{fieldName:e.fieldName,recordId:e.recordId,filter:t}),t}}(null==n?void 0:n.contextFilter),d=function(e,t,n,r,o,i){var a=i?":".concat(i.fieldName,"=").concat(i.recordId):"";return"".concat(e,":").concat(t||"all",":").concat(n,":").concat(r||"",":").concat(o||"").concat(a)}(o,i,a,l,s,null==n?void 0:n.contextFilter);if(!(null==n?void 0:n.skipCache)){var h=dg.get(d);if(h&&(c=h,Date.now()-c.timestamp<12e4))return Of("DataAggregationService","Cache hit for ".concat(d)),h.data}Ff("DataAggregationService","Aggregating data for ".concat(t.sprk_name),{entityName:o,aggregationType:a,aggregationField:l,groupByField:s,contextFilter:null==n?void 0:n.contextFilter});var p=[];s&&p.push(s),l&&a!==Y.Count&&p.push(l);var f=yield function(e,t,n){return cg(this,void 0,void 0,function*(){var r,o,i=null!==(r=null==n?void 0:n.maxRecords)&&void 0!==r?r:5e4,a=null!==(o=null==n?void 0:n.pageSize)&&void 0!==o?o:5e3,l=[],s="";(null==n?void 0:n.selectColumns)&&n.selectColumns.length>0&&(s+="?$select=".concat(n.selectColumns.join(","))),(null==n?void 0:n.filter)&&(s+=s?"&":"?",s+="$filter=".concat(encodeURIComponent(n.filter))),s+=s?"&":"?",s+="$top=".concat(Math.min(a,i)),Of("DataAggregationService","Fetching records from ".concat(t),{queryOptions:s,maxRecords:i});try{var c=yield e.webAPI.retrieveMultipleRecords(t,s,a);for(l.push(...c.entities);c.nextLink&&l.length<i;){var u=i-l.length,d="".concat(s,"&$top=").concat(Math.min(a,u));c=yield e.webAPI.retrieveMultipleRecords(t,d,a),l.push(...c.entities),Of("DataAggregationService","Fetched page, total records: ".concat(l.length))}return Ff("DataAggregationService","Fetched ".concat(l.length," records from ").concat(t)),l}catch(e){var h=e instanceof Error?e.message:String(e);throw Vf("DataAggregationService","Failed to fetch records: ".concat(h),e),new ug("Failed to fetch records: ".concat(h),e)}})}(e,o,{viewId:i,selectColumns:p.length>0?p:void 0,filter:u,maxRecords:null==n?void 0:n.maxRecords,pageSize:null==n?void 0:n.pageSize}),g=function(e,t,n,r){if(!r)return[{label:"Total",value:pg(e,t,n),fieldValue:null}];var o=new Map;for(var i of e){var a=hg(i[r]);o.has(a)||o.set(a,[]),o.get(a).push(i)}var l=[];for(var[s,c]of o){var u=pg(c,t,n),d=c[0],h=null==d?void 0:d[r];l.push({label:s,value:u,fieldValue:h})}return l.sort((e,t)=>t.value-e.value),Of("DataAggregationService","Aggregated ".concat(e.length," records into ").concat(l.length," groups")),l}(f,a,l,s),v={dataPoints:g,totalRecords:f.length,aggregationType:a,aggregationField:l,groupByField:s};return dg.set(d,{data:v,timestamp:Date.now()}),Ff("DataAggregationService","Aggregation complete: ".concat(g.length," data points from ").concat(f.length," records")),v})}var vg=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function l(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){e.done?o(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(a,l)}s((r=r.apply(e,t||[])).next())})};function mg(){return window.Xrm}function yg(e){var{chartDefinition:t,recordId:n,recordData:r}=e;if(t.sprk_onclickrecordfield&&r){var o=r[t.sprk_onclickrecordfield];if("string"==typeof o&&""!==o.trim())return o.replace(/[{}]/g,"");Rf("ClickActionHandler","Configured record field not found or empty, using default recordId",{field:t.sprk_onclickrecordfield})}return n}function _g(e){return void 0!==e.sprk_onclickaction&&null!==e.sprk_onclickaction&&e.sprk_onclickaction!==W.None}var xg=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function l(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){e.done?o(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(a,l)}s((r=r.apply(e,t||[])).next())})},bg=(0,a.makeStyles)({container:{display:"flex",flexDirection:"column",height:"100%",minHeight:"200px",padding:a.tokens.spacingVerticalM,paddingBottom:"36px",boxSizing:"border-box",position:"relative"},expandButton:{position:"absolute",top:0,right:0,zIndex:10},chartContainer:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",minHeight:"150px"},versionBadge:{position:"absolute",bottom:0,left:"8px",fontSize:a.tokens.fontSizeBase100,color:a.tokens.colorNeutralForeground4,opacity:.6,pointerEvents:"none"},placeholder:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:a.tokens.spacingVerticalM,color:a.tokens.colorNeutralForeground3,textAlign:"center"}}),Cg=e=>{var t,n,r,i,l,s,c,u,d,h,p,f,{context:g,notifyOutputChanged:v}=e,m=bg(),[y,_]=(0,o.useState)(!0),[x,b]=(0,o.useState)(null),[C,k]=(0,o.useState)(null),[w,E]=(0,o.useState)(null),S=null===(t=g.parameters.chartDefinition)||void 0===t?void 0:t.raw,T=null===(n=null==S?void 0:S[0])||void 0===n?void 0:n.id,D=null===(i=null===(r=g.parameters.chartDefinitionId)||void 0===r?void 0:r.raw)||void 0===i?void 0:i.trim(),M=T||D||null,A=T?"lookup":D?"static":"none",L=(null===(s=null===(l=g.parameters.contextFieldName)||void 0===l?void 0:l.raw)||void 0===s?void 0:s.trim())||null,P=(null===(c=g.mode.contextInfo)||void 0===c?void 0:c.entityId)||null,I=(null===(d=null===(u=g.parameters.fetchXmlOverride)||void 0===u?void 0:u.raw)||void 0===d?void 0:d.trim())||null,N=!1!==(null===(h=g.parameters.showToolbar)||void 0===h?void 0:h.raw),O=!1!==(null===(p=g.parameters.enableDrillThrough)||void 0===p?void 0:p.raw),F=null===(f=g.parameters.height)||void 0===f?void 0:f.raw;(0,o.useEffect)(()=>{if(!M)return _(!1),b(null),k(null),void Ff("VisualHostRoot","No chart definition configured");R(M,A)},[M,A,L,P]);var R=(e,t)=>xg(void 0,void 0,void 0,function*(){try{_(!0),b(null),Ff("VisualHostRoot","Loading chart definition: ".concat(e," (source: ").concat(t,")"),{contextFieldName:L,contextRecordId:P});var n=yield sg({webAPI:g.webAPI},e);if(k(n),Ff("VisualHostRoot","Loaded: ".concat(n.sprk_name),{visualType:n.sprk_visualtype,entity:n.sprk_entitylogicalname}),n.sprk_entitylogicalname)try{var r=yield gg({webAPI:g.webAPI},n,{contextFilter:L&&P?{fieldName:L,recordId:P}:void 0});E(r),Ff("VisualHostRoot","Data loaded: ".concat(r.dataPoints.length," data points from ").concat(r.totalRecords," records"))}catch(e){if(!(e instanceof ug))throw e;Vf("VisualHostRoot","Data aggregation error",e),E(null)}else Rf("VisualHostRoot","No entity configured, skipping data fetch"),E(null)}catch(t){if(t instanceof Qf)Rf("VisualHostRoot","Chart definition not found: ".concat(e)),b("Chart definition not found. Please verify the ID is correct.");else if(t instanceof eg)Vf("VisualHostRoot","Configuration load error",t),b("Failed to load chart: ".concat(t.message));else{var o=t instanceof Error?t.message:"Unknown error";Vf("VisualHostRoot","Failed to load chart definition",t),b("Failed to load chart: ".concat(o))}k(null),E(null)}finally{_(!1)}}),V=(0,o.useCallback)(e=>{O&&(Ff("VisualHostRoot","Drill interaction",e),console.log("Drill interaction:",e),v())},[O,v]),B=(0,o.useCallback)(e=>{var t={sprk_document:"sprk_visualizationdrillthroughworkspace_e48a5"};return e&&t[e]?t[e]:"sprk_visualizationdrillthroughworkspace_e48a5"},[]),H=(0,o.useCallback)(()=>xg(void 0,void 0,void 0,function*(){var e,t,n,r,o;if(Ff("VisualHostRoot","Expand clicked",{chartDefinitionId:M}),M&&C)try{var i=window.Xrm;if(!(null===(e=null==i?void 0:i.Navigation)||void 0===e?void 0:e.navigateTo))return Rf("VisualHostRoot","Xrm.Navigation not available"),void console.log("Expand clicked for chart:",M);var a=B(C.sprk_entitylogicalname),l={chartDefinitionId:M,chartTitle:C.sprk_name||"Drill Through"};C.sprk_groupbyfield&&(l.filterField=C.sprk_groupbyfield),Ff("VisualHostRoot","Opening Custom Page",{pageName:a,params:l});var s=null===(n=null===(t=i.Utility)||void 0===t?void 0:t.getGlobalContext)||void 0===n?void 0:n.call(t),c=(null===(r=null==s?void 0:s.getCurrentAppId)||void 0===r?void 0:r.call(s))||"",u=(null===(o=null==s?void 0:s.getClientUrl)||void 0===o?void 0:o.call(s))||window.location.origin,d=new URLSearchParams(Object.assign({pagetype:"custom",name:a},l));c&&d.set("appid",c),"".concat(u,"/main.aspx?").concat(d.toString());try{sessionStorage.setItem("drillThroughParams",JSON.stringify(l))}catch(e){}Ff("VisualHostRoot","Opening as modal dialog",{pageName:a,recordId:M,params:l}),yield i.Navigation.navigateTo({pageType:"custom",name:a,recordId:M},{target:2,position:1,width:{value:90,unit:"%"},height:{value:85,unit:"%"}}),Ff("VisualHostRoot","Drill-through modal opened")}catch(e){Vf("VisualHostRoot","Failed to open drill-through workspace",e),console.log("Expand clicked for chart:",M,C)}else Rf("VisualHostRoot","No chart definition to expand")}),[M,C,B]),z=(0,o.useCallback)((e,t,n)=>xg(void 0,void 0,void 0,function*(){C&&_g(C)&&(yield function(e,t){return vg(this,void 0,void 0,function*(){var n=e.chartDefinition.sprk_onclickaction;if(null==n||n===W.None)return!1;Ff("ClickActionHandler","Executing click action",{action:n,chartName:e.chartDefinition.sprk_name,recordId:e.recordId});try{switch(n){case W.OpenRecordForm:return yield function(e){return vg(this,void 0,void 0,function*(){var t,n=mg();if(null===(t=null==n?void 0:n.Navigation)||void 0===t?void 0:t.openForm){var r=yg(e),o=e.chartDefinition.sprk_onclicktarget||e.entityName;Ff("ClickActionHandler","Opening record form",{entityName:o,recordId:r}),yield n.Navigation.openForm({entityName:o,entityId:r})}else Rf("ClickActionHandler","Xrm.Navigation.openForm not available")})}(e),!0;case W.OpenSidePane:return yield function(e){return vg(this,void 0,void 0,function*(){var t,n,r=mg();if(null===(n=null===(t=null==r?void 0:r.App)||void 0===t?void 0:t.sidePanes)||void 0===n?void 0:n.createPane){var o=yg(e),i=e.chartDefinition.sprk_onclicktarget;i?(Ff("ClickActionHandler","Opening side pane",{pageName:i,recordId:o}),(yield r.App.sidePanes.createPane({title:e.chartDefinition.sprk_name||"Details",paneId:"visualhost_".concat(o),canClose:!0})).navigate({pageType:"custom",name:i,recordId:o})):Rf("ClickActionHandler","No target page configured for opensidepane action")}else Rf("ClickActionHandler","Xrm.App.sidePanes not available")})}(e),!0;case W.NavigateToPage:return yield function(e){return vg(this,void 0,void 0,function*(){var t,n=mg();if(null===(t=null==n?void 0:n.Navigation)||void 0===t?void 0:t.navigateTo){var r=yg(e),o=e.chartDefinition.sprk_onclicktarget;o?(Ff("ClickActionHandler","Navigating to page",{target:o,recordId:r}),yield n.Navigation.navigateTo({pageType:"custom",name:o,recordId:r})):Rf("ClickActionHandler","No target configured for navigatetopage action")}else Rf("ClickActionHandler","Xrm.Navigation.navigateTo not available")})}(e),!0;case W.OpenDatasetGrid:return t&&t(),!0;default:return Rf("ClickActionHandler","Unknown click action type",{action:n}),!1}}catch(e){return Vf("ClickActionHandler","Failed to execute click action",e),!1}})}({chartDefinition:C,recordId:e,entityName:t,recordData:n},H))}),[C,H]),Y=(0,o.useCallback)(()=>{var e,t;if(null==C?void 0:C.sprk_viewlisttabname){var n=window.Xrm,r=C.sprk_viewlisttabname;Ff("VisualHostRoot","View List click - navigating to tab",{tabName:r});try{var o=null==n?void 0:n.Page;if(null===(t=null===(e=null==o?void 0:o.ui)||void 0===e?void 0:e.tabs)||void 0===t?void 0:t.get){var i=o.ui.tabs.get(r);i?i.setFocus():Rf("VisualHostRoot","Tab '".concat(r,"' not found on current form"))}}catch(e){Vf("VisualHostRoot","Failed to navigate to tab",e)}}},[C]),j=F?{height:"".concat(F,"px")}:{};return o.createElement("div",{className:m.container,style:j},N&&O&&C&&o.createElement("div",{className:m.expandButton},o.createElement(a.Tooltip,{content:"View details",relationship:"label"},o.createElement(a.Button,{appearance:"subtle",icon:o.createElement(U,null),onClick:H,"aria-label":"View details in expanded workspace"}))),o.createElement("span",{className:m.versionBadge},"v1.2.0  2026-02-08"),o.createElement("div",{className:m.chartContainer},y?o.createElement(a.Spinner,{label:"Loading chart..."}):x?o.createElement(a.MessageBar,{intent:"error"},o.createElement(a.MessageBarBody,null,x)):C?o.createElement(Jf,{chartDefinition:C,chartData:w||void 0,onDrillInteraction:O?V:void 0,height:F||300,webApi:g.webAPI,contextRecordId:P||void 0,onClickAction:_g(C)?z:void 0,onViewListClick:C.sprk_viewlisttabname?Y:void 0,fetchXmlOverride:I||void 0}):o.createElement("div",{className:m.placeholder},o.createElement(a.Text,{size:400},"No chart configured"),o.createElement(a.Text,{size:200},"Bind to a lookup column or set Chart Definition ID property"))))},kg=(0,a.makeStyles)({container:{padding:a.tokens.spacingVerticalL,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"200px",gap:a.tokens.spacingVerticalM}});class wg extends o.Component{constructor(e){super(e),this.handleRetry=()=>{this.setState({hasError:!1,error:null})},this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){Vf("ErrorBoundary","Caught error",{error:e.message,stack:e.stack,componentStack:t.componentStack})}render(){return this.state.hasError?o.createElement(Eg,{onRetry:this.handleRetry}):this.props.children}}var Eg=e=>{var{onRetry:t}=e,n=kg();return o.createElement("div",{className:n.container},o.createElement(a.MessageBar,{intent:"error"},o.createElement(a.MessageBarBody,null,o.createElement(a.MessageBarTitle,null,"Something went wrong"),"An error occurred while rendering the chart. Please try again or contact your administrator if the problem persists.")),o.createElement(a.Button,{appearance:"primary",onClick:t},"Try Again"))},Sg="spaarke-theme-change";function Tg(){try{var e=localStorage.getItem("spaarke-theme");if("light"===e||"dark"===e||"auto"===e)return e}catch(e){}return"auto"}function Dg(){if(window.matchMedia){if(window.matchMedia("(forced-colors: active)").matches)return!0;if(window.matchMedia("(-ms-high-contrast: active)").matches)return!0}return!(!document.body.classList.contains("high-contrast")&&!document.body.classList.contains("ms-highContrast"))}function Mg(e){var t,n=Tg();if("dark"===n)return Of("ThemeProvider","Using localStorage preference: dark"),!0;if("light"===n)return Of("ThemeProvider","Using localStorage preference: light"),!1;var r=e;if(void 0!==(null===(t=null==r?void 0:r.fluentDesignLanguage)||void 0===t?void 0:t.isDarkTheme)){var o=r.fluentDesignLanguage.isDarkTheme;return Of("ThemeProvider","Using Power Apps context: ".concat(o?"dark":"light")),o}var i=function(){try{var e=document.querySelector('[data-id="navbar-container"]');if(e){var t=window.getComputedStyle(e).backgroundColor;if("rgb(10, 10, 10)"===t)return Of("ThemeProvider","Navbar detected: dark mode"),!0;if("rgb(240, 240, 240)"===t)return Of("ThemeProvider","Navbar detected: light mode"),!1}}catch(e){}return null}();if(null!==i)return i;var a=function(){try{return window.matchMedia("(prefers-color-scheme: dark)").matches}catch(e){return!1}}();return Of("ThemeProvider","Using system preference: ".concat(a?"dark":"light")),a}function Ag(e){return Dg()?"high-contrast":function(e){return Mg(e)}(e)?"dark":"light"}class Lg{constructor(){this.container=null,this._cleanupThemeListener=null,this._context=null,Ff("VisualHost","Constructor called")}init(e,t,n,r){try{Ff("VisualHost","Init - Setting up container"),this.notifyOutputChanged=t,this._context=e,this.container=r,this._cleanupThemeListener=function(e,t){var n=()=>{var n=Ag(t);Ff("ThemeProvider","Theme changed via event: ".concat(n)),e(n)},r=()=>{if("auto"===Tg()){var n=Ag(t);Ff("ThemeProvider","Theme changed via system: ".concat(n)),e(n)}};window.addEventListener(Sg,n);var o=window.matchMedia("(prefers-color-scheme: dark)");o.addEventListener("change",r);var i=window.matchMedia("(forced-colors: active)");return i.addEventListener("change",n),()=>{window.removeEventListener(Sg,n),o.removeEventListener("change",r),i.removeEventListener("change",n)}}(e=>{Ff("VisualHost","Theme changed: isDark=".concat(e)),this._context&&this.container&&this.renderReactTree(this._context)},e),this.renderReactTree(e),Ff("VisualHost","Init complete")}catch(e){throw Vf("VisualHost","Init failed",e),e}}updateView(e){var t,n;try{this._context=e;var r=null===(t=e.parameters.chartDefinition)||void 0===t?void 0:t.raw,o=null===(n=null==r?void 0:r[0])||void 0===n?void 0:n.id;Of("VisualHost","UpdateView - Re-rendering",{chartDefinitionId:o,lookupValue:r}),this.renderReactTree(e)}catch(e){Vf("VisualHost","UpdateView failed",e)}}destroy(){try{Ff("VisualHost","Destroy - Unmounting React"),this._cleanupThemeListener&&(this._cleanupThemeListener(),this._cleanupThemeListener=null),this.container&&(i.unmountComponentAtNode(this.container),this.container=null),this._context=null}catch(e){Vf("VisualHost","Destroy failed",e)}}getOutputs(){return{}}renderReactTree(e){if(this.container)try{var t=function(e){try{if(Dg())return Of("ThemeProvider","Resolved high-contrast theme"),a.teamsHighContrastTheme;var t=Mg(e);return Of("ThemeProvider","Theme resolved: ".concat(t?"dark":"light")),t?a.webDarkTheme:a.webLightTheme}catch(e){return Rf("ThemeProvider","Error resolving theme, using light theme fallback",e),a.webLightTheme}}(e);i.render(o.createElement(a.FluentProvider,{theme:t},o.createElement(wg,null,o.createElement(Cg,{context:e,notifyOutputChanged:this.notifyOutputChanged}))),this.container)}catch(e){throw Vf("VisualHost","Render failed",e),e}else Vf("VisualHost","Cannot render - container not initialized")}}pcf_tools_652ac3f36e1e4bca82eb3c1dc44e6fad=r})();
if (window.ComponentFramework && window.ComponentFramework.registerControl) {
	ComponentFramework.registerControl('Spaarke.Visuals.VisualHost', pcf_tools_652ac3f36e1e4bca82eb3c1dc44e6fad.VisualHost);
} else {
	var Spaarke = Spaarke || {};
	Spaarke.Visuals = Spaarke.Visuals || {};
	Spaarke.Visuals.VisualHost = pcf_tools_652ac3f36e1e4bca82eb3c1dc44e6fad.VisualHost;
	pcf_tools_652ac3f36e1e4bca82eb3c1dc44e6fad = undefined;
}