<?xml version="1.0" encoding="utf-8" ?>
<manifest>
  <control namespace="Spaarke.Visuals"
           constructor="VisualHost"
           version="1.0.0"
           display-name-key="Visual Host"
           description-key="Configuration-driven visualization control for charts, cards, and calendars"
           control-type="standard">

    <external-service-usage enabled="false" />

    <!-- Chart Definition ID - bound to a lookup field pointing to sprk_chartdefinition -->
    <property name="chartDefinitionId"
              display-name-key="Chart Definition ID"
              description-key="GUID of the sprk_chartdefinition record to render"
              of-type="SingleLine.Text"
              usage="bound"
              required="true" />

    <!-- Optional: Height override -->
    <property name="height"
              display-name-key="Height"
              description-key="Optional height in pixels (default: auto)"
              of-type="Whole.None"
              usage="input"
              required="false" />

    <!-- Optional: Show toolbar -->
    <property name="showToolbar"
              display-name-key="Show Toolbar"
              description-key="Show the chart toolbar with expand button"
              of-type="TwoOptions"
              usage="input"
              required="false"
              default-value="true" />

    <!-- Optional: Enable drill-through -->
    <property name="enableDrillThrough"
              display-name-key="Enable Drill-Through"
              description-key="Enable click interactions to drill into underlying data"
              of-type="TwoOptions"
              usage="input"
              required="false"
              default-value="true" />

    <resources>
      <code path="index.ts" order="1" />
      <css path="styles.css" order="2" />
      <!-- Note: React 18 and Fluent UI v9 are bundled with the control -->
      <!-- platform-library support for Fluent 9 is not yet available -->
    </resources>

    <feature-usage>
      <uses-feature name="WebAPI" required="true" />
    </feature-usage>
  </control>
</manifest>
