<?xml version="1.0" encoding="utf-8" ?>
<manifest>
  <control namespace="Sprk" constructor="SemanticSearchControl" version="1.0.15"
           display-name-key="Semantic Search Control"
           description-key="PCF control for semantic document search with natural language queries"
           control-type="virtual">

    <external-service-usage enabled="true">
      <domain>spe-api-dev-67e2xz.azurewebsites.net</domain>
      <domain>login.microsoftonline.com</domain>
    </external-service-usage>

    <!-- Input: API Base URL -->
    <property name="apiBaseUrl" display-name-key="API Base URL" description-key="BFF API base URL"
              of-type="SingleLine.Text" usage="input" required="false" />

    <!-- Input: Tenant ID for authentication -->
    <property name="tenantId" display-name-key="Tenant ID" description-key="Azure AD tenant ID"
              of-type="SingleLine.Text" usage="input" required="false" />

    <!-- Input: Search scope mode (all, matter, custom) -->
    <property name="searchScope" display-name-key="Search Scope" description-key="Search scope mode"
              of-type="Enum" usage="input" required="false">
      <value name="all" display-name-key="All">all</value>
      <value name="matter" display-name-key="Matter">matter</value>
      <value name="custom" display-name-key="Custom">custom</value>
    </property>

    <!-- Input: Scope ID for scoped search -->
    <property name="scopeId" display-name-key="Scope ID" description-key="ID for scoped search (e.g., Matter ID)"
              of-type="SingleLine.Text" usage="bound" required="false" />

    <!-- Input: Show/hide filter panel -->
    <property name="showFilters" display-name-key="Show Filters" description-key="Show or hide the filter panel"
              of-type="TwoOptions" usage="input" required="false" />

    <!-- Input: Results per page -->
    <property name="resultsLimit" display-name-key="Results Limit" description-key="Number of results per load"
              of-type="Whole.None" usage="input" required="false" />

    <!-- Input: Search input placeholder text -->
    <property name="placeholder" display-name-key="Placeholder" description-key="Search input placeholder text"
              of-type="SingleLine.Text" usage="input" required="false" />

    <!-- Input: Compact mode for form sections -->
    <property name="compactMode" display-name-key="Compact Mode" description-key="Enable compact layout for form sections"
              of-type="TwoOptions" usage="input" required="false" />

    <!-- Output: Selected document ID -->
    <property name="selectedDocumentId" display-name-key="Selected Document ID" description-key="The document selected by the user"
              of-type="SingleLine.Text" usage="output" />

    <resources>
      <code path="index.ts" order="1"/>
      <!-- Platform-provided libraries (not bundled) per ADR-022 -->
      <platform-library name="React" version="16.14.0" />
      <platform-library name="Fluent" version="9.46.2" />
    </resources>

    <feature-usage>
      <uses-feature name="WebAPI" required="true" />
      <uses-feature name="Utility" required="true" />
    </feature-usage>
  </control>
</manifest>
