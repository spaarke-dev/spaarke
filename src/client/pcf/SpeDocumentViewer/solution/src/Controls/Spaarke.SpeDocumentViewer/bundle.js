/*! For license information please see bundle.js.LICENSE.txt */
var pcf_tools_652ac3f36e1e4bca82eb3c1dc44e6fad;(()=>{"use strict";var e={31(e){e.exports=Reactv16},56(e,t,r){e.exports=function(e){var t=r.nc;t&&e.setAttribute("nonce",t)}},60(e,t,r){!function e(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(e){console.error(e)}}(),e.exports=r(492)},72(e){var t=[];function r(e){for(var r=-1,n=0;n<t.length;n++)if(t[n].identifier===e){r=n;break}return r}function n(e,n){for(var i={},a=[],c=0;c<e.length;c++){var l=e[c],s=n.base?l[0]+n.base:l[0],u=i[s]||0,d="".concat(s," ").concat(u);i[s]=u+1;var h=r(d),f={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==h)t[h].references++,t[h].updater(f);else{var p=o(f,n);n.byIndex=c,t.splice(c,0,{identifier:d,updater:p,references:1})}a.push(d)}return a}function o(e,t){var r=t.domAPI(t);return r.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;r.update(e=t)}else r.remove()}}e.exports=function(e,o){var i=n(e=e||[],o=o||{});return function(e){e=e||[];for(var a=0;a<i.length;a++){var c=r(i[a]);t[c].references--}for(var l=n(e,o),s=0;s<i.length;s++){var u=r(i[s]);0===t[u].references&&(t[u].updater(),t.splice(u,1))}i=l}}},113(e){e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},267(e){e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var r="",n=void 0!==t[5];return t[4]&&(r+="@supports (".concat(t[4],") {")),t[2]&&(r+="@media ".concat(t[2]," {")),n&&(r+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),r+=e(t),n&&(r+="}"),t[2]&&(r+="}"),t[4]&&(r+="}"),r}).join("")},t.i=function(e,r,n,o,i){"string"==typeof e&&(e=[[null,e,void 0]]);var a={};if(n)for(var c=0;c<this.length;c++){var l=this[c][0];null!=l&&(a[l]=!0)}for(var s=0;s<e.length;s++){var u=[].concat(e[s]);n&&a[u[0]]||(void 0!==i&&(void 0===u[5]||(u[1]="@layer".concat(u[5].length>0?" ".concat(u[5]):""," {").concat(u[1],"}")),u[5]=i),r&&(u[2]?(u[1]="@media ".concat(u[2]," {").concat(u[1],"}"),u[2]=r):u[2]=r),o&&(u[4]?(u[1]="@supports (".concat(u[4],") {").concat(u[1],"}"),u[4]=o):u[4]="".concat(o)),t.push(u))}},t}},290(e,t){function r(e,t){var r=e.length;e.push(t);e:for(;0<r;){var n=r-1>>>1,o=e[n];if(!(0<i(o,t)))break e;e[n]=t,e[r]=o,r=n}}function n(e){return 0===e.length?null:e[0]}function o(e){if(0===e.length)return null;var t=e[0],r=e.pop();if(r!==t){e[0]=r;e:for(var n=0,o=e.length,a=o>>>1;n<a;){var c=2*(n+1)-1,l=e[c],s=c+1,u=e[s];if(0>i(l,r))s<o&&0>i(u,l)?(e[n]=u,e[s]=r,n=s):(e[n]=l,e[c]=r,n=c);else{if(!(s<o&&0>i(u,r)))break e;e[n]=u,e[s]=r,n=s}}}return t}function i(e,t){var r=e.sortIndex-t.sortIndex;return 0!==r?r:e.id-t.id}if("object"==typeof performance&&"function"==typeof performance.now){var a=performance;t.unstable_now=function(){return a.now()}}else{var c=Date,l=c.now();t.unstable_now=function(){return c.now()-l}}var s=[],u=[],d=1,h=null,f=3,p=!1,g=!1,m=!1,v="function"==typeof setTimeout?setTimeout:null,y="function"==typeof clearTimeout?clearTimeout:null,b="undefined"!=typeof setImmediate?setImmediate:null;function w(e){for(var t=n(u);null!==t;){if(null===t.callback)o(u);else{if(!(t.startTime<=e))break;o(u),t.sortIndex=t.expirationTime,r(s,t)}t=n(u)}}function C(e){if(m=!1,w(e),!g)if(null!==n(s))g=!0,M(k);else{var t=n(u);null!==t&&N(C,t.startTime-e)}}function k(e,r){g=!1,m&&(m=!1,y(A),A=-1),p=!0;var i=f;try{for(w(r),h=n(s);null!==h&&(!(h.expirationTime>r)||e&&!O());){var a=h.callback;if("function"==typeof a){h.callback=null,f=h.priorityLevel;var c=a(h.expirationTime<=r);r=t.unstable_now(),"function"==typeof c?h.callback=c:h===n(s)&&o(s),w(r)}else o(s);h=n(s)}if(null!==h)var l=!0;else{var d=n(u);null!==d&&N(C,d.startTime-r),l=!1}return l}finally{h=null,f=i,p=!1}}"undefined"!=typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var I,S=!1,T=null,A=-1,P=5,E=-1;function O(){return!(t.unstable_now()-E<P)}function _(){if(null!==T){var e=t.unstable_now();E=e;var r=!0;try{r=T(!0,e)}finally{r?I():(S=!1,T=null)}}else S=!1}if("function"==typeof b)I=function(){b(_)};else if("undefined"!=typeof MessageChannel){var R=new MessageChannel,x=R.port2;R.port1.onmessage=_,I=function(){x.postMessage(null)}}else I=function(){v(_,0)};function M(e){T=e,S||(S=!0,I())}function N(e,r){A=v(function(){e(t.unstable_now())},r)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){g||p||(g=!0,M(k))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(s)},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var r=f;f=t;try{return e()}finally{f=r}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var r=f;f=e;try{return t()}finally{f=r}},t.unstable_scheduleCallback=function(e,o,i){var a=t.unstable_now();switch(i="object"==typeof i&&null!==i&&"number"==typeof(i=i.delay)&&0<i?a+i:a,e){case 1:var c=-1;break;case 2:c=250;break;case 5:c=1073741823;break;case 4:c=1e4;break;default:c=5e3}return e={id:d++,callback:o,priorityLevel:e,startTime:i,expirationTime:c=i+c,sortIndex:-1},i>a?(e.sortIndex=i,r(u,e),null===n(s)&&e===n(u)&&(m?(y(A),A=-1):m=!0,N(C,i-a))):(e.sortIndex=c,r(s,e),g||p||(g=!0,M(k))),e},t.unstable_shouldYield=O,t.unstable_wrapCallback=function(e){var t=f;return function(){var r=f;f=t;try{return e.apply(this,arguments)}finally{f=r}}}},457(e,t,r){r.d(t,{A:()=>c});var n=r(978),o=r.n(n),i=r(267),a=r.n(i)()(o());a.push([e.id,'.spe-document-viewer-container{display:flex;flex-direction:column;height:100%;width:100%;font-family:var(--fontFamilyBase, "Segoe UI", -apple-system, BlinkMacSystemFont, sans-serif)}.spe-document-viewer-loading-overlay{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;min-height:200px;background-color:var(--colorNeutralBackground1, #ffffff)}.spe-document-viewer-loading-spinner{width:40px;height:40px;border:4px solid var(--colorNeutralStroke1, #e0e0e0);border-top-color:var(--colorBrandBackground, #0078d4);border-radius:50%;animation:spin 1s linear infinite}@keyframes spin{to{transform:rotate(360deg)}}.spe-document-viewer-loading-text{margin-top:16px;color:var(--colorNeutralForeground2, #666666);font-size:14px}.spe-document-viewer-toolbar{display:flex;align-items:center;justify-content:space-between;padding:8px 12px;background-color:var(--colorNeutralBackground2, #f5f5f5);border-bottom:1px solid var(--colorNeutralStroke1, #e0e0e0);min-height:40px;flex-shrink:0}.spe-document-viewer-doc-name{font-weight:600;font-size:14px;color:var(--colorNeutralForeground1, #323130);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.spe-document-viewer-lock-indicator{display:flex;align-items:center;gap:4px;padding:4px 8px;background-color:var(--colorPaletteYellowBackground2, #fff4ce);border-radius:4px;font-size:12px;color:var(--colorPaletteYellowForeground2, #8a6900)}.spe-document-viewer-toolbar-actions{display:flex;align-items:center;gap:4px}.spe-document-viewer-preview{flex:1;position:relative;overflow:hidden;background-color:var(--colorNeutralBackground1, #ffffff)}.spe-document-viewer-iframe-loading{position:absolute;top:0;left:0;right:0;bottom:0;display:flex;align-items:center;justify-content:center;background-color:var(--colorNeutralBackground1, #ffffff);z-index:1}.spe-document-viewer-iframe{width:100%;height:100%;border:none}.spe-document-viewer-loading{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;min-height:200px;padding:40px}.spe-document-viewer-footer{display:flex;align-items:center;justify-content:flex-end;padding:4px 12px;background-color:var(--colorNeutralBackground2, #f5f5f5);border-top:1px solid var(--colorNeutralStroke1, #e0e0e0);flex-shrink:0}.spe-document-viewer-version{font-size:11px;color:var(--colorNeutralForeground3, #999999)}.spe-document-viewer-error{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;padding:40px;text-align:center}.spe-document-viewer-processing{position:absolute;top:0;left:0;right:0;bottom:0;display:flex;flex-direction:column;align-items:center;justify-content:center;background-color:rgba(255, 255, 255, 0.9);z-index:10}[data-theme=dark] .spe-document-viewer-loading-overlay,[data-theme=dark] .spe-document-viewer-toolbar,[data-theme=dark] .spe-document-viewer-footer{background-color:var(--colorNeutralBackground1, #1f1f1f)}[data-theme=dark] .spe-document-viewer-doc-name{color:var(--colorNeutralForeground1, #f5f5f5)}[data-theme=dark] .spe-document-viewer-preview{background-color:var(--colorNeutralBackground1, #1f1f1f)}',""]);const c=a},492(e,t,r){var n=r(31),o=r(493);function i(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=new Set,c={};function l(e,t){s(e,t),s(e+"Capture",t)}function s(e,t){for(c[e]=t,e=0;e<t.length;e++)a.add(t[e])}var u=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement),d=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},p={};function g(e,t,r,n,o,i,a){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=n,this.attributeNamespace=o,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=a}var m={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){m[e]=new g(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];m[t]=new g(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){m[e]=new g(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){m[e]=new g(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){m[e]=new g(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){m[e]=new g(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){m[e]=new g(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){m[e]=new g(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){m[e]=new g(e,5,!1,e.toLowerCase(),null,!1,!1)});var v=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function b(e,t,r,n){var o=m.hasOwnProperty(t)?m[t]:null;(null!==o?0!==o.type:n||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,r,n){if(null==t||function(e,t,r,n){if(null!==r&&0===r.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!n&&(null!==r?!r.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,r,n))return!0;if(n)return!1;if(null!==r)switch(r.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,r,o,n)&&(r=null),n||null===o?function(e){return!!d.call(p,e)||!d.call(f,e)&&(h.test(e)?p[e]=!0:(f[e]=!0,!1))}(t)&&(null===r?e.removeAttribute(t):e.setAttribute(t,""+r)):o.mustUseProperty?e[o.propertyName]=null===r?3!==o.type&&"":r:(t=o.attributeName,n=o.attributeNamespace,null===r?e.removeAttribute(t):(r=3===(o=o.type)||4===o&&!0===r?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(v,y);m[t]=new g(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(v,y);m[t]=new g(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(v,y);m[t]=new g(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){m[e]=new g(e,1,!1,e.toLowerCase(),null,!1,!1)}),m.xlinkHref=new g("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){m[e]=new g(e,1,!1,e.toLowerCase(),null,!0,!0)});var w=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,C=Symbol.for("react.element"),k=Symbol.for("react.portal"),I=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),T=Symbol.for("react.profiler"),A=Symbol.for("react.provider"),P=Symbol.for("react.context"),E=Symbol.for("react.forward_ref"),O=Symbol.for("react.suspense"),_=Symbol.for("react.suspense_list"),R=Symbol.for("react.memo"),x=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var M=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var N=Symbol.iterator;function D(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=N&&e[N]||e["@@iterator"])?e:null}var L,q=Object.assign;function j(e){if(void 0===L)try{throw Error()}catch(e){var t=e.stack.trim().match(/\n( *(at )?)/);L=t&&t[1]||""}return"\n"+L+e}var U=!1;function F(e,t){if(!e||U)return"";U=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(e){var n=e}Reflect.construct(e,[],t)}else{try{t.call()}catch(e){n=e}e.call(t.prototype)}else{try{throw Error()}catch(e){n=e}e()}}catch(t){if(t&&n&&"string"==typeof t.stack){for(var o=t.stack.split("\n"),i=n.stack.split("\n"),a=o.length-1,c=i.length-1;1<=a&&0<=c&&o[a]!==i[c];)c--;for(;1<=a&&0<=c;a--,c--)if(o[a]!==i[c]){if(1!==a||1!==c)do{if(a--,0>--c||o[a]!==i[c]){var l="\n"+o[a].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=a&&0<=c);break}}}finally{U=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?j(e):""}function H(e){switch(e.tag){case 5:return j(e.type);case 16:return j("Lazy");case 13:return j("Suspense");case 19:return j("SuspenseList");case 0:case 2:case 15:return F(e.type,!1);case 11:return F(e.type.render,!1);case 1:return F(e.type,!0);default:return""}}function z(e){if(null==e)return null;if("function"==typeof e)return e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case I:return"Fragment";case k:return"Portal";case T:return"Profiler";case S:return"StrictMode";case O:return"Suspense";case _:return"SuspenseList"}if("object"==typeof e)switch(e.$$typeof){case P:return(e.displayName||"Context")+".Consumer";case A:return(e._context.displayName||"Context")+".Provider";case E:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case R:return null!==(t=e.displayName||null)?t:z(e.type)||"Memo";case x:t=e._payload,e=e._init;try{return z(e(t))}catch(e){}}return null}function B(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return z(t);case 8:return t===S?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"==typeof t)return t.displayName||t.name||null;if("string"==typeof t)return t}return null}function K(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function V(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function W(e){e._valueTracker||(e._valueTracker=function(e){var t=V(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&void 0!==r&&"function"==typeof r.get&&"function"==typeof r.set){var o=r.get,i=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return o.call(this)},set:function(e){n=""+e,i.call(this,e)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(e){n=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function Q(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=V(e)?e.checked?"true":"false":e.value),(e=n)!==r&&(t.setValue(e),!0)}function G(e){if(void 0===(e=e||("undefined"!=typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function J(e,t){var r=t.checked;return q({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=r?r:e._wrapperState.initialChecked})}function Y(e,t){var r=null==t.defaultValue?"":t.defaultValue,n=null!=t.checked?t.checked:t.defaultChecked;r=K(null!=t.value?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function $(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function X(e,t){$(e,t);var r=K(t.value),n=t.type;if(null!=r)"number"===n?(0===r&&""===e.value||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if("submit"===n||"reset"===n)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,r):t.hasOwnProperty("defaultValue")&&ee(e,t.type,K(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!("submit"!==n&&"reset"!==n||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}""!==(r=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==r&&(e.name=r)}function ee(e,t,r){"number"===t&&G(e.ownerDocument)===e||(null==r?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var te=Array.isArray;function re(e,t,r,n){if(e=e.options,t){t={};for(var o=0;o<r.length;o++)t["$"+r[o]]=!0;for(r=0;r<e.length;r++)o=t.hasOwnProperty("$"+e[r].value),e[r].selected!==o&&(e[r].selected=o),o&&n&&(e[r].defaultSelected=!0)}else{for(r=""+K(r),t=null,o=0;o<e.length;o++){if(e[o].value===r)return e[o].selected=!0,void(n&&(e[o].defaultSelected=!0));null!==t||e[o].disabled||(t=e[o])}null!==t&&(t.selected=!0)}}function ne(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(i(91));return q({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function oe(e,t){var r=t.value;if(null==r){if(r=t.children,t=t.defaultValue,null!=r){if(null!=t)throw Error(i(92));if(te(r)){if(1<r.length)throw Error(i(93));r=r[0]}t=r}null==t&&(t=""),r=t}e._wrapperState={initialValue:K(r)}}function ie(e,t){var r=K(t.value),n=K(t.defaultValue);null!=r&&((r=""+r)!==e.value&&(e.value=r),null==t.defaultValue&&e.defaultValue!==r&&(e.defaultValue=r)),null!=n&&(e.defaultValue=""+n)}function ae(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function ce(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?ce(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var se,ue,de=(ue=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((se=se||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=se.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!=typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,r,n){MSApp.execUnsafeLocalFunction(function(){return ue(e,t)})}:ue);function he(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&3===r.nodeType)return void(r.nodeValue=t)}e.textContent=t}var fe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pe=["Webkit","ms","Moz","O"];function ge(e,t,r){return null==t||"boolean"==typeof t||""===t?"":r||"number"!=typeof t||0===t||fe.hasOwnProperty(e)&&fe[e]?(""+t).trim():t+"px"}function me(e,t){for(var r in e=e.style,t)if(t.hasOwnProperty(r)){var n=0===r.indexOf("--"),o=ge(r,t[r],n);"float"===r&&(r="cssFloat"),n?e.setProperty(r,o):e[r]=o}}Object.keys(fe).forEach(function(e){pe.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),fe[t]=fe[e]})});var ve=q({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ye(e,t){if(t){if(ve[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(i(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(i(60));if("object"!=typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(i(61))}if(null!=t.style&&"object"!=typeof t.style)throw Error(i(62))}}function be(e,t){if(-1===e.indexOf("-"))return"string"==typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var we=null;function Ce(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var ke=null,Ie=null,Se=null;function Te(e){if(e=wo(e)){if("function"!=typeof ke)throw Error(i(280));var t=e.stateNode;t&&(t=ko(t),ke(e.stateNode,e.type,t))}}function Ae(e){Ie?Se?Se.push(e):Se=[e]:Ie=e}function Pe(){if(Ie){var e=Ie,t=Se;if(Se=Ie=null,Te(e),t)for(e=0;e<t.length;e++)Te(t[e])}}function Ee(e,t){return e(t)}function Oe(){}var _e=!1;function Re(e,t,r){if(_e)return e(t,r);_e=!0;try{return Ee(e,t,r)}finally{_e=!1,(null!==Ie||null!==Se)&&(Oe(),Pe())}}function xe(e,t){var r=e.stateNode;if(null===r)return null;var n=ko(r);if(null===n)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(n=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!n;break e;default:e=!1}if(e)return null;if(r&&"function"!=typeof r)throw Error(i(231,t,typeof r));return r}var Me=!1;if(u)try{var Ne={};Object.defineProperty(Ne,"passive",{get:function(){Me=!0}}),window.addEventListener("test",Ne,Ne),window.removeEventListener("test",Ne,Ne)}catch(ue){Me=!1}function De(e,t,r,n,o,i,a,c,l){var s=Array.prototype.slice.call(arguments,3);try{t.apply(r,s)}catch(e){this.onError(e)}}var Le=!1,qe=null,je=!1,Ue=null,Fe={onError:function(e){Le=!0,qe=e}};function He(e,t,r,n,o,i,a,c,l){Le=!1,qe=null,De.apply(Fe,arguments)}function ze(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{!!(4098&(t=e).flags)&&(r=t.return),e=t.return}while(e)}return 3===t.tag?r:null}function Be(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&null!==(e=e.alternate)&&(t=e.memoizedState),null!==t)return t.dehydrated}return null}function Ke(e){if(ze(e)!==e)throw Error(i(188))}function Ve(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=ze(e)))throw Error(i(188));return t!==e?null:e}for(var r=e,n=t;;){var o=r.return;if(null===o)break;var a=o.alternate;if(null===a){if(null!==(n=o.return)){r=n;continue}break}if(o.child===a.child){for(a=o.child;a;){if(a===r)return Ke(o),e;if(a===n)return Ke(o),t;a=a.sibling}throw Error(i(188))}if(r.return!==n.return)r=o,n=a;else{for(var c=!1,l=o.child;l;){if(l===r){c=!0,r=o,n=a;break}if(l===n){c=!0,n=o,r=a;break}l=l.sibling}if(!c){for(l=a.child;l;){if(l===r){c=!0,r=a,n=o;break}if(l===n){c=!0,n=a,r=o;break}l=l.sibling}if(!c)throw Error(i(189))}}if(r.alternate!==n)throw Error(i(190))}if(3!==r.tag)throw Error(i(188));return r.stateNode.current===r?e:t}(e))?We(e):null}function We(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=We(e);if(null!==t)return t;e=e.sibling}return null}var Qe=o.unstable_scheduleCallback,Ge=o.unstable_cancelCallback,Je=o.unstable_shouldYield,Ye=o.unstable_requestPaint,$e=o.unstable_now,Xe=o.unstable_getCurrentPriorityLevel,Ze=o.unstable_ImmediatePriority,et=o.unstable_UserBlockingPriority,tt=o.unstable_NormalPriority,rt=o.unstable_LowPriority,nt=o.unstable_IdlePriority,ot=null,it=null,at=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(ct(e)/lt|0)|0},ct=Math.log,lt=Math.LN2,st=64,ut=4194304;function dt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ht(e,t){var r=e.pendingLanes;if(0===r)return 0;var n=0,o=e.suspendedLanes,i=e.pingedLanes,a=268435455&r;if(0!==a){var c=a&~o;0!==c?n=dt(c):0!==(i&=a)&&(n=dt(i))}else 0!==(a=r&~o)?n=dt(a):0!==i&&(n=dt(i));if(0===n)return 0;if(0!==t&&t!==n&&0===(t&o)&&((o=n&-n)>=(i=t&-t)||16===o&&4194240&i))return t;if(4&n&&(n|=16&r),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=n;0<t;)o=1<<(r=31-at(t)),n|=e[r],t&=~o;return n}function ft(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function pt(e){return 0!=(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function gt(){var e=st;return!(4194240&(st<<=1))&&(st=64),e}function mt(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function vt(e,t,r){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-at(t)]=r}function yt(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-at(r),o=1<<n;o&t|e[n]&t&&(e[n]|=t),r&=~o}}var bt=0;function wt(e){return 1<(e&=-e)?4<e?268435455&e?16:536870912:4:1}var Ct,kt,It,St,Tt,At=!1,Pt=[],Et=null,Ot=null,_t=null,Rt=new Map,xt=new Map,Mt=[],Nt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Dt(e,t){switch(e){case"focusin":case"focusout":Et=null;break;case"dragenter":case"dragleave":Ot=null;break;case"mouseover":case"mouseout":_t=null;break;case"pointerover":case"pointerout":Rt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":xt.delete(t.pointerId)}}function Lt(e,t,r,n,o,i){return null===e||e.nativeEvent!==i?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[o]},null!==t&&null!==(t=wo(t))&&kt(t),e):(e.eventSystemFlags|=n,t=e.targetContainers,null!==o&&-1===t.indexOf(o)&&t.push(o),e)}function qt(e){var t=bo(e.target);if(null!==t){var r=ze(t);if(null!==r)if(13===(t=r.tag)){if(null!==(t=Be(r)))return e.blockedOn=t,void Tt(e.priority,function(){It(r)})}else if(3===t&&r.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===r.tag?r.stateNode.containerInfo:null)}e.blockedOn=null}function jt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var r=Jt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==r)return null!==(t=wo(r))&&kt(t),e.blockedOn=r,!1;var n=new(r=e.nativeEvent).constructor(r.type,r);we=n,r.target.dispatchEvent(n),we=null,t.shift()}return!0}function Ut(e,t,r){jt(e)&&r.delete(t)}function Ft(){At=!1,null!==Et&&jt(Et)&&(Et=null),null!==Ot&&jt(Ot)&&(Ot=null),null!==_t&&jt(_t)&&(_t=null),Rt.forEach(Ut),xt.forEach(Ut)}function Ht(e,t){e.blockedOn===t&&(e.blockedOn=null,At||(At=!0,o.unstable_scheduleCallback(o.unstable_NormalPriority,Ft)))}function zt(e){function t(t){return Ht(t,e)}if(0<Pt.length){Ht(Pt[0],e);for(var r=1;r<Pt.length;r++){var n=Pt[r];n.blockedOn===e&&(n.blockedOn=null)}}for(null!==Et&&Ht(Et,e),null!==Ot&&Ht(Ot,e),null!==_t&&Ht(_t,e),Rt.forEach(t),xt.forEach(t),r=0;r<Mt.length;r++)(n=Mt[r]).blockedOn===e&&(n.blockedOn=null);for(;0<Mt.length&&null===(r=Mt[0]).blockedOn;)qt(r),null===r.blockedOn&&Mt.shift()}var Bt=w.ReactCurrentBatchConfig,Kt=!0;function Vt(e,t,r,n){var o=bt,i=Bt.transition;Bt.transition=null;try{bt=1,Qt(e,t,r,n)}finally{bt=o,Bt.transition=i}}function Wt(e,t,r,n){var o=bt,i=Bt.transition;Bt.transition=null;try{bt=4,Qt(e,t,r,n)}finally{bt=o,Bt.transition=i}}function Qt(e,t,r,n){if(Kt){var o=Jt(e,t,r,n);if(null===o)Kn(e,t,n,Gt,r),Dt(e,n);else if(function(e,t,r,n,o){switch(t){case"focusin":return Et=Lt(Et,e,t,r,n,o),!0;case"dragenter":return Ot=Lt(Ot,e,t,r,n,o),!0;case"mouseover":return _t=Lt(_t,e,t,r,n,o),!0;case"pointerover":var i=o.pointerId;return Rt.set(i,Lt(Rt.get(i)||null,e,t,r,n,o)),!0;case"gotpointercapture":return i=o.pointerId,xt.set(i,Lt(xt.get(i)||null,e,t,r,n,o)),!0}return!1}(o,e,t,r,n))n.stopPropagation();else if(Dt(e,n),4&t&&-1<Nt.indexOf(e)){for(;null!==o;){var i=wo(o);if(null!==i&&Ct(i),null===(i=Jt(e,t,r,n))&&Kn(e,t,n,Gt,r),i===o)break;o=i}null!==o&&n.stopPropagation()}else Kn(e,t,n,null,r)}}var Gt=null;function Jt(e,t,r,n){if(Gt=null,null!==(e=bo(e=Ce(n))))if(null===(t=ze(e)))e=null;else if(13===(r=t.tag)){if(null!==(e=Be(t)))return e;e=null}else if(3===r){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Gt=e,null}function Yt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Xe()){case Ze:return 1;case et:return 4;case tt:case rt:return 16;case nt:return 536870912;default:return 16}default:return 16}}var $t=null,Xt=null,Zt=null;function er(){if(Zt)return Zt;var e,t,r=Xt,n=r.length,o="value"in $t?$t.value:$t.textContent,i=o.length;for(e=0;e<n&&r[e]===o[e];e++);var a=n-e;for(t=1;t<=a&&r[n-t]===o[i-t];t++);return Zt=o.slice(e,1<t?1-t:void 0)}function tr(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function rr(){return!0}function nr(){return!1}function or(e){function t(t,r,n,o,i){for(var a in this._reactName=t,this._targetInst=n,this.type=r,this.nativeEvent=o,this.target=i,this.currentTarget=null,e)e.hasOwnProperty(a)&&(t=e[a],this[a]=t?t(o):o[a]);return this.isDefaultPrevented=(null!=o.defaultPrevented?o.defaultPrevented:!1===o.returnValue)?rr:nr,this.isPropagationStopped=nr,this}return q(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!=typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=rr)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!=typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=rr)},persist:function(){},isPersistent:rr}),t}var ir,ar,cr,lr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},sr=or(lr),ur=q({},lr,{view:0,detail:0}),dr=or(ur),hr=q({},ur,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Sr,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==cr&&(cr&&"mousemove"===e.type?(ir=e.screenX-cr.screenX,ar=e.screenY-cr.screenY):ar=ir=0,cr=e),ir)},movementY:function(e){return"movementY"in e?e.movementY:ar}}),fr=or(hr),pr=or(q({},hr,{dataTransfer:0})),gr=or(q({},ur,{relatedTarget:0})),mr=or(q({},lr,{animationName:0,elapsedTime:0,pseudoElement:0})),vr=q({},lr,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),yr=or(vr),br=or(q({},lr,{data:0})),wr={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Cr={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},kr={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ir(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=kr[e])&&!!t[e]}function Sr(){return Ir}var Tr=q({},ur,{key:function(e){if(e.key){var t=wr[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tr(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?Cr[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Sr,charCode:function(e){return"keypress"===e.type?tr(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tr(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Ar=or(Tr),Pr=or(q({},hr,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Er=or(q({},ur,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Sr})),Or=or(q({},lr,{propertyName:0,elapsedTime:0,pseudoElement:0})),_r=q({},hr,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Rr=or(_r),xr=[9,13,27,32],Mr=u&&"CompositionEvent"in window,Nr=null;u&&"documentMode"in document&&(Nr=document.documentMode);var Dr=u&&"TextEvent"in window&&!Nr,Lr=u&&(!Mr||Nr&&8<Nr&&11>=Nr),qr=String.fromCharCode(32),jr=!1;function Ur(e,t){switch(e){case"keyup":return-1!==xr.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Fr(e){return"object"==typeof(e=e.detail)&&"data"in e?e.data:null}var Hr=!1,zr={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Br(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!zr[e.type]:"textarea"===t}function Kr(e,t,r,n){Ae(n),0<(t=Wn(t,"onChange")).length&&(r=new sr("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Vr=null,Wr=null;function Qr(e){jn(e,0)}function Gr(e){if(Q(Co(e)))return e}function Jr(e,t){if("change"===e)return t}var Yr=!1;if(u){var $r;if(u){var Xr="oninput"in document;if(!Xr){var Zr=document.createElement("div");Zr.setAttribute("oninput","return;"),Xr="function"==typeof Zr.oninput}$r=Xr}else $r=!1;Yr=$r&&(!document.documentMode||9<document.documentMode)}function en(){Vr&&(Vr.detachEvent("onpropertychange",tn),Wr=Vr=null)}function tn(e){if("value"===e.propertyName&&Gr(Wr)){var t=[];Kr(t,Wr,e,Ce(e)),Re(Qr,t)}}function rn(e,t,r){"focusin"===e?(en(),Wr=r,(Vr=t).attachEvent("onpropertychange",tn)):"focusout"===e&&en()}function nn(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Gr(Wr)}function on(e,t){if("click"===e)return Gr(t)}function an(e,t){if("input"===e||"change"===e)return Gr(t)}var cn="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t};function ln(e,t){if(cn(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var o=r[n];if(!d.call(t,o)||!cn(e[o],t[o]))return!1}return!0}function sn(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function un(e,t){var r,n=sn(e);for(e=0;n;){if(3===n.nodeType){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=sn(n)}}function dn(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?dn(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function hn(){for(var e=window,t=G();t instanceof e.HTMLIFrameElement;){try{var r="string"==typeof t.contentWindow.location.href}catch(e){r=!1}if(!r)break;t=G((e=t.contentWindow).document)}return t}function fn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function pn(e){var t=hn(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&dn(r.ownerDocument.documentElement,r)){if(null!==n&&fn(r))if(t=n.start,void 0===(e=n.end)&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if((e=(t=r.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var o=r.textContent.length,i=Math.min(n.start,o);n=void 0===n.end?i:Math.min(n.end,o),!e.extend&&i>n&&(o=n,n=i,i=o),o=un(r,i);var a=un(r,n);o&&a&&(1!==e.rangeCount||e.anchorNode!==o.node||e.anchorOffset!==o.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&((t=t.createRange()).setStart(o.node,o.offset),e.removeAllRanges(),i>n?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}for(t=[],e=r;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"==typeof r.focus&&r.focus(),r=0;r<t.length;r++)(e=t[r]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var gn=u&&"documentMode"in document&&11>=document.documentMode,mn=null,vn=null,yn=null,bn=!1;function wn(e,t,r){var n=r.window===r?r.document:9===r.nodeType?r:r.ownerDocument;bn||null==mn||mn!==G(n)||(n="selectionStart"in(n=mn)&&fn(n)?{start:n.selectionStart,end:n.selectionEnd}:{anchorNode:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset},yn&&ln(yn,n)||(yn=n,0<(n=Wn(vn,"onSelect")).length&&(t=new sr("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=mn)))}function Cn(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var kn={animationend:Cn("Animation","AnimationEnd"),animationiteration:Cn("Animation","AnimationIteration"),animationstart:Cn("Animation","AnimationStart"),transitionend:Cn("Transition","TransitionEnd")},In={},Sn={};function Tn(e){if(In[e])return In[e];if(!kn[e])return e;var t,r=kn[e];for(t in r)if(r.hasOwnProperty(t)&&t in Sn)return In[e]=r[t];return e}u&&(Sn=document.createElement("div").style,"AnimationEvent"in window||(delete kn.animationend.animation,delete kn.animationiteration.animation,delete kn.animationstart.animation),"TransitionEvent"in window||delete kn.transitionend.transition);var An=Tn("animationend"),Pn=Tn("animationiteration"),En=Tn("animationstart"),On=Tn("transitionend"),_n=new Map,Rn="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function xn(e,t){_n.set(e,t),l(t,[e])}for(var Mn=0;Mn<Rn.length;Mn++){var Nn=Rn[Mn];xn(Nn.toLowerCase(),"on"+(Nn[0].toUpperCase()+Nn.slice(1)))}xn(An,"onAnimationEnd"),xn(Pn,"onAnimationIteration"),xn(En,"onAnimationStart"),xn("dblclick","onDoubleClick"),xn("focusin","onFocus"),xn("focusout","onBlur"),xn(On,"onTransitionEnd"),s("onMouseEnter",["mouseout","mouseover"]),s("onMouseLeave",["mouseout","mouseover"]),s("onPointerEnter",["pointerout","pointerover"]),s("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Dn="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ln=new Set("cancel close invalid load scroll toggle".split(" ").concat(Dn));function qn(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,function(e,t,r,n,o,a,c,l,s){if(He.apply(this,arguments),Le){if(!Le)throw Error(i(198));var u=qe;Le=!1,qe=null,je||(je=!0,Ue=u)}}(n,t,void 0,e),e.currentTarget=null}function jn(e,t){t=!!(4&t);for(var r=0;r<e.length;r++){var n=e[r],o=n.event;n=n.listeners;e:{var i=void 0;if(t)for(var a=n.length-1;0<=a;a--){var c=n[a],l=c.instance,s=c.currentTarget;if(c=c.listener,l!==i&&o.isPropagationStopped())break e;qn(o,c,s),i=l}else for(a=0;a<n.length;a++){if(l=(c=n[a]).instance,s=c.currentTarget,c=c.listener,l!==i&&o.isPropagationStopped())break e;qn(o,c,s),i=l}}}if(je)throw e=Ue,je=!1,Ue=null,e}function Un(e,t){var r=t[mo];void 0===r&&(r=t[mo]=new Set);var n=e+"__bubble";r.has(n)||(Bn(t,e,2,!1),r.add(n))}function Fn(e,t,r){var n=0;t&&(n|=4),Bn(r,e,n,t)}var Hn="_reactListening"+Math.random().toString(36).slice(2);function zn(e){if(!e[Hn]){e[Hn]=!0,a.forEach(function(t){"selectionchange"!==t&&(Ln.has(t)||Fn(t,!1,e),Fn(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Hn]||(t[Hn]=!0,Fn("selectionchange",!1,t))}}function Bn(e,t,r,n){switch(Yt(t)){case 1:var o=Vt;break;case 4:o=Wt;break;default:o=Qt}r=o.bind(null,t,r,e),o=void 0,!Me||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(o=!0),n?void 0!==o?e.addEventListener(t,r,{capture:!0,passive:o}):e.addEventListener(t,r,!0):void 0!==o?e.addEventListener(t,r,{passive:o}):e.addEventListener(t,r,!1)}function Kn(e,t,r,n,o){var i=n;if(!(1&t||2&t||null===n))e:for(;;){if(null===n)return;var a=n.tag;if(3===a||4===a){var c=n.stateNode.containerInfo;if(c===o||8===c.nodeType&&c.parentNode===o)break;if(4===a)for(a=n.return;null!==a;){var l=a.tag;if((3===l||4===l)&&((l=a.stateNode.containerInfo)===o||8===l.nodeType&&l.parentNode===o))return;a=a.return}for(;null!==c;){if(null===(a=bo(c)))return;if(5===(l=a.tag)||6===l){n=i=a;continue e}c=c.parentNode}}n=n.return}Re(function(){var n=i,o=Ce(r),a=[];e:{var c=_n.get(e);if(void 0!==c){var l=sr,s=e;switch(e){case"keypress":if(0===tr(r))break e;case"keydown":case"keyup":l=Ar;break;case"focusin":s="focus",l=gr;break;case"focusout":s="blur",l=gr;break;case"beforeblur":case"afterblur":l=gr;break;case"click":if(2===r.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=fr;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=pr;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Er;break;case An:case Pn:case En:l=mr;break;case On:l=Or;break;case"scroll":l=dr;break;case"wheel":l=Rr;break;case"copy":case"cut":case"paste":l=yr;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=Pr}var u=!!(4&t),d=!u&&"scroll"===e,h=u?null!==c?c+"Capture":null:c;u=[];for(var f,p=n;null!==p;){var g=(f=p).stateNode;if(5===f.tag&&null!==g&&(f=g,null!==h&&null!=(g=xe(p,h))&&u.push(Vn(p,g,f))),d)break;p=p.return}0<u.length&&(c=new l(c,s,null,r,o),a.push({event:c,listeners:u}))}}if(!(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(c="mouseover"===e||"pointerover"===e)||r===we||!(s=r.relatedTarget||r.fromElement)||!bo(s)&&!s[go])&&(l||c)&&(c=o.window===o?o:(c=o.ownerDocument)?c.defaultView||c.parentWindow:window,l?(l=n,null!==(s=(s=r.relatedTarget||r.toElement)?bo(s):null)&&(s!==(d=ze(s))||5!==s.tag&&6!==s.tag)&&(s=null)):(l=null,s=n),l!==s)){if(u=fr,g="onMouseLeave",h="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(u=Pr,g="onPointerLeave",h="onPointerEnter",p="pointer"),d=null==l?c:Co(l),f=null==s?c:Co(s),(c=new u(g,p+"leave",l,r,o)).target=d,c.relatedTarget=f,g=null,bo(o)===n&&((u=new u(h,p+"enter",s,r,o)).target=f,u.relatedTarget=d,g=u),d=g,l&&s)e:{for(h=s,p=0,f=u=l;f;f=Qn(f))p++;for(f=0,g=h;g;g=Qn(g))f++;for(;0<p-f;)u=Qn(u),p--;for(;0<f-p;)h=Qn(h),f--;for(;p--;){if(u===h||null!==h&&u===h.alternate)break e;u=Qn(u),h=Qn(h)}u=null}else u=null;null!==l&&Gn(a,c,l,u,!1),null!==s&&null!==d&&Gn(a,d,s,u,!0)}if("select"===(l=(c=n?Co(n):window).nodeName&&c.nodeName.toLowerCase())||"input"===l&&"file"===c.type)var m=Jr;else if(Br(c))if(Yr)m=an;else{m=nn;var v=rn}else(l=c.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===c.type||"radio"===c.type)&&(m=on);switch(m&&(m=m(e,n))?Kr(a,m,r,o):(v&&v(e,c,n),"focusout"===e&&(v=c._wrapperState)&&v.controlled&&"number"===c.type&&ee(c,"number",c.value)),v=n?Co(n):window,e){case"focusin":(Br(v)||"true"===v.contentEditable)&&(mn=v,vn=n,yn=null);break;case"focusout":yn=vn=mn=null;break;case"mousedown":bn=!0;break;case"contextmenu":case"mouseup":case"dragend":bn=!1,wn(a,r,o);break;case"selectionchange":if(gn)break;case"keydown":case"keyup":wn(a,r,o)}var y;if(Mr)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Hr?Ur(e,r)&&(b="onCompositionEnd"):"keydown"===e&&229===r.keyCode&&(b="onCompositionStart");b&&(Lr&&"ko"!==r.locale&&(Hr||"onCompositionStart"!==b?"onCompositionEnd"===b&&Hr&&(y=er()):(Xt="value"in($t=o)?$t.value:$t.textContent,Hr=!0)),0<(v=Wn(n,b)).length&&(b=new br(b,e,null,r,o),a.push({event:b,listeners:v}),(y||null!==(y=Fr(r)))&&(b.data=y))),(y=Dr?function(e,t){switch(e){case"compositionend":return Fr(t);case"keypress":return 32!==t.which?null:(jr=!0,qr);case"textInput":return(e=t.data)===qr&&jr?null:e;default:return null}}(e,r):function(e,t){if(Hr)return"compositionend"===e||!Mr&&Ur(e,t)?(e=er(),Zt=Xt=$t=null,Hr=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Lr&&"ko"!==t.locale?null:t.data}}(e,r))&&0<(n=Wn(n,"onBeforeInput")).length&&(o=new br("onBeforeInput","beforeinput",null,r,o),a.push({event:o,listeners:n}),o.data=y)}jn(a,t)})}function Vn(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Wn(e,t){for(var r=t+"Capture",n=[];null!==e;){var o=e,i=o.stateNode;5===o.tag&&null!==i&&(o=i,null!=(i=xe(e,r))&&n.unshift(Vn(e,i,o)),null!=(i=xe(e,t))&&n.push(Vn(e,i,o))),e=e.return}return n}function Qn(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Gn(e,t,r,n,o){for(var i=t._reactName,a=[];null!==r&&r!==n;){var c=r,l=c.alternate,s=c.stateNode;if(null!==l&&l===n)break;5===c.tag&&null!==s&&(c=s,o?null!=(l=xe(r,i))&&a.unshift(Vn(r,l,c)):o||null!=(l=xe(r,i))&&a.push(Vn(r,l,c))),r=r.return}0!==a.length&&e.push({event:t,listeners:a})}var Jn=/\r\n?/g,Yn=/\u0000|\uFFFD/g;function $n(e){return("string"==typeof e?e:""+e).replace(Jn,"\n").replace(Yn,"")}function Xn(e,t,r){if(t=$n(t),$n(e)!==t&&r)throw Error(i(425))}function Zn(){}var eo=null,to=null;function ro(e,t){return"textarea"===e||"noscript"===e||"string"==typeof t.children||"number"==typeof t.children||"object"==typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var no="function"==typeof setTimeout?setTimeout:void 0,oo="function"==typeof clearTimeout?clearTimeout:void 0,io="function"==typeof Promise?Promise:void 0,ao="function"==typeof queueMicrotask?queueMicrotask:void 0!==io?function(e){return io.resolve(null).then(e).catch(co)}:no;function co(e){setTimeout(function(){throw e})}function lo(e,t){var r=t,n=0;do{var o=r.nextSibling;if(e.removeChild(r),o&&8===o.nodeType)if("/$"===(r=o.data)){if(0===n)return e.removeChild(o),void zt(t);n--}else"$"!==r&&"$?"!==r&&"$!"!==r||n++;r=o}while(r);zt(t)}function so(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function uo(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var r=e.data;if("$"===r||"$!"===r||"$?"===r){if(0===t)return e;t--}else"/$"===r&&t++}e=e.previousSibling}return null}var ho=Math.random().toString(36).slice(2),fo="__reactFiber$"+ho,po="__reactProps$"+ho,go="__reactContainer$"+ho,mo="__reactEvents$"+ho,vo="__reactListeners$"+ho,yo="__reactHandles$"+ho;function bo(e){var t=e[fo];if(t)return t;for(var r=e.parentNode;r;){if(t=r[go]||r[fo]){if(r=t.alternate,null!==t.child||null!==r&&null!==r.child)for(e=uo(e);null!==e;){if(r=e[fo])return r;e=uo(e)}return t}r=(e=r).parentNode}return null}function wo(e){return!(e=e[fo]||e[go])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function Co(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(i(33))}function ko(e){return e[po]||null}var Io=[],So=-1;function To(e){return{current:e}}function Ao(e){0>So||(e.current=Io[So],Io[So]=null,So--)}function Po(e,t){So++,Io[So]=e.current,e.current=t}var Eo={},Oo=To(Eo),_o=To(!1),Ro=Eo;function xo(e,t){var r=e.type.contextTypes;if(!r)return Eo;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var o,i={};for(o in r)i[o]=t[o];return n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Mo(e){return null!=e.childContextTypes}function No(){Ao(_o),Ao(Oo)}function Do(e,t,r){if(Oo.current!==Eo)throw Error(i(168));Po(Oo,t),Po(_o,r)}function Lo(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,"function"!=typeof n.getChildContext)return r;for(var o in n=n.getChildContext())if(!(o in t))throw Error(i(108,B(e)||"Unknown",o));return q({},r,n)}function qo(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Eo,Ro=Oo.current,Po(Oo,e),Po(_o,_o.current),!0}function jo(e,t,r){var n=e.stateNode;if(!n)throw Error(i(169));r?(e=Lo(e,t,Ro),n.__reactInternalMemoizedMergedChildContext=e,Ao(_o),Ao(Oo),Po(Oo,e)):Ao(_o),Po(_o,r)}var Uo=null,Fo=!1,Ho=!1;function zo(e){null===Uo?Uo=[e]:Uo.push(e)}function Bo(){if(!Ho&&null!==Uo){Ho=!0;var e=0,t=bt;try{var r=Uo;for(bt=1;e<r.length;e++){var n=r[e];do{n=n(!0)}while(null!==n)}Uo=null,Fo=!1}catch(t){throw null!==Uo&&(Uo=Uo.slice(e+1)),Qe(Ze,Bo),t}finally{bt=t,Ho=!1}}return null}var Ko=[],Vo=0,Wo=null,Qo=0,Go=[],Jo=0,Yo=null,$o=1,Xo="";function Zo(e,t){Ko[Vo++]=Qo,Ko[Vo++]=Wo,Wo=e,Qo=t}function ei(e,t,r){Go[Jo++]=$o,Go[Jo++]=Xo,Go[Jo++]=Yo,Yo=e;var n=$o;e=Xo;var o=32-at(n)-1;n&=~(1<<o),r+=1;var i=32-at(t)+o;if(30<i){var a=o-o%5;i=(n&(1<<a)-1).toString(32),n>>=a,o-=a,$o=1<<32-at(t)+o|r<<o|n,Xo=i+e}else $o=1<<i|r<<o|n,Xo=e}function ti(e){null!==e.return&&(Zo(e,1),ei(e,1,0))}function ri(e){for(;e===Wo;)Wo=Ko[--Vo],Ko[Vo]=null,Qo=Ko[--Vo],Ko[Vo]=null;for(;e===Yo;)Yo=Go[--Jo],Go[Jo]=null,Xo=Go[--Jo],Go[Jo]=null,$o=Go[--Jo],Go[Jo]=null}var ni=null,oi=null,ii=!1,ai=null;function ci(e,t){var r=_s(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,null===(t=e.deletions)?(e.deletions=[r],e.flags|=16):t.push(r)}function li(e,t){switch(e.tag){case 5:var r=e.type;return null!==(t=1!==t.nodeType||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ni=e,oi=so(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ni=e,oi=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(r=null!==Yo?{id:$o,overflow:Xo}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},(r=_s(18,null,null,0)).stateNode=t,r.return=e,e.child=r,ni=e,oi=null,!0);default:return!1}}function si(e){return!(!(1&e.mode)||128&e.flags)}function ui(e){if(ii){var t=oi;if(t){var r=t;if(!li(e,t)){if(si(e))throw Error(i(418));t=so(r.nextSibling);var n=ni;t&&li(e,t)?ci(n,r):(e.flags=-4097&e.flags|2,ii=!1,ni=e)}}else{if(si(e))throw Error(i(418));e.flags=-4097&e.flags|2,ii=!1,ni=e}}}function di(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ni=e}function hi(e){if(e!==ni)return!1;if(!ii)return di(e),ii=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ro(e.type,e.memoizedProps)),t&&(t=oi)){if(si(e))throw fi(),Error(i(418));for(;t;)ci(e,t),t=so(t.nextSibling)}if(di(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(i(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var r=e.data;if("/$"===r){if(0===t){oi=so(e.nextSibling);break e}t--}else"$"!==r&&"$!"!==r&&"$?"!==r||t++}e=e.nextSibling}oi=null}}else oi=ni?so(e.stateNode.nextSibling):null;return!0}function fi(){for(var e=oi;e;)e=so(e.nextSibling)}function pi(){oi=ni=null,ii=!1}function gi(e){null===ai?ai=[e]:ai.push(e)}var mi=w.ReactCurrentBatchConfig;function vi(e,t,r){if(null!==(e=r.ref)&&"function"!=typeof e&&"object"!=typeof e){if(r._owner){if(r=r._owner){if(1!==r.tag)throw Error(i(309));var n=r.stateNode}if(!n)throw Error(i(147,e));var o=n,a=""+e;return null!==t&&null!==t.ref&&"function"==typeof t.ref&&t.ref._stringRef===a?t.ref:(t=function(e){var t=o.refs;null===e?delete t[a]:t[a]=e},t._stringRef=a,t)}if("string"!=typeof e)throw Error(i(284));if(!r._owner)throw Error(i(290,e))}return e}function yi(e,t){throw e=Object.prototype.toString.call(t),Error(i(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function bi(e){return(0,e._init)(e._payload)}function wi(e){function t(t,r){if(e){var n=t.deletions;null===n?(t.deletions=[r],t.flags|=16):n.push(r)}}function r(r,n){if(!e)return null;for(;null!==n;)t(r,n),n=n.sibling;return null}function n(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function o(e,t){return(e=xs(e,t)).index=0,e.sibling=null,e}function a(t,r,n){return t.index=n,e?null!==(n=t.alternate)?(n=n.index)<r?(t.flags|=2,r):n:(t.flags|=2,r):(t.flags|=1048576,r)}function c(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,r,n){return null===t||6!==t.tag?((t=Ls(r,e.mode,n)).return=e,t):((t=o(t,r)).return=e,t)}function s(e,t,r,n){var i=r.type;return i===I?d(e,t,r.props.children,n,r.key):null!==t&&(t.elementType===i||"object"==typeof i&&null!==i&&i.$$typeof===x&&bi(i)===t.type)?((n=o(t,r.props)).ref=vi(e,t,r),n.return=e,n):((n=Ms(r.type,r.key,r.props,null,e.mode,n)).ref=vi(e,t,r),n.return=e,n)}function u(e,t,r,n){return null===t||4!==t.tag||t.stateNode.containerInfo!==r.containerInfo||t.stateNode.implementation!==r.implementation?((t=qs(r,e.mode,n)).return=e,t):((t=o(t,r.children||[])).return=e,t)}function d(e,t,r,n,i){return null===t||7!==t.tag?((t=Ns(r,e.mode,n,i)).return=e,t):((t=o(t,r)).return=e,t)}function h(e,t,r){if("string"==typeof t&&""!==t||"number"==typeof t)return(t=Ls(""+t,e.mode,r)).return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case C:return(r=Ms(t.type,t.key,t.props,null,e.mode,r)).ref=vi(e,null,t),r.return=e,r;case k:return(t=qs(t,e.mode,r)).return=e,t;case x:return h(e,(0,t._init)(t._payload),r)}if(te(t)||D(t))return(t=Ns(t,e.mode,r,null)).return=e,t;yi(e,t)}return null}function f(e,t,r,n){var o=null!==t?t.key:null;if("string"==typeof r&&""!==r||"number"==typeof r)return null!==o?null:l(e,t,""+r,n);if("object"==typeof r&&null!==r){switch(r.$$typeof){case C:return r.key===o?s(e,t,r,n):null;case k:return r.key===o?u(e,t,r,n):null;case x:return f(e,t,(o=r._init)(r._payload),n)}if(te(r)||D(r))return null!==o?null:d(e,t,r,n,null);yi(e,r)}return null}function p(e,t,r,n,o){if("string"==typeof n&&""!==n||"number"==typeof n)return l(t,e=e.get(r)||null,""+n,o);if("object"==typeof n&&null!==n){switch(n.$$typeof){case C:return s(t,e=e.get(null===n.key?r:n.key)||null,n,o);case k:return u(t,e=e.get(null===n.key?r:n.key)||null,n,o);case x:return p(e,t,r,(0,n._init)(n._payload),o)}if(te(n)||D(n))return d(t,e=e.get(r)||null,n,o,null);yi(t,n)}return null}function g(o,i,c,l){for(var s=null,u=null,d=i,g=i=0,m=null;null!==d&&g<c.length;g++){d.index>g?(m=d,d=null):m=d.sibling;var v=f(o,d,c[g],l);if(null===v){null===d&&(d=m);break}e&&d&&null===v.alternate&&t(o,d),i=a(v,i,g),null===u?s=v:u.sibling=v,u=v,d=m}if(g===c.length)return r(o,d),ii&&Zo(o,g),s;if(null===d){for(;g<c.length;g++)null!==(d=h(o,c[g],l))&&(i=a(d,i,g),null===u?s=d:u.sibling=d,u=d);return ii&&Zo(o,g),s}for(d=n(o,d);g<c.length;g++)null!==(m=p(d,o,g,c[g],l))&&(e&&null!==m.alternate&&d.delete(null===m.key?g:m.key),i=a(m,i,g),null===u?s=m:u.sibling=m,u=m);return e&&d.forEach(function(e){return t(o,e)}),ii&&Zo(o,g),s}function m(o,c,l,s){var u=D(l);if("function"!=typeof u)throw Error(i(150));if(null==(l=u.call(l)))throw Error(i(151));for(var d=u=null,g=c,m=c=0,v=null,y=l.next();null!==g&&!y.done;m++,y=l.next()){g.index>m?(v=g,g=null):v=g.sibling;var b=f(o,g,y.value,s);if(null===b){null===g&&(g=v);break}e&&g&&null===b.alternate&&t(o,g),c=a(b,c,m),null===d?u=b:d.sibling=b,d=b,g=v}if(y.done)return r(o,g),ii&&Zo(o,m),u;if(null===g){for(;!y.done;m++,y=l.next())null!==(y=h(o,y.value,s))&&(c=a(y,c,m),null===d?u=y:d.sibling=y,d=y);return ii&&Zo(o,m),u}for(g=n(o,g);!y.done;m++,y=l.next())null!==(y=p(g,o,m,y.value,s))&&(e&&null!==y.alternate&&g.delete(null===y.key?m:y.key),c=a(y,c,m),null===d?u=y:d.sibling=y,d=y);return e&&g.forEach(function(e){return t(o,e)}),ii&&Zo(o,m),u}return function e(n,i,a,l){if("object"==typeof a&&null!==a&&a.type===I&&null===a.key&&(a=a.props.children),"object"==typeof a&&null!==a){switch(a.$$typeof){case C:e:{for(var s=a.key,u=i;null!==u;){if(u.key===s){if((s=a.type)===I){if(7===u.tag){r(n,u.sibling),(i=o(u,a.props.children)).return=n,n=i;break e}}else if(u.elementType===s||"object"==typeof s&&null!==s&&s.$$typeof===x&&bi(s)===u.type){r(n,u.sibling),(i=o(u,a.props)).ref=vi(n,u,a),i.return=n,n=i;break e}r(n,u);break}t(n,u),u=u.sibling}a.type===I?((i=Ns(a.props.children,n.mode,l,a.key)).return=n,n=i):((l=Ms(a.type,a.key,a.props,null,n.mode,l)).ref=vi(n,i,a),l.return=n,n=l)}return c(n);case k:e:{for(u=a.key;null!==i;){if(i.key===u){if(4===i.tag&&i.stateNode.containerInfo===a.containerInfo&&i.stateNode.implementation===a.implementation){r(n,i.sibling),(i=o(i,a.children||[])).return=n,n=i;break e}r(n,i);break}t(n,i),i=i.sibling}(i=qs(a,n.mode,l)).return=n,n=i}return c(n);case x:return e(n,i,(u=a._init)(a._payload),l)}if(te(a))return g(n,i,a,l);if(D(a))return m(n,i,a,l);yi(n,a)}return"string"==typeof a&&""!==a||"number"==typeof a?(a=""+a,null!==i&&6===i.tag?(r(n,i.sibling),(i=o(i,a)).return=n,n=i):(r(n,i),(i=Ls(a,n.mode,l)).return=n,n=i),c(n)):r(n,i)}}var Ci=wi(!0),ki=wi(!1),Ii=To(null),Si=null,Ti=null,Ai=null;function Pi(){Ai=Ti=Si=null}function Ei(e){var t=Ii.current;Ao(Ii),e._currentValue=t}function Oi(e,t,r){for(;null!==e;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==n&&(n.childLanes|=t)):null!==n&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function _i(e,t){Si=e,Ai=Ti=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(bc=!0),e.firstContext=null)}function Ri(e){var t=e._currentValue;if(Ai!==e)if(e={context:e,memoizedValue:t,next:null},null===Ti){if(null===Si)throw Error(i(308));Ti=e,Si.dependencies={lanes:0,firstContext:e}}else Ti=Ti.next=e;return t}var xi=null;function Mi(e){null===xi?xi=[e]:xi.push(e)}function Ni(e,t,r,n){var o=t.interleaved;return null===o?(r.next=r,Mi(t)):(r.next=o.next,o.next=r),t.interleaved=r,Di(e,n)}function Di(e,t){e.lanes|=t;var r=e.alternate;for(null!==r&&(r.lanes|=t),r=e,e=e.return;null!==e;)e.childLanes|=t,null!==(r=e.alternate)&&(r.childLanes|=t),r=e,e=e.return;return 3===r.tag?r.stateNode:null}var Li=!1;function qi(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function ji(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Ui(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Fi(e,t,r){var n=e.updateQueue;if(null===n)return null;if(n=n.shared,2&Pl){var o=n.pending;return null===o?t.next=t:(t.next=o.next,o.next=t),n.pending=t,Di(e,r)}return null===(o=n.interleaved)?(t.next=t,Mi(n)):(t.next=o.next,o.next=t),n.interleaved=t,Di(e,r)}function Hi(e,t,r){if(null!==(t=t.updateQueue)&&(t=t.shared,4194240&r)){var n=t.lanes;r|=n&=e.pendingLanes,t.lanes=r,yt(e,r)}}function zi(e,t){var r=e.updateQueue,n=e.alternate;if(null!==n&&r===(n=n.updateQueue)){var o=null,i=null;if(null!==(r=r.firstBaseUpdate)){do{var a={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};null===i?o=i=a:i=i.next=a,r=r.next}while(null!==r);null===i?o=i=t:i=i.next=t}else o=i=t;return r={baseState:n.baseState,firstBaseUpdate:o,lastBaseUpdate:i,shared:n.shared,effects:n.effects},void(e.updateQueue=r)}null===(e=r.lastBaseUpdate)?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Bi(e,t,r,n){var o=e.updateQueue;Li=!1;var i=o.firstBaseUpdate,a=o.lastBaseUpdate,c=o.shared.pending;if(null!==c){o.shared.pending=null;var l=c,s=l.next;l.next=null,null===a?i=s:a.next=s,a=l;var u=e.alternate;null!==u&&(c=(u=u.updateQueue).lastBaseUpdate)!==a&&(null===c?u.firstBaseUpdate=s:c.next=s,u.lastBaseUpdate=l)}if(null!==i){var d=o.baseState;for(a=0,u=s=l=null,c=i;;){var h=c.lane,f=c.eventTime;if((n&h)===h){null!==u&&(u=u.next={eventTime:f,lane:0,tag:c.tag,payload:c.payload,callback:c.callback,next:null});e:{var p=e,g=c;switch(h=t,f=r,g.tag){case 1:if("function"==typeof(p=g.payload)){d=p.call(f,d,h);break e}d=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null==(h="function"==typeof(p=g.payload)?p.call(f,d,h):p))break e;d=q({},d,h);break e;case 2:Li=!0}}null!==c.callback&&0!==c.lane&&(e.flags|=64,null===(h=o.effects)?o.effects=[c]:h.push(c))}else f={eventTime:f,lane:h,tag:c.tag,payload:c.payload,callback:c.callback,next:null},null===u?(s=u=f,l=d):u=u.next=f,a|=h;if(null===(c=c.next)){if(null===(c=o.shared.pending))break;c=(h=c).next,h.next=null,o.lastBaseUpdate=h,o.shared.pending=null}}if(null===u&&(l=d),o.baseState=l,o.firstBaseUpdate=s,o.lastBaseUpdate=u,null!==(t=o.shared.interleaved)){o=t;do{a|=o.lane,o=o.next}while(o!==t)}else null===i&&(o.shared.lanes=0);Dl|=a,e.lanes=a,e.memoizedState=d}}function Ki(e,t,r){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var n=e[t],o=n.callback;if(null!==o){if(n.callback=null,n=r,"function"!=typeof o)throw Error(i(191,o));o.call(n)}}}var Vi={},Wi=To(Vi),Qi=To(Vi),Gi=To(Vi);function Ji(e){if(e===Vi)throw Error(i(174));return e}function Yi(e,t){switch(Po(Gi,t),Po(Qi,e),Po(Wi,Vi),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Ao(Wi),Po(Wi,t)}function $i(){Ao(Wi),Ao(Qi),Ao(Gi)}function Xi(e){Ji(Gi.current);var t=Ji(Wi.current),r=le(t,e.type);t!==r&&(Po(Qi,e),Po(Wi,r))}function Zi(e){Qi.current===e&&(Ao(Wi),Ao(Qi))}var ea=To(0);function ta(e){for(var t=e;null!==t;){if(13===t.tag){var r=t.memoizedState;if(null!==r&&(null===(r=r.dehydrated)||"$?"===r.data||"$!"===r.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(128&t.flags)return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ra=[];function na(){for(var e=0;e<ra.length;e++)ra[e]._workInProgressVersionPrimary=null;ra.length=0}var oa=w.ReactCurrentDispatcher,ia=w.ReactCurrentBatchConfig,aa=0,ca=null,la=null,sa=null,ua=!1,da=!1,ha=0,fa=0;function pa(){throw Error(i(321))}function ga(e,t){if(null===t)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!cn(e[r],t[r]))return!1;return!0}function ma(e,t,r,n,o,a){if(aa=a,ca=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,oa.current=null===e||null===e.memoizedState?Za:ec,e=r(n,o),da){a=0;do{if(da=!1,ha=0,25<=a)throw Error(i(301));a+=1,sa=la=null,t.updateQueue=null,oa.current=tc,e=r(n,o)}while(da)}if(oa.current=Xa,t=null!==la&&null!==la.next,aa=0,sa=la=ca=null,ua=!1,t)throw Error(i(300));return e}function va(){var e=0!==ha;return ha=0,e}function ya(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===sa?ca.memoizedState=sa=e:sa=sa.next=e,sa}function ba(){if(null===la){var e=ca.alternate;e=null!==e?e.memoizedState:null}else e=la.next;var t=null===sa?ca.memoizedState:sa.next;if(null!==t)sa=t,la=e;else{if(null===e)throw Error(i(310));e={memoizedState:(la=e).memoizedState,baseState:la.baseState,baseQueue:la.baseQueue,queue:la.queue,next:null},null===sa?ca.memoizedState=sa=e:sa=sa.next=e}return sa}function wa(e,t){return"function"==typeof t?t(e):t}function Ca(e){var t=ba(),r=t.queue;if(null===r)throw Error(i(311));r.lastRenderedReducer=e;var n=la,o=n.baseQueue,a=r.pending;if(null!==a){if(null!==o){var c=o.next;o.next=a.next,a.next=c}n.baseQueue=o=a,r.pending=null}if(null!==o){a=o.next,n=n.baseState;var l=c=null,s=null,u=a;do{var d=u.lane;if((aa&d)===d)null!==s&&(s=s.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:e(n,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===s?(l=s=h,c=n):s=s.next=h,ca.lanes|=d,Dl|=d}u=u.next}while(null!==u&&u!==a);null===s?c=n:s.next=l,cn(n,t.memoizedState)||(bc=!0),t.memoizedState=n,t.baseState=c,t.baseQueue=s,r.lastRenderedState=n}if(null!==(e=r.interleaved)){o=e;do{a=o.lane,ca.lanes|=a,Dl|=a,o=o.next}while(o!==e)}else null===o&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function ka(e){var t=ba(),r=t.queue;if(null===r)throw Error(i(311));r.lastRenderedReducer=e;var n=r.dispatch,o=r.pending,a=t.memoizedState;if(null!==o){r.pending=null;var c=o=o.next;do{a=e(a,c.action),c=c.next}while(c!==o);cn(a,t.memoizedState)||(bc=!0),t.memoizedState=a,null===t.baseQueue&&(t.baseState=a),r.lastRenderedState=a}return[a,n]}function Ia(){}function Sa(e,t){var r=ca,n=ba(),o=t(),a=!cn(n.memoizedState,o);if(a&&(n.memoizedState=o,bc=!0),n=n.queue,La(Pa.bind(null,r,n,e),[e]),n.getSnapshot!==t||a||null!==sa&&1&sa.memoizedState.tag){if(r.flags|=2048,Ra(9,Aa.bind(null,r,n,o,t),void 0,null),null===El)throw Error(i(349));30&aa||Ta(r,t,o)}return o}function Ta(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},null===(t=ca.updateQueue)?(t={lastEffect:null,stores:null},ca.updateQueue=t,t.stores=[e]):null===(r=t.stores)?t.stores=[e]:r.push(e)}function Aa(e,t,r,n){t.value=r,t.getSnapshot=n,Ea(t)&&Oa(e)}function Pa(e,t,r){return r(function(){Ea(t)&&Oa(e)})}function Ea(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!cn(e,r)}catch(e){return!0}}function Oa(e){var t=Di(e,1);null!==t&&ts(t,e,1,-1)}function _a(e){var t=ya();return"function"==typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:wa,lastRenderedState:e},t.queue=e,e=e.dispatch=Ga.bind(null,ca,e),[t.memoizedState,e]}function Ra(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},null===(t=ca.updateQueue)?(t={lastEffect:null,stores:null},ca.updateQueue=t,t.lastEffect=e.next=e):null===(r=t.lastEffect)?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e),e}function xa(){return ba().memoizedState}function Ma(e,t,r,n){var o=ya();ca.flags|=e,o.memoizedState=Ra(1|t,r,void 0,void 0===n?null:n)}function Na(e,t,r,n){var o=ba();n=void 0===n?null:n;var i=void 0;if(null!==la){var a=la.memoizedState;if(i=a.destroy,null!==n&&ga(n,a.deps))return void(o.memoizedState=Ra(t,r,i,n))}ca.flags|=e,o.memoizedState=Ra(1|t,r,i,n)}function Da(e,t){return Ma(8390656,8,e,t)}function La(e,t){return Na(2048,8,e,t)}function qa(e,t){return Na(4,2,e,t)}function ja(e,t){return Na(4,4,e,t)}function Ua(e,t){return"function"==typeof t?(e=e(),t(e),function(){t(null)}):null!=t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Fa(e,t,r){return r=null!=r?r.concat([e]):null,Na(4,4,Ua.bind(null,t,e),r)}function Ha(){}function za(e,t){var r=ba();t=void 0===t?null:t;var n=r.memoizedState;return null!==n&&null!==t&&ga(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function Ba(e,t){var r=ba();t=void 0===t?null:t;var n=r.memoizedState;return null!==n&&null!==t&&ga(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function Ka(e,t,r){return 21&aa?(cn(r,t)||(r=gt(),ca.lanes|=r,Dl|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,bc=!0),e.memoizedState=r)}function Va(e,t){var r=bt;bt=0!==r&&4>r?r:4,e(!0);var n=ia.transition;ia.transition={};try{e(!1),t()}finally{bt=r,ia.transition=n}}function Wa(){return ba().memoizedState}function Qa(e,t,r){var n=es(e);r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},Ja(e)?Ya(t,r):null!==(r=Ni(e,t,r,n))&&(ts(r,e,n,Zl()),$a(r,t,n))}function Ga(e,t,r){var n=es(e),o={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(Ja(e))Ya(t,o);else{var i=e.alternate;if(0===e.lanes&&(null===i||0===i.lanes)&&null!==(i=t.lastRenderedReducer))try{var a=t.lastRenderedState,c=i(a,r);if(o.hasEagerState=!0,o.eagerState=c,cn(c,a)){var l=t.interleaved;return null===l?(o.next=o,Mi(t)):(o.next=l.next,l.next=o),void(t.interleaved=o)}}catch(e){}null!==(r=Ni(e,t,o,n))&&(ts(r,e,n,o=Zl()),$a(r,t,n))}}function Ja(e){var t=e.alternate;return e===ca||null!==t&&t===ca}function Ya(e,t){da=ua=!0;var r=e.pending;null===r?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function $a(e,t,r){if(4194240&r){var n=t.lanes;r|=n&=e.pendingLanes,t.lanes=r,yt(e,r)}}var Xa={readContext:Ri,useCallback:pa,useContext:pa,useEffect:pa,useImperativeHandle:pa,useInsertionEffect:pa,useLayoutEffect:pa,useMemo:pa,useReducer:pa,useRef:pa,useState:pa,useDebugValue:pa,useDeferredValue:pa,useTransition:pa,useMutableSource:pa,useSyncExternalStore:pa,useId:pa,unstable_isNewReconciler:!1},Za={readContext:Ri,useCallback:function(e,t){return ya().memoizedState=[e,void 0===t?null:t],e},useContext:Ri,useEffect:Da,useImperativeHandle:function(e,t,r){return r=null!=r?r.concat([e]):null,Ma(4194308,4,Ua.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Ma(4194308,4,e,t)},useInsertionEffect:function(e,t){return Ma(4,2,e,t)},useMemo:function(e,t){var r=ya();return t=void 0===t?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=ya();return t=void 0!==r?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=Qa.bind(null,ca,e),[n.memoizedState,e]},useRef:function(e){return e={current:e},ya().memoizedState=e},useState:_a,useDebugValue:Ha,useDeferredValue:function(e){return ya().memoizedState=e},useTransition:function(){var e=_a(!1),t=e[0];return e=Va.bind(null,e[1]),ya().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=ca,o=ya();if(ii){if(void 0===r)throw Error(i(407));r=r()}else{if(r=t(),null===El)throw Error(i(349));30&aa||Ta(n,t,r)}o.memoizedState=r;var a={value:r,getSnapshot:t};return o.queue=a,Da(Pa.bind(null,n,a,e),[e]),n.flags|=2048,Ra(9,Aa.bind(null,n,a,r,t),void 0,null),r},useId:function(){var e=ya(),t=El.identifierPrefix;if(ii){var r=Xo;t=":"+t+"R"+(r=($o&~(1<<32-at($o)-1)).toString(32)+r),0<(r=ha++)&&(t+="H"+r.toString(32)),t+=":"}else t=":"+t+"r"+(r=fa++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},ec={readContext:Ri,useCallback:za,useContext:Ri,useEffect:La,useImperativeHandle:Fa,useInsertionEffect:qa,useLayoutEffect:ja,useMemo:Ba,useReducer:Ca,useRef:xa,useState:function(){return Ca(wa)},useDebugValue:Ha,useDeferredValue:function(e){return Ka(ba(),la.memoizedState,e)},useTransition:function(){return[Ca(wa)[0],ba().memoizedState]},useMutableSource:Ia,useSyncExternalStore:Sa,useId:Wa,unstable_isNewReconciler:!1},tc={readContext:Ri,useCallback:za,useContext:Ri,useEffect:La,useImperativeHandle:Fa,useInsertionEffect:qa,useLayoutEffect:ja,useMemo:Ba,useReducer:ka,useRef:xa,useState:function(){return ka(wa)},useDebugValue:Ha,useDeferredValue:function(e){var t=ba();return null===la?t.memoizedState=e:Ka(t,la.memoizedState,e)},useTransition:function(){return[ka(wa)[0],ba().memoizedState]},useMutableSource:Ia,useSyncExternalStore:Sa,useId:Wa,unstable_isNewReconciler:!1};function rc(e,t){if(e&&e.defaultProps){for(var r in t=q({},t),e=e.defaultProps)void 0===t[r]&&(t[r]=e[r]);return t}return t}function nc(e,t,r,n){r=null==(r=r(n,t=e.memoizedState))?t:q({},t,r),e.memoizedState=r,0===e.lanes&&(e.updateQueue.baseState=r)}var oc={isMounted:function(e){return!!(e=e._reactInternals)&&ze(e)===e},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Zl(),o=es(e),i=Ui(n,o);i.payload=t,null!=r&&(i.callback=r),null!==(t=Fi(e,i,o))&&(ts(t,e,o,n),Hi(t,e,o))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Zl(),o=es(e),i=Ui(n,o);i.tag=1,i.payload=t,null!=r&&(i.callback=r),null!==(t=Fi(e,i,o))&&(ts(t,e,o,n),Hi(t,e,o))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Zl(),n=es(e),o=Ui(r,n);o.tag=2,null!=t&&(o.callback=t),null!==(t=Fi(e,o,n))&&(ts(t,e,n,r),Hi(t,e,n))}};function ic(e,t,r,n,o,i,a){return"function"==typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(n,i,a):!(t.prototype&&t.prototype.isPureReactComponent&&ln(r,n)&&ln(o,i))}function ac(e,t,r){var n=!1,o=Eo,i=t.contextType;return"object"==typeof i&&null!==i?i=Ri(i):(o=Mo(t)?Ro:Oo.current,i=(n=null!=(n=t.contextTypes))?xo(e,o):Eo),t=new t(r,i),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=oc,e.stateNode=t,t._reactInternals=e,n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=o,e.__reactInternalMemoizedMaskedChildContext=i),t}function cc(e,t,r,n){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(r,n),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&oc.enqueueReplaceState(t,t.state,null)}function lc(e,t,r,n){var o=e.stateNode;o.props=r,o.state=e.memoizedState,o.refs={},qi(e);var i=t.contextType;"object"==typeof i&&null!==i?o.context=Ri(i):(i=Mo(t)?Ro:Oo.current,o.context=xo(e,i)),o.state=e.memoizedState,"function"==typeof(i=t.getDerivedStateFromProps)&&(nc(e,t,i,r),o.state=e.memoizedState),"function"==typeof t.getDerivedStateFromProps||"function"==typeof o.getSnapshotBeforeUpdate||"function"!=typeof o.UNSAFE_componentWillMount&&"function"!=typeof o.componentWillMount||(t=o.state,"function"==typeof o.componentWillMount&&o.componentWillMount(),"function"==typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount(),t!==o.state&&oc.enqueueReplaceState(o,o.state,null),Bi(e,r,o,n),o.state=e.memoizedState),"function"==typeof o.componentDidMount&&(e.flags|=4194308)}function sc(e,t){try{var r="",n=t;do{r+=H(n),n=n.return}while(n);var o=r}catch(e){o="\nError generating stack: "+e.message+"\n"+e.stack}return{value:e,source:t,stack:o,digest:null}}function uc(e,t,r){return{value:e,source:null,stack:null!=r?r:null,digest:null!=t?t:null}}function dc(e,t){try{console.error(t.value)}catch(e){setTimeout(function(){throw e})}}var hc="function"==typeof WeakMap?WeakMap:Map;function fc(e,t,r){(r=Ui(-1,r)).tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Bl||(Bl=!0,Kl=n),dc(0,t)},r}function pc(e,t,r){(r=Ui(-1,r)).tag=3;var n=e.type.getDerivedStateFromError;if("function"==typeof n){var o=t.value;r.payload=function(){return n(o)},r.callback=function(){dc(0,t)}}var i=e.stateNode;return null!==i&&"function"==typeof i.componentDidCatch&&(r.callback=function(){dc(0,t),"function"!=typeof n&&(null===Vl?Vl=new Set([this]):Vl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),r}function gc(e,t,r){var n=e.pingCache;if(null===n){n=e.pingCache=new hc;var o=new Set;n.set(t,o)}else void 0===(o=n.get(t))&&(o=new Set,n.set(t,o));o.has(r)||(o.add(r),e=Ss.bind(null,e,t,r),t.then(e,e))}function mc(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function vc(e,t,r,n,o){return 1&e.mode?(e.flags|=65536,e.lanes=o,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,1===r.tag&&(null===r.alternate?r.tag=17:((t=Ui(-1,1)).tag=2,Fi(r,t,1))),r.lanes|=1),e)}var yc=w.ReactCurrentOwner,bc=!1;function wc(e,t,r,n){t.child=null===e?ki(t,null,r,n):Ci(t,e.child,r,n)}function Cc(e,t,r,n,o){r=r.render;var i=t.ref;return _i(t,o),n=ma(e,t,r,n,i,o),r=va(),null===e||bc?(ii&&r&&ti(t),t.flags|=1,wc(e,t,n,o),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,Bc(e,t,o))}function kc(e,t,r,n,o){if(null===e){var i=r.type;return"function"!=typeof i||Rs(i)||void 0!==i.defaultProps||null!==r.compare||void 0!==r.defaultProps?((e=Ms(r.type,null,n,t,t.mode,o)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=i,Ic(e,t,i,n,o))}if(i=e.child,0===(e.lanes&o)){var a=i.memoizedProps;if((r=null!==(r=r.compare)?r:ln)(a,n)&&e.ref===t.ref)return Bc(e,t,o)}return t.flags|=1,(e=xs(i,n)).ref=t.ref,e.return=t,t.child=e}function Ic(e,t,r,n,o){if(null!==e){var i=e.memoizedProps;if(ln(i,n)&&e.ref===t.ref){if(bc=!1,t.pendingProps=n=i,0===(e.lanes&o))return t.lanes=e.lanes,Bc(e,t,o);131072&e.flags&&(bc=!0)}}return Ac(e,t,r,n,o)}function Sc(e,t,r){var n=t.pendingProps,o=n.children,i=null!==e?e.memoizedState:null;if("hidden"===n.mode)if(1&t.mode){if(!(1073741824&r))return e=null!==i?i.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Po(xl,Rl),Rl|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=null!==i?i.baseLanes:r,Po(xl,Rl),Rl|=n}else t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Po(xl,Rl),Rl|=r;else null!==i?(n=i.baseLanes|r,t.memoizedState=null):n=r,Po(xl,Rl),Rl|=n;return wc(e,t,o,r),t.child}function Tc(e,t){var r=t.ref;(null===e&&null!==r||null!==e&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Ac(e,t,r,n,o){var i=Mo(r)?Ro:Oo.current;return i=xo(t,i),_i(t,o),r=ma(e,t,r,n,i,o),n=va(),null===e||bc?(ii&&n&&ti(t),t.flags|=1,wc(e,t,r,o),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,Bc(e,t,o))}function Pc(e,t,r,n,o){if(Mo(r)){var i=!0;qo(t)}else i=!1;if(_i(t,o),null===t.stateNode)zc(e,t),ac(t,r,n),lc(t,r,n,o),n=!0;else if(null===e){var a=t.stateNode,c=t.memoizedProps;a.props=c;var l=a.context,s=r.contextType;s="object"==typeof s&&null!==s?Ri(s):xo(t,s=Mo(r)?Ro:Oo.current);var u=r.getDerivedStateFromProps,d="function"==typeof u||"function"==typeof a.getSnapshotBeforeUpdate;d||"function"!=typeof a.UNSAFE_componentWillReceiveProps&&"function"!=typeof a.componentWillReceiveProps||(c!==n||l!==s)&&cc(t,a,n,s),Li=!1;var h=t.memoizedState;a.state=h,Bi(t,n,a,o),l=t.memoizedState,c!==n||h!==l||_o.current||Li?("function"==typeof u&&(nc(t,r,u,n),l=t.memoizedState),(c=Li||ic(t,r,c,n,h,l,s))?(d||"function"!=typeof a.UNSAFE_componentWillMount&&"function"!=typeof a.componentWillMount||("function"==typeof a.componentWillMount&&a.componentWillMount(),"function"==typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"==typeof a.componentDidMount&&(t.flags|=4194308)):("function"==typeof a.componentDidMount&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),a.props=n,a.state=l,a.context=s,n=c):("function"==typeof a.componentDidMount&&(t.flags|=4194308),n=!1)}else{a=t.stateNode,ji(e,t),c=t.memoizedProps,s=t.type===t.elementType?c:rc(t.type,c),a.props=s,d=t.pendingProps,h=a.context,l="object"==typeof(l=r.contextType)&&null!==l?Ri(l):xo(t,l=Mo(r)?Ro:Oo.current);var f=r.getDerivedStateFromProps;(u="function"==typeof f||"function"==typeof a.getSnapshotBeforeUpdate)||"function"!=typeof a.UNSAFE_componentWillReceiveProps&&"function"!=typeof a.componentWillReceiveProps||(c!==d||h!==l)&&cc(t,a,n,l),Li=!1,h=t.memoizedState,a.state=h,Bi(t,n,a,o);var p=t.memoizedState;c!==d||h!==p||_o.current||Li?("function"==typeof f&&(nc(t,r,f,n),p=t.memoizedState),(s=Li||ic(t,r,s,n,h,p,l)||!1)?(u||"function"!=typeof a.UNSAFE_componentWillUpdate&&"function"!=typeof a.componentWillUpdate||("function"==typeof a.componentWillUpdate&&a.componentWillUpdate(n,p,l),"function"==typeof a.UNSAFE_componentWillUpdate&&a.UNSAFE_componentWillUpdate(n,p,l)),"function"==typeof a.componentDidUpdate&&(t.flags|=4),"function"==typeof a.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!=typeof a.componentDidUpdate||c===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!=typeof a.getSnapshotBeforeUpdate||c===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=p),a.props=n,a.state=p,a.context=l,n=s):("function"!=typeof a.componentDidUpdate||c===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!=typeof a.getSnapshotBeforeUpdate||c===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),n=!1)}return Ec(e,t,r,n,i,o)}function Ec(e,t,r,n,o,i){Tc(e,t);var a=!!(128&t.flags);if(!n&&!a)return o&&jo(t,r,!1),Bc(e,t,i);n=t.stateNode,yc.current=t;var c=a&&"function"!=typeof r.getDerivedStateFromError?null:n.render();return t.flags|=1,null!==e&&a?(t.child=Ci(t,e.child,null,i),t.child=Ci(t,null,c,i)):wc(e,t,c,i),t.memoizedState=n.state,o&&jo(t,r,!0),t.child}function Oc(e){var t=e.stateNode;t.pendingContext?Do(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Do(0,t.context,!1),Yi(e,t.containerInfo)}function _c(e,t,r,n,o){return pi(),gi(o),t.flags|=256,wc(e,t,r,n),t.child}var Rc,xc,Mc,Nc={dehydrated:null,treeContext:null,retryLane:0};function Dc(e){return{baseLanes:e,cachePool:null,transitions:null}}function Lc(e,t,r){var n,o=t.pendingProps,a=ea.current,c=!1,l=!!(128&t.flags);if((n=l)||(n=(null===e||null!==e.memoizedState)&&!!(2&a)),n?(c=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(a|=1),Po(ea,1&a),null===e)return ui(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(1&t.mode?"$!"===e.data?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(l=o.children,e=o.fallback,c?(o=t.mode,c=t.child,l={mode:"hidden",children:l},1&o||null===c?c=Ds(l,o,0,null):(c.childLanes=0,c.pendingProps=l),e=Ns(e,o,r,null),c.return=t,e.return=t,c.sibling=e,t.child=c,t.child.memoizedState=Dc(r),t.memoizedState=Nc,e):qc(t,l));if(null!==(a=e.memoizedState)&&null!==(n=a.dehydrated))return function(e,t,r,n,o,a,c){if(r)return 256&t.flags?(t.flags&=-257,jc(e,t,c,n=uc(Error(i(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(a=n.fallback,o=t.mode,n=Ds({mode:"visible",children:n.children},o,0,null),(a=Ns(a,o,c,null)).flags|=2,n.return=t,a.return=t,n.sibling=a,t.child=n,1&t.mode&&Ci(t,e.child,null,c),t.child.memoizedState=Dc(c),t.memoizedState=Nc,a);if(!(1&t.mode))return jc(e,t,c,null);if("$!"===o.data){if(n=o.nextSibling&&o.nextSibling.dataset)var l=n.dgst;return n=l,jc(e,t,c,n=uc(a=Error(i(419)),n,void 0))}if(l=0!==(c&e.childLanes),bc||l){if(null!==(n=El)){switch(c&-c){case 4:o=2;break;case 16:o=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:o=32;break;case 536870912:o=268435456;break;default:o=0}0!==(o=0!==(o&(n.suspendedLanes|c))?0:o)&&o!==a.retryLane&&(a.retryLane=o,Di(e,o),ts(n,e,o,-1))}return ps(),jc(e,t,c,n=uc(Error(i(421))))}return"$?"===o.data?(t.flags|=128,t.child=e.child,t=As.bind(null,e),o._reactRetry=t,null):(e=a.treeContext,oi=so(o.nextSibling),ni=t,ii=!0,ai=null,null!==e&&(Go[Jo++]=$o,Go[Jo++]=Xo,Go[Jo++]=Yo,$o=e.id,Xo=e.overflow,Yo=t),(t=qc(t,n.children)).flags|=4096,t)}(e,t,l,o,n,a,r);if(c){c=o.fallback,l=t.mode,n=(a=e.child).sibling;var s={mode:"hidden",children:o.children};return 1&l||t.child===a?(o=xs(a,s)).subtreeFlags=14680064&a.subtreeFlags:((o=t.child).childLanes=0,o.pendingProps=s,t.deletions=null),null!==n?c=xs(n,c):(c=Ns(c,l,r,null)).flags|=2,c.return=t,o.return=t,o.sibling=c,t.child=o,o=c,c=t.child,l=null===(l=e.child.memoizedState)?Dc(r):{baseLanes:l.baseLanes|r,cachePool:null,transitions:l.transitions},c.memoizedState=l,c.childLanes=e.childLanes&~r,t.memoizedState=Nc,o}return e=(c=e.child).sibling,o=xs(c,{mode:"visible",children:o.children}),!(1&t.mode)&&(o.lanes=r),o.return=t,o.sibling=null,null!==e&&(null===(r=t.deletions)?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=o,t.memoizedState=null,o}function qc(e,t){return(t=Ds({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function jc(e,t,r,n){return null!==n&&gi(n),Ci(t,e.child,null,r),(e=qc(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Uc(e,t,r){e.lanes|=t;var n=e.alternate;null!==n&&(n.lanes|=t),Oi(e.return,t,r)}function Fc(e,t,r,n,o){var i=e.memoizedState;null===i?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:o}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=o)}function Hc(e,t,r){var n=t.pendingProps,o=n.revealOrder,i=n.tail;if(wc(e,t,n.children,r),2&(n=ea.current))n=1&n|2,t.flags|=128;else{if(null!==e&&128&e.flags)e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Uc(e,r,t);else if(19===e.tag)Uc(e,r,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Po(ea,n),1&t.mode)switch(o){case"forwards":for(r=t.child,o=null;null!==r;)null!==(e=r.alternate)&&null===ta(e)&&(o=r),r=r.sibling;null===(r=o)?(o=t.child,t.child=null):(o=r.sibling,r.sibling=null),Fc(t,!1,o,r,i);break;case"backwards":for(r=null,o=t.child,t.child=null;null!==o;){if(null!==(e=o.alternate)&&null===ta(e)){t.child=o;break}e=o.sibling,o.sibling=r,r=o,o=e}Fc(t,!0,r,null,i);break;case"together":Fc(t,!1,null,null,void 0);break;default:t.memoizedState=null}else t.memoizedState=null;return t.child}function zc(e,t){!(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Bc(e,t,r){if(null!==e&&(t.dependencies=e.dependencies),Dl|=t.lanes,0===(r&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(i(153));if(null!==t.child){for(r=xs(e=t.child,e.pendingProps),t.child=r,r.return=t;null!==e.sibling;)e=e.sibling,(r=r.sibling=xs(e,e.pendingProps)).return=t;r.sibling=null}return t.child}function Kc(e,t){if(!ii)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;null!==t;)null!==t.alternate&&(r=t),t=t.sibling;null===r?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;null!==r;)null!==r.alternate&&(n=r),r=r.sibling;null===n?t||null===e.tail?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Vc(e){var t=null!==e.alternate&&e.alternate.child===e.child,r=0,n=0;if(t)for(var o=e.child;null!==o;)r|=o.lanes|o.childLanes,n|=14680064&o.subtreeFlags,n|=14680064&o.flags,o.return=e,o=o.sibling;else for(o=e.child;null!==o;)r|=o.lanes|o.childLanes,n|=o.subtreeFlags,n|=o.flags,o.return=e,o=o.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function Wc(e,t,r){var n=t.pendingProps;switch(ri(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Vc(t),null;case 1:case 17:return Mo(t.type)&&No(),Vc(t),null;case 3:return n=t.stateNode,$i(),Ao(_o),Ao(Oo),na(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(hi(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&!(256&t.flags)||(t.flags|=1024,null!==ai&&(is(ai),ai=null))),Vc(t),null;case 5:Zi(t);var o=Ji(Gi.current);if(r=t.type,null!==e&&null!=t.stateNode)xc(e,t,r,n),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(null===t.stateNode)throw Error(i(166));return Vc(t),null}if(e=Ji(Wi.current),hi(t)){n=t.stateNode,r=t.type;var a=t.memoizedProps;switch(n[fo]=t,n[po]=a,e=!!(1&t.mode),r){case"dialog":Un("cancel",n),Un("close",n);break;case"iframe":case"object":case"embed":Un("load",n);break;case"video":case"audio":for(o=0;o<Dn.length;o++)Un(Dn[o],n);break;case"source":Un("error",n);break;case"img":case"image":case"link":Un("error",n),Un("load",n);break;case"details":Un("toggle",n);break;case"input":Y(n,a),Un("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!a.multiple},Un("invalid",n);break;case"textarea":oe(n,a),Un("invalid",n)}for(var l in ye(r,a),o=null,a)if(a.hasOwnProperty(l)){var s=a[l];"children"===l?"string"==typeof s?n.textContent!==s&&(!0!==a.suppressHydrationWarning&&Xn(n.textContent,s,e),o=["children",s]):"number"==typeof s&&n.textContent!==""+s&&(!0!==a.suppressHydrationWarning&&Xn(n.textContent,s,e),o=["children",""+s]):c.hasOwnProperty(l)&&null!=s&&"onScroll"===l&&Un("scroll",n)}switch(r){case"input":W(n),Z(n,a,!0);break;case"textarea":W(n),ae(n);break;case"select":case"option":break;default:"function"==typeof a.onClick&&(n.onclick=Zn)}n=o,t.updateQueue=n,null!==n&&(t.flags|=4)}else{l=9===o.nodeType?o:o.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=ce(r)),"http://www.w3.org/1999/xhtml"===e?"script"===r?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"==typeof n.is?e=l.createElement(r,{is:n.is}):(e=l.createElement(r),"select"===r&&(l=e,n.multiple?l.multiple=!0:n.size&&(l.size=n.size))):e=l.createElementNS(e,r),e[fo]=t,e[po]=n,Rc(e,t),t.stateNode=e;e:{switch(l=be(r,n),r){case"dialog":Un("cancel",e),Un("close",e),o=n;break;case"iframe":case"object":case"embed":Un("load",e),o=n;break;case"video":case"audio":for(o=0;o<Dn.length;o++)Un(Dn[o],e);o=n;break;case"source":Un("error",e),o=n;break;case"img":case"image":case"link":Un("error",e),Un("load",e),o=n;break;case"details":Un("toggle",e),o=n;break;case"input":Y(e,n),o=J(e,n),Un("invalid",e);break;case"option":default:o=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},o=q({},n,{value:void 0}),Un("invalid",e);break;case"textarea":oe(e,n),o=ne(e,n),Un("invalid",e)}for(a in ye(r,o),s=o)if(s.hasOwnProperty(a)){var u=s[a];"style"===a?me(e,u):"dangerouslySetInnerHTML"===a?null!=(u=u?u.__html:void 0)&&de(e,u):"children"===a?"string"==typeof u?("textarea"!==r||""!==u)&&he(e,u):"number"==typeof u&&he(e,""+u):"suppressContentEditableWarning"!==a&&"suppressHydrationWarning"!==a&&"autoFocus"!==a&&(c.hasOwnProperty(a)?null!=u&&"onScroll"===a&&Un("scroll",e):null!=u&&b(e,a,u,l))}switch(r){case"input":W(e),Z(e,n,!1);break;case"textarea":W(e),ae(e);break;case"option":null!=n.value&&e.setAttribute("value",""+K(n.value));break;case"select":e.multiple=!!n.multiple,null!=(a=n.value)?re(e,!!n.multiple,a,!1):null!=n.defaultValue&&re(e,!!n.multiple,n.defaultValue,!0);break;default:"function"==typeof o.onClick&&(e.onclick=Zn)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Vc(t),null;case 6:if(e&&null!=t.stateNode)Mc(0,t,e.memoizedProps,n);else{if("string"!=typeof n&&null===t.stateNode)throw Error(i(166));if(r=Ji(Gi.current),Ji(Wi.current),hi(t)){if(n=t.stateNode,r=t.memoizedProps,n[fo]=t,(a=n.nodeValue!==r)&&null!==(e=ni))switch(e.tag){case 3:Xn(n.nodeValue,r,!!(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Xn(n.nodeValue,r,!!(1&e.mode))}a&&(t.flags|=4)}else(n=(9===r.nodeType?r:r.ownerDocument).createTextNode(n))[fo]=t,t.stateNode=n}return Vc(t),null;case 13:if(Ao(ea),n=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(ii&&null!==oi&&1&t.mode&&!(128&t.flags))fi(),pi(),t.flags|=98560,a=!1;else if(a=hi(t),null!==n&&null!==n.dehydrated){if(null===e){if(!a)throw Error(i(318));if(!(a=null!==(a=t.memoizedState)?a.dehydrated:null))throw Error(i(317));a[fo]=t}else pi(),!(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Vc(t),a=!1}else null!==ai&&(is(ai),ai=null),a=!0;if(!a)return 65536&t.flags?t:null}return 128&t.flags?(t.lanes=r,t):((n=null!==n)!=(null!==e&&null!==e.memoizedState)&&n&&(t.child.flags|=8192,1&t.mode&&(null===e||1&ea.current?0===Ml&&(Ml=3):ps())),null!==t.updateQueue&&(t.flags|=4),Vc(t),null);case 4:return $i(),null===e&&zn(t.stateNode.containerInfo),Vc(t),null;case 10:return Ei(t.type._context),Vc(t),null;case 19:if(Ao(ea),null===(a=t.memoizedState))return Vc(t),null;if(n=!!(128&t.flags),null===(l=a.rendering))if(n)Kc(a,!1);else{if(0!==Ml||null!==e&&128&e.flags)for(e=t.child;null!==e;){if(null!==(l=ta(e))){for(t.flags|=128,Kc(a,!1),null!==(n=l.updateQueue)&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;null!==r;)e=n,(a=r).flags&=14680066,null===(l=a.alternate)?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=l.childLanes,a.lanes=l.lanes,a.child=l.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=l.memoizedProps,a.memoizedState=l.memoizedState,a.updateQueue=l.updateQueue,a.type=l.type,e=l.dependencies,a.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Po(ea,1&ea.current|2),t.child}e=e.sibling}null!==a.tail&&$e()>Hl&&(t.flags|=128,n=!0,Kc(a,!1),t.lanes=4194304)}else{if(!n)if(null!==(e=ta(l))){if(t.flags|=128,n=!0,null!==(r=e.updateQueue)&&(t.updateQueue=r,t.flags|=4),Kc(a,!0),null===a.tail&&"hidden"===a.tailMode&&!l.alternate&&!ii)return Vc(t),null}else 2*$e()-a.renderingStartTime>Hl&&1073741824!==r&&(t.flags|=128,n=!0,Kc(a,!1),t.lanes=4194304);a.isBackwards?(l.sibling=t.child,t.child=l):(null!==(r=a.last)?r.sibling=l:t.child=l,a.last=l)}return null!==a.tail?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=$e(),t.sibling=null,r=ea.current,Po(ea,n?1&r|2:1&r),t):(Vc(t),null);case 22:case 23:return us(),n=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==n&&(t.flags|=8192),n&&1&t.mode?!!(1073741824&Rl)&&(Vc(t),6&t.subtreeFlags&&(t.flags|=8192)):Vc(t),null;case 24:case 25:return null}throw Error(i(156,t.tag))}function Qc(e,t){switch(ri(t),t.tag){case 1:return Mo(t.type)&&No(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return $i(),Ao(_o),Ao(Oo),na(),65536&(e=t.flags)&&!(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Zi(t),null;case 13:if(Ao(ea),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(i(340));pi()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Ao(ea),null;case 4:return $i(),null;case 10:return Ei(t.type._context),null;case 22:case 23:return us(),null;default:return null}}Rc=function(e,t){for(var r=t.child;null!==r;){if(5===r.tag||6===r.tag)e.appendChild(r.stateNode);else if(4!==r.tag&&null!==r.child){r.child.return=r,r=r.child;continue}if(r===t)break;for(;null===r.sibling;){if(null===r.return||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}},xc=function(e,t,r,n){var o=e.memoizedProps;if(o!==n){e=t.stateNode,Ji(Wi.current);var i,a=null;switch(r){case"input":o=J(e,o),n=J(e,n),a=[];break;case"select":o=q({},o,{value:void 0}),n=q({},n,{value:void 0}),a=[];break;case"textarea":o=ne(e,o),n=ne(e,n),a=[];break;default:"function"!=typeof o.onClick&&"function"==typeof n.onClick&&(e.onclick=Zn)}for(u in ye(r,n),r=null,o)if(!n.hasOwnProperty(u)&&o.hasOwnProperty(u)&&null!=o[u])if("style"===u){var l=o[u];for(i in l)l.hasOwnProperty(i)&&(r||(r={}),r[i]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(c.hasOwnProperty(u)?a||(a=[]):(a=a||[]).push(u,null));for(u in n){var s=n[u];if(l=null!=o?o[u]:void 0,n.hasOwnProperty(u)&&s!==l&&(null!=s||null!=l))if("style"===u)if(l){for(i in l)!l.hasOwnProperty(i)||s&&s.hasOwnProperty(i)||(r||(r={}),r[i]="");for(i in s)s.hasOwnProperty(i)&&l[i]!==s[i]&&(r||(r={}),r[i]=s[i])}else r||(a||(a=[]),a.push(u,r)),r=s;else"dangerouslySetInnerHTML"===u?(s=s?s.__html:void 0,l=l?l.__html:void 0,null!=s&&l!==s&&(a=a||[]).push(u,s)):"children"===u?"string"!=typeof s&&"number"!=typeof s||(a=a||[]).push(u,""+s):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(c.hasOwnProperty(u)?(null!=s&&"onScroll"===u&&Un("scroll",e),a||l===s||(a=[])):(a=a||[]).push(u,s))}r&&(a=a||[]).push("style",r);var u=a;(t.updateQueue=u)&&(t.flags|=4)}},Mc=function(e,t,r,n){r!==n&&(t.flags|=4)};var Gc=!1,Jc=!1,Yc="function"==typeof WeakSet?WeakSet:Set,$c=null;function Xc(e,t){var r=e.ref;if(null!==r)if("function"==typeof r)try{r(null)}catch(r){Is(e,t,r)}else r.current=null}function Zc(e,t,r){try{r()}catch(r){Is(e,t,r)}}var el=!1;function tl(e,t,r){var n=t.updateQueue;if(null!==(n=null!==n?n.lastEffect:null)){var o=n=n.next;do{if((o.tag&e)===e){var i=o.destroy;o.destroy=void 0,void 0!==i&&Zc(t,r,i)}o=o.next}while(o!==n)}}function rl(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function nl(e){var t=e.ref;if(null!==t){var r=e.stateNode;e.tag,e=r,"function"==typeof t?t(e):t.current=e}}function ol(e){var t=e.alternate;null!==t&&(e.alternate=null,ol(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&null!==(t=e.stateNode)&&(delete t[fo],delete t[po],delete t[mo],delete t[vo],delete t[yo]),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function il(e){return 5===e.tag||3===e.tag||4===e.tag}function al(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||il(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function cl(e,t,r){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?8===r.nodeType?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(8===r.nodeType?(t=r.parentNode).insertBefore(e,r):(t=r).appendChild(e),null!=(r=r._reactRootContainer)||null!==t.onclick||(t.onclick=Zn));else if(4!==n&&null!==(e=e.child))for(cl(e,t,r),e=e.sibling;null!==e;)cl(e,t,r),e=e.sibling}function ll(e,t,r){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(4!==n&&null!==(e=e.child))for(ll(e,t,r),e=e.sibling;null!==e;)ll(e,t,r),e=e.sibling}var sl=null,ul=!1;function dl(e,t,r){for(r=r.child;null!==r;)hl(e,t,r),r=r.sibling}function hl(e,t,r){if(it&&"function"==typeof it.onCommitFiberUnmount)try{it.onCommitFiberUnmount(ot,r)}catch(e){}switch(r.tag){case 5:Jc||Xc(r,t);case 6:var n=sl,o=ul;sl=null,dl(e,t,r),ul=o,null!==(sl=n)&&(ul?(e=sl,r=r.stateNode,8===e.nodeType?e.parentNode.removeChild(r):e.removeChild(r)):sl.removeChild(r.stateNode));break;case 18:null!==sl&&(ul?(e=sl,r=r.stateNode,8===e.nodeType?lo(e.parentNode,r):1===e.nodeType&&lo(e,r),zt(e)):lo(sl,r.stateNode));break;case 4:n=sl,o=ul,sl=r.stateNode.containerInfo,ul=!0,dl(e,t,r),sl=n,ul=o;break;case 0:case 11:case 14:case 15:if(!Jc&&null!==(n=r.updateQueue)&&null!==(n=n.lastEffect)){o=n=n.next;do{var i=o,a=i.destroy;i=i.tag,void 0!==a&&(2&i||4&i)&&Zc(r,t,a),o=o.next}while(o!==n)}dl(e,t,r);break;case 1:if(!Jc&&(Xc(r,t),"function"==typeof(n=r.stateNode).componentWillUnmount))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(e){Is(r,t,e)}dl(e,t,r);break;case 21:dl(e,t,r);break;case 22:1&r.mode?(Jc=(n=Jc)||null!==r.memoizedState,dl(e,t,r),Jc=n):dl(e,t,r);break;default:dl(e,t,r)}}function fl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var r=e.stateNode;null===r&&(r=e.stateNode=new Yc),t.forEach(function(t){var n=Ps.bind(null,e,t);r.has(t)||(r.add(t),t.then(n,n))})}}function pl(e,t){var r=t.deletions;if(null!==r)for(var n=0;n<r.length;n++){var o=r[n];try{var a=e,c=t,l=c;e:for(;null!==l;){switch(l.tag){case 5:sl=l.stateNode,ul=!1;break e;case 3:case 4:sl=l.stateNode.containerInfo,ul=!0;break e}l=l.return}if(null===sl)throw Error(i(160));hl(a,c,o),sl=null,ul=!1;var s=o.alternate;null!==s&&(s.return=null),o.return=null}catch(e){Is(o,t,e)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)gl(t,e),t=t.sibling}function gl(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(pl(t,e),ml(e),4&n){try{tl(3,e,e.return),rl(3,e)}catch(t){Is(e,e.return,t)}try{tl(5,e,e.return)}catch(t){Is(e,e.return,t)}}break;case 1:pl(t,e),ml(e),512&n&&null!==r&&Xc(r,r.return);break;case 5:if(pl(t,e),ml(e),512&n&&null!==r&&Xc(r,r.return),32&e.flags){var o=e.stateNode;try{he(o,"")}catch(t){Is(e,e.return,t)}}if(4&n&&null!=(o=e.stateNode)){var a=e.memoizedProps,c=null!==r?r.memoizedProps:a,l=e.type,s=e.updateQueue;if(e.updateQueue=null,null!==s)try{"input"===l&&"radio"===a.type&&null!=a.name&&$(o,a),be(l,c);var u=be(l,a);for(c=0;c<s.length;c+=2){var d=s[c],h=s[c+1];"style"===d?me(o,h):"dangerouslySetInnerHTML"===d?de(o,h):"children"===d?he(o,h):b(o,d,h,u)}switch(l){case"input":X(o,a);break;case"textarea":ie(o,a);break;case"select":var f=o._wrapperState.wasMultiple;o._wrapperState.wasMultiple=!!a.multiple;var p=a.value;null!=p?re(o,!!a.multiple,p,!1):f!==!!a.multiple&&(null!=a.defaultValue?re(o,!!a.multiple,a.defaultValue,!0):re(o,!!a.multiple,a.multiple?[]:"",!1))}o[po]=a}catch(t){Is(e,e.return,t)}}break;case 6:if(pl(t,e),ml(e),4&n){if(null===e.stateNode)throw Error(i(162));o=e.stateNode,a=e.memoizedProps;try{o.nodeValue=a}catch(t){Is(e,e.return,t)}}break;case 3:if(pl(t,e),ml(e),4&n&&null!==r&&r.memoizedState.isDehydrated)try{zt(t.containerInfo)}catch(t){Is(e,e.return,t)}break;case 4:default:pl(t,e),ml(e);break;case 13:pl(t,e),ml(e),8192&(o=e.child).flags&&(a=null!==o.memoizedState,o.stateNode.isHidden=a,!a||null!==o.alternate&&null!==o.alternate.memoizedState||(Fl=$e())),4&n&&fl(e);break;case 22:if(d=null!==r&&null!==r.memoizedState,1&e.mode?(Jc=(u=Jc)||d,pl(t,e),Jc=u):pl(t,e),ml(e),8192&n){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!d&&1&e.mode)for($c=e,d=e.child;null!==d;){for(h=$c=d;null!==$c;){switch(p=(f=$c).child,f.tag){case 0:case 11:case 14:case 15:tl(4,f,f.return);break;case 1:Xc(f,f.return);var g=f.stateNode;if("function"==typeof g.componentWillUnmount){n=f,r=f.return;try{t=n,g.props=t.memoizedProps,g.state=t.memoizedState,g.componentWillUnmount()}catch(e){Is(n,r,e)}}break;case 5:Xc(f,f.return);break;case 22:if(null!==f.memoizedState){wl(h);continue}}null!==p?(p.return=f,$c=p):wl(h)}d=d.sibling}e:for(d=null,h=e;;){if(5===h.tag){if(null===d){d=h;try{o=h.stateNode,u?"function"==typeof(a=o.style).setProperty?a.setProperty("display","none","important"):a.display="none":(l=h.stateNode,c=null!=(s=h.memoizedProps.style)&&s.hasOwnProperty("display")?s.display:null,l.style.display=ge("display",c))}catch(t){Is(e,e.return,t)}}}else if(6===h.tag){if(null===d)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(t){Is(e,e.return,t)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===e)&&null!==h.child){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;null===h.sibling;){if(null===h.return||h.return===e)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:pl(t,e),ml(e),4&n&&fl(e);case 21:}}function ml(e){var t=e.flags;if(2&t){try{e:{for(var r=e.return;null!==r;){if(il(r)){var n=r;break e}r=r.return}throw Error(i(160))}switch(n.tag){case 5:var o=n.stateNode;32&n.flags&&(he(o,""),n.flags&=-33),ll(e,al(e),o);break;case 3:case 4:var a=n.stateNode.containerInfo;cl(e,al(e),a);break;default:throw Error(i(161))}}catch(t){Is(e,e.return,t)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function vl(e,t,r){$c=e,yl(e,t,r)}function yl(e,t,r){for(var n=!!(1&e.mode);null!==$c;){var o=$c,i=o.child;if(22===o.tag&&n){var a=null!==o.memoizedState||Gc;if(!a){var c=o.alternate,l=null!==c&&null!==c.memoizedState||Jc;c=Gc;var s=Jc;if(Gc=a,(Jc=l)&&!s)for($c=o;null!==$c;)l=(a=$c).child,22===a.tag&&null!==a.memoizedState?Cl(o):null!==l?(l.return=a,$c=l):Cl(o);for(;null!==i;)$c=i,yl(i,t,r),i=i.sibling;$c=o,Gc=c,Jc=s}bl(e)}else 8772&o.subtreeFlags&&null!==i?(i.return=o,$c=i):bl(e)}}function bl(e){for(;null!==$c;){var t=$c;if(8772&t.flags){var r=t.alternate;try{if(8772&t.flags)switch(t.tag){case 0:case 11:case 15:Jc||rl(5,t);break;case 1:var n=t.stateNode;if(4&t.flags&&!Jc)if(null===r)n.componentDidMount();else{var o=t.elementType===t.type?r.memoizedProps:rc(t.type,r.memoizedProps);n.componentDidUpdate(o,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;null!==a&&Ki(t,a,n);break;case 3:var c=t.updateQueue;if(null!==c){if(r=null,null!==t.child)switch(t.child.tag){case 5:case 1:r=t.child.stateNode}Ki(t,c,r)}break;case 5:var l=t.stateNode;if(null===r&&4&t.flags){r=l;var s=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":s.autoFocus&&r.focus();break;case"img":s.src&&(r.src=s.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var d=u.memoizedState;if(null!==d){var h=d.dehydrated;null!==h&&zt(h)}}}break;default:throw Error(i(163))}Jc||512&t.flags&&nl(t)}catch(e){Is(t,t.return,e)}}if(t===e){$c=null;break}if(null!==(r=t.sibling)){r.return=t.return,$c=r;break}$c=t.return}}function wl(e){for(;null!==$c;){var t=$c;if(t===e){$c=null;break}var r=t.sibling;if(null!==r){r.return=t.return,$c=r;break}$c=t.return}}function Cl(e){for(;null!==$c;){var t=$c;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{rl(4,t)}catch(e){Is(t,r,e)}break;case 1:var n=t.stateNode;if("function"==typeof n.componentDidMount){var o=t.return;try{n.componentDidMount()}catch(e){Is(t,o,e)}}var i=t.return;try{nl(t)}catch(e){Is(t,i,e)}break;case 5:var a=t.return;try{nl(t)}catch(e){Is(t,a,e)}}}catch(e){Is(t,t.return,e)}if(t===e){$c=null;break}var c=t.sibling;if(null!==c){c.return=t.return,$c=c;break}$c=t.return}}var kl,Il=Math.ceil,Sl=w.ReactCurrentDispatcher,Tl=w.ReactCurrentOwner,Al=w.ReactCurrentBatchConfig,Pl=0,El=null,Ol=null,_l=0,Rl=0,xl=To(0),Ml=0,Nl=null,Dl=0,Ll=0,ql=0,jl=null,Ul=null,Fl=0,Hl=1/0,zl=null,Bl=!1,Kl=null,Vl=null,Wl=!1,Ql=null,Gl=0,Jl=0,Yl=null,$l=-1,Xl=0;function Zl(){return 6&Pl?$e():-1!==$l?$l:$l=$e()}function es(e){return 1&e.mode?2&Pl&&0!==_l?_l&-_l:null!==mi.transition?(0===Xl&&(Xl=gt()),Xl):0!==(e=bt)?e:e=void 0===(e=window.event)?16:Yt(e.type):1}function ts(e,t,r,n){if(50<Jl)throw Jl=0,Yl=null,Error(i(185));vt(e,r,n),2&Pl&&e===El||(e===El&&(!(2&Pl)&&(Ll|=r),4===Ml&&as(e,_l)),rs(e,n),1===r&&0===Pl&&!(1&t.mode)&&(Hl=$e()+500,Fo&&Bo()))}function rs(e,t){var r=e.callbackNode;!function(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,o=e.expirationTimes,i=e.pendingLanes;0<i;){var a=31-at(i),c=1<<a,l=o[a];-1===l?0!==(c&r)&&0===(c&n)||(o[a]=ft(c,t)):l<=t&&(e.expiredLanes|=c),i&=~c}}(e,t);var n=ht(e,e===El?_l:0);if(0===n)null!==r&&Ge(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(null!=r&&Ge(r),1===t)0===e.tag?function(e){Fo=!0,zo(e)}(cs.bind(null,e)):zo(cs.bind(null,e)),ao(function(){!(6&Pl)&&Bo()}),r=null;else{switch(wt(n)){case 1:r=Ze;break;case 4:r=et;break;case 16:default:r=tt;break;case 536870912:r=nt}r=Es(r,ns.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function ns(e,t){if($l=-1,Xl=0,6&Pl)throw Error(i(327));var r=e.callbackNode;if(Cs()&&e.callbackNode!==r)return null;var n=ht(e,e===El?_l:0);if(0===n)return null;if(30&n||0!==(n&e.expiredLanes)||t)t=gs(e,n);else{t=n;var o=Pl;Pl|=2;var a=fs();for(El===e&&_l===t||(zl=null,Hl=$e()+500,ds(e,t));;)try{vs();break}catch(t){hs(e,t)}Pi(),Sl.current=a,Pl=o,null!==Ol?t=0:(El=null,_l=0,t=Ml)}if(0!==t){if(2===t&&0!==(o=pt(e))&&(n=o,t=os(e,o)),1===t)throw r=Nl,ds(e,0),as(e,n),rs(e,$e()),r;if(6===t)as(e,n);else{if(o=e.current.alternate,!(30&n||function(e){for(var t=e;;){if(16384&t.flags){var r=t.updateQueue;if(null!==r&&null!==(r=r.stores))for(var n=0;n<r.length;n++){var o=r[n],i=o.getSnapshot;o=o.value;try{if(!cn(i(),o))return!1}catch(e){return!1}}}if(r=t.child,16384&t.subtreeFlags&&null!==r)r.return=t,t=r;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(o)||(t=gs(e,n),2===t&&(a=pt(e),0!==a&&(n=a,t=os(e,a))),1!==t)))throw r=Nl,ds(e,0),as(e,n),rs(e,$e()),r;switch(e.finishedWork=o,e.finishedLanes=n,t){case 0:case 1:throw Error(i(345));case 2:case 5:ws(e,Ul,zl);break;case 3:if(as(e,n),(130023424&n)===n&&10<(t=Fl+500-$e())){if(0!==ht(e,0))break;if(((o=e.suspendedLanes)&n)!==n){Zl(),e.pingedLanes|=e.suspendedLanes&o;break}e.timeoutHandle=no(ws.bind(null,e,Ul,zl),t);break}ws(e,Ul,zl);break;case 4:if(as(e,n),(4194240&n)===n)break;for(t=e.eventTimes,o=-1;0<n;){var c=31-at(n);a=1<<c,(c=t[c])>o&&(o=c),n&=~a}if(n=o,10<(n=(120>(n=$e()-n)?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Il(n/1960))-n)){e.timeoutHandle=no(ws.bind(null,e,Ul,zl),n);break}ws(e,Ul,zl);break;default:throw Error(i(329))}}}return rs(e,$e()),e.callbackNode===r?ns.bind(null,e):null}function os(e,t){var r=jl;return e.current.memoizedState.isDehydrated&&(ds(e,t).flags|=256),2!==(e=gs(e,t))&&(t=Ul,Ul=r,null!==t&&is(t)),e}function is(e){null===Ul?Ul=e:Ul.push.apply(Ul,e)}function as(e,t){for(t&=~ql,t&=~Ll,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-at(t),n=1<<r;e[r]=-1,t&=~n}}function cs(e){if(6&Pl)throw Error(i(327));Cs();var t=ht(e,0);if(!(1&t))return rs(e,$e()),null;var r=gs(e,t);if(0!==e.tag&&2===r){var n=pt(e);0!==n&&(t=n,r=os(e,n))}if(1===r)throw r=Nl,ds(e,0),as(e,t),rs(e,$e()),r;if(6===r)throw Error(i(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,ws(e,Ul,zl),rs(e,$e()),null}function ls(e,t){var r=Pl;Pl|=1;try{return e(t)}finally{0===(Pl=r)&&(Hl=$e()+500,Fo&&Bo())}}function ss(e){null!==Ql&&0===Ql.tag&&!(6&Pl)&&Cs();var t=Pl;Pl|=1;var r=Al.transition,n=bt;try{if(Al.transition=null,bt=1,e)return e()}finally{bt=n,Al.transition=r,!(6&(Pl=t))&&Bo()}}function us(){Rl=xl.current,Ao(xl)}function ds(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(-1!==r&&(e.timeoutHandle=-1,oo(r)),null!==Ol)for(r=Ol.return;null!==r;){var n=r;switch(ri(n),n.tag){case 1:null!=(n=n.type.childContextTypes)&&No();break;case 3:$i(),Ao(_o),Ao(Oo),na();break;case 5:Zi(n);break;case 4:$i();break;case 13:case 19:Ao(ea);break;case 10:Ei(n.type._context);break;case 22:case 23:us()}r=r.return}if(El=e,Ol=e=xs(e.current,null),_l=Rl=t,Ml=0,Nl=null,ql=Ll=Dl=0,Ul=jl=null,null!==xi){for(t=0;t<xi.length;t++)if(null!==(n=(r=xi[t]).interleaved)){r.interleaved=null;var o=n.next,i=r.pending;if(null!==i){var a=i.next;i.next=o,n.next=a}r.pending=n}xi=null}return e}function hs(e,t){for(;;){var r=Ol;try{if(Pi(),oa.current=Xa,ua){for(var n=ca.memoizedState;null!==n;){var o=n.queue;null!==o&&(o.pending=null),n=n.next}ua=!1}if(aa=0,sa=la=ca=null,da=!1,ha=0,Tl.current=null,null===r||null===r.return){Ml=1,Nl=t,Ol=null;break}e:{var a=e,c=r.return,l=r,s=t;if(t=_l,l.flags|=32768,null!==s&&"object"==typeof s&&"function"==typeof s.then){var u=s,d=l,h=d.tag;if(!(1&d.mode||0!==h&&11!==h&&15!==h)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var p=mc(c);if(null!==p){p.flags&=-257,vc(p,c,l,0,t),1&p.mode&&gc(a,u,t),s=u;var g=(t=p).updateQueue;if(null===g){var m=new Set;m.add(s),t.updateQueue=m}else g.add(s);break e}if(!(1&t)){gc(a,u,t),ps();break e}s=Error(i(426))}else if(ii&&1&l.mode){var v=mc(c);if(null!==v){!(65536&v.flags)&&(v.flags|=256),vc(v,c,l,0,t),gi(sc(s,l));break e}}a=s=sc(s,l),4!==Ml&&(Ml=2),null===jl?jl=[a]:jl.push(a),a=c;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t,zi(a,fc(0,s,t));break e;case 1:l=s;var y=a.type,b=a.stateNode;if(!(128&a.flags||"function"!=typeof y.getDerivedStateFromError&&(null===b||"function"!=typeof b.componentDidCatch||null!==Vl&&Vl.has(b)))){a.flags|=65536,t&=-t,a.lanes|=t,zi(a,pc(a,l,t));break e}}a=a.return}while(null!==a)}bs(r)}catch(e){t=e,Ol===r&&null!==r&&(Ol=r=r.return);continue}break}}function fs(){var e=Sl.current;return Sl.current=Xa,null===e?Xa:e}function ps(){0!==Ml&&3!==Ml&&2!==Ml||(Ml=4),null===El||!(268435455&Dl)&&!(268435455&Ll)||as(El,_l)}function gs(e,t){var r=Pl;Pl|=2;var n=fs();for(El===e&&_l===t||(zl=null,ds(e,t));;)try{ms();break}catch(t){hs(e,t)}if(Pi(),Pl=r,Sl.current=n,null!==Ol)throw Error(i(261));return El=null,_l=0,Ml}function ms(){for(;null!==Ol;)ys(Ol)}function vs(){for(;null!==Ol&&!Je();)ys(Ol)}function ys(e){var t=kl(e.alternate,e,Rl);e.memoizedProps=e.pendingProps,null===t?bs(e):Ol=t,Tl.current=null}function bs(e){var t=e;do{var r=t.alternate;if(e=t.return,32768&t.flags){if(null!==(r=Qc(r,t)))return r.flags&=32767,void(Ol=r);if(null===e)return Ml=6,void(Ol=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}else if(null!==(r=Wc(r,t,Rl)))return void(Ol=r);if(null!==(t=t.sibling))return void(Ol=t);Ol=t=e}while(null!==t);0===Ml&&(Ml=5)}function ws(e,t,r){var n=bt,o=Al.transition;try{Al.transition=null,bt=1,function(e,t,r,n){do{Cs()}while(null!==Ql);if(6&Pl)throw Error(i(327));r=e.finishedWork;var o=e.finishedLanes;if(null===r)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(i(177));e.callbackNode=null,e.callbackPriority=0;var a=r.lanes|r.childLanes;if(function(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var o=31-at(r),i=1<<o;t[o]=0,n[o]=-1,e[o]=-1,r&=~i}}(e,a),e===El&&(Ol=El=null,_l=0),!(2064&r.subtreeFlags)&&!(2064&r.flags)||Wl||(Wl=!0,Es(tt,function(){return Cs(),null})),a=!!(15990&r.flags),15990&r.subtreeFlags||a){a=Al.transition,Al.transition=null;var c=bt;bt=1;var l=Pl;Pl|=4,Tl.current=null,function(e,t){if(eo=Kt,fn(e=hn())){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{var n=(r=(r=e.ownerDocument)&&r.defaultView||window).getSelection&&r.getSelection();if(n&&0!==n.rangeCount){r=n.anchorNode;var o=n.anchorOffset,a=n.focusNode;n=n.focusOffset;try{r.nodeType,a.nodeType}catch(e){r=null;break e}var c=0,l=-1,s=-1,u=0,d=0,h=e,f=null;t:for(;;){for(var p;h!==r||0!==o&&3!==h.nodeType||(l=c+o),h!==a||0!==n&&3!==h.nodeType||(s=c+n),3===h.nodeType&&(c+=h.nodeValue.length),null!==(p=h.firstChild);)f=h,h=p;for(;;){if(h===e)break t;if(f===r&&++u===o&&(l=c),f===a&&++d===n&&(s=c),null!==(p=h.nextSibling))break;f=(h=f).parentNode}h=p}r=-1===l||-1===s?null:{start:l,end:s}}else r=null}r=r||{start:0,end:0}}else r=null;for(to={focusedElem:e,selectionRange:r},Kt=!1,$c=t;null!==$c;)if(e=(t=$c).child,1028&t.subtreeFlags&&null!==e)e.return=t,$c=e;else for(;null!==$c;){t=$c;try{var g=t.alternate;if(1024&t.flags)switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==g){var m=g.memoizedProps,v=g.memoizedState,y=t.stateNode,b=y.getSnapshotBeforeUpdate(t.elementType===t.type?m:rc(t.type,m),v);y.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var w=t.stateNode.containerInfo;1===w.nodeType?w.textContent="":9===w.nodeType&&w.documentElement&&w.removeChild(w.documentElement);break;default:throw Error(i(163))}}catch(e){Is(t,t.return,e)}if(null!==(e=t.sibling)){e.return=t.return,$c=e;break}$c=t.return}g=el,el=!1}(e,r),gl(r,e),pn(to),Kt=!!eo,to=eo=null,e.current=r,vl(r,e,o),Ye(),Pl=l,bt=c,Al.transition=a}else e.current=r;if(Wl&&(Wl=!1,Ql=e,Gl=o),0===(a=e.pendingLanes)&&(Vl=null),function(e){if(it&&"function"==typeof it.onCommitFiberRoot)try{it.onCommitFiberRoot(ot,e,void 0,!(128&~e.current.flags))}catch(e){}}(r.stateNode),rs(e,$e()),null!==t)for(n=e.onRecoverableError,r=0;r<t.length;r++)n((o=t[r]).value,{componentStack:o.stack,digest:o.digest});if(Bl)throw Bl=!1,e=Kl,Kl=null,e;!!(1&Gl)&&0!==e.tag&&Cs(),1&(a=e.pendingLanes)?e===Yl?Jl++:(Jl=0,Yl=e):Jl=0,Bo()}(e,t,r,n)}finally{Al.transition=o,bt=n}return null}function Cs(){if(null!==Ql){var e=wt(Gl),t=Al.transition,r=bt;try{if(Al.transition=null,bt=16>e?16:e,null===Ql)var n=!1;else{if(e=Ql,Ql=null,Gl=0,6&Pl)throw Error(i(331));var o=Pl;for(Pl|=4,$c=e.current;null!==$c;){var a=$c,c=a.child;if(16&$c.flags){var l=a.deletions;if(null!==l){for(var s=0;s<l.length;s++){var u=l[s];for($c=u;null!==$c;){var d=$c;switch(d.tag){case 0:case 11:case 15:tl(8,d,a)}var h=d.child;if(null!==h)h.return=d,$c=h;else for(;null!==$c;){var f=(d=$c).sibling,p=d.return;if(ol(d),d===u){$c=null;break}if(null!==f){f.return=p,$c=f;break}$c=p}}}var g=a.alternate;if(null!==g){var m=g.child;if(null!==m){g.child=null;do{var v=m.sibling;m.sibling=null,m=v}while(null!==m)}}$c=a}}if(2064&a.subtreeFlags&&null!==c)c.return=a,$c=c;else e:for(;null!==$c;){if(2048&(a=$c).flags)switch(a.tag){case 0:case 11:case 15:tl(9,a,a.return)}var y=a.sibling;if(null!==y){y.return=a.return,$c=y;break e}$c=a.return}}var b=e.current;for($c=b;null!==$c;){var w=(c=$c).child;if(2064&c.subtreeFlags&&null!==w)w.return=c,$c=w;else e:for(c=b;null!==$c;){if(2048&(l=$c).flags)try{switch(l.tag){case 0:case 11:case 15:rl(9,l)}}catch(e){Is(l,l.return,e)}if(l===c){$c=null;break e}var C=l.sibling;if(null!==C){C.return=l.return,$c=C;break e}$c=l.return}}if(Pl=o,Bo(),it&&"function"==typeof it.onPostCommitFiberRoot)try{it.onPostCommitFiberRoot(ot,e)}catch(e){}n=!0}return n}finally{bt=r,Al.transition=t}}return!1}function ks(e,t,r){e=Fi(e,t=fc(0,t=sc(r,t),1),1),t=Zl(),null!==e&&(vt(e,1,t),rs(e,t))}function Is(e,t,r){if(3===e.tag)ks(e,e,r);else for(;null!==t;){if(3===t.tag){ks(t,e,r);break}if(1===t.tag){var n=t.stateNode;if("function"==typeof t.type.getDerivedStateFromError||"function"==typeof n.componentDidCatch&&(null===Vl||!Vl.has(n))){t=Fi(t,e=pc(t,e=sc(r,e),1),1),e=Zl(),null!==t&&(vt(t,1,e),rs(t,e));break}}t=t.return}}function Ss(e,t,r){var n=e.pingCache;null!==n&&n.delete(t),t=Zl(),e.pingedLanes|=e.suspendedLanes&r,El===e&&(_l&r)===r&&(4===Ml||3===Ml&&(130023424&_l)===_l&&500>$e()-Fl?ds(e,0):ql|=r),rs(e,t)}function Ts(e,t){0===t&&(1&e.mode?(t=ut,!(130023424&(ut<<=1))&&(ut=4194304)):t=1);var r=Zl();null!==(e=Di(e,t))&&(vt(e,t,r),rs(e,r))}function As(e){var t=e.memoizedState,r=0;null!==t&&(r=t.retryLane),Ts(e,r)}function Ps(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,o=e.memoizedState;null!==o&&(r=o.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(i(314))}null!==n&&n.delete(t),Ts(e,r)}function Es(e,t){return Qe(e,t)}function Os(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function _s(e,t,r,n){return new Os(e,t,r,n)}function Rs(e){return!(!(e=e.prototype)||!e.isReactComponent)}function xs(e,t){var r=e.alternate;return null===r?((r=_s(e.tag,t,e.key,e.mode)).elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=14680064&e.flags,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Ms(e,t,r,n,o,a){var c=2;if(n=e,"function"==typeof e)Rs(e)&&(c=1);else if("string"==typeof e)c=5;else e:switch(e){case I:return Ns(r.children,o,a,t);case S:c=8,o|=8;break;case T:return(e=_s(12,r,t,2|o)).elementType=T,e.lanes=a,e;case O:return(e=_s(13,r,t,o)).elementType=O,e.lanes=a,e;case _:return(e=_s(19,r,t,o)).elementType=_,e.lanes=a,e;case M:return Ds(r,o,a,t);default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case A:c=10;break e;case P:c=9;break e;case E:c=11;break e;case R:c=14;break e;case x:c=16,n=null;break e}throw Error(i(130,null==e?e:typeof e,""))}return(t=_s(c,r,t,o)).elementType=e,t.type=n,t.lanes=a,t}function Ns(e,t,r,n){return(e=_s(7,e,n,t)).lanes=r,e}function Ds(e,t,r,n){return(e=_s(22,e,n,t)).elementType=M,e.lanes=r,e.stateNode={isHidden:!1},e}function Ls(e,t,r){return(e=_s(6,e,null,t)).lanes=r,e}function qs(e,t,r){return(t=_s(4,null!==e.children?e.children:[],e.key,t)).lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function js(e,t,r,n,o){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=mt(0),this.expirationTimes=mt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=mt(0),this.identifierPrefix=n,this.onRecoverableError=o,this.mutableSourceEagerHydrationData=null}function Us(e,t,r,n,o,i,a,c,l){return e=new js(e,t,r,c,l),1===t?(t=1,!0===i&&(t|=8)):t=0,i=_s(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},qi(i),e}function Fs(e){if(!e)return Eo;e:{if(ze(e=e._reactInternals)!==e||1!==e.tag)throw Error(i(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Mo(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(i(171))}if(1===e.tag){var r=e.type;if(Mo(r))return Lo(e,r,t)}return t}function Hs(e,t,r,n,o,i,a,c,l){return(e=Us(r,n,!0,e,0,i,0,c,l)).context=Fs(null),r=e.current,(i=Ui(n=Zl(),o=es(r))).callback=null!=t?t:null,Fi(r,i,o),e.current.lanes=o,vt(e,o,n),rs(e,n),e}function zs(e,t,r,n){var o=t.current,i=Zl(),a=es(o);return r=Fs(r),null===t.context?t.context=r:t.pendingContext=r,(t=Ui(i,a)).payload={element:e},null!==(n=void 0===n?null:n)&&(t.callback=n),null!==(e=Fi(o,t,a))&&(ts(e,o,a,i),Hi(e,o,a)),a}function Bs(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Ks(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var r=e.retryLane;e.retryLane=0!==r&&r<t?r:t}}function Vs(e,t){Ks(e,t),(e=e.alternate)&&Ks(e,t)}kl=function(e,t,r){if(null!==e)if(e.memoizedProps!==t.pendingProps||_o.current)bc=!0;else{if(0===(e.lanes&r)&&!(128&t.flags))return bc=!1,function(e,t,r){switch(t.tag){case 3:Oc(t),pi();break;case 5:Xi(t);break;case 1:Mo(t.type)&&qo(t);break;case 4:Yi(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,o=t.memoizedProps.value;Po(Ii,n._currentValue),n._currentValue=o;break;case 13:if(null!==(n=t.memoizedState))return null!==n.dehydrated?(Po(ea,1&ea.current),t.flags|=128,null):0!==(r&t.child.childLanes)?Lc(e,t,r):(Po(ea,1&ea.current),null!==(e=Bc(e,t,r))?e.sibling:null);Po(ea,1&ea.current);break;case 19:if(n=0!==(r&t.childLanes),128&e.flags){if(n)return Hc(e,t,r);t.flags|=128}if(null!==(o=t.memoizedState)&&(o.rendering=null,o.tail=null,o.lastEffect=null),Po(ea,ea.current),n)break;return null;case 22:case 23:return t.lanes=0,Sc(e,t,r)}return Bc(e,t,r)}(e,t,r);bc=!!(131072&e.flags)}else bc=!1,ii&&1048576&t.flags&&ei(t,Qo,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;zc(e,t),e=t.pendingProps;var o=xo(t,Oo.current);_i(t,r),o=ma(null,t,n,e,o,r);var a=va();return t.flags|=1,"object"==typeof o&&null!==o&&"function"==typeof o.render&&void 0===o.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Mo(n)?(a=!0,qo(t)):a=!1,t.memoizedState=null!==o.state&&void 0!==o.state?o.state:null,qi(t),o.updater=oc,t.stateNode=o,o._reactInternals=t,lc(t,n,e,r),t=Ec(null,t,n,!0,a,r)):(t.tag=0,ii&&a&&ti(t),wc(null,t,o,r),t=t.child),t;case 16:n=t.elementType;e:{switch(zc(e,t),e=t.pendingProps,n=(o=n._init)(n._payload),t.type=n,o=t.tag=function(e){if("function"==typeof e)return Rs(e)?1:0;if(null!=e){if((e=e.$$typeof)===E)return 11;if(e===R)return 14}return 2}(n),e=rc(n,e),o){case 0:t=Ac(null,t,n,e,r);break e;case 1:t=Pc(null,t,n,e,r);break e;case 11:t=Cc(null,t,n,e,r);break e;case 14:t=kc(null,t,n,rc(n.type,e),r);break e}throw Error(i(306,n,""))}return t;case 0:return n=t.type,o=t.pendingProps,Ac(e,t,n,o=t.elementType===n?o:rc(n,o),r);case 1:return n=t.type,o=t.pendingProps,Pc(e,t,n,o=t.elementType===n?o:rc(n,o),r);case 3:e:{if(Oc(t),null===e)throw Error(i(387));n=t.pendingProps,o=(a=t.memoizedState).element,ji(e,t),Bi(t,n,null,r);var c=t.memoizedState;if(n=c.element,a.isDehydrated){if(a={element:n,isDehydrated:!1,cache:c.cache,pendingSuspenseBoundaries:c.pendingSuspenseBoundaries,transitions:c.transitions},t.updateQueue.baseState=a,t.memoizedState=a,256&t.flags){t=_c(e,t,n,r,o=sc(Error(i(423)),t));break e}if(n!==o){t=_c(e,t,n,r,o=sc(Error(i(424)),t));break e}for(oi=so(t.stateNode.containerInfo.firstChild),ni=t,ii=!0,ai=null,r=ki(t,null,n,r),t.child=r;r;)r.flags=-3&r.flags|4096,r=r.sibling}else{if(pi(),n===o){t=Bc(e,t,r);break e}wc(e,t,n,r)}t=t.child}return t;case 5:return Xi(t),null===e&&ui(t),n=t.type,o=t.pendingProps,a=null!==e?e.memoizedProps:null,c=o.children,ro(n,o)?c=null:null!==a&&ro(n,a)&&(t.flags|=32),Tc(e,t),wc(e,t,c,r),t.child;case 6:return null===e&&ui(t),null;case 13:return Lc(e,t,r);case 4:return Yi(t,t.stateNode.containerInfo),n=t.pendingProps,null===e?t.child=Ci(t,null,n,r):wc(e,t,n,r),t.child;case 11:return n=t.type,o=t.pendingProps,Cc(e,t,n,o=t.elementType===n?o:rc(n,o),r);case 7:return wc(e,t,t.pendingProps,r),t.child;case 8:case 12:return wc(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,o=t.pendingProps,a=t.memoizedProps,c=o.value,Po(Ii,n._currentValue),n._currentValue=c,null!==a)if(cn(a.value,c)){if(a.children===o.children&&!_o.current){t=Bc(e,t,r);break e}}else for(null!==(a=t.child)&&(a.return=t);null!==a;){var l=a.dependencies;if(null!==l){c=a.child;for(var s=l.firstContext;null!==s;){if(s.context===n){if(1===a.tag){(s=Ui(-1,r&-r)).tag=2;var u=a.updateQueue;if(null!==u){var d=(u=u.shared).pending;null===d?s.next=s:(s.next=d.next,d.next=s),u.pending=s}}a.lanes|=r,null!==(s=a.alternate)&&(s.lanes|=r),Oi(a.return,r,t),l.lanes|=r;break}s=s.next}}else if(10===a.tag)c=a.type===t.type?null:a.child;else if(18===a.tag){if(null===(c=a.return))throw Error(i(341));c.lanes|=r,null!==(l=c.alternate)&&(l.lanes|=r),Oi(c,r,t),c=a.sibling}else c=a.child;if(null!==c)c.return=a;else for(c=a;null!==c;){if(c===t){c=null;break}if(null!==(a=c.sibling)){a.return=c.return,c=a;break}c=c.return}a=c}wc(e,t,o.children,r),t=t.child}return t;case 9:return o=t.type,n=t.pendingProps.children,_i(t,r),n=n(o=Ri(o)),t.flags|=1,wc(e,t,n,r),t.child;case 14:return o=rc(n=t.type,t.pendingProps),kc(e,t,n,o=rc(n.type,o),r);case 15:return Ic(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,o=t.pendingProps,o=t.elementType===n?o:rc(n,o),zc(e,t),t.tag=1,Mo(n)?(e=!0,qo(t)):e=!1,_i(t,r),ac(t,n,o),lc(t,n,o,r),Ec(null,t,n,!0,e,r);case 19:return Hc(e,t,r);case 22:return Sc(e,t,r)}throw Error(i(156,t.tag))};var Ws="function"==typeof reportError?reportError:function(e){console.error(e)};function Qs(e){this._internalRoot=e}function Gs(e){this._internalRoot=e}function Js(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Ys(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function $s(){}function Xs(e,t,r,n,o){var i=r._reactRootContainer;if(i){var a=i;if("function"==typeof o){var c=o;o=function(){var e=Bs(a);c.call(e)}}zs(t,a,e,o)}else a=function(e,t,r,n,o){if(o){if("function"==typeof n){var i=n;n=function(){var e=Bs(a);i.call(e)}}var a=Hs(t,n,e,0,null,!1,0,"",$s);return e._reactRootContainer=a,e[go]=a.current,zn(8===e.nodeType?e.parentNode:e),ss(),a}for(;o=e.lastChild;)e.removeChild(o);if("function"==typeof n){var c=n;n=function(){var e=Bs(l);c.call(e)}}var l=Us(e,0,!1,null,0,!1,0,"",$s);return e._reactRootContainer=l,e[go]=l.current,zn(8===e.nodeType?e.parentNode:e),ss(function(){zs(t,l,r,n)}),l}(r,t,e,o,n);return Bs(a)}Gs.prototype.render=Qs.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(i(409));zs(e,t,null,null)},Gs.prototype.unmount=Qs.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;ss(function(){zs(null,e,null,null)}),t[go]=null}},Gs.prototype.unstable_scheduleHydration=function(e){if(e){var t=St();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Mt.length&&0!==t&&t<Mt[r].priority;r++);Mt.splice(r,0,e),0===r&&qt(e)}},Ct=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=dt(t.pendingLanes);0!==r&&(yt(t,1|r),rs(t,$e()),!(6&Pl)&&(Hl=$e()+500,Bo()))}break;case 13:ss(function(){var t=Di(e,1);if(null!==t){var r=Zl();ts(t,e,1,r)}}),Vs(e,1)}},kt=function(e){if(13===e.tag){var t=Di(e,134217728);null!==t&&ts(t,e,134217728,Zl()),Vs(e,134217728)}},It=function(e){if(13===e.tag){var t=es(e),r=Di(e,t);null!==r&&ts(r,e,t,Zl()),Vs(e,t)}},St=function(){return bt},Tt=function(e,t){var r=bt;try{return bt=e,t()}finally{bt=r}},ke=function(e,t,r){switch(t){case"input":if(X(e,r),t=r.name,"radio"===r.type&&null!=t){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var o=ko(n);if(!o)throw Error(i(90));Q(n),X(n,o)}}}break;case"textarea":ie(e,r);break;case"select":null!=(t=r.value)&&re(e,!!r.multiple,t,!1)}},Ee=ls,Oe=ss;var Zs={usingClientEntryPoint:!1,Events:[wo,Co,ko,Ae,Pe,ls]},eu={findFiberByHostInstance:bo,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},tu={bundleType:eu.bundleType,version:eu.version,rendererPackageName:eu.rendererPackageName,rendererConfig:eu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:w.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Ve(e))?null:e.stateNode},findFiberByHostInstance:eu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var ru=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ru.isDisabled&&ru.supportsFiber)try{ot=ru.inject(tu),it=ru}catch(ue){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Zs,t.createPortal=function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Js(t))throw Error(i(200));return function(e,t,r){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:k,key:null==n?null:""+n,children:e,containerInfo:t,implementation:r}}(e,t,null,r)},t.createRoot=function(e,t){if(!Js(e))throw Error(i(299));var r=!1,n="",o=Ws;return null!=t&&(!0===t.unstable_strictMode&&(r=!0),void 0!==t.identifierPrefix&&(n=t.identifierPrefix),void 0!==t.onRecoverableError&&(o=t.onRecoverableError)),t=Us(e,1,!1,null,0,r,0,n,o),e[go]=t.current,zn(8===e.nodeType?e.parentNode:e),new Qs(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"==typeof e.render)throw Error(i(188));throw e=Object.keys(e).join(","),Error(i(268,e))}return null===(e=Ve(t))?null:e.stateNode},t.flushSync=function(e){return ss(e)},t.hydrate=function(e,t,r){if(!Ys(t))throw Error(i(200));return Xs(null,e,t,!0,r)},t.hydrateRoot=function(e,t,r){if(!Js(e))throw Error(i(405));var n=null!=r&&r.hydratedSources||null,o=!1,a="",c=Ws;if(null!=r&&(!0===r.unstable_strictMode&&(o=!0),void 0!==r.identifierPrefix&&(a=r.identifierPrefix),void 0!==r.onRecoverableError&&(c=r.onRecoverableError)),t=Hs(t,null,e,1,null!=r?r:null,o,0,a,c),e[go]=t.current,zn(e),n)for(e=0;e<n.length;e++)o=(o=(r=n[e])._getVersion)(r._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[r,o]:t.mutableSourceEagerHydrationData.push(r,o);return new Gs(t)},t.render=function(e,t,r){if(!Ys(t))throw Error(i(200));return Xs(null,e,t,!1,r)},t.unmountComponentAtNode=function(e){if(!Ys(e))throw Error(i(40));return!!e._reactRootContainer&&(ss(function(){Xs(null,null,e,!1,function(){e._reactRootContainer=null,e[go]=null})}),!0)},t.unstable_batchedUpdates=ls,t.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Ys(r))throw Error(i(200));if(null==e||void 0===e._reactInternals)throw Error(i(38));return Xs(e,t,r,!1,n)},t.version="18.3.1-next-f1338f8080-20240426"},493(e,t,r){e.exports=r(290)},540(e){e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},659(e){var t={};e.exports=function(e,r){var n=function(e){if(void 0===t[e]){var r=document.querySelector(e);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(e){r=null}t[e]=r}return t[e]}(e);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");n.appendChild(r)}},741(e,t,r){var n=r(60);t.H=n.createRoot,n.hydrateRoot},825(e){e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(r){!function(e,t,r){var n="";r.supports&&(n+="@supports (".concat(r.supports,") {")),r.media&&(n+="@media ".concat(r.media," {"));var o=void 0!==r.layer;o&&(n+="@layer".concat(r.layer.length>0?" ".concat(r.layer):""," {")),n+=r.css,o&&(n+="}"),r.media&&(n+="}"),r.supports&&(n+="}");var i=r.sourceMap;i&&"undefined"!=typeof btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),t.styleTagTransform(n,e,t.options)}(t,e,r)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},978(e){e.exports=function(e){return e[1]}}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;if(void 0===e[n]){var i=new Error("Cannot find module '"+n+"'");throw i.code="MODULE_NOT_FOUND",i}var a=t[n]={id:n,exports:{}};return e[n](a,a.exports,r),a.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.nc=void 0;var n={};r.r(n),r.d(n,{SpeDocumentViewer:()=>Lp});var o,i=r(31),a=r(741),c={LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",DEFAULT_COMMON_TENANT:"common",ADFS:"adfs",DSTS:"dstsv2",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",CIAM_AUTH_URL:".ciamlogin.com",AAD_TENANT_DOMAIN_SUFFIX:".onmicrosoft.com",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",EMAIL_SCOPE:"email",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined",EMPTY_STRING:"",NOT_APPLICABLE:"N/A",NOT_AVAILABLE:"Not Available",FORWARD_SLASH:"/",IMDS_ENDPOINT:"http://169.254.169.254/metadata/instance/compute/location",IMDS_VERSION:"2020-06-01",IMDS_TIMEOUT:2e3,AZURE_REGION_AUTO_DISCOVER_FLAG:"TryAutoDetect",REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX:"login.microsoft.com",KNOWN_PUBLIC_CLOUDS:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"],SHR_NONCE_VALIDITY:240,INVALID_INSTANCE:"invalid_instance"},l="POST",s=[c.OPENID_SCOPE,c.PROFILE_SCOPE,c.OFFLINE_ACCESS_SCOPE],u=[...s,c.EMAIL_SCOPE],d="Content-Type",h="Retry-After",f="X-AnchorMailbox",p="x-ms-request-id",g="x-ms-httpver",m="active-account-filters",v="common",y="organizations",b="consumers",w="access_token",C="xms_cc",k="login",I="select_account",S="consent",T="none",A="code",P="query",E="Generic",O={ID_TOKEN:"IdToken",ACCESS_TOKEN:"AccessToken",ACCESS_TOKEN_WITH_AUTH_SCHEME:"AccessToken_With_AuthScheme",REFRESH_TOKEN:"RefreshToken"},_="appmetadata",R="1",x="authority-metadata",M="config",N="cache",D="network",L="hardcoded_values",q={SCHEMA_VERSION:5,MAX_LAST_HEADER_BYTES:330,MAX_CACHED_ERRORS:50,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"},j={BEARER:"Bearer",POP:"pop",SSH:"ssh-cert"},U="throttling";!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose",e[e.Trace=4]="Trace"}(o||(o={}));class F{constructor(e,t,r){this.level=o.Info;var n=e||F.createDefaultLoggerOptions();this.localCallback=n.loggerCallback||(()=>{}),this.piiLoggingEnabled=n.piiLoggingEnabled||!1,this.level="number"==typeof n.logLevel?n.logLevel:o.Info,this.correlationId=n.correlationId||c.EMPTY_STRING,this.packageName=t||c.EMPTY_STRING,this.packageVersion=r||c.EMPTY_STRING}static createDefaultLoggerOptions(){return{loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:o.Info}}clone(e,t,r){return new F({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level,correlationId:r||this.correlationId},e,t)}logMessage(e,t){if(!(t.logLevel>this.level||!this.piiLoggingEnabled&&t.containsPii)){var r=(new Date).toUTCString(),n="[".concat(r,"] : [").concat(t.correlationId||this.correlationId||"","]"),i="".concat(n," : ").concat(this.packageName,"@").concat(this.packageVersion," : ").concat(o[t.logLevel]," - ").concat(e);this.executeCallback(t.logLevel,i,t.containsPii||!1)}}executeCallback(e,t,r){this.localCallback&&this.localCallback(e,t,r)}error(e,t){this.logMessage(e,{logLevel:o.Error,containsPii:!1,correlationId:t||c.EMPTY_STRING})}errorPii(e,t){this.logMessage(e,{logLevel:o.Error,containsPii:!0,correlationId:t||c.EMPTY_STRING})}warning(e,t){this.logMessage(e,{logLevel:o.Warning,containsPii:!1,correlationId:t||c.EMPTY_STRING})}warningPii(e,t){this.logMessage(e,{logLevel:o.Warning,containsPii:!0,correlationId:t||c.EMPTY_STRING})}info(e,t){this.logMessage(e,{logLevel:o.Info,containsPii:!1,correlationId:t||c.EMPTY_STRING})}infoPii(e,t){this.logMessage(e,{logLevel:o.Info,containsPii:!0,correlationId:t||c.EMPTY_STRING})}verbose(e,t){this.logMessage(e,{logLevel:o.Verbose,containsPii:!1,correlationId:t||c.EMPTY_STRING})}verbosePii(e,t){this.logMessage(e,{logLevel:o.Verbose,containsPii:!0,correlationId:t||c.EMPTY_STRING})}trace(e,t){this.logMessage(e,{logLevel:o.Trace,containsPii:!1,correlationId:t||c.EMPTY_STRING})}tracePii(e,t){this.logMessage(e,{logLevel:o.Trace,containsPii:!0,correlationId:t||c.EMPTY_STRING})}isPiiLoggingEnabled(){return this.piiLoggingEnabled||!1}}var H="OIDC",z="EAR",B="none",K="unexpected_error",V="post_request_failed",W={[K]:"Unexpected error in authentication.",[V]:"Post request failed from the network, could be a 4xx/5xx or a network unavailability. Please check the exact error code for details."};class Q extends Error{constructor(e,t,r){super(t?"".concat(e,": ").concat(t):e),Object.setPrototypeOf(this,Q.prototype),this.errorCode=e||c.EMPTY_STRING,this.errorMessage=t||c.EMPTY_STRING,this.subError=r||c.EMPTY_STRING,this.name="AuthError"}setCorrelationId(e){this.correlationId=e}}function G(e,t){return new Q(e,t?"".concat(W[e]," ").concat(t):W[e])}var J="client_info_decoding_error",Y="client_info_empty_error",$="token_parsing_error",X="null_or_empty_token",Z="endpoints_resolution_error",ee="network_error",te="openid_config_error",re="hash_not_deserialized",ne="invalid_state",oe="state_mismatch",ie="state_not_found",ae="nonce_mismatch",ce="auth_time_not_found",le="max_age_transpired",se="multiple_matching_tokens",ue="multiple_matching_accounts",de="multiple_matching_appMetadata",he="request_cannot_be_made",fe="cannot_remove_empty_scope",pe="cannot_append_scopeset",ge="empty_input_scopeset",me="device_code_polling_cancelled",ve="device_code_expired",ye="device_code_unknown_error",be="no_account_in_silent_request",we="invalid_cache_record",Ce="invalid_cache_environment",ke="no_account_found",Ie="no_crypto_object",Se="unexpected_credential_type",Te="invalid_assertion",Ae="invalid_client_credential",Pe="token_refresh_required",Ee="user_timeout_reached",Oe="token_claims_cnf_required_for_signedjwt",_e="authorization_code_missing_from_server_response",Re="binding_key_not_removed",xe="end_session_endpoint_not_supported",Me="key_id_missing",Ne="no_network_connectivity",De="user_canceled",Le="missing_tenant_id_error",qe="method_not_implemented",je="nested_app_auth_bridge_disabled",Ue="platform_broker_error",Fe={[J]:"The client info could not be parsed/decoded correctly",[Y]:"The client info was empty",[$]:"Token cannot be parsed",[X]:"The token is null or empty",[Z]:"Endpoints cannot be resolved",[ee]:"Network request failed",[te]:"Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints.",[re]:"The hash parameters could not be deserialized",[ne]:"State was not the expected format",[oe]:"State mismatch error",[ie]:"State not found",[ae]:"Nonce mismatch error",[ce]:"Max Age was requested and the ID token is missing the auth_time variable. auth_time is an optional claim and is not enabled by default - it must be enabled. See https://aka.ms/msaljs/optional-claims for more information.",[le]:"Max Age is set to 0, or too much time has elapsed since the last end-user authentication.",[se]:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account.",[ue]:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account",[de]:"The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata",[he]:"Token request cannot be made without authorization code or refresh token.",[fe]:"Cannot remove null or empty scope from ScopeSet",[pe]:"Cannot append ScopeSet",[ge]:"Empty input ScopeSet cannot be processed",[me]:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true.",[ve]:"Device code is expired.",[ye]:"Device code stopped polling for unknown reasons.",[be]:"Please pass an account object, silent flow is not supported without account information",[we]:"Cache record object was null or undefined.",[Ce]:"Invalid environment when attempting to create cache entry",[ke]:"No account found in cache for given key.",[Ie]:"No crypto object detected.",[Se]:"Unexpected credential type.",[Te]:"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515",[Ae]:"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential",[Pe]:"Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired.",[Ee]:"User defined timeout for device code polling reached",[Oe]:"Cannot generate a POP jwt if the token_claims are not populated",[_e]:"Server response does not contain an authorization code to proceed",[Re]:"Could not remove the credential's binding key from storage.",[xe]:"The provided authority does not support logout",[Me]:"A keyId value is missing from the requested bound token's cache record and is required to match the token to it's stored binding key.",[Ne]:"No network connectivity. Check your internet connection.",[De]:"User cancelled the flow.",[Le]:"A tenant id - not common, organizations, or consumers - must be specified when using the client_credentials flow.",[qe]:"This method has not been implemented",[je]:"The nested app auth bridge is disabled",[Ue]:"An error occurred in the native broker. See the platformBrokerError property for details."};class He extends Q{constructor(e,t){super(e,t?"".concat(Fe[e],": ").concat(t):Fe[e]),this.name="ClientAuthError",Object.setPrototypeOf(this,He.prototype)}}function ze(e,t){return new He(e,t)}function Be(e,t,r,n,o,i,a){try{var c=e[i](a),l=c.value}catch(e){return void r(e)}c.done?t(l):Promise.resolve(l).then(n,o)}function Ke(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var i=e.apply(t,r);function a(e){Be(i,n,o,a,c,"next",e)}function c(e){Be(i,n,o,a,c,"throw",e)}a(void 0)})}}var Ve={createNewGuid:()=>{throw ze(qe)},base64Decode:()=>{throw ze(qe)},base64Encode:()=>{throw ze(qe)},base64UrlEncode:()=>{throw ze(qe)},encodeKid:()=>{throw ze(qe)},getPublicKeyThumbprint:()=>Ke(function*(){throw ze(qe)})(),removeTokenBindingKey:()=>Ke(function*(){throw ze(qe)})(),clearKeystore:()=>Ke(function*(){throw ze(qe)})(),signJwt:()=>Ke(function*(){throw ze(qe)})(),hashString:()=>Ke(function*(){throw ze(qe)})()},We="@azure/msal-common",Qe="15.13.3",Ge="redirect_uri_empty",Je="claims_request_parsing_error",Ye="authority_uri_insecure",$e="url_parse_error",Xe="empty_url_error",Ze="empty_input_scopes_error",et="invalid_claims",tt="token_request_empty",rt="logout_request_empty",nt="invalid_code_challenge_method",ot="pkce_params_missing",it="invalid_cloud_discovery_metadata",at="invalid_authority_metadata",ct="untrusted_authority",lt="missing_ssh_jwk",st="missing_ssh_kid",ut="missing_nonce_authentication_header",dt="invalid_authentication_header",ht="cannot_set_OIDCOptions",ft="cannot_allow_platform_broker",pt="authority_mismatch",gt="invalid_request_method_for_EAR",mt="invalid_authorize_post_body_parameters",vt="invalid_platform_broker_configuration",yt={[Ge]:"A redirect URI is required for all calls, and none has been set.",[Je]:"Could not parse the given claims request object.",[Ye]:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options",[$e]:"URL could not be parsed into appropriate segments.",[Xe]:"URL was empty or null.",[Ze]:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token.",[et]:"Given claims parameter must be a stringified JSON object.",[tt]:"Token request was empty and not found in cache.",[rt]:"The logout request was null or undefined.",[nt]:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".',[ot]:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request",[it]:"Invalid cloudDiscoveryMetadata provided. Must be a stringified JSON object containing tenant_discovery_endpoint and metadata fields",[at]:"Invalid authorityMetadata provided. Must by a stringified JSON object containing authorization_endpoint, token_endpoint, issuer fields.",[ct]:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter.",[lt]:"Missing sshJwk in SSH certificate request. A stringified JSON Web Key is required when using the SSH authentication scheme.",[st]:"Missing sshKid in SSH certificate request. A string that uniquely identifies the public SSH key is required when using the SSH authentication scheme.",[ut]:"Unable to find an authentication header containing server nonce. Either the Authentication-Info or WWW-Authenticate headers must be present in order to obtain a server nonce.",[dt]:"Invalid authentication header provided",[ht]:"Cannot set OIDCOptions parameter. Please change the protocol mode to OIDC or use a non-Microsoft authority.",[ft]:"Cannot set allowPlatformBroker parameter to true when not in AAD protocol mode.",[pt]:"Authority mismatch error. Authority provided in login request or PublicClientApplication config does not match the environment of the provided account. Please use a matching account or make an interactive request to login to this authority.",[mt]:"Invalid authorize post body parameters provided. If you are using authorizePostBodyParameters, the request method must be POST. Please check the request method and parameters.",[gt]:"Invalid request method for EAR protocol mode. The request method cannot be GET when using EAR protocol mode. Please change the request method to POST.",[vt]:"Invalid platform broker configuration. `allowPlatformBrokerWithDOM` can only be enabled when `allowPlatformBroker` is enabled."};class bt extends Q{constructor(e){super(e,yt[e]),this.name="ClientConfigurationError",Object.setPrototypeOf(this,bt.prototype)}}function wt(e){return new bt(e)}class Ct{static isEmptyObj(e){if(e)try{var t=JSON.parse(e);return 0===Object.keys(t).length}catch(e){}return!0}static startsWith(e,t){return 0===e.indexOf(t)}static endsWith(e,t){return e.length>=t.length&&e.lastIndexOf(t)===e.length-t.length}static queryStringToObject(e){var t={},r=e.split("&"),n=e=>decodeURIComponent(e.replace(/\+/g," "));return r.forEach(e=>{if(e.trim()){var[r,o]=e.split(/=(.+)/g,2);r&&o&&(t[n(r)]=n(o))}}),t}static trimArrayEntries(e){return e.map(e=>e.trim())}static removeEmptyStringsFromArray(e){return e.filter(e=>!!e)}static jsonParseHelper(e){try{return JSON.parse(e)}catch(e){return null}}static matchPattern(e,t){return new RegExp(e.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?")).test(t)}}class kt{constructor(e){var t=e?Ct.trimArrayEntries([...e]):[],r=t?Ct.removeEmptyStringsFromArray(t):[];if(!r||!r.length)throw wt(Ze);this.scopes=new Set,r.forEach(e=>this.scopes.add(e))}static fromString(e){var t=(e||c.EMPTY_STRING).split(" ");return new kt(t)}static createSearchScopes(e){var t=e&&e.length>0?e:[...s],r=new kt(t);return r.containsOnlyOIDCScopes()?r.removeScope(c.OFFLINE_ACCESS_SCOPE):r.removeOIDCScopes(),r}containsScope(e){var t=this.printScopesLowerCase().split(" "),r=new kt(t);return!!e&&r.scopes.has(e.toLowerCase())}containsScopeSet(e){return!(!e||e.scopes.size<=0)&&this.scopes.size>=e.scopes.size&&e.asArray().every(e=>this.containsScope(e))}containsOnlyOIDCScopes(){var e=0;return u.forEach(t=>{this.containsScope(t)&&(e+=1)}),this.scopes.size===e}appendScope(e){e&&this.scopes.add(e.trim())}appendScopes(e){try{e.forEach(e=>this.appendScope(e))}catch(e){throw ze(pe)}}removeScope(e){if(!e)throw ze(fe);this.scopes.delete(e.trim())}removeOIDCScopes(){u.forEach(e=>{this.scopes.delete(e)})}unionScopeSets(e){if(!e)throw ze(ge);var t=new Set;return e.scopes.forEach(e=>t.add(e.toLowerCase())),this.scopes.forEach(e=>t.add(e.toLowerCase())),t}intersectingScopeSets(e){if(!e)throw ze(ge);e.containsOnlyOIDCScopes()||e.removeOIDCScopes();var t=this.unionScopeSets(e),r=e.getScopeCount(),n=this.getScopeCount();return t.size<n+r}getScopeCount(){return this.scopes.size}asArray(){var e=[];return this.scopes.forEach(t=>e.push(t)),e}printScopes(){return this.scopes?this.asArray().join(" "):c.EMPTY_STRING}printScopesLowerCase(){return this.printScopes().toLowerCase()}}function It(e,t){if(!e)throw ze(Y);try{var r=t(e);return JSON.parse(r)}catch(e){throw ze(J)}}function St(e){if(!e)throw ze(J);var t=e.split(".",2);return{uid:t[0],utid:t.length<2?c.EMPTY_STRING:t[1]}}var Tt=["isHomeTenant"],At=["isHomeTenant"];function Pt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Et(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Pt(Object(r),!0).forEach(function(t){Ot(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Pt(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Ot(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _t(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function Rt(e,t){return!!e&&!!t&&e===t.split(".")[1]}function xt(e,t,r,n){if(n){var{oid:o,sub:i,tid:a,name:c,tfp:l,acr:s,preferred_username:u,upn:d,login_hint:h}=n,f=a||l||s||"";return{tenantId:f,localAccountId:o||i||"",name:c,username:u||d||"",loginHint:h,isHomeTenant:Rt(f,e)}}return{tenantId:r,localAccountId:t,username:"",isHomeTenant:Rt(r,e)}}function Mt(e,t,r,n){var o=e;if(t){var{isHomeTenant:i}=t,a=_t(t,Tt);o=Et(Et({},e),a)}if(r){var c=xt(e.homeAccountId,e.localAccountId,e.tenantId,r),{isHomeTenant:l}=c,s=_t(c,At);return Et(Et(Et({},o),s),{},{idTokenClaims:r,idToken:n})}return o}function Nt(e){return e&&(e.tid||e.tfp||e.acr)||null}class Dt{static getAccountInfo(e){return{homeAccountId:e.homeAccountId,environment:e.environment,tenantId:e.realm,username:e.username,localAccountId:e.localAccountId,loginHint:e.loginHint,name:e.name,nativeAccountId:e.nativeAccountId,authorityType:e.authorityType,tenantProfiles:new Map((e.tenantProfiles||[]).map(e=>[e.tenantId,e])),dataBoundary:e.dataBoundary}}isSingleTenant(){return!this.tenantProfiles}static createAccount(e,t,r){var n,o,i,a,c,l,s,u,d,h,f=new Dt;1===t.authorityType?f.authorityType="ADFS":t.protocolMode===H?f.authorityType=E:f.authorityType="MSSTS",e.clientInfo&&r&&(h=It(e.clientInfo,r)).xms_tdbr&&(f.dataBoundary="EU"===h.xms_tdbr?"EU":"None"),f.clientInfo=e.clientInfo,f.homeAccountId=e.homeAccountId,f.nativeAccountId=e.nativeAccountId;var p=e.environment||t&&t.getPreferredCache();if(!p)throw ze(Ce);f.environment=p,f.realm=(null===(n=h)||void 0===n?void 0:n.utid)||Nt(e.idTokenClaims)||"",f.localAccountId=(null===(o=h)||void 0===o?void 0:o.uid)||(null===(i=e.idTokenClaims)||void 0===i?void 0:i.oid)||(null===(a=e.idTokenClaims)||void 0===a?void 0:a.sub)||"";var g=(null===(c=e.idTokenClaims)||void 0===c?void 0:c.preferred_username)||(null===(l=e.idTokenClaims)||void 0===l?void 0:l.upn),m=null!==(s=e.idTokenClaims)&&void 0!==s&&s.emails?e.idTokenClaims.emails[0]:null;if(f.username=g||m||"",f.loginHint=null===(u=e.idTokenClaims)||void 0===u?void 0:u.login_hint,f.name=(null===(d=e.idTokenClaims)||void 0===d?void 0:d.name)||"",f.cloudGraphHostName=e.cloudGraphHostName,f.msGraphHost=e.msGraphHost,e.tenantProfiles)f.tenantProfiles=e.tenantProfiles;else{var v=xt(e.homeAccountId,f.localAccountId,f.realm,e.idTokenClaims);f.tenantProfiles=[v]}return f}static createFromAccountInfo(e,t,r){var n,o=new Dt;return o.authorityType=e.authorityType||E,o.homeAccountId=e.homeAccountId,o.localAccountId=e.localAccountId,o.nativeAccountId=e.nativeAccountId,o.realm=e.tenantId,o.environment=e.environment,o.username=e.username,o.name=e.name,o.loginHint=e.loginHint,o.cloudGraphHostName=t,o.msGraphHost=r,o.tenantProfiles=Array.from((null===(n=e.tenantProfiles)||void 0===n?void 0:n.values())||[]),o.dataBoundary=e.dataBoundary,o}static generateHomeAccountId(e,t,r,n,o){if(1!==t&&2!==t){if(e)try{var i=It(e,n.base64Decode);if(i.uid&&i.utid)return"".concat(i.uid,".").concat(i.utid)}catch(e){}r.warning("No client info in response")}return(null==o?void 0:o.sub)||""}static isAccountEntity(e){return!!e&&e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("localAccountId")&&e.hasOwnProperty("username")&&e.hasOwnProperty("authorityType")}static accountInfoIsEqual(e,t,r){if(!e||!t)return!1;var n=!0;if(r){var o=e.idTokenClaims||{},i=t.idTokenClaims||{};n=o.iat===i.iat&&o.nonce===i.nonce}return e.homeAccountId===t.homeAccountId&&e.localAccountId===t.localAccountId&&e.username===t.username&&e.tenantId===t.tenantId&&e.loginHint===t.loginHint&&e.environment===t.environment&&e.nativeAccountId===t.nativeAccountId&&n}}function Lt(e,t){var r=function(e){if(!e)throw ze(X);var t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(e);if(!t||t.length<4)throw ze($);return t[2]}(e);try{var n=t(r);return JSON.parse(n)}catch(e){throw ze($)}}function qt(e){if(!e.signin_state)return!1;var t=["kmsi","dvc_dmjd"];return e.signin_state.some(e=>t.includes(e.trim().toLowerCase()))}function jt(e,t){if(0===t||Date.now()-3e5>e+t)throw ze(le)}function Ut(e){if(!e)return e;var t=e.toLowerCase();return Ct.endsWith(t,"?")?t=t.slice(0,-1):Ct.endsWith(t,"?/")&&(t=t.slice(0,-2)),Ct.endsWith(t,"/")||(t+="/"),t}function Ft(e){return e.startsWith("#/")?e.substring(2):e.startsWith("#")||e.startsWith("?")?e.substring(1):e}function Ht(e){if(!e||e.indexOf("=")<0)return null;try{var t=Ft(e),r=Object.fromEntries(new URLSearchParams(t));if(r.code||r.ear_jwe||r.error||r.error_description||r.state)return r}catch(e){throw ze(re)}return null}function zt(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2?arguments[2]:void 0,n=new Array;return e.forEach((e,o)=>{!t&&r&&o in r?n.push("".concat(o,"=").concat(e)):n.push("".concat(o,"=").concat(encodeURIComponent(e)))}),n.join("&")}function Bt(e){if(!e)return e;var t=e.split("#")[0];try{var r=new URL(t);return Ut(r.origin+r.pathname+r.search)}catch(e){return Ut(t)}}class Kt{get urlString(){return this._urlString}constructor(e){if(this._urlString=e,!this._urlString)throw wt(Xe);e.includes("#")||(this._urlString=Kt.canonicalizeUri(e))}static canonicalizeUri(e){if(e){var t=e.toLowerCase();return Ct.endsWith(t,"?")?t=t.slice(0,-1):Ct.endsWith(t,"?/")&&(t=t.slice(0,-2)),Ct.endsWith(t,"/")||(t+="/"),t}return e}validateAsUri(){var e;try{e=this.getUrlComponents()}catch(e){throw wt($e)}if(!e.HostNameAndPort||!e.PathSegments)throw wt($e);if(!e.Protocol||"https:"!==e.Protocol.toLowerCase())throw wt(Ye)}static appendQueryString(e,t){return t?e.indexOf("?")<0?"".concat(e,"?").concat(t):"".concat(e,"&").concat(t):e}static removeHashFromUrl(e){return Kt.canonicalizeUri(e.split("#")[0])}replaceTenantPath(e){var t=this.getUrlComponents(),r=t.PathSegments;return!e||0===r.length||r[0]!==v&&r[0]!==y||(r[0]=e),Kt.constructAuthorityUriFromObject(t)}getUrlComponents(){var e=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),t=this.urlString.match(e);if(!t)throw wt($e);var r={Protocol:t[1],HostNameAndPort:t[4],AbsolutePath:t[5],QueryString:t[7]},n=r.AbsolutePath.split("/");return n=n.filter(e=>e&&e.length>0),r.PathSegments=n,r.QueryString&&r.QueryString.endsWith("/")&&(r.QueryString=r.QueryString.substring(0,r.QueryString.length-1)),r}static getDomainFromUrl(e){var t=RegExp("^([^:/?#]+://)?([^/?#]*)"),r=e.match(t);if(!r)throw wt($e);return r[2]}static getAbsoluteUrl(e,t){if(e[0]===c.FORWARD_SLASH){var r=new Kt(t).getUrlComponents();return r.Protocol+"//"+r.HostNameAndPort+e}return e}static constructAuthorityUriFromObject(e){return new Kt(e.Protocol+"//"+e.HostNameAndPort+"/"+e.PathSegments.join("/"))}static hashContainsKnownProperties(e){return!!Ht(e)}}var Vt={"login.microsoftonline.com":{token_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.com/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/logout"},"login.chinacloudapi.cn":{token_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.chinacloudapi.cn/{tenantid}/discovery/v2.0/keys",issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",authorization_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/logout"},"login.microsoftonline.us":{token_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.us/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/logout"}},Wt={metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},Qt=new Set;function Gt(e,t,r,n){if(null==n||n.trace("getAliasesFromMetadata called with source: ".concat(r)),e&&t){var o=Jt(t,e);if(o)return null==n||n.trace("getAliasesFromMetadata: found cloud discovery metadata in ".concat(r,", returning aliases")),o.aliases;null==n||n.trace("getAliasesFromMetadata: did not find cloud discovery metadata in ".concat(r))}return null}function Jt(e,t){for(var r=0;r<e.length;r++){var n=e[r];if(n.aliases.includes(t))return n}return null}Wt.metadata.forEach(e=>{e.aliases.forEach(e=>{Qt.add(e)})});var Yt="cache_quota_exceeded",$t="cache_error_unknown",Xt={[Yt]:"Exceeded cache storage capacity.",[$t]:"Unexpected error occurred when using cache storage."};class Zt extends Q{constructor(e,t){var r=t||(Xt[e]?Xt[e]:Xt[$t]);super("".concat(e,": ").concat(r)),Object.setPrototypeOf(this,Zt.prototype),this.name="CacheError",this.errorCode=e,this.errorMessage=r}}function er(e){return e instanceof Error?"QuotaExceededError"===e.name||"NS_ERROR_DOM_QUOTA_REACHED"===e.name||e.message.includes("exceeded the quota")?new Zt(Yt):new Zt(e.name,e.message):new Zt($t)}function tr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function rr(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nr(e,t,r,n,o,i,a){try{var c=e[i](a),l=c.value}catch(e){return void r(e)}c.done?t(l):Promise.resolve(l).then(n,o)}function or(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var i=e.apply(t,r);function a(e){nr(i,n,o,a,c,"next",e)}function c(e){nr(i,n,o,a,c,"throw",e)}a(void 0)})}}class ir{constructor(e,t,r,n,o){this.clientId=e,this.cryptoImpl=t,this.commonLogger=r.clone(We,Qe),this.staticAuthorityOptions=o,this.performanceClient=n}getAllAccounts(e,t){return this.buildTenantProfiles(this.getAccountsFilteredBy(e,t),t,e)}getAccountInfoFilteredBy(e,t){if(0===Object.keys(e).length||Object.values(e).every(e=>!e))return this.commonLogger.warning("getAccountInfoFilteredBy: Account filter is empty or invalid, returning null"),null;var r=this.getAllAccounts(e,t);return r.length>1?r.sort(e=>e.idTokenClaims?-1:1)[0]:1===r.length?r[0]:null}getBaseAccountInfo(e,t){var r=this.getAccountsFilteredBy(e,t);return r.length>0?Dt.getAccountInfo(r[0]):null}buildTenantProfiles(e,t,r){return e.flatMap(e=>this.getTenantProfilesFromAccountEntity(e,t,null==r?void 0:r.tenantId,r))}getTenantedAccountInfoByFilter(e,t,r,n,o){var i;if(o&&!this.tenantProfileMatchesFilter(r,o))return null;var a=this.getIdToken(e,n,t,r.tenantId);return a&&(i=Lt(a.secret,this.cryptoImpl.base64Decode),!this.idTokenClaimsMatchTenantProfileFilter(i,o))?null:Mt(e,r,i,null==a?void 0:a.secret)}getTenantProfilesFromAccountEntity(e,t,r,n){var o=Dt.getAccountInfo(e),i=o.tenantProfiles||new Map,a=this.getTokenKeys();if(r){var c=i.get(r);if(!c)return[];i=new Map([[r,c]])}var l=[];return i.forEach(e=>{var r=this.getTenantedAccountInfoByFilter(o,a,e,t,n);r&&l.push(r)}),l}tenantProfileMatchesFilter(e,t){return!(t.localAccountId&&!this.matchLocalAccountIdFromTenantProfile(e,t.localAccountId)||t.name&&e.name!==t.name||void 0!==t.isHomeTenant&&e.isHomeTenant!==t.isHomeTenant)}idTokenClaimsMatchTenantProfileFilter(e,t){if(t){if(t.localAccountId&&!this.matchLocalAccountIdFromTokenClaims(e,t.localAccountId))return!1;if(t.loginHint&&!this.matchLoginHintFromTokenClaims(e,t.loginHint))return!1;if(t.username&&!this.matchUsername(e.preferred_username,t.username))return!1;if(t.name&&!this.matchName(e,t.name))return!1;if(t.sid&&!this.matchSid(e,t.sid))return!1}return!0}saveCacheRecord(e,t,r,n){var o=this;return or(function*(){if(!e)throw ze(we);try{e.account&&(yield o.setAccount(e.account,t,r)),e.idToken&&!1!==(null==n?void 0:n.idToken)&&(yield o.setIdTokenCredential(e.idToken,t,r)),e.accessToken&&!1!==(null==n?void 0:n.accessToken)&&(yield o.saveAccessToken(e.accessToken,t,r)),e.refreshToken&&!1!==(null==n?void 0:n.refreshToken)&&(yield o.setRefreshTokenCredential(e.refreshToken,t,r)),e.appMetadata&&o.setAppMetadata(e.appMetadata,t)}catch(e){var i;throw null===(i=o.commonLogger)||void 0===i||i.error("CacheManager.saveCacheRecord: failed"),e instanceof Q?e:er(e)}})()}saveAccessToken(e,t,r){var n=this;return or(function*(){var o={clientId:e.clientId,credentialType:e.credentialType,environment:e.environment,homeAccountId:e.homeAccountId,realm:e.realm,tokenType:e.tokenType,requestedClaimsHash:e.requestedClaimsHash},i=n.getTokenKeys(),a=kt.fromString(e.target);i.accessToken.forEach(e=>{if(n.accessTokenKeyMatchesFilter(e,o,!1)){var r=n.getAccessTokenCredential(e,t);r&&n.credentialMatchesFilter(r,o)&&kt.fromString(r.target).intersectingScopeSets(a)&&n.removeAccessToken(e,t)}}),yield n.setAccessTokenCredential(e,t,r)})()}getAccountsFilteredBy(e,t){var r=this.getAccountKeys(),n=[];return r.forEach(r=>{var o,i=this.getAccount(r,t);if(i&&(!e.homeAccountId||this.matchHomeAccountId(i,e.homeAccountId))&&(!e.username||this.matchUsername(i.username,e.username))&&(!e.environment||this.matchEnvironment(i,e.environment))&&(!e.realm||this.matchRealm(i,e.realm))&&(!e.nativeAccountId||this.matchNativeAccountId(i,e.nativeAccountId))&&(!e.authorityType||this.matchAuthorityType(i,e.authorityType))){var a={localAccountId:null==e?void 0:e.localAccountId,name:null==e?void 0:e.name},c=null===(o=i.tenantProfiles)||void 0===o?void 0:o.filter(e=>this.tenantProfileMatchesFilter(e,a));c&&0===c.length||n.push(i)}}),n}credentialMatchesFilter(e,t){if(t.clientId&&!this.matchClientId(e,t.clientId))return!1;if(t.userAssertionHash&&!this.matchUserAssertionHash(e,t.userAssertionHash))return!1;if("string"==typeof t.homeAccountId&&!this.matchHomeAccountId(e,t.homeAccountId))return!1;if(t.environment&&!this.matchEnvironment(e,t.environment))return!1;if(t.realm&&!this.matchRealm(e,t.realm))return!1;if(t.credentialType&&!this.matchCredentialType(e,t.credentialType))return!1;if(t.familyId&&!this.matchFamilyId(e,t.familyId))return!1;if(t.target&&!this.matchTarget(e,t.target))return!1;if((t.requestedClaimsHash||e.requestedClaimsHash)&&e.requestedClaimsHash!==t.requestedClaimsHash)return!1;if(e.credentialType===O.ACCESS_TOKEN_WITH_AUTH_SCHEME){if(t.tokenType&&!this.matchTokenType(e,t.tokenType))return!1;if(t.tokenType===j.SSH&&t.keyId&&!this.matchKeyId(e,t.keyId))return!1}return!0}getAppMetadataFilteredBy(e){var t=this.getKeys(),r={};return t.forEach(t=>{if(this.isAppMetadata(t)){var n=this.getAppMetadata(t);n&&(e.environment&&!this.matchEnvironment(n,e.environment)||e.clientId&&!this.matchClientId(n,e.clientId)||(r[t]=n))}}),r}getAuthorityMetadataByAlias(e){var t=this.getAuthorityMetadataKeys(),r=null;return t.forEach(t=>{if(this.isAuthorityMetadata(t)&&-1!==t.indexOf(this.clientId)){var n=this.getAuthorityMetadata(t);n&&-1!==n.aliases.indexOf(e)&&(r=n)}}),r}removeAllAccounts(e){this.getAllAccounts({},e).forEach(t=>{this.removeAccount(t,e)})}removeAccount(e,t){this.removeAccountContext(e,t),this.getAccountKeys().filter(t=>t.includes(e.homeAccountId)&&t.includes(e.environment)).forEach(e=>{this.removeItem(e,t),this.performanceClient.incrementFields({accountsRemoved:1},t)})}removeAccountContext(e,t){var r=this.getTokenKeys(),n=t=>t.includes(e.homeAccountId)&&t.includes(e.environment);r.idToken.filter(n).forEach(e=>{this.removeIdToken(e,t)}),r.accessToken.filter(n).forEach(e=>{this.removeAccessToken(e,t)}),r.refreshToken.filter(n).forEach(e=>{this.removeRefreshToken(e,t)})}removeAccessToken(e,t){var r=this.getAccessTokenCredential(e,t);if(this.removeItem(e,t),this.performanceClient.incrementFields({accessTokensRemoved:1},t),r&&r.credentialType.toLowerCase()===O.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase()&&r.tokenType===j.POP){var n=r.keyId;n&&this.cryptoImpl.removeTokenBindingKey(n).catch(()=>{var e;this.commonLogger.error("Failed to remove token binding key ".concat(n),t),null===(e=this.performanceClient)||void 0===e||e.incrementFields({removeTokenBindingKeyFailure:1},t)})}}removeAppMetadata(e){return this.getKeys().forEach(t=>{this.isAppMetadata(t)&&this.removeItem(t,e)}),!0}getIdToken(e,t,r,n,o){this.commonLogger.trace("CacheManager - getIdToken called");var i={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:O.ID_TOKEN,clientId:this.clientId,realm:n},a=this.getIdTokensByFilter(i,t,r),c=a.size;if(c<1)return this.commonLogger.info("CacheManager:getIdToken - No token found"),null;if(c>1){var l=a;if(!n){var s=new Map;a.forEach((t,r)=>{t.realm===e.tenantId&&s.set(r,t)});var u=s.size;if(u<1)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account but none match account entity tenant id, returning first result"),a.values().next().value;if(1===u)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account, defaulting to home tenant profile"),s.values().next().value;l=s}return this.commonLogger.info("CacheManager:getIdToken - Multiple matching ID tokens found, clearing them"),l.forEach((e,r)=>{this.removeIdToken(r,t)}),o&&t&&o.addFields({multiMatchedID:a.size},t),null}return this.commonLogger.info("CacheManager:getIdToken - Returning ID token"),a.values().next().value}getIdTokensByFilter(e,t,r){var n=r&&r.idToken||this.getTokenKeys().idToken,o=new Map;return n.forEach(r=>{if(this.idTokenKeyMatchesFilter(r,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?tr(Object(r),!0).forEach(function(t){rr(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tr(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({clientId:this.clientId},e))){var n=this.getIdTokenCredential(r,t);n&&this.credentialMatchesFilter(n,e)&&o.set(r,n)}}),o}idTokenKeyMatchesFilter(e,t){var r=e.toLowerCase();return!(t.clientId&&-1===r.indexOf(t.clientId.toLowerCase())||t.homeAccountId&&-1===r.indexOf(t.homeAccountId.toLowerCase()))}removeIdToken(e,t){this.removeItem(e,t)}removeRefreshToken(e,t){this.removeItem(e,t)}getAccessToken(e,t,r,n){var o=t.correlationId;this.commonLogger.trace("CacheManager - getAccessToken called",o);var i=kt.createSearchScopes(t.scopes),a=t.authenticationScheme||j.BEARER,c=a&&a.toLowerCase()!==j.BEARER.toLowerCase()?O.ACCESS_TOKEN_WITH_AUTH_SCHEME:O.ACCESS_TOKEN,l={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:c,clientId:this.clientId,realm:n||e.tenantId,target:i,tokenType:a,keyId:t.sshKid,requestedClaimsHash:t.requestedClaimsHash},s=r&&r.accessToken||this.getTokenKeys().accessToken,u=[];s.forEach(e=>{if(this.accessTokenKeyMatchesFilter(e,l,!0)){var t=this.getAccessTokenCredential(e,o);t&&this.credentialMatchesFilter(t,l)&&u.push(t)}});var d=u.length;return d<1?(this.commonLogger.info("CacheManager:getAccessToken - No token found",o),null):d>1?(this.commonLogger.info("CacheManager:getAccessToken - Multiple access tokens found, clearing them",o),u.forEach(e=>{this.removeAccessToken(this.generateCredentialKey(e),o)}),this.performanceClient.addFields({multiMatchedAT:u.length},o),null):(this.commonLogger.info("CacheManager:getAccessToken - Returning access token",o),u[0])}accessTokenKeyMatchesFilter(e,t,r){var n=e.toLowerCase();if(t.clientId&&-1===n.indexOf(t.clientId.toLowerCase()))return!1;if(t.homeAccountId&&-1===n.indexOf(t.homeAccountId.toLowerCase()))return!1;if(t.realm&&-1===n.indexOf(t.realm.toLowerCase()))return!1;if(t.requestedClaimsHash&&-1===n.indexOf(t.requestedClaimsHash.toLowerCase()))return!1;if(t.target)for(var o=t.target.asArray(),i=0;i<o.length;i++){if(r&&!n.includes(o[i].toLowerCase()))return!1;if(!r&&n.includes(o[i].toLowerCase()))return!0}return!0}getAccessTokensByFilter(e,t){var r=this.getTokenKeys(),n=[];return r.accessToken.forEach(r=>{if(this.accessTokenKeyMatchesFilter(r,e,!0)){var o=this.getAccessTokenCredential(r,t);o&&this.credentialMatchesFilter(o,e)&&n.push(o)}}),n}getRefreshToken(e,t,r,n,o){this.commonLogger.trace("CacheManager - getRefreshToken called");var i=t?R:void 0,a={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:O.REFRESH_TOKEN,clientId:this.clientId,familyId:i},c=n&&n.refreshToken||this.getTokenKeys().refreshToken,l=[];c.forEach(e=>{if(this.refreshTokenKeyMatchesFilter(e,a)){var t=this.getRefreshTokenCredential(e,r);t&&this.credentialMatchesFilter(t,a)&&l.push(t)}});var s=l.length;return s<1?(this.commonLogger.info("CacheManager:getRefreshToken - No refresh token found."),null):(s>1&&o&&r&&o.addFields({multiMatchedRT:s},r),this.commonLogger.info("CacheManager:getRefreshToken - returning refresh token"),l[0])}refreshTokenKeyMatchesFilter(e,t){var r=e.toLowerCase();return!(t.familyId&&-1===r.indexOf(t.familyId.toLowerCase())||!t.familyId&&t.clientId&&-1===r.indexOf(t.clientId.toLowerCase())||t.homeAccountId&&-1===r.indexOf(t.homeAccountId.toLowerCase()))}readAppMetadataFromCache(e){var t={environment:e,clientId:this.clientId},r=this.getAppMetadataFilteredBy(t),n=Object.keys(r).map(e=>r[e]),o=n.length;if(o<1)return null;if(o>1)throw ze(de);return n[0]}isAppMetadataFOCI(e){var t=this.readAppMetadataFromCache(e);return!(!t||t.familyId!==R)}matchHomeAccountId(e,t){return!("string"!=typeof e.homeAccountId||t!==e.homeAccountId)}matchLocalAccountIdFromTokenClaims(e,t){return t===(e.oid||e.sub)}matchLocalAccountIdFromTenantProfile(e,t){return e.localAccountId===t}matchName(e,t){var r;return!(t.toLowerCase()!==(null===(r=e.name)||void 0===r?void 0:r.toLowerCase()))}matchUsername(e,t){return!(!e||"string"!=typeof e||(null==t?void 0:t.toLowerCase())!==e.toLowerCase())}matchUserAssertionHash(e,t){return!(!e.userAssertionHash||t!==e.userAssertionHash)}matchEnvironment(e,t){if(this.staticAuthorityOptions){var r=function(e,t){var r,n=e.canonicalAuthority;if(n){var o,i=new Kt(n).getUrlComponents().HostNameAndPort;r=Gt(i,null===(o=e.cloudDiscoveryMetadata)||void 0===o?void 0:o.metadata,M,t)||Gt(i,Wt.metadata,L,t)||e.knownAuthorities}return r||[]}(this.staticAuthorityOptions,this.commonLogger);if(r.includes(t)&&r.includes(e.environment))return!0}var n=this.getAuthorityMetadataByAlias(t);return!!(n&&n.aliases.indexOf(e.environment)>-1)}matchCredentialType(e,t){return e.credentialType&&t.toLowerCase()===e.credentialType.toLowerCase()}matchClientId(e,t){return!(!e.clientId||t!==e.clientId)}matchFamilyId(e,t){return!(!e.familyId||t!==e.familyId)}matchRealm(e,t){var r;return!((null===(r=e.realm)||void 0===r?void 0:r.toLowerCase())!==t.toLowerCase())}matchNativeAccountId(e,t){return!(!e.nativeAccountId||t!==e.nativeAccountId)}matchLoginHintFromTokenClaims(e,t){return e.login_hint===t||e.preferred_username===t||e.upn===t}matchSid(e,t){return e.sid===t}matchAuthorityType(e,t){return!(!e.authorityType||t.toLowerCase()!==e.authorityType.toLowerCase())}matchTarget(e,t){return!(e.credentialType!==O.ACCESS_TOKEN&&e.credentialType!==O.ACCESS_TOKEN_WITH_AUTH_SCHEME||!e.target)&&kt.fromString(e.target).containsScopeSet(t)}matchTokenType(e,t){return!(!e.tokenType||e.tokenType!==t)}matchKeyId(e,t){return!(!e.keyId||e.keyId!==t)}isAppMetadata(e){return-1!==e.indexOf(_)}isAuthorityMetadata(e){return-1!==e.indexOf(x)}generateAuthorityMetadataCacheKey(e){return"".concat(x,"-").concat(this.clientId,"-").concat(e)}static toObject(e,t){for(var r in t)e[r]=t[r];return e}}class ar extends ir{setAccount(){return or(function*(){throw ze(qe)})()}getAccount(){throw ze(qe)}setIdTokenCredential(){return or(function*(){throw ze(qe)})()}getIdTokenCredential(){throw ze(qe)}setAccessTokenCredential(){return or(function*(){throw ze(qe)})()}getAccessTokenCredential(){throw ze(qe)}setRefreshTokenCredential(){return or(function*(){throw ze(qe)})()}getRefreshTokenCredential(){throw ze(qe)}setAppMetadata(){throw ze(qe)}getAppMetadata(){throw ze(qe)}setServerTelemetry(){throw ze(qe)}getServerTelemetry(){throw ze(qe)}setAuthorityMetadata(){throw ze(qe)}getAuthorityMetadata(){throw ze(qe)}getAuthorityMetadataKeys(){throw ze(qe)}setThrottlingCache(){throw ze(qe)}getThrottlingCache(){throw ze(qe)}removeItem(){throw ze(qe)}getKeys(){throw ze(qe)}getAccountKeys(){throw ze(qe)}getTokenKeys(){throw ze(qe)}generateCredentialKey(){throw ze(qe)}generateAccountKey(){throw ze(qe)}}var cr="acquireTokenByCode",lr="acquireTokenByRefreshToken",sr="acquireTokenSilent",ur="acquireTokenSilentAsync",dr="acquireTokenPopup",hr="acquireTokenRedirect",fr="cryptoOptsGetPublicKeyThumbprint",pr="cryptoOptsSignJwt",gr="silentCacheClientAcquireToken",mr="silentIframeClientAcquireToken",vr="silentRefreshClientAcquireToken",yr="ssoSilent",br="standardInteractionClientGetDiscoveredAuthority",wr="nativeInteractionClientAcquireToken",Cr="networkClientSendPostRequestAsync",kr="refreshTokenClientExecutePostToTokenEndpoint",Ir="authorizationCodeClientExecutePostToTokenEndpoint",Sr="refreshTokenClientExecuteTokenRequest",Tr="refreshTokenClientAcquireToken",Ar="refreshTokenClientAcquireTokenWithCachedRefreshToken",Pr="refreshTokenClientAcquireTokenByRefreshToken",Er="refreshTokenClientCreateTokenRequestBody",Or="acquireTokenFromCache",_r="silentFlowClientAcquireCachedToken",Rr="silentFlowClientGenerateResultFromCacheRecord",xr="acquireTokenBySilentIframe",Mr="initializeBaseRequest",Nr="initializeSilentRequest",Dr="initializeClientApplication",Lr="initializeCache",qr="silentIframeClientTokenHelper",jr="silentHandlerInitiateAuthRequest",Ur="silentHandlerMonitorIframeForHash",Fr="silentHandlerLoadFrame",Hr="silentHandlerLoadFrameSync",zr="standardInteractionClientCreateAuthCodeClient",Br="standardInteractionClientGetClientConfiguration",Kr="standardInteractionClientInitializeAuthorizationRequest",Vr="getAuthCodeUrl",Wr="handleCodeResponseFromServer",Qr="handleCodeResponse",Gr="handleResponseEar",Jr="handleResponsePlatformBroker",Yr="handleResponseCode",$r="updateTokenEndpointAuthority",Xr="authClientAcquireToken",Zr="authClientExecuteTokenRequest",en="authClientCreateTokenRequestBody",tn="popTokenGenerateCnf",rn="popTokenGenerateKid",nn="handleServerTokenResponse",on="deserializeResponse",an="authorityFactoryCreateDiscoveredInstance",cn="authorityResolveEndpointsAsync",ln="authorityGetCloudDiscoveryMetadataFromNetwork",sn="authorityUpdateCloudDiscoveryMetadata",un="authorityGetEndpointMetadataFromNetwork",dn="authorityUpdateEndpointMetadata",hn="authorityUpdateMetadataWithRegionalInformation",fn="regionDiscoveryDetectRegion",pn="regionDiscoveryGetRegionFromIMDS",gn="regionDiscoveryGetCurrentVersion",mn="acquireTokenByCodeAsync",vn="handleRedirectPromise",yn="handleNativeRedirectPromise",bn="nativeMessageHandlerHandshake",wn="removeHiddenIframe",Cn="clearTokensAndKeysWithClaims",kn="cacheManagerGetRefreshToken",In="importExistingCache",Sn="setUserData",Tn="localStorageUpdated",An="generatePkceCodes",Pn="generateCodeVerifier",En="generateCodeChallengeFromVerifier",On="sha256Digest",_n="getRandomValues",Rn="generateHKDF",xn="generateBaseKey",Mn="base64Decode",Nn="urlEncodeArr",Dn="encrypt",Ln="decrypt",qn="generateEarKey",jn="decryptEarResponse",Un=(new Map([[cr,"ATByCode"],[lr,"ATByRT"],[sr,"ATS"],[ur,"ATSAsync"],[dr,"ATPopup"],[hr,"ATRedirect"],[fr,"CryptoGetPKThumb"],[pr,"CryptoSignJwt"],[gr,"SltCacheClientAT"],[mr,"SltIframeClientAT"],[vr,"SltRClientAT"],[yr,"SsoSlt"],[br,"StdIntClientGetDiscAuth"],["fetchAccountIdWithNativeBroker","FetchAccIdWithNtvBroker"],[wr,"NtvIntClientAT"],["baseClientCreateTokenRequestHeaders","BaseClientCreateTReqHead"],[Cr,"NetClientSendPost"],[kr,"RTClientExecPost"],[Ir,"AuthCodeClientExecPost"],["brokerHandshake","BrokerHandshake"],["acquireTokenByRefreshTokenInBroker","ATByRTInBroker"],["acquireTokenByBroker","ATByBroker"],[Sr,"RTClientExecTReq"],[Tr,"RTClientAT"],[Ar,"RTClientATWithCachedRT"],[Pr,"RTClientATByRT"],[Er,"RTClientCreateTReqBody"],[Or,"ATFromCache"],[_r,"SltFlowClientATCached"],[Rr,"SltFlowClientGenResFromCache"],[xr,"ATBySltIframe"],[Mr,"InitBaseReq"],[Nr,"InitSltReq"],[Dr,"InitClientApplication"],[Lr,"InitCache"],[In,"importCache"],[Sn,"setUserData"],[Tn,"localStorageUpdated"],[qr,"SIClientTHelper"],[jr,"SHandlerInitAuthReq"],[Ur,"SltHandlerMonitorIframeForHash"],[Fr,"SHandlerLoadFrame"],[Hr,"SHandlerLoadFrameSync"],[zr,"StdIntClientCreateAuthCodeClient"],[Br,"StdIntClientGetClientConf"],[Kr,"StdIntClientInitAuthReq"],[Vr,"GetAuthCodeUrl"],[Wr,"HandleCodeResFromServer"],[Qr,"HandleCodeResp"],[Gr,"HandleRespEar"],[Yr,"HandleRespCode"],[Jr,"HandleRespPlatBroker"],[$r,"UpdTEndpointAuth"],[Xr,"AuthClientAT"],[Zr,"AuthClientExecTReq"],[en,"AuthClientCreateTReqBody"],[tn,"PopTGenCnf"],[rn,"PopTGenKid"],[nn,"HandleServerTRes"],[on,"DeserializeRes"],[an,"AuthFactCreateDiscInst"],[cn,"AuthResolveEndpointsAsync"],["authorityResolveEndpointsFromLocalSources","AuthResolveEndpointsFromLocal"],[ln,"AuthGetCDMetaFromNet"],[sn,"AuthUpdCDMeta"],[un,"AuthUpdCDMetaFromNet"],[dn,"AuthUpdEndpointMeta"],[hn,"AuthUpdMetaWithRegInfo"],[fn,"RegDiscDetectReg"],[pn,"RegDiscGetRegFromIMDS"],[gn,"RegDiscGetCurrentVer"],[mn,"ATByCodeAsync"],["getEndpointMetadataFromNetwork","GetEndpointMetaFromNet"],["getCloudDiscoveryMetadataFromNetworkMeasurement","GetCDMetaFromNet"],[vn,"HandleRedirectPromise"],[yn,"HandleNtvRedirectPromise"],["updateCloudDiscoveryMetadataMeasurement","UpdateCDMeta"],["usernamePasswordClientAcquireToken","UserPassClientAT"],[bn,"NtvMsgHandlerHandshake"],["nativeGenerateAuthResult","NtvGenAuthRes"],[wn,"RemoveHiddenIframe"],[Cn,"ClearTAndKeysWithClaims"],[kn,"CacheManagerGetRT"],[An,"GenPkceCodes"],[Pn,"GenCodeVerifier"],[En,"GenCodeChallengeFromVerifier"],[On,"Sha256Digest"],[_n,"GetRandomValues"],[Rn,"genHKDF"],[xn,"genBaseKey"],[Mn,"b64Decode"],[Nn,"urlEncArr"],[Dn,"encrypt"],[Ln,"decrypt"],[qn,"genEarKey"],[jn,"decryptEarResp"]]),1);new Set(["accessTokenSize","durationMs","idTokenSize","matsSilentStatus","matsHttpStatus","refreshTokenSize","queuedTimeMs","startTimeMs","status","multiMatchedAT","multiMatchedID","multiMatchedRT","unencryptedCacheCount","encryptedCacheExpiredCount","oldAccountCount","oldAccessCount","oldIdCount","oldRefreshCount","currAccountCount","currAccessCount","currIdCount","currRefreshCount","expiredCacheRemovedCount","upgradedCacheCount"]);class Fn{startMeasurement(){}endMeasurement(){}flushMeasurement(){return null}}class Hn{generateId(){return"callback-id"}startMeasurement(e,t){return{end:()=>null,discard:()=>{},add:()=>{},increment:()=>{},event:{eventId:this.generateId(),status:Un,authority:"",libraryName:"",libraryVersion:"",clientId:"",name:e,startTimeMs:Date.now(),correlationId:t||""},measurement:new Fn}}startPerformanceMeasurement(){return new Fn}calculateQueuedTime(){return 0}addQueueMeasurement(){}setPreQueueTime(){}endMeasurement(){return null}discardMeasurements(){}removePerformanceCallback(){return!0}addPerformanceCallback(){return""}emitEvents(){}addFields(){}incrementFields(){}cacheEventByCorrelationId(){}}function zn(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Bn(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?zn(Object(r),!0).forEach(function(t){Kn(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):zn(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Kn(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Vn(e,t,r,n,o,i,a){try{var c=e[i](a),l=c.value}catch(e){return void r(e)}c.done?t(l):Promise.resolve(l).then(n,o)}function Wn(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var i=e.apply(t,r);function a(e){Vn(i,n,o,a,c,"next",e)}function c(e){Vn(i,n,o,a,c,"throw",e)}a(void 0)})}}var Qn={tokenRenewalOffsetSeconds:300,preventCorsPreflight:!1},Gn={loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:o.Info,correlationId:c.EMPTY_STRING},Jn={claimsBasedCachingEnabled:!1},Yn={sendGetRequestAsync:()=>Wn(function*(){throw ze(qe)})(),sendPostRequestAsync:()=>Wn(function*(){throw ze(qe)})()},$n={sku:c.SKU,version:Qe,cpu:c.EMPTY_STRING,os:c.EMPTY_STRING},Xn={clientSecret:c.EMPTY_STRING,clientAssertion:void 0},Zn={azureCloudInstance:B,tenant:"".concat(c.DEFAULT_COMMON_TENANT)},eo={application:{appName:"",appVersion:""}};function to(e){return e.authOptions.authority.options.protocolMode===H}var ro,no={sendGetRequestAsync:()=>Promise.reject(ze(qe)),sendPostRequestAsync:()=>Promise.reject(ze(qe))},oo="invalid_grant",io="msal",ao="msal.js.browser",co="53ee284d-920a-4b59-9d30-a60315b26836",lo="ppnbnpeolgkicgegkbkbjmhlideopiji",so="MicrosoftEntra",uo="Handshake",ho="localStorage",fo="sessionStorage",po="memoryStorage",go="signin",mo="signout",vo="request.origin",yo="urlHash",bo="request.params",wo="code.verifier",Co="interaction.status",ko="request.native",Io="wrapper.sku",So="wrapper.version",To=861,Ao=862;!function(e){e.Redirect="redirect",e.Popup="popup",e.Silent="silent",e.None="none"}(ro||(ro={}));var Po={scopes:s},Eo="msal.db",Oo="".concat(Eo,".keys"),_o=[0,5,4],Ro="pkce_not_created",xo="ear_jwk_empty",Mo="ear_jwe_empty",No="crypto_nonexistent",Do="empty_navigate_uri",Lo="hash_empty_error",qo="no_state_in_hash",jo="hash_does_not_contain_known_properties",Uo="unable_to_parse_state",Fo="state_interaction_type_mismatch",Ho="interaction_in_progress",zo="popup_window_error",Bo="empty_window_error",Ko="user_cancelled",Vo="monitor_popup_timeout",Wo="monitor_window_timeout",Qo="redirect_in_iframe",Go="block_iframe_reload",Jo="block_nested_popups",Yo="iframe_closed_prematurely",$o="silent_logout_unsupported",Xo="no_account_error",Zo="silent_prompt_value_error",ei="no_token_request_cache_error",ti="unable_to_parse_token_request_cache_error",ri="auth_request_not_set_error",ni="invalid_cache_type",oi="non_browser_environment",ii="database_not_open",ai="no_network_connectivity",ci="post_request_failed",li="get_request_failed",si="failed_to_parse_response",ui="unable_to_load_token",di="crypto_key_not_found",hi="auth_code_required",fi="auth_code_or_nativeAccountId_required",pi="spa_code_and_nativeAccountId_present",gi="database_unavailable",mi="unable_to_acquire_token_from_native_platform",vi="native_handshake_timeout",yi="native_extension_not_installed",bi="native_connection_not_established",wi="uninitialized_public_client_application",Ci="native_prompt_not_supported",ki="invalid_base64_string",Ii="invalid_pop_token_request",Si="failed_to_build_headers",Ti="failed_to_parse_headers",Ai="failed_to_decrypt_ear_response",Pi="timed_out",Ei="For more visit: aka.ms/msaljs/browser-errors",Oi={[Ro]:"The PKCE code challenge and verifier could not be generated.",[xo]:"No EAR encryption key provided. This is unexpected.",[Mo]:"Server response does not contain ear_jwe property. This is unexpected.",[No]:"The crypto object or function is not available.",[Do]:"Navigation URI is empty. Please check stack trace for more info.",[Lo]:"Hash value cannot be processed because it is empty. Please verify that your redirectUri is not clearing the hash. ".concat(Ei),[qo]:"Hash does not contain state. Please verify that the request originated from msal.",[jo]:"Hash does not contain known properites. Please verify that your redirectUri is not changing the hash.  ".concat(Ei),[Uo]:"Unable to parse state. Please verify that the request originated from msal.",[Fo]:"Hash contains state but the interaction type does not match the caller.",[Ho]:"Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API.   ".concat(Ei),[zo]:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser.",[Bo]:"window.open returned null or undefined window object.",[Ko]:"User cancelled the flow.",[Vo]:"Token acquisition in popup failed due to timeout.  ".concat(Ei),[Wo]:"Token acquisition in iframe failed due to timeout.  ".concat(Ei),[Qo]:"Redirects are not supported for iframed or brokered applications. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs.",[Go]:"Request was blocked inside an iframe because MSAL detected an authentication response.  ".concat(Ei),[Jo]:"Request was blocked inside a popup because MSAL detected it was running in a popup.",[Yo]:"The iframe being monitored was closed prematurely.",[$o]:"Silent logout not supported. Please call logoutRedirect or logoutPopup instead.",[Xo]:"No account object provided to acquireTokenSilent and no active account has been set. Please call setActiveAccount or provide an account on the request.",[Zo]:"The value given for the prompt value is not valid for silent requests - must be set to 'none' or 'no_session'.",[ei]:"No token request found in cache.",[ti]:"The cached token request could not be parsed.",[ri]:"Auth Request not set. Please ensure initiateAuthRequest was called from the InteractionHandler",[ni]:"Invalid cache type",[oi]:"Login and token requests are not supported in non-browser environments.",[ii]:"Database is not open!",[ai]:"No network connectivity. Check your internet connection.",[ci]:"Network request failed: If the browser threw a CORS error, check that the redirectUri is registered in the Azure App Portal as type 'SPA'",[li]:"Network request failed. Please check the network trace to determine root cause.",[si]:"Failed to parse network response. Check network trace.",[ui]:"Error loading token to cache.",[di]:"Cryptographic Key or Keypair not found in browser storage.",[hi]:"An authorization code must be provided (as the `code` property on the request) to this flow.",[fi]:"An authorization code or nativeAccountId must be provided to this flow.",[pi]:"Request cannot contain both spa code and native account id.",[gi]:"IndexedDB, which is required for persistent cryptographic key storage, is unavailable. This may be caused by browser privacy features which block persistent storage in third-party contexts.",[mi]:"Unable to acquire token from native platform.  ".concat(Ei),[vi]:"Timed out while attempting to establish connection to browser extension",[yi]:"Native extension is not installed. If you think this is a mistake call the initialize function.",[bi]:"Connection to native platform has not been established. Please install a compatible browser extension and run initialize().  ".concat(Ei),[wi]:"You must call and await the initialize function before attempting to call any other MSAL API.  ".concat(Ei),[Ci]:"The provided prompt is not supported by the native platform. This request should be routed to the web based flow.",[ki]:"Invalid base64 encoded string.",[Ii]:"Invalid PoP token request. The request should not have both a popKid value and signPopToken set to true.",[Si]:"Failed to build request headers object.",[Ti]:"Failed to parse response headers",[Ai]:"Failed to decrypt ear response",[Pi]:"The request timed out."};class _i extends Q{constructor(e,t){super(e,Oi[e],t),Object.setPrototypeOf(this,_i.prototype),this.name="BrowserAuthError"}}function Ri(e,t){return new _i(e,t)}class xi{navigateInternal(e,t){return xi.defaultNavigateWindow(e,t)}navigateExternal(e,t){return xi.defaultNavigateWindow(e,t)}static defaultNavigateWindow(e,t){return t.noHistory?window.location.replace(e):window.location.assign(e),new Promise((e,r)=>{setTimeout(()=>{r(Ri(Pi,"failed_to_redirect"))},t.timeout)})}}class Mi extends Q{constructor(e,t,r){super(e.errorCode,e.errorMessage,e.subError),Object.setPrototypeOf(this,Mi.prototype),this.name="NetworkError",this.error=e,this.httpStatus=t,this.responseHeaders=r}}function Ni(e,t,r,n){return e.errorMessage="".concat(e.errorMessage,", additionalErrorInfo: error.name:").concat(null==n?void 0:n.name,", error.message:").concat(null==n?void 0:n.message),new Mi(e,t,r)}function Di(e,t,r,n,o,i,a){try{var c=e[i](a),l=c.value}catch(e){return void r(e)}c.done?t(l):Promise.resolve(l).then(n,o)}function Li(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var i=e.apply(t,r);function a(e){Di(i,n,o,a,c,"next",e)}function c(e){Di(i,n,o,a,c,"throw",e)}a(void 0)})}}class qi{sendGetRequestAsync(e,t){return Li(function*(){var r,n,o=0,i=ji(t);try{r=yield fetch(e,{method:"GET",headers:i})}catch(e){throw Ni(Ri(window.navigator.onLine?li:ai),void 0,void 0,e)}n=Ui(r.headers);try{return o=r.status,{headers:n,body:yield r.json(),status:o}}catch(e){throw Ni(Ri(si),o,n,e)}})()}sendPostRequestAsync(e,t){return Li(function*(){var r,n,o=t&&t.body||"",i=ji(t),a=0;try{r=yield fetch(e,{method:"POST",headers:i,body:o})}catch(e){throw Ni(Ri(window.navigator.onLine?ci:ai),void 0,void 0,e)}n=Ui(r.headers);try{return a=r.status,{headers:n,body:yield r.json(),status:a}}catch(e){throw Ni(Ri(si),a,n,e)}})()}}function ji(e){try{var t=new Headers;if(!e||!e.headers)return t;var r=e.headers;return Object.entries(r).forEach(e=>{var[r,n]=e;t.append(r,n)}),t}catch(e){throw Ni(Ri(Si),void 0,void 0,e)}}function Ui(e){try{var t={};return e.forEach((e,r)=>{t[r]=e}),t}catch(e){throw Ri(Ti)}}var Fi="client_id",Hi="redirect_uri",zi="token_type",Bi="req_cnf",Ki="return_spa_code",Vi="x-client-xtra-sku",Wi="brk_client_id",Qi="brk_redirect_uri",Gi="instance_aware";function Ji(e,t,r){if(t){var n=e.get(Fi);n&&e.has(Wi)&&(null==r||r.addFields({embeddedClientId:n,embeddedRedirectUri:e.get(Hi)},t))}}function Yi(e,t){e.set("response_type",t)}function $i(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:s;!r||n.includes("openid")||t.includes("openid")||n.push("openid");var o=r?[...t||[],...n]:t||[],i=new kt(o);e.set("scope",i.printScopes())}function Xi(e,t){e.set(Fi,t)}function Zi(e,t){e.set(Hi,t)}function ea(e,t){e.set("login_hint",t)}function ta(e,t){e.set(f,"UPN:".concat(t))}function ra(e,t){e.set(f,"Oid:".concat(t.uid,"@").concat(t.utid))}function na(e,t){e.set("sid",t)}function oa(e,t,r){var n=function(e,t){var r;if(e)try{r=JSON.parse(e)}catch(e){throw wt(et)}else r={};return t&&t.length>0&&(r.hasOwnProperty(w)||(r[w]={}),r[w][C]={values:t}),JSON.stringify(r)}(t,r);try{JSON.parse(n)}catch(e){throw wt(et)}e.set("claims",n)}function ia(e,t){e.set("client-request-id",t)}function aa(e,t){e.set("x-client-SKU",t.sku),e.set("x-client-VER",t.version),t.os&&e.set("x-client-OS",t.os),t.cpu&&e.set("x-client-CPU",t.cpu)}function ca(e,t){null!=t&&t.appName&&e.set("x-app-name",t.appName),null!=t&&t.appVersion&&e.set("x-app-ver",t.appVersion)}function la(e,t){t&&e.set("state",t)}function sa(e,t,r){if(!t||!r)throw wt(ot);e.set("code_challenge",t),e.set("code_challenge_method",r)}function ua(e,t){e.set("client_secret",t)}function da(e,t){t&&e.set("client_assertion",t)}function ha(e,t){t&&e.set("client_assertion_type",t)}function fa(e,t){e.set("grant_type",t)}function pa(e){e.set("client_info","1")}function ga(e){e.has(Gi)||e.set(Gi,"true")}function ma(e,t){Object.entries(t).forEach(t=>{var[r,n]=t;!e.has(r)&&n&&e.set(r,n)})}function va(e,t){t&&(e.set(zi,j.POP),e.set(Bi,t))}function ya(e,t){t&&(e.set(zi,j.SSH),e.set(Bi,t))}function ba(e,t){e.set("x-client-current-telemetry",t.generateCurrentRequestHeaderValue()),e.set("x-client-last-telemetry",t.generateLastRequestHeaderValue())}function wa(e){e.set("x-ms-lib-capability","retry-after, h429")}function Ca(e,t,r){e.has(Wi)||e.set(Wi,t),e.has(Qi)||e.set(Qi,r)}function ka(e){return encodeURIComponent(Sa(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"))}function Ia(e){return Ta(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function Sa(e){return Ta((new TextEncoder).encode(e))}function Ta(e){var t=Array.from(e,e=>String.fromCodePoint(e)).join("");return btoa(t)}function Aa(e){return(new TextDecoder).decode(Pa(e))}function Pa(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw Ri(ki)}var r=atob(t);return Uint8Array.from(r,e=>e.codePointAt(0)||0)}function Ea(e,t,r,n,o,i,a){try{var c=e[i](a),l=c.value}catch(e){return void r(e)}c.done?t(l):Promise.resolve(l).then(n,o)}function Oa(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var i=e.apply(t,r);function a(e){Ea(i,n,o,a,c,"next",e)}function c(e){Ea(i,n,o,a,c,"throw",e)}a(void 0)})}}var _a="AES-GCM",Ra="HKDF",xa="SHA-256",Ma=new Uint8Array([1,0,1]),Na="0123456789abcdef",Da=new Uint32Array(1),La="raw",qa="encrypt",ja="decrypt",Ua={name:"RSASSA-PKCS1-v1_5",hash:xa,modulusLength:2048,publicExponent:Ma};function Fa(e,t,r){return Ha.apply(this,arguments)}function Ha(){return(Ha=Oa(function*(e,t,r){null==t||t.addQueueMeasurement(On,r);var n=(new TextEncoder).encode(e);return window.crypto.subtle.digest(xa,n)})).apply(this,arguments)}function za(e){return window.crypto.getRandomValues(e)}function Ba(){return window.crypto.getRandomValues(Da),Da[0]}function Ka(){var e=Date.now(),t=1024*Ba()+(1023&Ba()),r=new Uint8Array(16),n=Math.trunc(t/2**30),o=t&2**30-1,i=Ba();r[0]=e/2**40,r[1]=e/2**32,r[2]=e/2**24,r[3]=e/65536,r[4]=e/256,r[5]=e,r[6]=112|n>>>8,r[7]=n,r[8]=128|o>>>24,r[9]=o>>>16,r[10]=o>>>8,r[11]=o,r[12]=i>>>24,r[13]=i>>>16,r[14]=i>>>8,r[15]=i;for(var a="",c=0;c<r.length;c++)a+=Na.charAt(r[c]>>>4),a+=Na.charAt(15&r[c]),3!==c&&5!==c&&7!==c&&9!==c||(a+="-");return a}function Va(){return(Va=Oa(function*(e,t){return window.crypto.subtle.generateKey(Ua,e,t)})).apply(this,arguments)}function Wa(e){return Qa.apply(this,arguments)}function Qa(){return(Qa=Oa(function*(e){return window.crypto.subtle.exportKey("jwk",e)})).apply(this,arguments)}function Ga(){return(Ga=Oa(function*(e,t,r){return window.crypto.subtle.importKey("jwk",e,Ua,t,r)})).apply(this,arguments)}function Ja(){return(Ja=Oa(function*(e,t){return window.crypto.subtle.sign(Ua,e,t)})).apply(this,arguments)}function Ya(){return $a.apply(this,arguments)}function $a(){return($a=Oa(function*(){var e=yield tc(),t={alg:"dir",kty:"oct",k:Ia(new Uint8Array(e))};return Sa(JSON.stringify(t))})).apply(this,arguments)}function Xa(){return(Xa=Oa(function*(e){var t=Aa(e),r=Pa(JSON.parse(t).k);return window.crypto.subtle.importKey(La,r,_a,!1,[ja])})).apply(this,arguments)}function Za(e,t){return ec.apply(this,arguments)}function ec(){return ec=Oa(function*(e,t){var r=t.split(".");if(5!==r.length)throw Ri(Ai,"jwe_length");var n=yield function(e){return Xa.apply(this,arguments)}(e).catch(()=>{throw Ri(Ai,"import_key")});try{var o=(new TextEncoder).encode(r[0]),i=Pa(r[2]),a=Pa(r[3]),c=Pa(r[4]),l=8*c.byteLength,s=new Uint8Array(a.length+c.length);s.set(a),s.set(c,a.length);var u=yield window.crypto.subtle.decrypt({name:_a,iv:i,tagLength:l,additionalData:o},n,s);return(new TextDecoder).decode(u)}catch(e){throw Ri(Ai,"decrypt")}}),ec.apply(this,arguments)}function tc(){return rc.apply(this,arguments)}function rc(){return(rc=Oa(function*(){var e=yield window.crypto.subtle.generateKey({name:_a,length:256},!0,[qa,ja]);return window.crypto.subtle.exportKey(La,e)})).apply(this,arguments)}function nc(e){return oc.apply(this,arguments)}function oc(){return(oc=Oa(function*(e){return window.crypto.subtle.importKey(La,e,Ra,!1,["deriveKey"])})).apply(this,arguments)}function ic(e,t,r){return ac.apply(this,arguments)}function ac(){return(ac=Oa(function*(e,t,r){return window.crypto.subtle.deriveKey({name:Ra,salt:t,hash:xa,info:(new TextEncoder).encode(r)},e,{name:_a,length:256},!1,[qa,ja])})).apply(this,arguments)}function cc(e,t,r){return lc.apply(this,arguments)}function lc(){return(lc=Oa(function*(e,t,r){var n=(new TextEncoder).encode(t),o=window.crypto.getRandomValues(new Uint8Array(16)),i=yield ic(e,o,r),a=yield window.crypto.subtle.encrypt({name:_a,iv:new Uint8Array(12)},i,n);return{data:Ia(new Uint8Array(a)),nonce:Ia(o)}})).apply(this,arguments)}function sc(e,t,r,n){return uc.apply(this,arguments)}function uc(){return(uc=Oa(function*(e,t,r,n){var o=Pa(n),i=yield ic(e,Pa(t),r),a=yield window.crypto.subtle.decrypt({name:_a,iv:new Uint8Array(12)},i,o);return(new TextDecoder).decode(a)})).apply(this,arguments)}function dc(e){return hc.apply(this,arguments)}function hc(){return(hc=Oa(function*(e){var t=yield Fa(e);return Ia(new Uint8Array(t))})).apply(this,arguments)}var fc="storage_not_supported",pc="stubbed_public_client_application_called",gc="in_mem_redirect_unavailable",mc={[fc]:"Given storage configuration option was not supported.",[pc]:"Stub instance of Public Client Application was called. If using msal-react, please ensure context is not used without a provider. For more visit: aka.ms/msaljs/browser-errors",[gc]:"Redirect cannot be supported. In-memory storage was selected and storeAuthStateInCookie=false, which would cause the library to be unable to handle the incoming hash. If you would like to use the redirect API, please use session/localStorage or set storeAuthStateInCookie=true."};class vc extends Q{constructor(e,t){super(e,t),this.name="BrowserConfigurationAuthError",Object.setPrototypeOf(this,vc.prototype)}}function yc(e){return new vc(e,mc[e])}function bc(e){e.location.hash="","function"==typeof e.history.replaceState&&e.history.replaceState(null,"","".concat(e.location.origin).concat(e.location.pathname).concat(e.location.search))}function wc(){return window.parent!==window}function Cc(){return"undefined"!=typeof window&&window.location?window.location.href.split("?")[0].split("#")[0]:""}function kc(){if("undefined"==typeof window)throw Ri(oi)}function Ic(e){if(!e)throw Ri(wi)}function Sc(e){kc(),function(){if(Kt.hashContainsKnownProperties(window.location.hash)&&wc())throw Ri(Go)}(),function(){if("undefined"!=typeof window&&window.opener&&window.opener!==window&&"string"==typeof window.name&&0===window.name.indexOf("".concat(io,".")))throw Ri(Jo)}(),Ic(e)}function Tc(e,t){if(Sc(e),function(e){if(wc()&&!e)throw Ri(Qo)}(t.system.allowRedirectInIframe),t.cache.cacheLocation===po&&!t.cache.storeAuthStateInCookie)throw yc(gc)}function Ac(e){var t=document.createElement("link");t.rel="preconnect",t.href=new URL(e).origin,t.crossOrigin="anonymous",document.head.appendChild(t),window.setTimeout(()=>{try{document.head.removeChild(t)}catch(e){}},1e4)}function Pc(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Ec(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Pc(Object(r),!0).forEach(function(t){Oc(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Pc(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Oc(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var _c=1e4,Rc="4.27.0",xc="msal",Mc="browser",Nc="".concat(xc,".").concat(Mc,".log.level"),Dc="".concat(xc,".").concat(Mc,".log.pii"),Lc=("".concat(xc,".").concat(Mc,".performance.enabled"),"".concat(xc,".version")),qc="account.keys",jc="token.keys";function Uc(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2;return e<1?"".concat(xc,".").concat(qc):"".concat(xc,".").concat(e,".").concat(qc)}function Fc(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return t<1?"".concat(xc,".").concat(jc,".").concat(e):"".concat(xc,".").concat(t,".").concat(jc,".").concat(e)}function Hc(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function zc(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Bc{static loggerCallback(e,t){switch(e){case o.Error:return void console.error(t);case o.Info:return void console.info(t);case o.Verbose:return void console.debug(t);case o.Warning:return void console.warn(t);default:return void console.log(t)}}constructor(e){var t,r,n;this.browserEnvironment="undefined"!=typeof window,this.config=function(e,t){var{auth:r,cache:n,system:i,telemetry:a}=e,l={clientId:c.EMPTY_STRING,authority:"".concat(c.DEFAULT_AUTHORITY),knownAuthorities:[],cloudDiscoveryMetadata:c.EMPTY_STRING,authorityMetadata:c.EMPTY_STRING,redirectUri:"undefined"!=typeof window?Cc():"",postLogoutRedirectUri:c.EMPTY_STRING,navigateToLoginRequestUrl:!0,clientCapabilities:[],protocolMode:"AAD",OIDCOptions:{serverResponseType:"fragment",defaultScopes:[c.OPENID_SCOPE,c.PROFILE_SCOPE,c.OFFLINE_ACCESS_SCOPE]},azureCloudOptions:{azureCloudInstance:B,tenant:c.EMPTY_STRING},skipAuthorityMetadataCache:!1,supportsNestedAppAuth:!1,instanceAware:!1,encodeExtraQueryParams:!1},s={cacheLocation:fo,cacheRetentionDays:5,temporaryCacheLocation:fo,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!(!n||n.cacheLocation!==ho),claimsBasedCachingEnabled:!1},u={loggerCallback:()=>{},logLevel:o.Info,piiLoggingEnabled:!1},d=Ec(Ec({},Qn),{},{loggerOptions:u,networkClient:t?new qi:no,navigationClient:new xi,loadFrameTimeout:0,windowHashTimeout:(null==i?void 0:i.loadFrameTimeout)||6e4,iframeHashTimeout:(null==i?void 0:i.loadFrameTimeout)||_c,navigateFrameWait:0,redirectNavigationTimeout:3e4,asyncPopups:!1,allowRedirectInIframe:!1,allowPlatformBroker:!1,allowPlatformBrokerWithDOM:!1,nativeBrokerHandshakeTimeout:(null==i?void 0:i.nativeBrokerHandshakeTimeout)||2e3,pollIntervalMilliseconds:30}),h=Ec(Ec(Ec({},d),i),{},{loggerOptions:(null==i?void 0:i.loggerOptions)||u}),f={application:{appName:c.EMPTY_STRING,appVersion:c.EMPTY_STRING},client:new Hn};if((null==r?void 0:r.protocolMode)!==H&&null!=r&&r.OIDCOptions&&new F(h.loggerOptions).warning(JSON.stringify(wt(ht))),null!=r&&r.protocolMode&&r.protocolMode===H&&null!=h&&h.allowPlatformBroker)throw wt(ft);return{auth:Ec(Ec(Ec({},l),r),{},{OIDCOptions:Ec(Ec({},l.OIDCOptions),null==r?void 0:r.OIDCOptions)}),cache:Ec(Ec({},s),n),system:h,telemetry:Ec(Ec({},f),a)}}(e,this.browserEnvironment);try{n=window[fo]}catch(e){}var i=null===(t=n)||void 0===t?void 0:t.getItem(Nc),a=null===(r=n)||void 0===r||null===(r=r.getItem(Dc))||void 0===r?void 0:r.toLowerCase(),l="true"===a||"false"!==a&&void 0,s=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Hc(Object(r),!0).forEach(function(t){zc(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Hc(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({},this.config.system.loggerOptions),u=i&&Object.keys(o).includes(i)?o[i]:void 0;u&&(s.loggerCallback=Bc.loggerCallback,s.logLevel=u),void 0!==l&&(s.piiLoggingEnabled=l),this.logger=new F(s,"@azure/msal-browser",Rc),this.available=!1}getConfig(){return this.config}getLogger(){return this.logger}isAvailable(){return this.available}isBrowserEnvironment(){return this.browserEnvironment}}function Kc(e,t,r,n,o,i,a){try{var c=e[i](a),l=c.value}catch(e){return void r(e)}c.done?t(l):Promise.resolve(l).then(n,o)}class Vc extends Bc{getModuleName(){return Vc.MODULE_NAME}getId(){return Vc.ID}initialize(){var e,t=this;return(e=function*(){return t.available="undefined"!=typeof window,t.available},function(){var t=this,r=arguments;return new Promise(function(n,o){var i=e.apply(t,r);function a(e){Kc(i,n,o,a,c,"next",e)}function c(e){Kc(i,n,o,a,c,"throw",e)}a(void 0)})})()}}Vc.MODULE_NAME="",Vc.ID="StandardOperatingContext";var Wc="missing_kid_error",Qc="missing_alg_error",Gc={[Wc]:"The JOSE Header for the requested JWT, JWS or JWK object requires a keyId to be configured as the 'kid' header claim. No 'kid' value was provided.",[Qc]:"The JOSE Header for the requested JWT, JWS or JWK object requires an algorithm to be specified as the 'alg' header claim. No 'alg' value was provided."};class Jc extends Q{constructor(e,t){super(e,t),this.name="JoseHeaderError",Object.setPrototypeOf(this,Jc.prototype)}}function Yc(e){return new Jc(e,Gc[e])}class $c{constructor(e){this.typ=e.typ,this.alg=e.alg,this.kid=e.kid}static getShrHeaderString(e){if(!e.kid)throw Yc(Wc);if(!e.alg)throw Yc(Qc);var t=new $c({typ:e.typ||"pop",kid:e.kid,alg:e.alg});return JSON.stringify(t)}}function Xc(e,t,r,n,o,i,a){try{var c=e[i](a),l=c.value}catch(e){return void r(e)}c.done?t(l):Promise.resolve(l).then(n,o)}function Zc(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var i=e.apply(t,r);function a(e){Xc(i,n,o,a,c,"next",e)}function c(e){Xc(i,n,o,a,c,"throw",e)}a(void 0)})}}class el{constructor(){this.dbName=Eo,this.version=1,this.tableName=Oo,this.dbOpen=!1}open(){var e=this;return Zc(function*(){return new Promise((t,r)=>{var n=window.indexedDB.open(e.dbName,e.version);n.addEventListener("upgradeneeded",t=>{t.target.result.createObjectStore(e.tableName)}),n.addEventListener("success",r=>{var n=r;e.db=n.target.result,e.dbOpen=!0,t()}),n.addEventListener("error",()=>r(Ri(gi)))})})()}closeConnection(){var e=this.db;e&&this.dbOpen&&(e.close(),this.dbOpen=!1)}validateDbIsOpen(){var e=this;return Zc(function*(){if(!e.dbOpen)return e.open()})()}getItem(e){var t=this;return Zc(function*(){return yield t.validateDbIsOpen(),new Promise((r,n)=>{if(!t.db)return n(Ri(ii));var o=t.db.transaction([t.tableName],"readonly").objectStore(t.tableName).get(e);o.addEventListener("success",e=>{var n=e;t.closeConnection(),r(n.target.result)}),o.addEventListener("error",e=>{t.closeConnection(),n(e)})})})()}setItem(e,t){var r=this;return Zc(function*(){return yield r.validateDbIsOpen(),new Promise((n,o)=>{if(!r.db)return o(Ri(ii));var i=r.db.transaction([r.tableName],"readwrite").objectStore(r.tableName).put(t,e);i.addEventListener("success",()=>{r.closeConnection(),n()}),i.addEventListener("error",e=>{r.closeConnection(),o(e)})})})()}removeItem(e){var t=this;return Zc(function*(){return yield t.validateDbIsOpen(),new Promise((r,n)=>{if(!t.db)return n(Ri(ii));var o=t.db.transaction([t.tableName],"readwrite").objectStore(t.tableName).delete(e);o.addEventListener("success",()=>{t.closeConnection(),r()}),o.addEventListener("error",e=>{t.closeConnection(),n(e)})})})()}getKeys(){var e=this;return Zc(function*(){return yield e.validateDbIsOpen(),new Promise((t,r)=>{if(!e.db)return r(Ri(ii));var n=e.db.transaction([e.tableName],"readonly").objectStore(e.tableName).getAllKeys();n.addEventListener("success",r=>{var n=r;e.closeConnection(),t(n.target.result)}),n.addEventListener("error",t=>{e.closeConnection(),r(t)})})})()}containsKey(e){var t=this;return Zc(function*(){return yield t.validateDbIsOpen(),new Promise((r,n)=>{if(!t.db)return n(Ri(ii));var o=t.db.transaction([t.tableName],"readonly").objectStore(t.tableName).count(e);o.addEventListener("success",e=>{var n=e;t.closeConnection(),r(1===n.target.result)}),o.addEventListener("error",e=>{t.closeConnection(),n(e)})})})()}deleteDatabase(){var e=this;return Zc(function*(){return e.db&&e.dbOpen&&e.closeConnection(),new Promise((e,t)=>{var r=window.indexedDB.deleteDatabase(Eo),n=setTimeout(()=>t(!1),200);r.addEventListener("success",()=>(clearTimeout(n),e(!0))),r.addEventListener("blocked",()=>(clearTimeout(n),e(!0))),r.addEventListener("error",()=>(clearTimeout(n),t(!1)))})})()}}function tl(e,t,r,n,o,i,a){try{var c=e[i](a),l=c.value}catch(e){return void r(e)}c.done?t(l):Promise.resolve(l).then(n,o)}function rl(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var i=e.apply(t,r);function a(e){tl(i,n,o,a,c,"next",e)}function c(e){tl(i,n,o,a,c,"throw",e)}a(void 0)})}}class nl{constructor(){this.cache=new Map}initialize(){return rl(function*(){})()}getItem(e){return this.cache.get(e)||null}getUserData(e){return this.getItem(e)}setItem(e,t){this.cache.set(e,t)}setUserData(e,t){var r=this;return rl(function*(){r.setItem(e,t)})()}removeItem(e){this.cache.delete(e)}getKeys(){var e=[];return this.cache.forEach((t,r)=>{e.push(r)}),e}containsKey(e){return this.cache.has(e)}clear(){this.cache.clear()}decryptData(){return Promise.resolve(null)}}function ol(e,t,r,n,o,i,a){try{var c=e[i](a),l=c.value}catch(e){return void r(e)}c.done?t(l):Promise.resolve(l).then(n,o)}function il(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var i=e.apply(t,r);function a(e){ol(i,n,o,a,c,"next",e)}function c(e){ol(i,n,o,a,c,"throw",e)}a(void 0)})}}class al{constructor(e){this.inMemoryCache=new nl,this.indexedDBCache=new el,this.logger=e}handleDatabaseAccessError(e){if(!(e instanceof _i&&e.errorCode===gi))throw e;this.logger.error("Could not access persistent storage. This may be caused by browser privacy features which block persistent storage in third-party contexts.")}getItem(e){var t=this;return il(function*(){var r=t.inMemoryCache.getItem(e);if(!r)try{return t.logger.verbose("Queried item not found in in-memory cache, now querying persistent storage."),yield t.indexedDBCache.getItem(e)}catch(e){t.handleDatabaseAccessError(e)}return r})()}setItem(e,t){var r=this;return il(function*(){r.inMemoryCache.setItem(e,t);try{yield r.indexedDBCache.setItem(e,t)}catch(e){r.handleDatabaseAccessError(e)}})()}removeItem(e){var t=this;return il(function*(){t.inMemoryCache.removeItem(e);try{yield t.indexedDBCache.removeItem(e)}catch(e){t.handleDatabaseAccessError(e)}})()}getKeys(){var e=this;return il(function*(){var t=e.inMemoryCache.getKeys();if(0===t.length)try{return e.logger.verbose("In-memory cache is empty, now querying persistent storage."),yield e.indexedDBCache.getKeys()}catch(t){e.handleDatabaseAccessError(t)}return t})()}containsKey(e){var t=this;return il(function*(){var r=t.inMemoryCache.containsKey(e);if(!r)try{return t.logger.verbose("Key not found in in-memory cache, now querying persistent storage."),yield t.indexedDBCache.containsKey(e)}catch(e){t.handleDatabaseAccessError(e)}return r})()}clearInMemory(){this.logger.verbose("Deleting in-memory keystore"),this.inMemoryCache.clear(),this.logger.verbose("In-memory keystore deleted")}clearPersistent(){var e=this;return il(function*(){try{e.logger.verbose("Deleting persistent keystore");var t=yield e.indexedDBCache.deleteDatabase();return t&&e.logger.verbose("Persistent keystore deleted"),t}catch(t){return e.handleDatabaseAccessError(t),!1}})()}}function cl(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function ll(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?cl(Object(r),!0).forEach(function(t){sl(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):cl(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function sl(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ul(e,t,r,n,o,i,a){try{var c=e[i](a),l=c.value}catch(e){return void r(e)}c.done?t(l):Promise.resolve(l).then(n,o)}function dl(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var i=e.apply(t,r);function a(e){ul(i,n,o,a,c,"next",e)}function c(e){ul(i,n,o,a,c,"throw",e)}a(void 0)})}}class hl{constructor(e,t,r){this.logger=e,function(e){if(!window)throw Ri(oi);if(!window.crypto)throw Ri(No);if(!e&&!window.crypto.subtle)throw Ri(No,"crypto_subtle_undefined")}(null!=r&&r),this.cache=new al(this.logger),this.performanceClient=t}createNewGuid(){return Ka()}base64Encode(e){return Sa(e)}base64Decode(e){return Aa(e)}base64UrlEncode(e){return ka(e)}encodeKid(e){return this.base64UrlEncode(JSON.stringify({kid:e}))}getPublicKeyThumbprint(e){var t=this;return dl(function*(){var r,n=null===(r=t.performanceClient)||void 0===r?void 0:r.startMeasurement(fr,e.correlationId),o=yield function(e,t){return Va.apply(this,arguments)}(hl.EXTRACTABLE,hl.POP_KEY_USAGES),i=yield Wa(o.publicKey),a=fl({e:i.e,kty:i.kty,n:i.n}),c=yield t.hashString(a),l=yield Wa(o.privateKey),s=yield function(e,t,r){return Ga.apply(this,arguments)}(l,!1,["sign"]);return yield t.cache.setItem(c,{privateKey:s,publicKey:o.publicKey,requestMethod:e.resourceRequestMethod,requestUri:e.resourceRequestUri}),n&&n.end({success:!0}),c})()}removeTokenBindingKey(e){var t=this;return dl(function*(){if(yield t.cache.removeItem(e),yield t.cache.containsKey(e))throw ze(Re)})()}clearKeystore(){var e=this;return dl(function*(){e.cache.clearInMemory();try{return yield e.cache.clearPersistent(),!0}catch(t){return t instanceof Error?e.logger.error("Clearing keystore failed with error: ".concat(t.message)):e.logger.error("Clearing keystore failed with unknown error"),!1}})()}signJwt(e,t,r,n){var o=this;return dl(function*(){var i,a=null===(i=o.performanceClient)||void 0===i?void 0:i.startMeasurement(pr,n),c=yield o.cache.getItem(t);if(!c)throw Ri(di);var l=yield Wa(c.publicKey),s=fl(l),u=ka(JSON.stringify({kid:t})),d=ka($c.getShrHeaderString(ll(ll({},null==r?void 0:r.header),{},{alg:l.alg,kid:u})));e.cnf={jwk:JSON.parse(s)};var h=ka(JSON.stringify(e)),f="".concat(d,".").concat(h),p=(new TextEncoder).encode(f),g=yield function(e,t){return Ja.apply(this,arguments)}(c.privateKey,p),m=Ia(new Uint8Array(g)),v="".concat(f,".").concat(m);return a&&a.end({success:!0}),v})()}hashString(e){return dl(function*(){return dc(e)})()}}function fl(e){return JSON.stringify(e,Object.keys(e).sort())}hl.POP_KEY_USAGES=["sign","verify"],hl.EXTRACTABLE=!0;var pl=(e,t,r,n,o)=>function(){r.trace("Executing function ".concat(t));var i=null==n?void 0:n.startMeasurement(t,o);if(o){var a=t+"CallCount";null==n||n.incrementFields({[a]:1},o)}try{var c=e(...arguments);return null==i||i.end({success:!0}),r.trace("Returning result from ".concat(t)),c}catch(e){r.trace("Error occurred in ".concat(t));try{r.trace(JSON.stringify(e))}catch(e){r.trace("Unable to print error message.")}throw null==i||i.end({success:!1},e),e}},gl=(e,t,r,n,o)=>function(){r.trace("Executing function ".concat(t));var i=null==n?void 0:n.startMeasurement(t,o);if(o){var a=t+"CallCount";null==n||n.incrementFields({[a]:1},o)}return null==n||n.setPreQueueTime(t,o),e(...arguments).then(e=>(r.trace("Returning result from ".concat(t)),null==i||i.end({success:!0}),e)).catch(e=>{r.trace("Error occurred in ".concat(t));try{r.trace(JSON.stringify(e))}catch(e){r.trace("Unable to print error message.")}throw null==i||i.end({success:!1},e),e})};function ml(e,t,r,n,o,i,a){try{var c=e[i](a),l=c.value}catch(e){return void r(e)}c.done?t(l):Promise.resolve(l).then(n,o)}function vl(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var i=e.apply(t,r);function a(e){ml(i,n,o,a,c,"next",e)}function c(e){ml(i,n,o,a,c,"throw",e)}a(void 0)})}}class yl{constructor(e,t,r,n){this.networkInterface=e,this.logger=t,this.performanceClient=r,this.correlationId=n}detectRegion(e,t){var r=this;return vl(function*(){var n;null===(n=r.performanceClient)||void 0===n||n.addQueueMeasurement(fn,r.correlationId);var o=e;if(o)t.region_source="3";else{var i=yl.IMDS_OPTIONS;try{var a=yield gl(r.getRegionFromIMDS.bind(r),pn,r.logger,r.performanceClient,r.correlationId)(c.IMDS_VERSION,i);if(200===a.status&&(o=a.body,t.region_source="4"),400===a.status){var l=yield gl(r.getCurrentVersion.bind(r),gn,r.logger,r.performanceClient,r.correlationId)(i);if(!l)return t.region_source="1",null;var s=yield gl(r.getRegionFromIMDS.bind(r),pn,r.logger,r.performanceClient,r.correlationId)(l,i);200===s.status&&(o=s.body,t.region_source="4")}}catch(e){return t.region_source="1",null}}return o||(t.region_source="1"),o||null})()}getRegionFromIMDS(e,t){var r=this;return vl(function*(){var n;return null===(n=r.performanceClient)||void 0===n||n.addQueueMeasurement(pn,r.correlationId),r.networkInterface.sendGetRequestAsync("".concat(c.IMDS_ENDPOINT,"?api-version=").concat(e,"&format=text"),t,c.IMDS_TIMEOUT)})()}getCurrentVersion(e){var t=this;return vl(function*(){var r;null===(r=t.performanceClient)||void 0===r||r.addQueueMeasurement(gn,t.correlationId);try{var n=yield t.networkInterface.sendGetRequestAsync("".concat(c.IMDS_ENDPOINT,"?format=json"),e);return 400===n.status&&n.body&&n.body["newest-versions"]&&n.body["newest-versions"].length>0?n.body["newest-versions"][0]:null}catch(e){return null}})()}}function bl(){return Math.round((new Date).getTime()/1e3)}function wl(e){return e.getTime()/1e3}function Cl(e){return e?new Date(1e3*Number(e)):new Date}function kl(e,t){var r=Number(e)||0;return bl()+t>r}function Il(e,t){var r=Number(e)+24*t*60*60*1e3;return Date.now()>r}function Sl(e,t,r,n,o){return{credentialType:O.ID_TOKEN,homeAccountId:e,environment:t,clientId:n,secret:r,realm:o,lastUpdatedAt:Date.now().toString()}}function Tl(e,t,r,n,o,i,a,c,l,s,u,d,h,f,p){var g,m,v={homeAccountId:e,credentialType:O.ACCESS_TOKEN,secret:r,cachedAt:bl().toString(),expiresOn:a.toString(),extendedExpiresOn:c.toString(),environment:t,clientId:n,realm:o,target:i,tokenType:u||j.BEARER,lastUpdatedAt:Date.now().toString()};if(d&&(v.userAssertionHash=d),s&&(v.refreshOn=s.toString()),f&&(v.requestedClaims=f,v.requestedClaimsHash=p),(null===(g=v.tokenType)||void 0===g?void 0:g.toLowerCase())!==j.BEARER.toLowerCase())switch(v.credentialType=O.ACCESS_TOKEN_WITH_AUTH_SCHEME,v.tokenType){case j.POP:var y=Lt(r,l);if(null==y||null===(m=y.cnf)||void 0===m||!m.kid)throw ze(Oe);v.keyId=y.cnf.kid;break;case j.SSH:v.keyId=h}return v}function Al(e,t,r,n,o,i,a){var c={credentialType:O.REFRESH_TOKEN,homeAccountId:e,environment:t,clientId:n,secret:r,lastUpdatedAt:Date.now().toString()};return i&&(c.userAssertionHash=i),o&&(c.familyId=o),a&&(c.expiresOn=a.toString()),c}function Pl(e){return e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")}function El(e){return!!e&&Pl(e)&&e.hasOwnProperty("realm")&&e.hasOwnProperty("target")&&(e.credentialType===O.ACCESS_TOKEN||e.credentialType===O.ACCESS_TOKEN_WITH_AUTH_SCHEME)}function Ol(e){return!!e&&Pl(e)&&e.credentialType===O.REFRESH_TOKEN}function _l(){return bl()+86400}function Rl(e,t,r){e.authorization_endpoint=t.authorization_endpoint,e.token_endpoint=t.token_endpoint,e.end_session_endpoint=t.end_session_endpoint,e.issuer=t.issuer,e.endpointsFromNetwork=r,e.jwks_uri=t.jwks_uri}function xl(e,t,r){e.aliases=t.aliases,e.preferred_cache=t.preferred_cache,e.preferred_network=t.preferred_network,e.aliasesFromNetwork=r}function Ml(e){return e.expiresAt<=bl()}function Nl(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Dl(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Nl(Object(r),!0).forEach(function(t){Ll(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Nl(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Ll(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ql(e,t,r,n,o,i,a){try{var c=e[i](a),l=c.value}catch(e){return void r(e)}c.done?t(l):Promise.resolve(l).then(n,o)}function jl(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var i=e.apply(t,r);function a(e){ql(i,n,o,a,c,"next",e)}function c(e){ql(i,n,o,a,c,"throw",e)}a(void 0)})}}yl.IMDS_OPTIONS={headers:{Metadata:"true"}};class Ul{constructor(e,t,r,n,o,i,a,c){this.canonicalAuthority=e,this._canonicalAuthority.validateAsUri(),this.networkInterface=t,this.cacheManager=r,this.authorityOptions=n,this.regionDiscoveryMetadata={region_used:void 0,region_source:void 0,region_outcome:void 0},this.logger=o,this.performanceClient=a,this.correlationId=i,this.managedIdentity=c||!1,this.regionDiscovery=new yl(t,this.logger,this.performanceClient,this.correlationId)}getAuthorityType(e){if(e.HostNameAndPort.endsWith(c.CIAM_AUTH_URL))return 3;var t=e.PathSegments;if(t.length)switch(t[0].toLowerCase()){case c.ADFS:return 1;case c.DSTS:return 2}return 0}get authorityType(){return this.getAuthorityType(this.canonicalAuthorityUrlComponents)}get protocolMode(){return this.authorityOptions.protocolMode}get options(){return this.authorityOptions}get canonicalAuthority(){return this._canonicalAuthority.urlString}set canonicalAuthority(e){this._canonicalAuthority=new Kt(e),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null}get canonicalAuthorityUrlComponents(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents}get hostnameAndPort(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()}get tenant(){return this.canonicalAuthorityUrlComponents.PathSegments[0]}get authorizationEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.authorization_endpoint);throw ze(Z)}get tokenEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint);throw ze(Z)}get deviceCodeEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));throw ze(Z)}get endSessionEndpoint(){if(this.discoveryComplete()){if(!this.metadata.end_session_endpoint)throw ze(xe);return this.replacePath(this.metadata.end_session_endpoint)}throw ze(Z)}get selfSignedJwtAudience(){if(this.discoveryComplete())return this.replacePath(this.metadata.issuer);throw ze(Z)}get jwksUri(){if(this.discoveryComplete())return this.replacePath(this.metadata.jwks_uri);throw ze(Z)}canReplaceTenant(e){return 1===e.PathSegments.length&&!Ul.reservedTenantDomains.has(e.PathSegments[0])&&0===this.getAuthorityType(e)&&this.protocolMode!==H}replaceTenant(e){return e.replace(/{tenant}|{tenantid}/g,this.tenant)}replacePath(e){var t=e,r=new Kt(this.metadata.canonical_authority).getUrlComponents(),n=r.PathSegments;return this.canonicalAuthorityUrlComponents.PathSegments.forEach((e,o)=>{var i=n[o];if(0===o&&this.canReplaceTenant(r)){var a=new Kt(this.metadata.authorization_endpoint).getUrlComponents().PathSegments[0];i!==a&&(this.logger.verbose("Replacing tenant domain name ".concat(i," with id ").concat(a)),i=a)}e!==i&&(t=t.replace("/".concat(i,"/"),"/".concat(e,"/")))}),this.replaceTenant(t)}get defaultOpenIdConfigurationEndpoint(){var e=this.hostnameAndPort;return this.canonicalAuthority.endsWith("v2.0/")||1===this.authorityType||this.protocolMode===H&&!this.isAliasOfKnownMicrosoftAuthority(e)?"".concat(this.canonicalAuthority,".well-known/openid-configuration"):"".concat(this.canonicalAuthority,"v2.0/.well-known/openid-configuration")}discoveryComplete(){return!!this.metadata}resolveEndpointsAsync(){var e=this;return jl(function*(){var t,r;null===(t=e.performanceClient)||void 0===t||t.addQueueMeasurement(cn,e.correlationId);var n=e.getCurrentMetadataEntity(),o=yield gl(e.updateCloudDiscoveryMetadata.bind(e),sn,e.logger,e.performanceClient,e.correlationId)(n);e.canonicalAuthority=e.canonicalAuthority.replace(e.hostnameAndPort,n.preferred_network);var i=yield gl(e.updateEndpointMetadata.bind(e),dn,e.logger,e.performanceClient,e.correlationId)(n);e.updateCachedMetadata(n,o,{source:i}),null===(r=e.performanceClient)||void 0===r||r.addFields({cloudDiscoverySource:o,authorityEndpointSource:i},e.correlationId)})()}getCurrentMetadataEntity(){var e=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort);return e||(e={aliases:[],preferred_cache:this.hostnameAndPort,preferred_network:this.hostnameAndPort,canonical_authority:this.canonicalAuthority,authorization_endpoint:"",token_endpoint:"",end_session_endpoint:"",issuer:"",aliasesFromNetwork:!1,endpointsFromNetwork:!1,expiresAt:_l(),jwks_uri:""}),e}updateCachedMetadata(e,t,r){t!==N&&(null==r?void 0:r.source)!==N&&(e.expiresAt=_l(),e.canonical_authority=this.canonicalAuthority);var n=this.cacheManager.generateAuthorityMetadataCacheKey(e.preferred_cache);this.cacheManager.setAuthorityMetadata(n,e),this.metadata=e}updateEndpointMetadata(e){var t=this;return jl(function*(){var r;null===(r=t.performanceClient)||void 0===r||r.addQueueMeasurement(dn,t.correlationId);var n=t.updateEndpointMetadataFromLocalSources(e);if(n){var o;if(n.source===L&&null!==(o=t.authorityOptions.azureRegionConfiguration)&&void 0!==o&&o.azureRegion&&n.metadata){var i=yield gl(t.updateMetadataWithRegionalInformation.bind(t),hn,t.logger,t.performanceClient,t.correlationId)(n.metadata);Rl(e,i,!1),e.canonical_authority=t.canonicalAuthority}return n.source}var a,c=yield gl(t.getEndpointMetadataFromNetwork.bind(t),un,t.logger,t.performanceClient,t.correlationId)();if(c)return null!==(a=t.authorityOptions.azureRegionConfiguration)&&void 0!==a&&a.azureRegion&&(c=yield gl(t.updateMetadataWithRegionalInformation.bind(t),hn,t.logger,t.performanceClient,t.correlationId)(c)),Rl(e,c,!0),D;throw ze(te,t.defaultOpenIdConfigurationEndpoint)})()}updateEndpointMetadataFromLocalSources(e){this.logger.verbose("Attempting to get endpoint metadata from authority configuration");var t=this.getEndpointMetadataFromConfig();if(t)return this.logger.verbose("Found endpoint metadata in authority configuration"),Rl(e,t,!1),{source:M};if(this.logger.verbose("Did not find endpoint metadata in the config... Attempting to get endpoint metadata from the hardcoded values."),this.authorityOptions.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get endpoint metadata from the network metadata cache.");else{var r=this.getEndpointMetadataFromHardcodedValues();if(r)return Rl(e,r,!1),{source:L,metadata:r};this.logger.verbose("Did not find endpoint metadata in hardcoded values... Attempting to get endpoint metadata from the network metadata cache.")}var n=Ml(e);return this.isAuthoritySameType(e)&&e.endpointsFromNetwork&&!n?(this.logger.verbose("Found endpoint metadata in the cache."),{source:N}):(n&&this.logger.verbose("The metadata entity is expired."),null)}isAuthoritySameType(e){return new Kt(e.canonical_authority).getUrlComponents().PathSegments.length===this.canonicalAuthorityUrlComponents.PathSegments.length}getEndpointMetadataFromConfig(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch(e){throw wt(at)}return null}getEndpointMetadataFromNetwork(){var e=this;return jl(function*(){var t;null===(t=e.performanceClient)||void 0===t||t.addQueueMeasurement(un,e.correlationId);var r=e.defaultOpenIdConfigurationEndpoint;e.logger.verbose("Authority.getEndpointMetadataFromNetwork: attempting to retrieve OAuth endpoints from ".concat(r));try{var n=yield e.networkInterface.sendGetRequestAsync(r,{}),o=function(e){return e.hasOwnProperty("authorization_endpoint")&&e.hasOwnProperty("token_endpoint")&&e.hasOwnProperty("issuer")&&e.hasOwnProperty("jwks_uri")}(n.body);return o?n.body:(e.logger.verbose("Authority.getEndpointMetadataFromNetwork: could not parse response as OpenID configuration"),null)}catch(t){return e.logger.verbose("Authority.getEndpointMetadataFromNetwork: ".concat(t)),null}})()}getEndpointMetadataFromHardcodedValues(){return this.hostnameAndPort in Vt?Vt[this.hostnameAndPort]:null}updateMetadataWithRegionalInformation(e){var t=this;return jl(function*(){var r,n;null===(r=t.performanceClient)||void 0===r||r.addQueueMeasurement(hn,t.correlationId);var o=null===(n=t.authorityOptions.azureRegionConfiguration)||void 0===n?void 0:n.azureRegion;if(o){var i;if(o!==c.AZURE_REGION_AUTO_DISCOVER_FLAG)return t.regionDiscoveryMetadata.region_outcome="2",t.regionDiscoveryMetadata.region_used=o,Ul.replaceWithRegionalInformation(e,o);var a=yield gl(t.regionDiscovery.detectRegion.bind(t.regionDiscovery),fn,t.logger,t.performanceClient,t.correlationId)(null===(i=t.authorityOptions.azureRegionConfiguration)||void 0===i?void 0:i.environmentRegion,t.regionDiscoveryMetadata);if(a)return t.regionDiscoveryMetadata.region_outcome="4",t.regionDiscoveryMetadata.region_used=a,Ul.replaceWithRegionalInformation(e,a);t.regionDiscoveryMetadata.region_outcome="5"}return e})()}updateCloudDiscoveryMetadata(e){var t=this;return jl(function*(){var r;null===(r=t.performanceClient)||void 0===r||r.addQueueMeasurement(sn,t.correlationId);var n=t.updateCloudDiscoveryMetadataFromLocalSources(e);if(n)return n;var o=yield gl(t.getCloudDiscoveryMetadataFromNetwork.bind(t),ln,t.logger,t.performanceClient,t.correlationId)();if(o)return xl(e,o,!0),D;throw wt(ct)})()}updateCloudDiscoveryMetadataFromLocalSources(e){this.logger.verbose("Attempting to get cloud discovery metadata  from authority configuration"),this.logger.verbosePii("Known Authorities: ".concat(this.authorityOptions.knownAuthorities||c.NOT_APPLICABLE)),this.logger.verbosePii("Authority Metadata: ".concat(this.authorityOptions.authorityMetadata||c.NOT_APPLICABLE)),this.logger.verbosePii("Canonical Authority: ".concat(e.canonical_authority||c.NOT_APPLICABLE));var t,r=this.getCloudDiscoveryMetadataFromConfig();if(r)return this.logger.verbose("Found cloud discovery metadata in authority configuration"),xl(e,r,!1),M;if(this.logger.verbose("Did not find cloud discovery metadata in the config... Attempting to get cloud discovery metadata from the hardcoded values."),this.options.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded cloud discovery metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get cloud discovery metadata from the network metadata cache.");else{var n=(t=this.hostnameAndPort,Jt(Wt.metadata,t));if(n)return this.logger.verbose("Found cloud discovery metadata from hardcoded values."),xl(e,n,!1),L;this.logger.verbose("Did not find cloud discovery metadata in hardcoded values... Attempting to get cloud discovery metadata from the network metadata cache.")}var o=Ml(e);return this.isAuthoritySameType(e)&&e.aliasesFromNetwork&&!o?(this.logger.verbose("Found cloud discovery metadata in the cache."),N):(o&&this.logger.verbose("The metadata entity is expired."),null)}getCloudDiscoveryMetadataFromConfig(){if(3===this.authorityType)return this.logger.verbose("CIAM authorities do not support cloud discovery metadata, generate the aliases from authority host."),Ul.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort);if(this.authorityOptions.cloudDiscoveryMetadata){this.logger.verbose("The cloud discovery metadata has been provided as a network response, in the config.");try{this.logger.verbose("Attempting to parse the cloud discovery metadata.");var e=Jt(JSON.parse(this.authorityOptions.cloudDiscoveryMetadata).metadata,this.hostnameAndPort);if(this.logger.verbose("Parsed the cloud discovery metadata."),e)return this.logger.verbose("There is returnable metadata attached to the parsed cloud discovery metadata."),e;this.logger.verbose("There is no metadata attached to the parsed cloud discovery metadata.")}catch(e){throw this.logger.verbose("Unable to parse the cloud discovery metadata. Throwing Invalid Cloud Discovery Metadata Error."),wt(it)}}return this.isInKnownAuthorities()?(this.logger.verbose("The host is included in knownAuthorities. Creating new cloud discovery metadata from the host."),Ul.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)):null}getCloudDiscoveryMetadataFromNetwork(){var e=this;return jl(function*(){var t;null===(t=e.performanceClient)||void 0===t||t.addQueueMeasurement(ln,e.correlationId);var r="".concat(c.AAD_INSTANCE_DISCOVERY_ENDPT).concat(e.canonicalAuthority,"oauth2/v2.0/authorize"),n=null;try{var o,i,a=yield e.networkInterface.sendGetRequestAsync(r,{});if(function(e){return e.hasOwnProperty("tenant_discovery_endpoint")&&e.hasOwnProperty("metadata")}(a.body))i=(o=a.body).metadata,e.logger.verbosePii("tenant_discovery_endpoint is: ".concat(o.tenant_discovery_endpoint));else{if(!function(e){return e.hasOwnProperty("error")&&e.hasOwnProperty("error_description")}(a.body))return e.logger.error("AAD did not return a CloudInstanceDiscoveryResponse or CloudInstanceDiscoveryErrorResponse"),null;if(e.logger.warning("A CloudInstanceDiscoveryErrorResponse was returned. The cloud instance discovery network request's status code is: ".concat(a.status)),(o=a.body).error===c.INVALID_INSTANCE)return e.logger.error("The CloudInstanceDiscoveryErrorResponse error is invalid_instance."),null;e.logger.warning("The CloudInstanceDiscoveryErrorResponse error is ".concat(o.error)),e.logger.warning("The CloudInstanceDiscoveryErrorResponse error description is ".concat(o.error_description)),e.logger.warning("Setting the value of the CloudInstanceDiscoveryMetadata (returned from the network) to []"),i=[]}e.logger.verbose("Attempting to find a match between the developer's authority and the CloudInstanceDiscoveryMetadata returned from the network request."),n=Jt(i,e.hostnameAndPort)}catch(t){if(t instanceof Q)e.logger.error("There was a network error while attempting to get the cloud discovery instance metadata.\nError: ".concat(t.errorCode,"\nError Description: ").concat(t.errorMessage));else{var l=t;e.logger.error("A non-MSALJS error was thrown while attempting to get the cloud instance discovery metadata.\nError: ".concat(l.name,"\nError Description: ").concat(l.message))}return null}return n||(e.logger.warning("The developer's authority was not found within the CloudInstanceDiscoveryMetadata returned from the network request."),e.logger.verbose("Creating custom Authority for custom domain scenario."),n=Ul.createCloudDiscoveryMetadataFromHost(e.hostnameAndPort)),n})()}isInKnownAuthorities(){return this.authorityOptions.knownAuthorities.filter(e=>e&&Kt.getDomainFromUrl(e).toLowerCase()===this.hostnameAndPort).length>0}static generateAuthority(e,t){var r;if(t&&t.azureCloudInstance!==B){var n=t.tenant?t.tenant:c.DEFAULT_COMMON_TENANT;r="".concat(t.azureCloudInstance,"/").concat(n,"/")}return r||e}static createCloudDiscoveryMetadataFromHost(e){return{preferred_network:e,preferred_cache:e,aliases:[e]}}getPreferredCache(){if(this.managedIdentity)return c.DEFAULT_AUTHORITY_HOST;if(this.discoveryComplete())return this.metadata.preferred_cache;throw ze(Z)}isAlias(e){return this.metadata.aliases.indexOf(e)>-1}isAliasOfKnownMicrosoftAuthority(e){return Qt.has(e)}static isPublicCloudAuthority(e){return c.KNOWN_PUBLIC_CLOUDS.indexOf(e)>=0}static buildRegionalAuthorityString(e,t,r){var n=new Kt(e);n.validateAsUri();var o=n.getUrlComponents(),i="".concat(t,".").concat(o.HostNameAndPort);this.isPublicCloudAuthority(o.HostNameAndPort)&&(i="".concat(t,".").concat(c.REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX));var a=Kt.constructAuthorityUriFromObject(Dl(Dl({},n.getUrlComponents()),{},{HostNameAndPort:i})).urlString;return r?"".concat(a,"?").concat(r):a}static replaceWithRegionalInformation(e,t){var r=Dl({},e);return r.authorization_endpoint=Ul.buildRegionalAuthorityString(r.authorization_endpoint,t),r.token_endpoint=Ul.buildRegionalAuthorityString(r.token_endpoint,t),r.end_session_endpoint&&(r.end_session_endpoint=Ul.buildRegionalAuthorityString(r.end_session_endpoint,t)),r}static transformCIAMAuthority(e){var t=e,r=new Kt(e).getUrlComponents();if(0===r.PathSegments.length&&r.HostNameAndPort.endsWith(c.CIAM_AUTH_URL)){var n=r.HostNameAndPort.split(".")[0];t="".concat(t).concat(n).concat(c.AAD_TENANT_DOMAIN_SUFFIX)}return t}}function Fl(e){return e.endsWith(c.FORWARD_SLASH)?e:"".concat(e).concat(c.FORWARD_SLASH)}Ul.reservedTenantDomains=new Set(["{tenant}","{tenantid}",v,b,y]);var Hl="no_tokens_found",zl="native_account_unavailable",Bl="refresh_token_expired",Kl="ux_not_allowed",Vl="bad_token",Wl=["interaction_required","consent_required","login_required",Vl,Kl],Ql=["message_only","additional_action","basic_action","user_password_expired","consent_required","bad_token"],Gl={[Hl]:"No refresh token found in the cache. Please sign-in.",[zl]:"The requested account is not available in the native broker. It may have been deleted or logged out. Please sign-in again using an interactive API.",[Bl]:"Refresh token has expired.",[Vl]:"Identity provider returned bad_token due to an expired or invalid refresh token. Please invoke an interactive API to resolve.",[Kl]:"`canShowUI` flag in Edge was set to false. User interaction required on web page. Please invoke an interactive API to resolve."};class Jl extends Q{constructor(e,t,r,n,o,i,a,l){super(e,t,r),Object.setPrototypeOf(this,Jl.prototype),this.timestamp=n||c.EMPTY_STRING,this.traceId=o||c.EMPTY_STRING,this.correlationId=i||c.EMPTY_STRING,this.claims=a||c.EMPTY_STRING,this.name="InteractionRequiredAuthError",this.errorNo=l}}function Yl(e,t,r){var n=!!e&&Wl.indexOf(e)>-1,o=!!r&&Ql.indexOf(r)>-1,i=!!t&&Wl.some(e=>t.indexOf(e)>-1);return n||i||o}function $l(e){return new Jl(e,Gl[e])}function Xl(e,t,r){var n;return{clientId:e,authority:t.authority,scopes:t.scopes,homeAccountIdentifier:r,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid,embeddedClientId:t.embeddedClientId||(null===(n=t.tokenBodyParameters)||void 0===n?void 0:n.clientId)}}function Zl(e,t,r,n,o,i,a){try{var c=e[i](a),l=c.value}catch(e){return void r(e)}c.done?t(l):Promise.resolve(l).then(n,o)}var es="None";class ts{initialize(){return Promise.resolve()}getItem(e){for(var t="".concat(encodeURIComponent(e)),r=document.cookie.split(";"),n=0;n<r.length;n++){var o=r[n],[i,...a]=decodeURIComponent(o).trim().split("="),c=a.join("=");if(i===t)return c}return""}getUserData(){throw ze(qe)}setItem(e,t,r){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"Lax",i="".concat(encodeURIComponent(e),"=").concat(encodeURIComponent(t),";path=/;SameSite=").concat(o,";");if(r){var a=function(e){var t=new Date;return new Date(t.getTime()+864e5*e).toUTCString()}(r);i+="expires=".concat(a,";")}(n||o===es)&&(i+="Secure;"),document.cookie=i}setUserData(){return(e=function*(){return Promise.reject(ze(qe))},function(){var t=this,r=arguments;return new Promise(function(n,o){var i=e.apply(t,r);function a(e){Zl(i,n,o,a,c,"next",e)}function c(e){Zl(i,n,o,a,c,"throw",e)}a(void 0)})})();var e}removeItem(e){this.setItem(e,"",-1)}getKeys(){var e=document.cookie.split(";"),t=[];return e.forEach(e=>{var r=decodeURIComponent(e).trim().split("=");t.push(r[0])}),t}containsKey(e){return this.getKeys().includes(e)}decryptData(){return Promise.resolve(null)}}function rs(e,t){var r=e.getItem(Uc(t));return r?JSON.parse(r):[]}function ns(e,t,r){var n=t.getItem(Fc(e,r));if(n){var o=JSON.parse(n);if(o&&o.hasOwnProperty("idToken")&&o.hasOwnProperty("accessToken")&&o.hasOwnProperty("refreshToken"))return o}return{idToken:[],accessToken:[],refreshToken:[]}}function os(e){return e.hasOwnProperty("id")&&e.hasOwnProperty("nonce")&&e.hasOwnProperty("data")}function is(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function as(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?is(Object(r),!0).forEach(function(t){cs(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):is(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function cs(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ls(e,t,r,n,o,i,a){try{var c=e[i](a),l=c.value}catch(e){return void r(e)}c.done?t(l):Promise.resolve(l).then(n,o)}function ss(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var i=e.apply(t,r);function a(e){ls(i,n,o,a,c,"next",e)}function c(e){ls(i,n,o,a,c,"throw",e)}a(void 0)})}}var us="msal.cache.encryption";class ds{constructor(e,t,r){if(!window.localStorage)throw yc(fc);this.memoryStorage=new nl,this.initialized=!1,this.clientId=e,this.logger=t,this.performanceClient=r,this.broadcast=new BroadcastChannel("msal.broadcast.cache")}initialize(e){var t=this;return ss(function*(){var r=new ts,n=r.getItem(us),o={key:"",id:""};if(n)try{o=JSON.parse(n)}catch(e){}if(o.key&&o.id){var i=pl(Pa,Mn,t.logger,t.performanceClient,e)(o.key);t.encryptionCookie={id:o.id,key:yield gl(nc,Rn,t.logger,t.performanceClient,e)(i)}}else{var a=Ka(),c=yield gl(tc,xn,t.logger,t.performanceClient,e)(),l=pl(Ia,Nn,t.logger,t.performanceClient,e)(new Uint8Array(c));t.encryptionCookie={id:a,key:yield gl(nc,Rn,t.logger,t.performanceClient,e)(c)};var s={id:a,key:l};r.setItem(us,JSON.stringify(s),0,!0,es)}yield gl(t.importExistingCache.bind(t),In,t.logger,t.performanceClient,e)(e),t.broadcast.addEventListener("message",t.updateCache.bind(t)),t.initialized=!0})()}getItem(e){return window.localStorage.getItem(e)}getUserData(e){if(!this.initialized)throw Ri(wi);return this.memoryStorage.getItem(e)}decryptData(e,t,r){var n=this;return ss(function*(){if(!n.initialized||!n.encryptionCookie)throw Ri(wi);if(t.id!==n.encryptionCookie.id)return n.performanceClient.incrementFields({encryptedCacheExpiredCount:1},r),null;var o=yield gl(sc,Ln,n.logger,n.performanceClient,r)(n.encryptionCookie.key,t.nonce,n.getContext(e),t.data);if(!o)return null;try{return as(as({},JSON.parse(o)),{},{lastUpdatedAt:t.lastUpdatedAt})}catch(e){return n.performanceClient.incrementFields({encryptedCacheCorruptionCount:1},r),null}})()}setItem(e,t){window.localStorage.setItem(e,t)}setUserData(e,t,r,n,o){var i=this;return ss(function*(){if(!i.initialized||!i.encryptionCookie)throw Ri(wi);if(o)i.setItem(e,t);else{var{data:a,nonce:c}=yield gl(cc,Dn,i.logger,i.performanceClient,r)(i.encryptionCookie.key,t,i.getContext(e)),l={id:i.encryptionCookie.id,nonce:c,data:a,lastUpdatedAt:n};i.setItem(e,JSON.stringify(l))}i.memoryStorage.setItem(e,t),i.broadcast.postMessage({key:e,value:t,context:i.getContext(e)})})()}removeItem(e){this.memoryStorage.containsKey(e)&&(this.memoryStorage.removeItem(e),this.broadcast.postMessage({key:e,value:null,context:this.getContext(e)})),window.localStorage.removeItem(e)}getKeys(){return Object.keys(window.localStorage)}containsKey(e){return window.localStorage.hasOwnProperty(e)}clear(){this.memoryStorage.clear(),rs(this).forEach(e=>this.removeItem(e));var e=ns(this.clientId,this);e.idToken.forEach(e=>this.removeItem(e)),e.accessToken.forEach(e=>this.removeItem(e)),e.refreshToken.forEach(e=>this.removeItem(e)),this.getKeys().forEach(e=>{(e.startsWith(xc)||-1!==e.indexOf(this.clientId))&&this.removeItem(e)})}importExistingCache(e){var t=this;return ss(function*(){if(t.encryptionCookie){var r=rs(t);(r=yield t.importArray(r,e)).length?t.setItem(Uc(),JSON.stringify(r)):t.removeItem(Uc());var n=ns(t.clientId,t);n.idToken=yield t.importArray(n.idToken,e),n.accessToken=yield t.importArray(n.accessToken,e),n.refreshToken=yield t.importArray(n.refreshToken,e),n.idToken.length||n.accessToken.length||n.refreshToken.length?t.setItem(Fc(t.clientId),JSON.stringify(n)):t.removeItem(Fc(t.clientId))}})()}getItemFromEncryptedCache(e,t){var r=this;return ss(function*(){if(!r.encryptionCookie)return null;var n,o=r.getItem(e);if(!o)return null;try{n=JSON.parse(o)}catch(e){return null}return os(n)?n.id!==r.encryptionCookie.id?(r.performanceClient.incrementFields({encryptedCacheExpiredCount:1},t),null):(r.performanceClient.incrementFields({encryptedCacheCount:1},t),gl(sc,Ln,r.logger,r.performanceClient,t)(r.encryptionCookie.key,n.nonce,r.getContext(e),n.data)):(r.performanceClient.incrementFields({unencryptedCacheCount:1},t),o)})()}importArray(e,t){var r=this;return ss(function*(){var n=[],o=[];return e.forEach(e=>{var i=r.getItemFromEncryptedCache(e,t).then(t=>{t?(r.memoryStorage.setItem(e,t),n.push(e)):r.removeItem(e)});o.push(i)}),yield Promise.all(o),n})()}getContext(e){var t="";return e.includes(this.clientId)&&(t=this.clientId),t}updateCache(e){this.logger.trace("Updating internal cache from broadcast event");var t=this.performanceClient.startMeasurement(Tn);t.add({isBackground:!0});var{key:r,value:n,context:o}=e.data;return r?o&&o!==this.clientId?(this.logger.trace("Ignoring broadcast event from clientId: ".concat(o)),void t.end({success:!1,errorCode:"contextMismatch"})):(n?(this.memoryStorage.setItem(r,n),this.logger.verbose("Updated item in internal cache")):(this.memoryStorage.removeItem(r),this.logger.verbose("Removed item from internal cache")),void t.end({success:!0})):(this.logger.error("Broadcast event missing key"),void t.end({success:!1,errorCode:"noKey"}))}}function hs(e,t,r,n,o,i,a){try{var c=e[i](a),l=c.value}catch(e){return void r(e)}c.done?t(l):Promise.resolve(l).then(n,o)}function fs(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var i=e.apply(t,r);function a(e){hs(i,n,o,a,c,"next",e)}function c(e){hs(i,n,o,a,c,"throw",e)}a(void 0)})}}class ps{constructor(){if(!window.sessionStorage)throw yc(fc)}initialize(){return fs(function*(){})()}getItem(e){return window.sessionStorage.getItem(e)}getUserData(e){return this.getItem(e)}setItem(e,t){window.sessionStorage.setItem(e,t)}setUserData(e,t){var r=this;return fs(function*(){r.setItem(e,t)})()}removeItem(e){window.sessionStorage.removeItem(e)}getKeys(){return Object.keys(window.sessionStorage)}containsKey(e){return window.sessionStorage.hasOwnProperty(e)}decryptData(){return Promise.resolve(null)}}var gs="msal:initializeEnd",ms="msal:accountAdded",vs="msal:accountRemoved",ys="msal:activeAccountChanged",bs="msal:loginStart",ws="msal:loginSuccess",Cs="msal:loginFailure",ks="msal:acquireTokenStart",Is="msal:acquireTokenSuccess",Ss="msal:acquireTokenFailure",Ts="msal:acquireTokenByCodeFailure",As="msal:handleRedirectEnd",Ps="msal:popupOpened",Es="msal:logoutStart",Os="msal:logoutSuccess",_s="msal:logoutFailure",Rs="msal:logoutEnd";function xs(e,t){var r=e.indexOf(t);r>-1&&e.splice(r,1)}function Ms(e,t,r,n,o,i,a){try{var c=e[i](a),l=c.value}catch(e){return void r(e)}c.done?t(l):Promise.resolve(l).then(n,o)}function Ns(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var i=e.apply(t,r);function a(e){Ms(i,n,o,a,c,"next",e)}function c(e){Ms(i,n,o,a,c,"throw",e)}a(void 0)})}}class Ds extends ir{constructor(e,t,r,n,o,i,a){super(e,r,n,o,a),this.cacheConfig=t,this.logger=n,this.internalStorage=new nl,this.browserStorage=Ls(e,t.cacheLocation,n,o),this.temporaryCacheStorage=Ls(e,t.temporaryCacheLocation,n,o),this.cookieStorage=new ts,this.eventHandler=i}initialize(e){var t=this;return Ns(function*(){t.performanceClient.addFields({cacheLocation:t.cacheConfig.cacheLocation,cacheRetentionDays:t.cacheConfig.cacheRetentionDays},e),yield t.browserStorage.initialize(e),yield t.migrateExistingCache(e),t.trackVersionChanges(e)})()}migrateExistingCache(e){var t=this;return Ns(function*(){var r=rs(t.browserStorage),n=ns(t.clientId,t.browserStorage);t.performanceClient.addFields({preMigrateAcntCount:r.length,preMigrateATCount:n.accessToken.length,preMigrateITCount:n.idToken.length,preMigrateRTCount:n.refreshToken.length},e);for(var o=0;o<2;o++){var i=o;yield t.removeStaleAccounts(o,i,e)}for(var a=0;a<2;a++){var c=a;yield t.migrateIdTokens(a,c,e)}for(var l=t.getKMSIValues(),s=0;s<2;s++)yield t.migrateAccessTokens(s,l,e),yield t.migrateRefreshTokens(s,l,e);r=rs(t.browserStorage),n=ns(t.clientId,t.browserStorage),t.performanceClient.addFields({postMigrateAcntCount:r.length,postMigrateATCount:n.accessToken.length,postMigrateITCount:n.idToken.length,postMigrateRTCount:n.refreshToken.length},e)})()}updateOldEntry(e,t){var r=this;return Ns(function*(){var n=r.browserStorage.getItem(e),o=r.validateAndParseJson(n||"");if(!o)return r.browserStorage.removeItem(e),null;if(o.lastUpdatedAt){if(Il(o.lastUpdatedAt,r.cacheConfig.cacheRetentionDays))return r.browserStorage.removeItem(e),r.performanceClient.incrementFields({expiredCacheRemovedCount:1},t),null}else o.lastUpdatedAt=Date.now().toString(),r.setItem(e,JSON.stringify(o),t);var i=os(o)?yield r.browserStorage.decryptData(e,o,t):o;return i&&Pl(i)?(El(i)||Ol(i))&&i.expiresOn&&kl(i.expiresOn,300)?(r.browserStorage.removeItem(e),r.performanceClient.incrementFields({expiredCacheRemovedCount:1},t),null):i:(r.performanceClient.incrementFields({invalidCacheCount:1},t),null)})()}removeStaleAccounts(e,t,r){var n=this;return Ns(function*(){var o=rs(n.browserStorage,e);if(0!==o.length){for(var i of[...o]){n.performanceClient.incrementFields({oldAcntCount:1},r);var a=n.browserStorage.getItem(i),c=n.validateAndParseJson(a||"");c?c.lastUpdatedAt?Il(c.lastUpdatedAt,n.cacheConfig.cacheRetentionDays)&&(yield n.removeAccountOldSchema(i,c,t,r),xs(o,i)):(c.lastUpdatedAt=Date.now().toString(),n.setItem(i,JSON.stringify(c),r)):xs(o,i)}n.setAccountKeys(o,r,e)}})()}removeAccountOldSchema(e,t,r,n){var o=this;return Ns(function*(){var i=os(t)?yield o.browserStorage.decryptData(e,t,n):t,a=null==i?void 0:i.homeAccountId;if(a){var c=o.getTokenKeys(r);[...c.idToken].filter(e=>e.includes(a)).forEach(e=>{o.browserStorage.removeItem(e),xs(c.idToken,e)}),[...c.accessToken].filter(e=>e.includes(a)).forEach(e=>{o.browserStorage.removeItem(e),xs(c.accessToken,e)}),[...c.refreshToken].filter(e=>e.includes(a)).forEach(e=>{o.browserStorage.removeItem(e),xs(c.refreshToken,e)}),o.setTokenKeys(c,n,r)}o.performanceClient.incrementFields({expiredAcntRemovedCount:1},n),o.browserStorage.removeItem(e)})()}getKMSIValues(){var e={},t=this.getTokenKeys().idToken;for(var r of t){var n=this.browserStorage.getUserData(r);if(n){var o=JSON.parse(n),i=Lt(o.secret,Aa);i&&(e[o.homeAccountId]=qt(i))}}return e}migrateIdTokens(e,t,r){var n=this;return Ns(function*(){var o=ns(n.clientId,n.browserStorage,e);if(0!==o.idToken.length){var i=ns(n.clientId,n.browserStorage,2),a=rs(n.browserStorage),c=rs(n.browserStorage,t),l=function*(){n.performanceClient.incrementFields({oldITCount:1},r);var e=yield n.updateOldEntry(s,r);if(!e)return xs(o.idToken,s),0;var t=a.find(t=>t.includes(e.homeAccountId)),l=c.find(t=>t.includes(e.homeAccountId)),u=null;if(t)u=n.getAccount(t,r);else if(l){var d=n.browserStorage.getItem(l),h=n.validateAndParseJson(d||"");u=h&&os(h)?yield n.browserStorage.decryptData(l,h,r):h}if(!u)return n.performanceClient.incrementFields({skipITMigrateCount:1},r),0;var f=Lt(e.secret,Aa),p=n.generateCredentialKey(e),g=n.getIdTokenCredential(p,r),m=Object.keys(f).includes("signin_state"),v=g&&Object.keys(Lt(g.secret,Aa)||{}).includes("signin_state");if(!g||e.lastUpdatedAt>g.lastUpdatedAt&&(m||!v)){var y=u.tenantProfiles||[],b=Nt(f)||u.realm;if(b&&!y.find(e=>e.tenantId===b)){var w=xt(u.homeAccountId,u.localAccountId,b,f);y.push(w)}u.tenantProfiles=y;var C=n.generateAccountKey(Dt.getAccountInfo(u)),k=qt(f);yield n.setUserData(C,JSON.stringify(u),r,u.lastUpdatedAt,k),a.includes(C)||a.push(C),yield n.setUserData(p,JSON.stringify(e),r,e.lastUpdatedAt,k),n.performanceClient.incrementFields({migratedITCount:1},r),i.idToken.push(p)}};for(var s of[...o.idToken])yield*l();n.setTokenKeys(o,r,e),n.setTokenKeys(i,r),n.setAccountKeys(a,r)}})()}migrateAccessTokens(e,t,r){var n=this;return Ns(function*(){var o=ns(n.clientId,n.browserStorage,e);if(0!==o.accessToken.length){var i=ns(n.clientId,n.browserStorage,2);for(var a of[...o.accessToken]){n.performanceClient.incrementFields({oldATCount:1},r);var c=yield n.updateOldEntry(a,r);if(c)if(Object.keys(t).includes(c.homeAccountId)){var l=n.generateCredentialKey(c),s=t[c.homeAccountId];if(i.accessToken.includes(l)){var u=n.getAccessTokenCredential(l,r);(!u||c.lastUpdatedAt>u.lastUpdatedAt)&&(yield n.setUserData(l,JSON.stringify(c),r,c.lastUpdatedAt,s),n.performanceClient.incrementFields({migratedATCount:1},r))}else yield n.setUserData(l,JSON.stringify(c),r,c.lastUpdatedAt,s),n.performanceClient.incrementFields({migratedATCount:1},r),i.accessToken.push(l)}else n.performanceClient.incrementFields({skipATMigrateCount:1},r);else xs(o.accessToken,a)}n.setTokenKeys(o,r,e),n.setTokenKeys(i,r)}})()}migrateRefreshTokens(e,t,r){var n=this;return Ns(function*(){var o=ns(n.clientId,n.browserStorage,e);if(0!==o.refreshToken.length){var i=ns(n.clientId,n.browserStorage,2);for(var a of[...o.refreshToken]){n.performanceClient.incrementFields({oldRTCount:1},r);var c=yield n.updateOldEntry(a,r);if(c)if(Object.keys(t).includes(c.homeAccountId)){var l=n.generateCredentialKey(c),s=t[c.homeAccountId];if(i.refreshToken.includes(l)){var u=n.getRefreshTokenCredential(l,r);(!u||c.lastUpdatedAt>u.lastUpdatedAt)&&(yield n.setUserData(l,JSON.stringify(c),r,c.lastUpdatedAt,s),n.performanceClient.incrementFields({migratedRTCount:1},r))}else yield n.setUserData(l,JSON.stringify(c),r,c.lastUpdatedAt,s),n.performanceClient.incrementFields({migratedRTCount:1},r),i.refreshToken.push(l)}else n.performanceClient.incrementFields({skipRTMigrateCount:1},r);else xs(o.refreshToken,a)}n.setTokenKeys(o,r,e),n.setTokenKeys(i,r)}})()}trackVersionChanges(e){var t=this.browserStorage.getItem(Lc);t&&(this.logger.info("MSAL.js was last initialized by version: ".concat(t)),this.performanceClient.addFields({previousLibraryVersion:t},e)),t!==Rc&&this.setItem(Lc,Rc,e)}validateAndParseJson(e){if(!e)return null;try{var t=JSON.parse(e);return t&&"object"==typeof t?t:null}catch(e){return null}}setItem(e,t,r){for(var n=new Array(3).fill(0),o=[],i=0;i<=20;i++)try{if(this.browserStorage.setItem(e,t),i>0)for(var a=0;a<=2;a++){var c=n.slice(0,a).reduce((e,t)=>e+t,0);if(c>=i)break;var l=i>c+n[a]?c+n[a]:i;i>c&&n[a]>0&&this.removeAccessTokenKeys(o.slice(c,l),r,a)}break}catch(a){var s=er(a);if(!(s.errorCode===Yt&&i<20))throw s;if(!o.length)for(var u=0;u<=2;u++)if(e===Fc(this.clientId,u)){var d=JSON.parse(t).accessToken;o.push(...d),n[u]=d.length}else{var h=this.getTokenKeys(u).accessToken;o.push(...h),n[u]=h.length}if(o.length<=i)throw s;this.removeAccessToken(o[i],r,!1)}}setUserData(e,t,r,n,o){var i=this;return Ns(function*(){for(var a=new Array(3).fill(0),c=[],l=0;l<=20;l++)try{if(yield gl(i.browserStorage.setUserData.bind(i.browserStorage),Sn,i.logger,i.performanceClient)(e,t,r,n,o),l>0)for(var s=0;s<=2;s++){var u=a.slice(0,s).reduce((e,t)=>e+t,0);if(u>=l)break;var d=l>u+a[s]?u+a[s]:l;l>u&&a[s]>0&&i.removeAccessTokenKeys(c.slice(u,d),r,s)}break}catch(e){var h=er(e);if(!(h.errorCode===Yt&&l<20))throw h;if(!c.length)for(var f=0;f<=2;f++){var p=i.getTokenKeys(f).accessToken;c.push(...p),a[f]=p.length}if(c.length<=l)throw h;i.removeAccessToken(c[l],r,!1)}})()}getAccount(e,t){this.logger.trace("BrowserCacheManager.getAccount called");var r=this.browserStorage.getUserData(e);if(!r)return this.removeAccountKeyFromMap(e,t),null;var n=this.validateAndParseJson(r);return n&&Dt.isAccountEntity(n)?ir.toObject(new Dt,n):null}setAccount(e,t,r){var n=this;return Ns(function*(){n.logger.trace("BrowserCacheManager.setAccount called");var o=n.generateAccountKey(Dt.getAccountInfo(e)),i=Date.now().toString();e.lastUpdatedAt=i,yield n.setUserData(o,JSON.stringify(e),t,i,r);var a=n.addAccountKeyToMap(o,t);n.performanceClient.addFields({kmsi:r},t),n.cacheConfig.cacheLocation===ho&&a&&n.eventHandler.emitEvent(ms,void 0,Dt.getAccountInfo(e))})()}getAccountKeys(){return rs(this.browserStorage)}setAccountKeys(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;0===e.length?this.removeItem(Uc(r)):this.setItem(Uc(r),JSON.stringify(e),t)}addAccountKeyToMap(e,t){this.logger.trace("BrowserCacheManager.addAccountKeyToMap called"),this.logger.tracePii("BrowserCacheManager.addAccountKeyToMap called with key: ".concat(e));var r=this.getAccountKeys();return-1===r.indexOf(e)?(r.push(e),this.setItem(Uc(),JSON.stringify(r),t),this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key added"),!0):(this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key already exists in map"),!1)}removeAccountKeyFromMap(e,t){this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap called"),this.logger.tracePii("BrowserCacheManager.removeAccountKeyFromMap called with key: ".concat(e));var r=this.getAccountKeys(),n=r.indexOf(e);n>-1?(r.splice(n,1),this.setAccountKeys(r,t),this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap account key removed")):this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap key not found in existing map")}removeAccount(e,t){var r=this.getActiveAccount(t);(null==r?void 0:r.homeAccountId)===e.homeAccountId&&(null==r?void 0:r.environment)===e.environment&&this.setActiveAccount(null,t),super.removeAccount(e,t),this.removeAccountKeyFromMap(this.generateAccountKey(e),t),this.browserStorage.getKeys().forEach(t=>{t.includes(e.homeAccountId)&&t.includes(e.environment)&&this.browserStorage.removeItem(t)}),this.cacheConfig.cacheLocation===ho&&this.eventHandler.emitEvent(vs,void 0,e)}removeIdToken(e,t){super.removeIdToken(e,t);var r=this.getTokenKeys(),n=r.idToken.indexOf(e);n>-1&&(this.logger.info("idToken removed from tokenKeys map"),r.idToken.splice(n,1),this.setTokenKeys(r,t))}removeAccessToken(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];super.removeAccessToken(e,t),r&&this.removeAccessTokenKeys([e],t)}removeAccessTokenKeys(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;this.logger.trace("removeAccessTokenKey called");var n=this.getTokenKeys(r),o=0;if(e.forEach(e=>{var t=n.accessToken.indexOf(e);t>-1&&(n.accessToken.splice(t,1),o++)}),o>0)return this.logger.info("removed ".concat(o," accessToken keys from tokenKeys map")),void this.setTokenKeys(n,t,r)}removeRefreshToken(e,t){super.removeRefreshToken(e,t);var r=this.getTokenKeys(),n=r.refreshToken.indexOf(e);n>-1&&(this.logger.info("refreshToken removed from tokenKeys map"),r.refreshToken.splice(n,1),this.setTokenKeys(r,t))}getTokenKeys(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2;return ns(this.clientId,this.browserStorage,e)}setTokenKeys(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;0!==e.idToken.length||0!==e.accessToken.length||0!==e.refreshToken.length?this.setItem(Fc(this.clientId,r),JSON.stringify(e),t):this.removeItem(Fc(this.clientId,r))}getIdTokenCredential(e,t){var r=this.browserStorage.getUserData(e);if(!r)return this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeIdToken(e,t),null;var n,o=this.validateAndParseJson(r);return o&&(n=o)&&Pl(n)&&n.hasOwnProperty("realm")&&n.credentialType===O.ID_TOKEN?(this.logger.trace("BrowserCacheManager.getIdTokenCredential: cache hit"),o):(this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),null)}setIdTokenCredential(e,t,r){var n=this;return Ns(function*(){n.logger.trace("BrowserCacheManager.setIdTokenCredential called");var o=n.generateCredentialKey(e),i=Date.now().toString();e.lastUpdatedAt=i,yield n.setUserData(o,JSON.stringify(e),t,i,r);var a=n.getTokenKeys();-1===a.idToken.indexOf(o)&&(n.logger.info("BrowserCacheManager: addTokenKey - idToken added to map"),a.idToken.push(o),n.setTokenKeys(a,t))})()}getAccessTokenCredential(e,t){var r=this.browserStorage.getUserData(e);if(!r)return this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeAccessTokenKeys([e],t),null;var n=this.validateAndParseJson(r);return n&&El(n)?(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: cache hit"),n):(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),null)}setAccessTokenCredential(e,t,r){var n=this;return Ns(function*(){n.logger.trace("BrowserCacheManager.setAccessTokenCredential called");var o=n.generateCredentialKey(e),i=Date.now().toString();e.lastUpdatedAt=i,yield n.setUserData(o,JSON.stringify(e),t,i,r);var a=n.getTokenKeys(),c=a.accessToken.indexOf(o);-1!==c&&a.accessToken.splice(c,1),n.logger.trace("access token ".concat(-1===c?"added to":"updated in"," map")),a.accessToken.push(o),n.setTokenKeys(a,t)})()}getRefreshTokenCredential(e,t){var r=this.browserStorage.getUserData(e);if(!r)return this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeRefreshToken(e,t),null;var n=this.validateAndParseJson(r);return n&&Ol(n)?(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: cache hit"),n):(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),null)}setRefreshTokenCredential(e,t,r){var n=this;return Ns(function*(){n.logger.trace("BrowserCacheManager.setRefreshTokenCredential called");var o=n.generateCredentialKey(e),i=Date.now().toString();e.lastUpdatedAt=i,yield n.setUserData(o,JSON.stringify(e),t,i,r);var a=n.getTokenKeys();-1===a.refreshToken.indexOf(o)&&(n.logger.info("BrowserCacheManager: addTokenKey - refreshToken added to map"),a.refreshToken.push(o),n.setTokenKeys(a,t))})()}getAppMetadata(e){var t=this.browserStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null;var r,n=this.validateAndParseJson(t);return n&&((r=n)&&0===e.indexOf(_)&&r.hasOwnProperty("clientId")&&r.hasOwnProperty("environment"))?(this.logger.trace("BrowserCacheManager.getAppMetadata: cache hit"),n):(this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null)}setAppMetadata(e,t){this.logger.trace("BrowserCacheManager.setAppMetadata called");var r=function(e){var{environment:t,clientId:r}=e;return[_,t,r].join("-").toLowerCase()}(e);this.setItem(r,JSON.stringify(e),t)}getServerTelemetry(e){var t=this.browserStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null;var r,n,o,i=this.validateAndParseJson(t);return i&&(r=i,n=0===e.indexOf(q.CACHE_KEY),o=!0,r&&(o=r.hasOwnProperty("failedRequests")&&r.hasOwnProperty("errors")&&r.hasOwnProperty("cacheHits")),n&&o)?(this.logger.trace("BrowserCacheManager.getServerTelemetry: cache hit"),i):(this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null)}setServerTelemetry(e,t,r){this.logger.trace("BrowserCacheManager.setServerTelemetry called"),this.setItem(e,JSON.stringify(t),r)}getAuthorityMetadata(e){var t=this.internalStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAuthorityMetadata: called, no cache hit"),null;var r=this.validateAndParseJson(t);return r&&function(e,t){return!!t&&0===e.indexOf(x)&&t.hasOwnProperty("aliases")&&t.hasOwnProperty("preferred_cache")&&t.hasOwnProperty("preferred_network")&&t.hasOwnProperty("canonical_authority")&&t.hasOwnProperty("authorization_endpoint")&&t.hasOwnProperty("token_endpoint")&&t.hasOwnProperty("issuer")&&t.hasOwnProperty("aliasesFromNetwork")&&t.hasOwnProperty("endpointsFromNetwork")&&t.hasOwnProperty("expiresAt")&&t.hasOwnProperty("jwks_uri")}(e,r)?(this.logger.trace("BrowserCacheManager.getAuthorityMetadata: cache hit"),r):null}getAuthorityMetadataKeys(){return this.internalStorage.getKeys().filter(e=>this.isAuthorityMetadata(e))}setWrapperMetadata(e,t){this.internalStorage.setItem(Io,e),this.internalStorage.setItem(So,t)}getWrapperMetadata(){return[this.internalStorage.getItem(Io)||c.EMPTY_STRING,this.internalStorage.getItem(So)||c.EMPTY_STRING]}setAuthorityMetadata(e,t){this.logger.trace("BrowserCacheManager.setAuthorityMetadata called"),this.internalStorage.setItem(e,JSON.stringify(t))}getActiveAccount(e){var t=this.generateCacheKey(m),r=this.browserStorage.getItem(t);if(!r)return this.logger.trace("BrowserCacheManager.getActiveAccount: No active account filters found"),null;var n=this.validateAndParseJson(r);return n?(this.logger.trace("BrowserCacheManager.getActiveAccount: Active account filters schema found"),this.getAccountInfoFilteredBy({homeAccountId:n.homeAccountId,localAccountId:n.localAccountId,tenantId:n.tenantId},e)):(this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null)}setActiveAccount(e,t){var r=this.generateCacheKey(m);if(e){this.logger.verbose("setActiveAccount: Active account set");var n={homeAccountId:e.homeAccountId,localAccountId:e.localAccountId,tenantId:e.tenantId,lastUpdatedAt:bl().toString()};this.setItem(r,JSON.stringify(n),t)}else this.logger.verbose("setActiveAccount: No account passed, active account not set"),this.browserStorage.removeItem(r);this.eventHandler.emitEvent(ys)}getThrottlingCache(e){var t=this.browserStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null;var r=this.validateAndParseJson(t);return r&&function(e,t){var r=!1;e&&(r=0===e.indexOf(U));var n=!0;return t&&(n=t.hasOwnProperty("throttleTime")),r&&n}(e,r)?(this.logger.trace("BrowserCacheManager.getThrottlingCache: cache hit"),r):(this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null)}setThrottlingCache(e,t,r){this.logger.trace("BrowserCacheManager.setThrottlingCache called"),this.setItem(e,JSON.stringify(t),r)}getTemporaryCache(e,t){var r=t?this.generateCacheKey(e):e;if(this.cacheConfig.storeAuthStateInCookie){var n=this.cookieStorage.getItem(r);if(n)return this.logger.trace("BrowserCacheManager.getTemporaryCache: storeAuthStateInCookies set to true, retrieving from cookies"),n}var o=this.temporaryCacheStorage.getItem(r);if(!o){if(this.cacheConfig.cacheLocation===ho){var i=this.browserStorage.getItem(r);if(i)return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item found in local storage"),i}return this.logger.trace("BrowserCacheManager.getTemporaryCache: No cache item found in local storage"),null}return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item returned"),o}setTemporaryCache(e,t,r){var n=r?this.generateCacheKey(e):e;this.temporaryCacheStorage.setItem(n,t),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.setTemporaryCache: storeAuthStateInCookie set to true, setting item cookie"),this.cookieStorage.setItem(n,t,void 0,this.cacheConfig.secureCookies))}removeItem(e){this.browserStorage.removeItem(e)}removeTemporaryItem(e){this.temporaryCacheStorage.removeItem(e),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.removeItem: storeAuthStateInCookie is true, clearing item cookie"),this.cookieStorage.removeItem(e))}getKeys(){return this.browserStorage.getKeys()}clear(e){this.removeAllAccounts(e),this.removeAppMetadata(e),this.temporaryCacheStorage.getKeys().forEach(e=>{-1===e.indexOf(xc)&&-1===e.indexOf(this.clientId)||this.removeTemporaryItem(e)}),this.browserStorage.getKeys().forEach(e=>{-1===e.indexOf(xc)&&-1===e.indexOf(this.clientId)||this.browserStorage.removeItem(e)}),this.internalStorage.clear()}clearTokensAndKeysWithClaims(e){this.performanceClient.addQueueMeasurement(Cn,e);var t=this.getTokenKeys(),r=0;t.accessToken.forEach(t=>{var n=this.getAccessTokenCredential(t,e);null!=n&&n.requestedClaimsHash&&t.includes(n.requestedClaimsHash.toLowerCase())&&(this.removeAccessToken(t,e),r++)}),r>0&&this.logger.warning("".concat(r," access tokens with claims in the cache keys have been removed from the cache."))}generateCacheKey(e){return Ct.startsWith(e,xc)?e:"".concat(xc,".").concat(this.clientId,".").concat(e)}generateCredentialKey(e){var t=e.credentialType===O.REFRESH_TOKEN&&e.familyId||e.clientId,r=e.tokenType&&e.tokenType.toLowerCase()!==j.BEARER.toLowerCase()?e.tokenType.toLowerCase():"";return["".concat(xc,".").concat(2),e.homeAccountId,e.environment,e.credentialType,t,e.realm||"",e.target||"",e.requestedClaimsHash||"",r].join("|").toLowerCase()}generateAccountKey(e){var t=e.homeAccountId.split(".")[1];return["".concat(xc,".").concat(2),e.homeAccountId,e.environment,t||e.tenantId||""].join("|").toLowerCase()}resetRequestCache(){this.logger.trace("BrowserCacheManager.resetRequestCache called"),this.removeTemporaryItem(this.generateCacheKey(bo)),this.removeTemporaryItem(this.generateCacheKey(wo)),this.removeTemporaryItem(this.generateCacheKey(vo)),this.removeTemporaryItem(this.generateCacheKey(yo)),this.removeTemporaryItem(this.generateCacheKey(ko)),this.setInteractionInProgress(!1)}cacheAuthorizeRequest(e,t){this.logger.trace("BrowserCacheManager.cacheAuthorizeRequest called");var r=Sa(JSON.stringify(e));if(this.setTemporaryCache(bo,r,!0),t){var n=Sa(t);this.setTemporaryCache(wo,n,!0)}}getCachedRequest(){this.logger.trace("BrowserCacheManager.getCachedRequest called");var e=this.getTemporaryCache(bo,!0);if(!e)throw Ri(ei);var t,r=this.getTemporaryCache(wo,!0),n="";try{t=JSON.parse(Aa(e)),r&&(n=Aa(r))}catch(t){throw this.logger.errorPii("Attempted to parse: ".concat(e)),this.logger.error("Parsing cached token request threw with error: ".concat(t)),Ri(ti)}return[t,n]}getCachedNativeRequest(){this.logger.trace("BrowserCacheManager.getCachedNativeRequest called");var e=this.getTemporaryCache(ko,!0);return e?this.validateAndParseJson(e)||(this.logger.error("BrowserCacheManager.getCachedNativeRequest: Unable to parse native request"),null):(this.logger.trace("BrowserCacheManager.getCachedNativeRequest: No cached native request found"),null)}isInteractionInProgress(e){var t,r=null===(t=this.getInteractionInProgress())||void 0===t?void 0:t.clientId;return e?r===this.clientId:!!r}getInteractionInProgress(){var e="".concat(xc,".").concat(Co),t=this.getTemporaryCache(e,!1);try{return t?JSON.parse(t):null}catch(t){return this.logger.error("Cannot parse interaction status. Removing temporary cache items and clearing url hash. Retrying interaction should fix the error"),this.removeTemporaryItem(e),this.resetRequestCache(),bc(window),null}}setInteractionInProgress(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:go,n="".concat(xc,".").concat(Co);if(e){if(this.getInteractionInProgress())throw Ri(Ho);this.setTemporaryCache(n,JSON.stringify({clientId:this.clientId,type:r}),!1)}else e||(null===(t=this.getInteractionInProgress())||void 0===t?void 0:t.clientId)!==this.clientId||this.removeTemporaryItem(n)}hydrateCache(e,t){var r=this;return Ns(function*(){var n,o,i,a,c=Sl(null===(n=e.account)||void 0===n?void 0:n.homeAccountId,null===(o=e.account)||void 0===o?void 0:o.environment,e.idToken,r.clientId,e.tenantId);t.claims&&(a=yield r.cryptoImpl.hashString(t.claims));var l={idToken:c,accessToken:Tl(null===(i=e.account)||void 0===i?void 0:i.homeAccountId,e.account.environment,e.accessToken,r.clientId,e.tenantId,e.scopes.join(" "),e.expiresOn?wl(e.expiresOn):0,e.extExpiresOn?wl(e.extExpiresOn):0,Aa,void 0,e.tokenType,void 0,t.sshKid,t.claims,a)};return r.saveCacheRecord(l,e.correlationId,qt(Lt(e.idToken,Aa)))})()}saveCacheRecord(e,t,r,n){var o=()=>super.saveCacheRecord,i=this;return Ns(function*(){try{yield o().call(i,e,t,r,n)}catch(e){if(e instanceof Zt&&i.performanceClient&&t)try{var a=i.getTokenKeys();i.performanceClient.addFields({cacheRtCount:a.refreshToken.length,cacheIdCount:a.idToken.length,cacheAtCount:a.accessToken.length},t)}catch(e){}throw e}})()}}function Ls(e,t,r,n){try{switch(t){case ho:return new ds(e,r,n);case fo:return new ps}}catch(e){r.error(e)}return new nl}class qs{constructor(e){this.eventCallbacks=new Map,this.logger=e||new F({}),"undefined"!=typeof BroadcastChannel&&(this.broadcastChannel=new BroadcastChannel("msal.broadcast.event")),this.invokeCrossTabCallbacks=this.invokeCrossTabCallbacks.bind(this)}addEventCallback(e,t,r){if("undefined"!=typeof window){var n=r||Ka();return this.eventCallbacks.has(n)?(this.logger.error("Event callback with id: ".concat(n," is already registered. Please provide a unique id or remove the existing callback and try again.")),null):(this.eventCallbacks.set(n,[e,t||[]]),this.logger.verbose("Event callback registered with id: ".concat(n)),n)}return null}removeEventCallback(e){this.eventCallbacks.delete(e),this.logger.verbose("Event callback ".concat(e," removed."))}emitEvent(e,t,r,n){var o,i={eventType:e,interactionType:t||null,payload:r||null,error:n||null,timestamp:Date.now()};switch(e){case ms:case vs:case ys:null===(o=this.broadcastChannel)||void 0===o||o.postMessage(i);break;default:this.invokeCallbacks(i)}}invokeCallbacks(e){this.eventCallbacks.forEach((t,r)=>{var[n,o]=t;(0===o.length||o.includes(e.eventType))&&(this.logger.verbose("Emitting event to callback ".concat(r,": ").concat(e.eventType)),n.apply(null,[e]))})}invokeCrossTabCallbacks(e){var t=e.data;this.invokeCallbacks(t)}subscribeCrossTab(){var e;null===(e=this.broadcastChannel)||void 0===e||e.addEventListener("message",this.invokeCrossTabCallbacks)}unsubscribeCrossTab(){var e;null===(e=this.broadcastChannel)||void 0===e||e.removeEventListener("message",this.invokeCrossTabCallbacks)}}var js="home_account_id",Us="UPN";function Fs(e,t,r,n,o,i,a){try{var c=e[i](a),l=c.value}catch(e){return void r(e)}c.done?t(l):Promise.resolve(l).then(n,o)}function Hs(e,t,r,n,o,i,a){return zs.apply(this,arguments)}function zs(){var e;return e=function*(e,t,r,n,o,i,a){null==a||a.addQueueMeasurement(an,i);var c=Ul.transformCIAMAuthority(Fl(e)),l=new Ul(c,t,r,n,o,i,a);try{return yield gl(l.resolveEndpointsAsync.bind(l),cn,o,a,i)(),l}catch(e){throw ze(Z)}},zs=function(){var t=this,r=arguments;return new Promise(function(n,o){var i=e.apply(t,r);function a(e){Fs(i,n,o,a,c,"next",e)}function c(e){Fs(i,n,o,a,c,"throw",e)}a(void 0)})},zs.apply(this,arguments)}class Bs extends Q{constructor(e,t,r,n,o){super(e,t,r),this.name="ServerError",this.errorNo=n,this.status=o,Object.setPrototypeOf(this,Bs.prototype)}}class Ks{static generateThrottlingStorageKey(e){return"".concat(U,".").concat(JSON.stringify(e))}static preProcess(e,t,r){var n=Ks.generateThrottlingStorageKey(t),o=e.getThrottlingCache(n);if(o){var i;if(o.throttleTime<Date.now())return void e.removeItem(n,r);throw new Bs((null===(i=o.errorCodes)||void 0===i?void 0:i.join(" "))||c.EMPTY_STRING,o.errorMessage,o.subError)}}static postProcess(e,t,r,n){if(Ks.checkResponseStatus(r)||Ks.checkResponseForRetryAfter(r)){var o={throttleTime:Ks.calculateThrottleTime(parseInt(r.headers[h])),error:r.body.error,errorCodes:r.body.error_codes,errorMessage:r.body.error_description,subError:r.body.suberror};e.setThrottlingCache(Ks.generateThrottlingStorageKey(t),o,n)}}static checkResponseStatus(e){return 429===e.status||e.status>=500&&e.status<600}static checkResponseForRetryAfter(e){return!!e.headers&&e.headers.hasOwnProperty(h)&&(e.status<200||e.status>=300)}static calculateThrottleTime(e){var t=e<=0?0:e,r=Date.now()/1e3;return Math.floor(1e3*Math.min(r+(t||60),r+3600))}static removeThrottle(e,t,r,n){var o=Xl(t,r,n),i=this.generateThrottlingStorageKey(o);e.removeItem(i,r.correlationId)}}function Vs(e,t,r,n,o,i,a){try{var c=e[i](a),l=c.value}catch(e){return void r(e)}c.done?t(l):Promise.resolve(l).then(n,o)}function Ws(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var i=e.apply(t,r);function a(e){Vs(i,n,o,a,c,"next",e)}function c(e){Vs(i,n,o,a,c,"throw",e)}a(void 0)})}}class Qs{constructor(e,t){this.config=function(e){var t,{authOptions:r,systemOptions:n,loggerOptions:o,cacheOptions:i,storageInterface:a,networkInterface:c,cryptoInterface:l,clientCredentials:s,libraryInfo:u,telemetry:d,serverTelemetryManager:h,persistencePlugin:f,serializableCache:p}=e,g=Bn(Bn({},Gn),o);return{authOptions:(t=r,Bn({clientCapabilities:[],azureCloudOptions:Zn,skipAuthorityMetadataCache:!1,instanceAware:!1,encodeExtraQueryParams:!1},t)),systemOptions:Bn(Bn({},Qn),n),loggerOptions:g,cacheOptions:Bn(Bn({},Jn),i),storageInterface:a||new ar(r.clientId,Ve,new F(g),new Hn),networkInterface:c||Yn,cryptoInterface:l||Ve,clientCredentials:s||Xn,libraryInfo:Bn(Bn({},$n),u),telemetry:Bn(Bn({},eo),d),serverTelemetryManager:h||null,persistencePlugin:f||null,serializableCache:p||null}}(e),this.logger=new F(this.config.loggerOptions,We,Qe),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority,this.performanceClient=t}createTokenRequestHeaders(e){var t={};if(t[d]=c.URL_FORM_CONTENT_TYPE,!this.config.systemOptions.preventCorsPreflight&&e)switch(e.type){case js:try{var r=St(e.credential);t[f]="Oid:".concat(r.uid,"@").concat(r.utid)}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}break;case Us:t[f]="UPN: ".concat(e.credential)}return t}executePostToTokenEndpoint(e,t,r,n,o,i){var a=this;return Ws(function*(){var c;i&&(null===(c=a.performanceClient)||void 0===c||c.addQueueMeasurement(i,o));var l=yield a.sendPostRequest(n,e,{body:t,headers:r},o);return a.config.serverTelemetryManager&&l.status<500&&429!==l.status&&a.config.serverTelemetryManager.clearTelemetryCache(),l})()}sendPostRequest(e,t,r,n){var o=this;return Ws(function*(){var i;Ks.preProcess(o.cacheManager,e,n);try{var a,c,l=(i=yield gl(o.networkClient.sendPostRequestAsync.bind(o.networkClient),Cr,o.logger,o.performanceClient,n)(t,r)).headers||{};null===(a=o.performanceClient)||void 0===a||a.addFields({refreshTokenSize:(null===(c=i.body.refresh_token)||void 0===c?void 0:c.length)||0,httpVerToken:l[g]||"",requestId:l[p]||""},n)}catch(e){if(e instanceof Mi){var s,u=e.responseHeaders;throw u&&(null===(s=o.performanceClient)||void 0===s||s.addFields({httpVerToken:u[g]||"",requestId:u[p]||"",contentTypeHeader:u[d]||void 0,contentLengthHeader:u["Content-Length"]||void 0,httpStatus:e.httpStatus},n)),e.error}throw e instanceof Q?e:ze(ee)}return Ks.postProcess(o.cacheManager,e,i,n),i})()}updateAuthority(e,t){var r=this;return Ws(function*(){var n;null===(n=r.performanceClient)||void 0===n||n.addQueueMeasurement($r,t);var o="https://".concat(e,"/").concat(r.authority.tenant,"/"),i=yield Hs(o,r.networkClient,r.cacheManager,r.authority.options,r.logger,t,r.performanceClient);r.authority=i})()}createTokenQueryParameters(e){var t=new Map;return e.embeddedClientId&&Ca(t,this.config.authOptions.clientId,this.config.authOptions.redirectUri),e.tokenQueryParameters&&ma(t,e.tokenQueryParameters),ia(t,e.correlationId),Ji(t,e.correlationId,this.performanceClient),zt(t)}}class Gs{static setRequestState(e,t,r){var n=Gs.generateLibraryState(e,r);return t?"".concat(n).concat(c.RESOURCE_DELIM).concat(t):n}static generateLibraryState(e,t){if(!e)throw ze(Ie);var r={id:e.createNewGuid()};t&&(r.meta=t);var n=JSON.stringify(r);return e.base64Encode(n)}static parseRequestState(e,t){if(!e)throw ze(Ie);if(!t)throw ze(ne);try{var r=t.split(c.RESOURCE_DELIM),n=r[0],o=r.length>1?r.slice(1).join(c.RESOURCE_DELIM):c.EMPTY_STRING,i=e.base64Decode(n),a=JSON.parse(i);return{userRequestState:o||c.EMPTY_STRING,libraryState:a}}catch(e){throw ze(ne)}}}function Js(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Ys(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $s(e,t,r,n,o,i,a){try{var c=e[i](a),l=c.value}catch(e){return void r(e)}c.done?t(l):Promise.resolve(l).then(n,o)}function Xs(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var i=e.apply(t,r);function a(e){$s(i,n,o,a,c,"next",e)}function c(e){$s(i,n,o,a,c,"throw",e)}a(void 0)})}}class Zs{constructor(e,t){this.cryptoUtils=e,this.performanceClient=t}generateCnf(e,t){var r=this;return Xs(function*(){var n;null===(n=r.performanceClient)||void 0===n||n.addQueueMeasurement(tn,e.correlationId);var o=yield gl(r.generateKid.bind(r),tn,t,r.performanceClient,e.correlationId)(e),i=r.cryptoUtils.base64UrlEncode(JSON.stringify(o));return{kid:o.kid,reqCnfString:i}})()}generateKid(e){var t=this;return Xs(function*(){var r;return null===(r=t.performanceClient)||void 0===r||r.addQueueMeasurement(rn,e.correlationId),{kid:yield t.cryptoUtils.getPublicKeyThumbprint(e),xms_ksl:"sw"}})()}signPopToken(e,t,r){var n=this;return Xs(function*(){return n.signPayload(e,t,r)})()}signPayload(e,t,r,n){var o=this;return Xs(function*(){var{resourceRequestMethod:i,resourceRequestUri:a,shrClaims:c,shrNonce:l,shrOptions:s}=r,u=a?new Kt(a):void 0,d=null==u?void 0:u.getUrlComponents();return o.cryptoUtils.signJwt(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Js(Object(r),!0).forEach(function(t){Ys(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Js(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({at:e,ts:bl(),m:null==i?void 0:i.toUpperCase(),u:null==d?void 0:d.HostNameAndPort,nonce:l||o.cryptoUtils.createNewGuid(),p:null==d?void 0:d.AbsolutePath,q:null!=d&&d.QueryString?[[],d.QueryString]:void 0,client_claims:c||void 0},n),t,s,r.correlationId)})()}}class eu{constructor(e,t){this.cache=e,this.hasChanged=t}get cacheHasChanged(){return this.hasChanged}get tokenCache(){return this.cache}}function tu(e,t,r,n,o,i,a){try{var c=e[i](a),l=c.value}catch(e){return void r(e)}c.done?t(l):Promise.resolve(l).then(n,o)}function ru(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var i=e.apply(t,r);function a(e){tu(i,n,o,a,c,"next",e)}function c(e){tu(i,n,o,a,c,"throw",e)}a(void 0)})}}class nu{constructor(e,t,r,n,o,i,a){this.clientId=e,this.cacheStorage=t,this.cryptoObj=r,this.logger=n,this.serializableCache=o,this.persistencePlugin=i,this.performanceClient=a}validateTokenResponse(e,t){if(e.error||e.error_description||e.suberror){var r,n="Error(s): ".concat(e.error_codes||c.NOT_AVAILABLE," - Timestamp: ").concat(e.timestamp||c.NOT_AVAILABLE," - Description: ").concat(e.error_description||c.NOT_AVAILABLE," - Correlation ID: ").concat(e.correlation_id||c.NOT_AVAILABLE," - Trace ID: ").concat(e.trace_id||c.NOT_AVAILABLE),o=null!==(r=e.error_codes)&&void 0!==r&&r.length?e.error_codes[0]:void 0,i=new Bs(e.error,n,e.suberror,o,e.status);if(t&&e.status&&e.status>=500&&e.status<=599)return void this.logger.warning("executeTokenRequest:validateTokenResponse - AAD is currently unavailable and the access token is unable to be refreshed.\n".concat(i));if(t&&e.status&&e.status>=400&&e.status<=499)return void this.logger.warning("executeTokenRequest:validateTokenResponse - AAD is currently available but is unable to refresh the access token.\n".concat(i));if(Yl(e.error,e.error_description,e.suberror))throw new Jl(e.error,e.error_description,e.suberror,e.timestamp||c.EMPTY_STRING,e.trace_id||c.EMPTY_STRING,e.correlation_id||c.EMPTY_STRING,e.claims||c.EMPTY_STRING,o);throw i}}handleServerTokenResponse(e,t,r,n,o,i,a,l,s){var u=this;return ru(function*(){var d,h,f;if(null===(d=u.performanceClient)||void 0===d||d.addQueueMeasurement(nn,e.correlation_id),e.id_token){if(h=Lt(e.id_token||c.EMPTY_STRING,u.cryptoObj.base64Decode),o&&o.nonce&&h.nonce!==o.nonce)throw ze(ae);if(n.maxAge||0===n.maxAge){var p=h.auth_time;if(!p)throw ze(ce);jt(p,n.maxAge)}}u.homeAccountIdentifier=Dt.generateHomeAccountId(e.client_info||c.EMPTY_STRING,t.authorityType,u.logger,u.cryptoObj,h),o&&o.state&&(f=Gs.parseRequestState(u.cryptoObj,o.state)),e.key_id=e.key_id||n.sshKid||void 0;var g,m=u.generateCacheRecord(e,t,r,n,h,i,o);try{if(u.persistencePlugin&&u.serializableCache&&(u.logger.verbose("Persistence enabled, calling beforeCacheAccess"),g=new eu(u.serializableCache,!0),yield u.persistencePlugin.beforeCacheAccess(g)),a&&!l&&m.account){var v=u.cacheStorage.generateAccountKey(Dt.getAccountInfo(m.account));if(!u.cacheStorage.getAccount(v,n.correlationId))return u.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),yield nu.generateAuthenticationResult(u.cryptoObj,t,m,!1,n,h,f,void 0,s)}yield u.cacheStorage.saveCacheRecord(m,n.correlationId,qt(h||{}),n.storeInCache)}finally{u.persistencePlugin&&u.serializableCache&&g&&(u.logger.verbose("Persistence enabled, calling afterCacheAccess"),yield u.persistencePlugin.afterCacheAccess(g))}return nu.generateAuthenticationResult(u.cryptoObj,t,m,!1,n,h,f,e,s)})()}generateCacheRecord(e,t,r,n,o,i,a){var c=t.getPreferredCache();if(!c)throw ze(Ce);var l,s,u=Nt(o);e.id_token&&o&&(l=Sl(this.homeAccountIdentifier,c,e.id_token,this.clientId,u||""),s=ou(this.cacheStorage,t,this.homeAccountIdentifier,this.cryptoObj.base64Decode,n.correlationId,o,e.client_info,c,u,a,void 0,this.logger));var d=null;if(e.access_token){var h=e.scope?kt.fromString(e.scope):new kt(n.scopes||[]),f=("string"==typeof e.expires_in?parseInt(e.expires_in,10):e.expires_in)||0,p=("string"==typeof e.ext_expires_in?parseInt(e.ext_expires_in,10):e.ext_expires_in)||0,g=("string"==typeof e.refresh_in?parseInt(e.refresh_in,10):e.refresh_in)||void 0,m=r+f,v=m+p,y=g&&g>0?r+g:void 0;d=Tl(this.homeAccountIdentifier,c,e.access_token,this.clientId,u||t.tenant||"",h.printScopes(),m,v,this.cryptoObj.base64Decode,y,e.token_type,i,e.key_id,n.claims,n.requestedClaimsHash)}var b,w=null;e.refresh_token&&(e.refresh_token_expires_in&&(b=r+("string"==typeof e.refresh_token_expires_in?parseInt(e.refresh_token_expires_in,10):e.refresh_token_expires_in)),w=Al(this.homeAccountIdentifier,c,e.refresh_token,this.clientId,e.foci,i,b));var C=null;return e.foci&&(C={clientId:this.clientId,environment:c,familyId:e.foci}),{account:s,idToken:l,accessToken:d,refreshToken:w,appMetadata:C}}static generateAuthenticationResult(e,t,r,n,o,i,a,l,s){return ru(function*(){var u,d,h,f,p,g,m,v=c.EMPTY_STRING,y=[],b=null,w=c.EMPTY_STRING;if(r.accessToken){if(r.accessToken.tokenType!==j.POP||o.popKid)v=r.accessToken.secret;else{var C=new Zs(e),{secret:k,keyId:I}=r.accessToken;if(!I)throw ze(Me);v=yield C.signPopToken(k,I,o)}y=kt.fromString(r.accessToken.target).asArray(),b=Cl(r.accessToken.expiresOn),g=Cl(r.accessToken.extendedExpiresOn),r.accessToken.refreshOn&&(m=Cl(r.accessToken.refreshOn))}r.appMetadata&&(w=r.appMetadata.familyId===R?R:"");var S=(null==i?void 0:i.oid)||(null==i?void 0:i.sub)||"",T=(null==i?void 0:i.tid)||"";null!=l&&l.spa_accountid&&r.account&&(r.account.nativeAccountId=null==l?void 0:l.spa_accountid);var A=r.account?Mt(Dt.getAccountInfo(r.account),void 0,i,null===(u=r.idToken)||void 0===u?void 0:u.secret):null;return{authority:t.canonicalAuthority,uniqueId:S,tenantId:T,scopes:y,account:A,idToken:(null==r||null===(d=r.idToken)||void 0===d?void 0:d.secret)||"",idTokenClaims:i||{},accessToken:v,fromCache:n,expiresOn:b,extExpiresOn:g,refreshOn:m,correlationId:o.correlationId,requestId:s||c.EMPTY_STRING,familyId:w,tokenType:(null===(h=r.accessToken)||void 0===h?void 0:h.tokenType)||c.EMPTY_STRING,state:a?a.userRequestState:c.EMPTY_STRING,cloudGraphHostName:(null===(f=r.account)||void 0===f?void 0:f.cloudGraphHostName)||c.EMPTY_STRING,msGraphHost:(null===(p=r.account)||void 0===p?void 0:p.msGraphHost)||c.EMPTY_STRING,code:null==l?void 0:l.spa_code,fromNativeBroker:!1}})()}}function ou(e,t,r,n,o,i,a,c,l,s,u,d){null==d||d.verbose("setCachedAccount called");var h=e.getAccountKeys().find(e=>e.startsWith(r)),f=null;h&&(f=e.getAccount(h,o));var p=f||Dt.createAccount({homeAccountId:r,idTokenClaims:i,clientInfo:a,environment:c,cloudGraphHostName:null==s?void 0:s.cloud_graph_host_name,msGraphHost:null==s?void 0:s.msgraph_host,nativeAccountId:u},t,n),g=p.tenantProfiles||[],m=l||p.realm;if(m&&!g.find(e=>e.tenantId===m)){var v=xt(r,p.localAccountId,m,i);g.push(v)}return p.tenantProfiles=g,p}function iu(e,t,r,n,o,i,a){try{var c=e[i](a),l=c.value}catch(e){return void r(e)}c.done?t(l):Promise.resolve(l).then(n,o)}function au(e,t,r){return cu.apply(this,arguments)}function cu(){var e;return e=function*(e,t,r){return"string"==typeof e?e:e({clientId:t,tokenEndpoint:r})},cu=function(){var t=this,r=arguments;return new Promise(function(n,o){var i=e.apply(t,r);function a(e){iu(i,n,o,a,c,"next",e)}function c(e){iu(i,n,o,a,c,"throw",e)}a(void 0)})},cu.apply(this,arguments)}function lu(e,t,r,n,o,i,a){try{var c=e[i](a),l=c.value}catch(e){return void r(e)}c.done?t(l):Promise.resolve(l).then(n,o)}function su(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var i=e.apply(t,r);function a(e){lu(i,n,o,a,c,"next",e)}function c(e){lu(i,n,o,a,c,"throw",e)}a(void 0)})}}class uu extends Qs{constructor(e,t){var r;super(e,t),this.includeRedirectUri=!0,this.oidcDefaultScopes=null===(r=this.config.authOptions.authority.options.OIDCOptions)||void 0===r?void 0:r.defaultScopes}acquireToken(e,t){var r=this;return su(function*(){var n,o;if(null===(n=r.performanceClient)||void 0===n||n.addQueueMeasurement(Xr,e.correlationId),!e.code)throw ze(he);var i=bl(),a=yield gl(r.executeTokenRequest.bind(r),Zr,r.logger,r.performanceClient,e.correlationId)(r.authority,e),c=null===(o=a.headers)||void 0===o?void 0:o[p],l=new nu(r.config.authOptions.clientId,r.cacheManager,r.cryptoUtils,r.logger,r.config.serializableCache,r.config.persistencePlugin,r.performanceClient);return l.validateTokenResponse(a.body),gl(l.handleServerTokenResponse.bind(l),nn,r.logger,r.performanceClient,e.correlationId)(a.body,r.authority,i,e,t,void 0,void 0,void 0,c)})()}getLogoutUri(e){if(!e)throw wt(rt);var t=this.createLogoutUrlQueryString(e);return Kt.appendQueryString(this.authority.endSessionEndpoint,t)}executeTokenRequest(e,t){var r=this;return su(function*(){var n;null===(n=r.performanceClient)||void 0===n||n.addQueueMeasurement(Zr,t.correlationId);var o=r.createTokenQueryParameters(t),i=Kt.appendQueryString(e.tokenEndpoint,o),a=yield gl(r.createTokenRequestBody.bind(r),en,r.logger,r.performanceClient,t.correlationId)(t),c=void 0;if(t.clientInfo)try{var l=It(t.clientInfo,r.cryptoUtils.base64Decode);c={credential:"".concat(l.uid).concat(".").concat(l.utid),type:js}}catch(e){r.logger.verbose("Could not parse client info for CCS Header: "+e)}var s=r.createTokenRequestHeaders(c||t.ccsCredential),u=Xl(r.config.authOptions.clientId,t);return gl(r.executePostToTokenEndpoint.bind(r),Ir,r.logger,r.performanceClient,t.correlationId)(i,a,s,u,t.correlationId,Ir)})()}createTokenRequestBody(e){var t=this;return su(function*(){var r,n;null===(r=t.performanceClient)||void 0===r||r.addQueueMeasurement(en,e.correlationId);var o=new Map;if(Xi(o,e.embeddedClientId||(null===(n=e.tokenBodyParameters)||void 0===n?void 0:n[Fi])||t.config.authOptions.clientId),t.includeRedirectUri)Zi(o,e.redirectUri);else if(!e.redirectUri)throw wt(Ge);if($i(o,e.scopes,!0,t.oidcDefaultScopes),function(e,t){e.set("code",t)}(o,e.code),aa(o,t.config.libraryInfo),ca(o,t.config.telemetry.application),wa(o),t.serverTelemetryManager&&!to(t.config)&&ba(o,t.serverTelemetryManager),e.codeVerifier&&function(e,t){e.set("code_verifier",t)}(o,e.codeVerifier),t.config.clientCredentials.clientSecret&&ua(o,t.config.clientCredentials.clientSecret),t.config.clientCredentials.clientAssertion){var i=t.config.clientCredentials.clientAssertion;da(o,yield au(i.assertion,t.config.authOptions.clientId,e.resourceRequestUri)),ha(o,i.assertionType)}if(fa(o,"authorization_code"),pa(o),e.authenticationScheme===j.POP){var a=new Zs(t.cryptoUtils,t.performanceClient);va(o,e.popKid?t.cryptoUtils.encodeKid(e.popKid):(yield gl(a.generateCnf.bind(a),tn,t.logger,t.performanceClient,e.correlationId)(e,t.logger)).reqCnfString)}else if(e.authenticationScheme===j.SSH){if(!e.sshJwk)throw wt(lt);ya(o,e.sshJwk)}(!Ct.isEmptyObj(e.claims)||t.config.authOptions.clientCapabilities&&t.config.authOptions.clientCapabilities.length>0)&&oa(o,e.claims,t.config.authOptions.clientCapabilities);var c=void 0;if(e.clientInfo)try{var l=It(e.clientInfo,t.cryptoUtils.base64Decode);c={credential:"".concat(l.uid).concat(".").concat(l.utid),type:js}}catch(e){t.logger.verbose("Could not parse client info for CCS Header: "+e)}else c=e.ccsCredential;if(t.config.systemOptions.preventCorsPreflight&&c)switch(c.type){case js:try{ra(o,St(c.credential))}catch(e){t.logger.verbose("Could not parse home account ID for CCS Header: "+e)}break;case Us:ta(o,c.credential)}return e.embeddedClientId&&Ca(o,t.config.authOptions.clientId,t.config.authOptions.redirectUri),e.tokenBodyParameters&&ma(o,e.tokenBodyParameters),!e.enableSpaAuthorizationCode||e.tokenBodyParameters&&e.tokenBodyParameters[Ki]||ma(o,{[Ki]:"1"}),Ji(o,e.correlationId,t.performanceClient),zt(o)})()}createLogoutUrlQueryString(e){var t=new Map;return e.postLogoutRedirectUri&&function(e,t){e.set("post_logout_redirect_uri",t)}(t,e.postLogoutRedirectUri),e.correlationId&&ia(t,e.correlationId),e.idTokenHint&&function(e,t){e.set("id_token_hint",t)}(t,e.idTokenHint),e.state&&la(t,e.state),e.logoutHint&&function(e,t){e.set("logout_hint",t)}(t,e.logoutHint),e.extraQueryParameters&&ma(t,e.extraQueryParameters),this.config.authOptions.instanceAware&&ga(t),zt(t,this.config.authOptions.encodeExtraQueryParams,e.extraQueryParameters)}}class du{constructor(e,t){this.cacheOutcome="0",this.cacheManager=t,this.apiId=e.apiId,this.correlationId=e.correlationId,this.wrapperSKU=e.wrapperSKU||c.EMPTY_STRING,this.wrapperVer=e.wrapperVer||c.EMPTY_STRING,this.telemetryCacheKey=q.CACHE_KEY+"-"+e.clientId}generateCurrentRequestHeaderValue(){var e="".concat(this.apiId).concat(q.VALUE_SEPARATOR).concat(this.cacheOutcome),t=[this.wrapperSKU,this.wrapperVer],r=this.getNativeBrokerErrorCode();null!=r&&r.length&&t.push("broker_error=".concat(r));var n=t.join(q.VALUE_SEPARATOR),o=[e,this.getRegionDiscoveryFields()].join(q.VALUE_SEPARATOR);return[q.SCHEMA_VERSION,o,n].join(q.CATEGORY_SEPARATOR)}generateLastRequestHeaderValue(){var e=this.getLastRequests(),t=du.maxErrorsToSend(e),r=e.failedRequests.slice(0,2*t).join(q.VALUE_SEPARATOR),n=e.errors.slice(0,t).join(q.VALUE_SEPARATOR),o=e.errors.length,i=[o,t<o?q.OVERFLOW_TRUE:q.OVERFLOW_FALSE].join(q.VALUE_SEPARATOR);return[q.SCHEMA_VERSION,e.cacheHits,r,n,i].join(q.CATEGORY_SEPARATOR)}cacheFailedRequest(e){var t=this.getLastRequests();t.errors.length>=q.MAX_CACHED_ERRORS&&(t.failedRequests.shift(),t.failedRequests.shift(),t.errors.shift()),t.failedRequests.push(this.apiId,this.correlationId),e instanceof Error&&e&&e.toString()?e instanceof Q?e.subError?t.errors.push(e.subError):e.errorCode?t.errors.push(e.errorCode):t.errors.push(e.toString()):t.errors.push(e.toString()):t.errors.push(q.UNKNOWN_ERROR),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t,this.correlationId)}incrementCacheHits(){var e=this.getLastRequests();return e.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e,this.correlationId),e.cacheHits}getLastRequests(){return this.cacheManager.getServerTelemetry(this.telemetryCacheKey)||{failedRequests:[],errors:[],cacheHits:0}}clearTelemetryCache(){var e=this.getLastRequests(),t=du.maxErrorsToSend(e);if(t===e.errors.length)this.cacheManager.removeItem(this.telemetryCacheKey,this.correlationId);else{var r={failedRequests:e.failedRequests.slice(2*t),errors:e.errors.slice(t),cacheHits:0};this.cacheManager.setServerTelemetry(this.telemetryCacheKey,r,this.correlationId)}}static maxErrorsToSend(e){var t,r=0,n=0,o=e.errors.length;for(t=0;t<o;t++){var i=e.failedRequests[2*t]||c.EMPTY_STRING,a=e.failedRequests[2*t+1]||c.EMPTY_STRING,l=e.errors[t]||c.EMPTY_STRING;if(!((n+=i.toString().length+a.toString().length+l.length+3)<q.MAX_LAST_HEADER_BYTES))break;r+=1}return r}getRegionDiscoveryFields(){var e=[];return e.push(this.regionUsed||c.EMPTY_STRING),e.push(this.regionSource||c.EMPTY_STRING),e.push(this.regionOutcome||c.EMPTY_STRING),e.join(",")}updateRegionDiscoveryMetadata(e){this.regionUsed=e.region_used,this.regionSource=e.region_source,this.regionOutcome=e.region_outcome}setCacheOutcome(e){this.cacheOutcome=e}setNativeBrokerErrorCode(e){var t=this.getLastRequests();t.nativeBrokerErrorCode=e,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t,this.correlationId)}getNativeBrokerErrorCode(){return this.getLastRequests().nativeBrokerErrorCode}clearNativeBrokerErrorCode(){var e=this.getLastRequests();delete e.nativeBrokerErrorCode,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e,this.correlationId)}static makeExtraSkuString(e){return function(e){var{skus:t,libraryName:r,libraryVersion:n,extensionName:o,extensionVersion:i}=e,a=new Map([[0,[r,n]],[2,[o,i]]]),c=[];if(null!=t&&t.length){if((c=t.split(",")).length<4)return t}else c=Array.from({length:4},()=>"|");return a.forEach((e,t)=>{var r,n;2===e.length&&null!==(r=e[0])&&void 0!==r&&r.length&&null!==(n=e[1])&&void 0!==n&&n.length&&function(e){var{skuArr:t,index:r,skuName:n,skuVersion:o}=e;r>=t.length||(t[r]=[n,o].join("|"))}({skuArr:c,index:t,skuName:e[0],skuVersion:e[1]})}),c.join(",")}(e)}}function hu(e,t,r,n,o,i,a){try{var c=e[i](a),l=c.value}catch(e){return void r(e)}c.done?t(l):Promise.resolve(l).then(n,o)}function fu(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var i=e.apply(t,r);function a(e){hu(i,n,o,a,c,"next",e)}function c(e){hu(i,n,o,a,c,"throw",e)}a(void 0)})}}class pu{constructor(e,t,r,n,o,i,a,c,l){this.config=e,this.browserStorage=t,this.browserCrypto=r,this.networkClient=this.config.system.networkClient,this.eventHandler=o,this.navigationClient=i,this.platformAuthProvider=c,this.correlationId=l||Ka(),this.logger=n.clone(ao,Rc,this.correlationId),this.performanceClient=a}clearCacheOnLogout(e,t){var r=this;return fu(function*(){if(t)try{r.browserStorage.removeAccount(t,e),r.logger.verbose("Cleared cache items belonging to the account provided in the logout request.")}catch(e){r.logger.error("Account provided in logout request was not found. Local cache unchanged.")}else try{r.logger.verbose("No account provided in logout request, clearing all cache items.",r.correlationId),r.browserStorage.clear(e),yield r.browserCrypto.clearKeystore()}catch(e){r.logger.error("Attempted to clear all MSAL cache items and failed. Local cache unchanged.")}})()}getRedirectUri(e){this.logger.verbose("getRedirectUri called");var t=e||this.config.auth.redirectUri;return Kt.getAbsoluteUrl(t,Cc())}initializeServerTelemetryManager(e,t){this.logger.verbose("initializeServerTelemetryManager called");var r={clientId:this.config.auth.clientId,correlationId:this.correlationId,apiId:e,forceRefresh:t||!1,wrapperSKU:this.browserStorage.getWrapperMetadata()[0],wrapperVer:this.browserStorage.getWrapperMetadata()[1]};return new du(r,this.browserStorage)}getDiscoveredAuthority(e){var t=this;return fu(function*(){var{account:r}=e,n=e.requestExtraQueryParameters&&e.requestExtraQueryParameters.hasOwnProperty("instance_aware")?e.requestExtraQueryParameters.instance_aware:void 0;t.performanceClient.addQueueMeasurement(br,t.correlationId);var o={protocolMode:t.config.auth.protocolMode,OIDCOptions:t.config.auth.OIDCOptions,knownAuthorities:t.config.auth.knownAuthorities,cloudDiscoveryMetadata:t.config.auth.cloudDiscoveryMetadata,authorityMetadata:t.config.auth.authorityMetadata,skipAuthorityMetadataCache:t.config.auth.skipAuthorityMetadataCache},i=e.requestAuthority||t.config.auth.authority,a=null!=n&&n.length?"true"===n:t.config.auth.instanceAware,c=r&&a?t.config.auth.authority.replace(Kt.getDomainFromUrl(i),r.environment):i,l=Ul.generateAuthority(c,e.requestAzureCloudOptions||t.config.auth.azureCloudOptions),s=yield gl(Hs,an,t.logger,t.performanceClient,t.correlationId)(l,t.config.system.networkClient,t.browserStorage,o,t.logger,t.correlationId,t.performanceClient);if(r&&!s.isAlias(r.environment))throw wt(pt);return s})()}}function gu(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function mu(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?gu(Object(r),!0).forEach(function(t){vu(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):gu(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function vu(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function yu(e,t,r,n,o,i,a){try{var c=e[i](a),l=c.value}catch(e){return void r(e)}c.done?t(l):Promise.resolve(l).then(n,o)}function bu(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var i=e.apply(t,r);function a(e){yu(i,n,o,a,c,"next",e)}function c(e){yu(i,n,o,a,c,"throw",e)}a(void 0)})}}function wu(e,t,r,n){return Cu.apply(this,arguments)}function Cu(){return(Cu=bu(function*(e,t,r,n){r.addQueueMeasurement(Mr,e.correlationId);var o=e.authority||t.auth.authority,i=[...e&&e.scopes||[]],a=mu(mu({},e),{},{correlationId:e.correlationId,authority:o,scopes:i});if(a.authenticationScheme){if(a.authenticationScheme===j.SSH){if(!e.sshJwk)throw wt(lt);if(!e.sshKid)throw wt(st)}n.verbose('Authentication Scheme set to "'.concat(a.authenticationScheme,'" as configured in Auth request'))}else a.authenticationScheme=j.BEARER,n.verbose('Authentication Scheme wasn\'t explicitly set in request, defaulting to "Bearer" request');return t.cache.claimsBasedCachingEnabled&&e.claims&&!Ct.isEmptyObj(e.claims)&&(a.requestedClaimsHash=yield dc(e.claims)),a})).apply(this,arguments)}function ku(e,t,r,n,o){return Iu.apply(this,arguments)}function Iu(){return(Iu=bu(function*(e,t,r,n,o){n.addQueueMeasurement(Nr,e.correlationId);var i=yield gl(wu,Mr,o,n,e.correlationId)(e,r,n,o);return mu(mu(mu({},e),i),{},{account:t,forceRefresh:e.forceRefresh||!1})})).apply(this,arguments)}function Su(e,t){var r,n=e.httpMethod;if(t===z){if((r=n||l)!==l)throw wt(gt)}else r=n||"GET";if(e.authorizePostBodyParameters&&r!==l)throw wt(mt);return r}function Tu(e,t,r,n,o,i,a){try{var c=e[i](a),l=c.value}catch(e){return void r(e)}c.done?t(l):Promise.resolve(l).then(n,o)}function Au(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var i=e.apply(t,r);function a(e){Tu(i,n,o,a,c,"next",e)}function c(e){Tu(i,n,o,a,c,"throw",e)}a(void 0)})}}function Pu(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Eu(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Pu(Object(r),!0).forEach(function(t){Ou(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Pu(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Ou(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class _u extends pu{initializeLogoutRequest(e){this.logger.verbose("initializeLogoutRequest called",null==e?void 0:e.correlationId);var t=Eu({correlationId:this.correlationId||Ka()},e);if(e)if(e.logoutHint)this.logger.verbose("logoutHint has already been set in logoutRequest");else if(e.account){var r=this.getLogoutHintFromIdTokenClaims(e.account);r&&(this.logger.verbose("Setting logoutHint to login_hint ID Token Claim value for the account provided"),t.logoutHint=r)}else this.logger.verbose("logoutHint was not set and account was not passed into logout request, logoutHint will not be set");else this.logger.verbose("logoutHint will not be set since no logout request was configured");return e&&null===e.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri passed as null, not setting post logout redirect uri",t.correlationId):e&&e.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to uri set on logout request",t.correlationId),t.postLogoutRedirectUri=Kt.getAbsoluteUrl(e.postLogoutRedirectUri,Cc())):null===this.config.auth.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri configured as null and no uri set on request, not passing post logout redirect",t.correlationId):this.config.auth.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to configured uri",t.correlationId),t.postLogoutRedirectUri=Kt.getAbsoluteUrl(this.config.auth.postLogoutRedirectUri,Cc())):(this.logger.verbose("Setting postLogoutRedirectUri to current page",t.correlationId),t.postLogoutRedirectUri=Kt.getAbsoluteUrl(Cc(),Cc())),t}getLogoutHintFromIdTokenClaims(e){var t=e.idTokenClaims;if(t){if(t.login_hint)return t.login_hint;this.logger.verbose("The ID Token Claims tied to the provided account do not contain a login_hint claim, logoutHint will not be added to logout request")}else this.logger.verbose("The provided account does not contain ID Token Claims, logoutHint will not be added to logout request");return null}createAuthCodeClient(e){var t=this;return Au(function*(){t.performanceClient.addQueueMeasurement(zr,t.correlationId);var r=yield gl(t.getClientConfiguration.bind(t),Br,t.logger,t.performanceClient,t.correlationId)(e);return new uu(r,t.performanceClient)})()}getClientConfiguration(e){var t=this;return Au(function*(){var{serverTelemetryManager:r,requestAuthority:n,requestAzureCloudOptions:o,requestExtraQueryParameters:i,account:a}=e;t.performanceClient.addQueueMeasurement(Br,t.correlationId);var l=e.authority||(yield gl(t.getDiscoveredAuthority.bind(t),br,t.logger,t.performanceClient,t.correlationId)({requestAuthority:n,requestAzureCloudOptions:o,requestExtraQueryParameters:i,account:a})),s=t.config.system.loggerOptions;return{authOptions:{clientId:t.config.auth.clientId,authority:l,clientCapabilities:t.config.auth.clientCapabilities,redirectUri:t.config.auth.redirectUri},systemOptions:{tokenRenewalOffsetSeconds:t.config.system.tokenRenewalOffsetSeconds,preventCorsPreflight:!0},loggerOptions:{loggerCallback:s.loggerCallback,piiLoggingEnabled:s.piiLoggingEnabled,logLevel:s.logLevel,correlationId:t.correlationId},cacheOptions:{claimsBasedCachingEnabled:t.config.cache.claimsBasedCachingEnabled},cryptoInterface:t.browserCrypto,networkInterface:t.networkClient,storageInterface:t.browserStorage,serverTelemetryManager:r,libraryInfo:{sku:ao,version:Rc,cpu:c.EMPTY_STRING,os:c.EMPTY_STRING},telemetry:t.config.telemetry}})()}initializeAuthorizationRequest(e,t){var r=this;return Au(function*(){r.performanceClient.addQueueMeasurement(Kr,r.correlationId);var n=r.getRedirectUri(e.redirectUri),o={interactionType:t},i=Gs.setRequestState(r.browserCrypto,e&&e.state||c.EMPTY_STRING,o),a=yield gl(wu,Mr,r.logger,r.performanceClient,r.correlationId)(Eu(Eu({},e),{},{correlationId:r.correlationId}),r.config,r.performanceClient,r.logger),l=Eu(Eu({},a),{},{redirectUri:n,state:i,nonce:e.nonce||Ka(),responseMode:r.config.auth.OIDCOptions.serverResponseType}),s=Eu(Eu({},l),{},{httpMethod:Su(l,r.config.auth.protocolMode)});if(e.loginHint||e.sid)return s;var u=e.account||r.browserStorage.getActiveAccount(r.correlationId);return u&&(r.logger.verbose("Setting validated request account",r.correlationId),r.logger.verbosePii("Setting validated request account: ".concat(u.homeAccountId),r.correlationId),s.account=u),s})()}}function Ru(e,t,r){var n=Ht(e);if(!n)throw Ft(e)?(r.error("A ".concat(t," is present in the iframe but it does not contain known properties. It's likely that the ").concat(t," has been replaced by code running on the redirectUri page.")),r.errorPii("The ".concat(t," detected is: ").concat(e)),Ri(jo)):(r.error("The request has returned to the redirectUri but a ".concat(t," is not present. It's likely that the ").concat(t," has been removed or the page has been redirected by code running on the redirectUri page.")),Ri(Lo));return n}function xu(e,t,r,n){var o=zt(t,r,n);return Kt.appendQueryString(e.authorizationEndpoint,o)}function Mu(e,t){if(!e.state||!t)throw e.state?ze(ie,"Cached State"):ze(ie,"Server State");var r,n;try{r=decodeURIComponent(e.state)}catch(t){throw ze(ne,e.state)}try{n=decodeURIComponent(t)}catch(t){throw ze(ne,e.state)}if(r!==n)throw ze(oe);if(e.error||e.error_description||e.suberror){var o=function(e){var t,r,n="code=",o=null===(t=e.error_uri)||void 0===t?void 0:t.lastIndexOf(n);return o&&o>=0?null===(r=e.error_uri)||void 0===r?void 0:r.substring(o+5):void 0}(e);if(Yl(e.error,e.error_description,e.suberror))throw new Jl(e.error||"",e.error_description,e.suberror,e.timestamp||"",e.trace_id||"",e.correlation_id||"",e.claims||"",o);throw new Bs(e.error||"",e.error_description,e.suberror,o)}}function Nu(e,t,r,n,o,i,a){try{var c=e[i](a),l=c.value}catch(e){return void r(e)}c.done?t(l):Promise.resolve(l).then(n,o)}function Du(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var i=e.apply(t,r);function a(e){Nu(i,n,o,a,c,"next",e)}function c(e){Nu(i,n,o,a,c,"throw",e)}a(void 0)})}}class Lu{constructor(e,t,r,n,o){this.authModule=e,this.browserStorage=t,this.authCodeRequest=r,this.logger=n,this.performanceClient=o}handleCodeResponse(e,t){var r=this;return Du(function*(){var n;r.performanceClient.addQueueMeasurement(Qr,t.correlationId);try{n=function(e,t){if(Mu(e,t),!e.code)throw ze(_e);return e}(e,t.state)}catch(e){throw e instanceof Bs&&e.subError===Ko?Ri(Ko):e}return gl(r.handleCodeResponseFromServer.bind(r),Wr,r.logger,r.performanceClient,t.correlationId)(n,t)})()}handleCodeResponseFromServer(e,t){var r=arguments,n=this;return Du(function*(){var o=!(r.length>2&&void 0!==r[2])||r[2];if(n.performanceClient.addQueueMeasurement(Wr,t.correlationId),n.logger.trace("InteractionHandler.handleCodeResponseFromServer called"),n.authCodeRequest.code=e.code,e.cloud_instance_host_name&&(yield gl(n.authModule.updateAuthority.bind(n.authModule),$r,n.logger,n.performanceClient,t.correlationId)(e.cloud_instance_host_name,t.correlationId)),o&&(e.nonce=t.nonce||void 0),e.state=t.state,e.client_info)n.authCodeRequest.clientInfo=e.client_info;else{var i=n.createCcsCredentials(t);i&&(n.authCodeRequest.ccsCredential=i)}return yield gl(n.authModule.acquireToken.bind(n.authModule),Xr,n.logger,n.performanceClient,t.correlationId)(n.authCodeRequest,e)})()}createCcsCredentials(e){return e.account?{credential:e.account.homeAccountId,type:js}:e.loginHint?{credential:e.loginHint,type:Us}:null}}var qu="user_switch",ju={[qu]:"User attempted to switch accounts in the native broker, which is not allowed. All new accounts must sign-in through the standard web flow first, please try again."};class Uu extends Q{constructor(e,t,r){super(e,t),Object.setPrototypeOf(this,Uu.prototype),this.name="NativeAuthError",this.ext=r}}function Fu(e){if(e.ext&&e.ext.status&&"DISABLED"===e.ext.status)return!0;if(e.ext&&e.ext.error&&-2147186943===e.ext.error)return!0;switch(e.errorCode){case"ContentError":case"PageException":return!0;default:return!1}}function Hu(e,t,r){if(r&&r.status)switch(r.status){case"ACCOUNT_UNAVAILABLE":return $l(zl);case"USER_INTERACTION_REQUIRED":return new Jl(e,t);case"USER_CANCEL":return Ri(Ko);case"NO_NETWORK":return Ri(ai);case"UX_NOT_ALLOWED":return $l(Kl)}return new Uu(e,ju[e]||t,r)}function zu(e,t,r,n,o,i,a){try{var c=e[i](a),l=c.value}catch(e){return void r(e)}c.done?t(l):Promise.resolve(l).then(n,o)}function Bu(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var i=e.apply(t,r);function a(e){zu(i,n,o,a,c,"next",e)}function c(e){zu(i,n,o,a,c,"throw",e)}a(void 0)})}}class Ku extends Qs{constructor(e,t){super(e,t)}acquireCachedToken(e){var t=this;return Bu(function*(){var r;null===(r=t.performanceClient)||void 0===r||r.addQueueMeasurement(_r,e.correlationId);var n="0";if(e.forceRefresh||!t.config.cacheOptions.claimsBasedCachingEnabled&&!Ct.isEmptyObj(e.claims))throw t.setCacheOutcome("1",e.correlationId),ze(Pe);if(!e.account)throw ze(be);var o,i=e.account.tenantId||function(e){var t,r=null===(t=new Kt(e).getUrlComponents().PathSegments.slice(-1)[0])||void 0===t?void 0:t.toLowerCase();switch(r){case v:case y:case b:return;default:return r}}(e.authority),a=t.cacheManager.getTokenKeys(),c=t.cacheManager.getAccessToken(e.account,e,a,i);if(!c)throw t.setCacheOutcome("2",e.correlationId),ze(Pe);if(o=c.cachedAt,Number(o)>bl()||kl(c.expiresOn,t.config.systemOptions.tokenRenewalOffsetSeconds))throw t.setCacheOutcome("3",e.correlationId),ze(Pe);c.refreshOn&&kl(c.refreshOn,0)&&(n="4");var l=e.authority||t.authority.getPreferredCache(),s={account:t.cacheManager.getAccount(t.cacheManager.generateAccountKey(e.account),e.correlationId),accessToken:c,idToken:t.cacheManager.getIdToken(e.account,e.correlationId,a,i,t.performanceClient),refreshToken:null,appMetadata:t.cacheManager.readAppMetadataFromCache(l)};return t.setCacheOutcome(n,e.correlationId),t.config.serverTelemetryManager&&t.config.serverTelemetryManager.incrementCacheHits(),[yield gl(t.generateResultFromCacheRecord.bind(t),Rr,t.logger,t.performanceClient,e.correlationId)(s,e),n]})()}setCacheOutcome(e,t){var r,n;null===(r=this.serverTelemetryManager)||void 0===r||r.setCacheOutcome(e),null===(n=this.performanceClient)||void 0===n||n.addFields({cacheOutcome:e},t),"0"!==e&&this.logger.info("Token refresh is required due to cache outcome: ".concat(e))}generateResultFromCacheRecord(e,t){var r=this;return Bu(function*(){var n,o;if(null===(n=r.performanceClient)||void 0===n||n.addQueueMeasurement(Rr,t.correlationId),e.idToken&&(o=Lt(e.idToken.secret,r.config.cryptoInterface.base64Decode)),t.maxAge||0===t.maxAge){var i,a=null===(i=o)||void 0===i?void 0:i.auth_time;if(!a)throw ze(ce);jt(a,t.maxAge)}return nu.generateAuthenticationResult(r.cryptoUtils,r.authority,e,!0,t,o)})()}}function Vu(e,t,r,n,o,i,a){try{var c=e[i](a),l=c.value}catch(e){return void r(e)}c.done?t(l):Promise.resolve(l).then(n,o)}class Wu extends _u{acquireToken(e){var t,r=this;return(t=function*(){r.performanceClient.addQueueMeasurement(gr,e.correlationId);var t=r.initializeServerTelemetryManager(61),n=yield gl(r.getClientConfiguration.bind(r),Br,r.logger,r.performanceClient,r.correlationId)({serverTelemetryManager:t,requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,account:e.account}),o=new Ku(n,r.performanceClient);r.logger.verbose("Silent auth client created");try{var i=(yield gl(o.acquireCachedToken.bind(o),_r,r.logger,r.performanceClient,e.correlationId)(e))[0];return r.performanceClient.addFields({fromCache:!0},e.correlationId),i}catch(e){throw e instanceof _i&&e.errorCode===di&&r.logger.verbose("Signing keypair for bound access token not found. Refreshing bound access token and generating a new crypto keypair."),e}},function(){var e=this,r=arguments;return new Promise(function(n,o){var i=t.apply(e,r);function a(e){Vu(i,n,o,a,c,"next",e)}function c(e){Vu(i,n,o,a,c,"throw",e)}a(void 0)})})()}logout(e){this.logger.verbose("logoutRedirect called");var t=this.initializeLogoutRequest(e);return this.clearCacheOnLogout(t.correlationId,null==t?void 0:t.account)}}var Qu=["prompt"],Gu=["scopes"];function Ju(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function Yu(){return Yu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Yu.apply(null,arguments)}function $u(e,t,r,n,o,i,a){try{var c=e[i](a),l=c.value}catch(e){return void r(e)}c.done?t(l):Promise.resolve(l).then(n,o)}function Xu(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var i=e.apply(t,r);function a(e){$u(i,n,o,a,c,"next",e)}function c(e){$u(i,n,o,a,c,"throw",e)}a(void 0)})}}function Zu(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function ed(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Zu(Object(r),!0).forEach(function(t){td(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Zu(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function td(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class rd extends pu{constructor(e,t,r,n,o,i,a,c,l,s,u,d){super(e,t,r,n,o,i,c,l,d),this.apiId=a,this.accountId=s,this.platformAuthProvider=l,this.nativeStorageManager=u,this.silentCacheClient=new Wu(e,this.nativeStorageManager,r,n,o,i,c,l,d);var h=this.platformAuthProvider.getExtensionName();this.skus=du.makeExtraSkuString({libraryName:ao,libraryVersion:Rc,extensionName:h,extensionVersion:this.platformAuthProvider.getExtensionVersion()})}addRequestSKUs(e){e.extraParameters=ed(ed({},e.extraParameters),{},{[Vi]:this.skus})}acquireToken(e,t){var r=this;return Xu(function*(){r.performanceClient.addQueueMeasurement(wr,r.correlationId),r.logger.trace("NativeInteractionClient - acquireToken called.");var n=r.performanceClient.startMeasurement(wr,r.correlationId),o=bl(),i=r.initializeServerTelemetryManager(r.apiId);try{var a=yield r.initializeNativeRequest(e);try{var c=yield r.acquireTokensFromCache(r.accountId,a);return n.end({success:!0,isNativeBroker:!1,fromCache:!0}),c}catch(e){if(1===t)throw r.logger.info("MSAL internal Cache does not contain tokens, return error as per cache policy"),n.end({success:!1,brokerErrorCode:"cache_request_failed"}),e;r.logger.info("MSAL internal Cache does not contain tokens, proceed to make a native call")}var l=yield r.platformAuthProvider.sendMessage(a);return yield r.handleNativeResponse(l,a,o).then(e=>(n.end({success:!0,isNativeBroker:!0,requestId:e.requestId}),i.clearNativeBrokerErrorCode(),e)).catch(e=>{throw n.end({success:!1,errorCode:e.errorCode,subErrorCode:e.subError}),e})}catch(e){throw e instanceof Uu&&i.setNativeBrokerErrorCode(e.errorCode),n.end({success:!1}),e}})()}createSilentCacheRequest(e,t){return{authority:e.authority,correlationId:this.correlationId,scopes:kt.fromString(e.scope).asArray(),account:t,forceRefresh:!1}}acquireTokensFromCache(e,t){var r=this;return Xu(function*(){if(!e)throw r.logger.warning("NativeInteractionClient:acquireTokensFromCache - No nativeAccountId provided"),ze(ke);var n=r.browserStorage.getBaseAccountInfo({nativeAccountId:e},r.correlationId);if(!n)throw ze(ke);try{var o=r.createSilentCacheRequest(t,n),i=yield r.silentCacheClient.acquireToken(o),a=ed(ed({},n),{},{idTokenClaims:null==i?void 0:i.idTokenClaims,idToken:null==i?void 0:i.idToken});return ed(ed({},i),{},{account:a})}catch(e){throw e}})()}acquireTokenRedirect(e,t){var r=this;return Xu(function*(){r.logger.trace("NativeInteractionClient - acquireTokenRedirect called.");var n=Yu({},(function(e){if(null==e)throw new TypeError("Cannot destructure "+e)}(e),e));delete n.onRedirectNavigate;var o=yield r.initializeNativeRequest(n);try{yield r.platformAuthProvider.sendMessage(o)}catch(e){if(e instanceof Uu&&(r.initializeServerTelemetryManager(r.apiId).setNativeBrokerErrorCode(e.errorCode),Fu(e)))throw e}r.browserStorage.setTemporaryCache(ko,JSON.stringify(o),!0);var i={apiId:To,timeout:r.config.system.redirectNavigationTimeout,noHistory:!1},a=r.config.auth.navigateToLoginRequestUrl?window.location.href:r.getRedirectUri(e.redirectUri);t.end({success:!0}),yield r.navigationClient.navigateExternal(a,i)})()}handleRedirectPromise(e,t){var r=this;return Xu(function*(){if(r.logger.trace("NativeInteractionClient - handleRedirectPromise called."),!r.browserStorage.isInteractionInProgress(!0))return r.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;var n=r.browserStorage.getCachedNativeRequest();if(!n)return r.logger.verbose("NativeInteractionClient - handleRedirectPromise called but there is no cached request, returning null."),e&&t&&(null==e||e.addFields({errorCode:"no_cached_request"},t)),null;var{prompt:o}=n,i=Ju(n,Qu);o&&r.logger.verbose("NativeInteractionClient - handleRedirectPromise called and prompt was included in the original request, removing prompt from cached request to prevent second interaction with native broker window."),r.browserStorage.removeItem(r.browserStorage.generateCacheKey(ko));var a=bl();try{r.logger.verbose("NativeInteractionClient - handleRedirectPromise sending message to native broker.");var c=yield r.platformAuthProvider.sendMessage(i),l=yield r.handleNativeResponse(c,i,a);return r.initializeServerTelemetryManager(r.apiId).clearNativeBrokerErrorCode(),e&&r.correlationId&&r.performanceClient.addFields({isNativeBroker:!0},r.correlationId),l}catch(e){throw e}})()}logout(){return this.logger.trace("NativeInteractionClient - logout called."),Promise.reject("Logout not implemented yet")}handleNativeResponse(e,t,r){var n=this;return Xu(function*(){var o,i;n.logger.trace("NativeInteractionClient - handleNativeResponse called.");var a=Lt(e.id_token,Aa),c=n.createHomeAccountIdentifier(e,a),l=null===(o=n.browserStorage.getAccountInfoFilteredBy({nativeAccountId:t.accountId},n.correlationId))||void 0===o?void 0:o.homeAccountId;if(null!==(i=t.extraParameters)&&void 0!==i&&i.child_client_id&&e.account.id!==t.accountId)n.logger.info("handleNativeServerResponse: Double broker flow detected, ignoring accountId mismatch");else if(c!==l&&e.account.id!==t.accountId)throw Hu(qu);var s=yield n.getDiscoveredAuthority({requestAuthority:t.authority}),u=ou(n.browserStorage,s,c,Aa,n.correlationId,a,e.client_info,void 0,a.tid,void 0,e.account.id,n.logger);e.expires_in=Number(e.expires_in);var d=yield n.generateAuthenticationResult(e,t,a,u,s.canonicalAuthority,r);return yield n.cacheAccount(u,n.correlationId,qt(a)),yield n.cacheNativeTokens(e,t,c,a,e.access_token,d.tenantId,r),d})()}createHomeAccountIdentifier(e,t){return Dt.generateHomeAccountId(e.client_info||c.EMPTY_STRING,0,this.logger,this.browserCrypto,t)}generateScopes(e,t){return t?kt.fromString(t):kt.fromString(e)}generatePopAccessToken(e,t){var r=this;return Xu(function*(){if(t.tokenType===j.POP&&t.signPopToken){if(e.shr)return r.logger.trace("handleNativeServerResponse: SHR is enabled in native layer"),e.shr;var n=new Zs(r.browserCrypto),o={resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,shrNonce:t.shrNonce};if(!t.keyId)throw ze(Me);return n.signPopToken(e.access_token,t.keyId,o)}return e.access_token})()}generateAuthenticationResult(e,t,r,n,o,i){var a=this;return Xu(function*(){var l=a.addTelemetryFromNativeResponse(e.properties.MATS),s=a.generateScopes(t.scope,e.scope),u=e.account.properties||{},d=u.UID||r.oid||r.sub||c.EMPTY_STRING,h=u.TenantId||r.tid||c.EMPTY_STRING,f=Mt(Dt.getAccountInfo(n),void 0,r,e.id_token);f.nativeAccountId!==e.account.id&&(f.nativeAccountId=e.account.id);var p=yield a.generatePopAccessToken(e,t),g=t.tokenType===j.POP?j.POP:j.BEARER;return{authority:o,uniqueId:d,tenantId:h,scopes:s.asArray(),account:f,idToken:e.id_token,idTokenClaims:r,accessToken:p,fromCache:!!l&&a.isResponseFromCache(l),expiresOn:Cl(i+e.expires_in),tokenType:g,correlationId:a.correlationId,state:e.state,fromNativeBroker:!0}})()}cacheAccount(e,t,r){var n=this;return Xu(function*(){yield n.browserStorage.setAccount(e,n.correlationId,r),n.browserStorage.removeAccountContext(Dt.getAccountInfo(e),t)})()}cacheNativeTokens(e,t,r,n,o,i,a){var l=Sl(r,t.authority,e.id_token||"",t.clientId,n.tid||""),s=a+(t.tokenType===j.POP?c.SHR_NONCE_VALIDITY:("string"==typeof e.expires_in?parseInt(e.expires_in,10):e.expires_in)||0),u=this.generateScopes(e.scope,t.scope),d={idToken:l,accessToken:Tl(r,t.authority,o,t.clientId,n.tid||i,u.printScopes(),s,0,Aa,void 0,t.tokenType,void 0,t.keyId)};return this.nativeStorageManager.saveCacheRecord(d,this.correlationId,qt(n),t.storeInCache)}getExpiresInValue(e,t){return e===j.POP?c.SHR_NONCE_VALIDITY:("string"==typeof t?parseInt(t,10):t)||0}addTelemetryFromNativeResponse(e){var t=this.getMATSFromResponse(e);return t?(this.performanceClient.addFields({extensionId:this.platformAuthProvider.getExtensionId(),extensionVersion:this.platformAuthProvider.getExtensionVersion(),matsBrokerVersion:t.broker_version,matsAccountJoinOnStart:t.account_join_on_start,matsAccountJoinOnEnd:t.account_join_on_end,matsDeviceJoin:t.device_join,matsPromptBehavior:t.prompt_behavior,matsApiErrorCode:t.api_error_code,matsUiVisible:t.ui_visible,matsSilentCode:t.silent_code,matsSilentBiSubCode:t.silent_bi_sub_code,matsSilentMessage:t.silent_message,matsSilentStatus:t.silent_status,matsHttpStatus:t.http_status,matsHttpEventCount:t.http_event_count},this.correlationId),t):null}getMATSFromResponse(e){if(e)try{return JSON.parse(e)}catch(e){this.logger.error("NativeInteractionClient - Error parsing MATS telemetry, returning null instead")}return null}isResponseFromCache(e){return void 0===e.is_cached?(this.logger.verbose("NativeInteractionClient - MATS telemetry does not contain field indicating if response was served from cache. Returning false."),!1):!!e.is_cached}initializeNativeRequest(e){var t=this;return Xu(function*(){t.logger.trace("NativeInteractionClient - initializeNativeRequest called");var r=yield t.getCanonicalAuthority(e),{scopes:n}=e,o=Ju(e,Gu),i=new kt(n||[]);i.appendScopes(s);var a=ed(ed({},o),{},{accountId:t.accountId,clientId:t.config.auth.clientId,authority:r.urlString,scope:i.printScopes(),redirectUri:t.getRedirectUri(e.redirectUri),prompt:t.getPrompt(e.prompt),correlationId:t.correlationId,tokenType:e.authenticationScheme,windowTitleSubstring:document.title,extraParameters:ed(ed({},e.extraQueryParameters),e.tokenQueryParameters),extendedExpiryToken:!1,keyId:e.popKid});if(a.signPopToken&&e.popKid)throw Ri(Ii);if(t.handleExtraBrokerParams(a),a.extraParameters=a.extraParameters||{},a.extraParameters.telemetry="MATS",e.authenticationScheme===j.POP){var c,l={resourceRequestUri:e.resourceRequestUri,resourceRequestMethod:e.resourceRequestMethod,shrClaims:e.shrClaims,shrNonce:e.shrNonce},u=new Zs(t.browserCrypto);if(a.keyId)c=t.browserCrypto.base64UrlEncode(JSON.stringify({kid:a.keyId})),a.signPopToken=!1;else{var d=yield gl(u.generateCnf.bind(u),tn,t.logger,t.performanceClient,t.correlationId)(l,t.logger);c=d.reqCnfString,a.keyId=d.kid,a.signPopToken=!0}a.reqCnf=c}return t.addRequestSKUs(a),a})()}getCanonicalAuthority(e){var t=this;return Xu(function*(){var r=e.authority||t.config.auth.authority;e.account&&(yield t.getDiscoveredAuthority({requestAuthority:r,requestAzureCloudOptions:e.azureCloudOptions,account:e.account}));var n=new Kt(r);return n.validateAsUri(),n})()}getPrompt(e){switch(this.apiId){case 863:case 61:return this.logger.trace("initializeNativeRequest: silent request sets prompt to none"),T}if(e)switch(e){case T:case S:case k:case I:return this.logger.trace("initializeNativeRequest: prompt is compatible with native flow"),e;default:throw this.logger.trace("initializeNativeRequest: prompt = ".concat(e," is not compatible with native flow")),Ri(Ci)}else this.logger.trace("initializeNativeRequest: prompt was not provided")}handleExtraBrokerParams(e){var t,r=e.extraParameters&&e.extraParameters.hasOwnProperty(Wi)&&e.extraParameters.hasOwnProperty(Qi)&&e.extraParameters.hasOwnProperty(Fi);if(e.embeddedClientId||r){var n="",o=e.redirectUri;e.embeddedClientId?(e.redirectUri=this.config.auth.redirectUri,n=e.embeddedClientId):e.extraParameters&&(e.redirectUri=e.extraParameters[Qi],n=e.extraParameters[Fi]),e.extraParameters={child_client_id:n,child_redirect_uri:o},null===(t=this.performanceClient)||void 0===t||t.addFields({embeddedClientId:n,embeddedRedirectUri:o},this.correlationId)}}}function nd(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function od(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?nd(Object(r),!0).forEach(function(t){id(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nd(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function id(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ad(e,t,r,n,o,i,a){try{var c=e[i](a),l=c.value}catch(e){return void r(e)}c.done?t(l):Promise.resolve(l).then(n,o)}function cd(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var i=e.apply(t,r);function a(e){ad(i,n,o,a,c,"next",e)}function c(e){ad(i,n,o,a,c,"throw",e)}a(void 0)})}}function ld(e,t,r,n,o){return sd.apply(this,arguments)}function sd(){return(sd=cd(function*(e,t,r,n,o){var i=function(e,t,r,n){var o,i,a,c=t.correlationId,l=new Map;if(Xi(l,t.embeddedClientId||(null===(o=t.extraQueryParameters)||void 0===o?void 0:o[Fi])||e.clientId),$i(l,[...t.scopes||[],...t.extraScopesToConsent||[]],!0,null===(i=e.authority.options.OIDCOptions)||void 0===i?void 0:i.defaultScopes),Zi(l,t.redirectUri),ia(l,c),function(e,t){e.set("response_mode",t||"query")}(l,t.responseMode),pa(l),t.prompt&&(function(e,t){e.set("prompt",t)}(l,t.prompt),null==n||n.addFields({prompt:t.prompt},c)),t.domainHint&&(function(e,t){e.set("domain_hint",t)}(l,t.domainHint),null==n||n.addFields({domainHintFromRequest:!0},c)),t.prompt!==I)if(t.sid&&t.prompt===T)r.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),na(l,t.sid),null==n||n.addFields({sidFromRequest:!0},c);else if(t.account){var s=(null===(a=t.account.idTokenClaims)||void 0===a?void 0:a.sid)||null,u=(d=t.account).loginHint||(null===(h=d.idTokenClaims)||void 0===h?void 0:h.login_hint)||null;if(u&&t.domainHint&&(r.warning('AuthorizationCodeClient.createAuthCodeUrlQueryString: "domainHint" param is set, skipping opaque "login_hint" claim. Please consider not passing domainHint'),u=null),u){r.verbose("createAuthCodeUrlQueryString: login_hint claim present on account"),ea(l,u),null==n||n.addFields({loginHintFromClaim:!0},c);try{ra(l,St(t.account.homeAccountId))}catch(e){r.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(s&&t.prompt===T){r.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),na(l,s),null==n||n.addFields({sidFromClaim:!0},c);try{ra(l,St(t.account.homeAccountId))}catch(e){r.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(t.loginHint)r.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),ea(l,t.loginHint),ta(l,t.loginHint),null==n||n.addFields({loginHintFromRequest:!0},c);else if(t.account.username){r.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),ea(l,t.account.username),null==n||n.addFields({loginHintFromUpn:!0},c);try{ra(l,St(t.account.homeAccountId))}catch(e){r.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}}else t.loginHint&&(r.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),ea(l,t.loginHint),ta(l,t.loginHint),null==n||n.addFields({loginHintFromRequest:!0},c));else r.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");var d,h;return t.nonce&&function(e,t){e.set("nonce",t)}(l,t.nonce),t.state&&la(l,t.state),(t.claims||e.clientCapabilities&&e.clientCapabilities.length>0)&&oa(l,t.claims,e.clientCapabilities),t.embeddedClientId&&Ca(l,e.clientId,e.redirectUri),!e.instanceAware||t.extraQueryParameters&&Object.keys(t.extraQueryParameters).includes(Gi)||ga(l),l}(od(od({},e.auth),{},{authority:t}),r,n,o);if(aa(i,{sku:ao,version:Rc,os:"",cpu:""}),e.auth.protocolMode!==H&&ca(i,e.telemetry.application),r.platformBroker&&(function(e){e.set("nativebroker","1")}(i),o.addFields({isPlatformAuthorizeRequest:!0},r.correlationId),r.authenticationScheme===j.POP)){var a=new hl(n,o),c=new Zs(a);va(i,r.popKid?a.encodeKid(r.popKid):(yield gl(c.generateCnf.bind(c),tn,n,o,r.correlationId)(r,n)).reqCnfString)}return Ji(i,r.correlationId,o),i})).apply(this,arguments)}function ud(e,t,r,n,o){return dd.apply(this,arguments)}function dd(){return(dd=cd(function*(e,t,r,n,o){if(!r.codeChallenge)throw wt(ot);var i=yield gl(ld,"getStandardParams",n,o,r.correlationId)(e,t,r,n,o);return Yi(i,A),sa(i,r.codeChallenge,c.S256_CODE_CHALLENGE_METHOD),ma(i,r.extraQueryParameters||{}),xu(t,i,e.auth.encodeExtraQueryParams,r.extraQueryParameters)})).apply(this,arguments)}function hd(e,t,r,n,o,i){return fd.apply(this,arguments)}function fd(){return(fd=cd(function*(e,t,r,n,o,i){if(!n.earJwk)throw Ri(xo);var a=yield ld(t,r,n,o,i);Yi(a,"id_token token refresh_token"),function(e,t){e.set("ear_jwk",encodeURIComponent(t)),e.set("ear_jwe_crypto","eyJhbGciOiJkaXIiLCJlbmMiOiJBMjU2R0NNIn0")}(a,n.earJwk),sa(a,n.codeChallenge,c.S256_CODE_CHALLENGE_METHOD);var l=new Map;return ma(l,n.extraQueryParameters||{}),md(e,xu(r,l,t.auth.encodeExtraQueryParams,n.extraQueryParameters),a)})).apply(this,arguments)}function pd(e,t,r,n,o,i){return gd.apply(this,arguments)}function gd(){return(gd=cd(function*(e,t,r,n,o,i){var a=yield ld(t,r,n,o,i);Yi(a,A),sa(a,n.codeChallenge,n.codeChallengeMethod||c.S256_CODE_CHALLENGE_METHOD),function(e,t){Object.entries(t).forEach(t=>{var[r,n]=t;n&&e.set(r,n)})}(a,n.authorizePostBodyParameters||{});var l=new Map;return ma(l,n.extraQueryParameters||{}),md(e,xu(r,l,t.auth.encodeExtraQueryParams,n.extraQueryParameters),a)})).apply(this,arguments)}function md(e,t,r){var n=e.createElement("form");return n.method="post",n.action=t,r.forEach((t,r)=>{var o=e.createElement("input");o.hidden=!0,o.name=r,o.value=t,n.appendChild(o)}),e.body.appendChild(n),n}function vd(e,t,r,n,o,i,a,c,l,s){return yd.apply(this,arguments)}function yd(){return(yd=cd(function*(e,t,r,n,o,i,a,c,l,s){if(c.verbose("Account id found, calling WAM for token"),!s)throw Ri(bi);var u=new hl(c,l),d=new rd(n,o,u,c,a,n.system.navigationClient,r,l,s,t,i,e.correlationId),{userRequestState:h}=Gs.parseRequestState(u,e.state);return gl(d.acquireToken.bind(d),wr,c,l,e.correlationId)(od(od({},e),{},{state:h,prompt:void 0}))})).apply(this,arguments)}function bd(e,t,r,n,o,i,a,c,l,s,u,d){return wd.apply(this,arguments)}function wd(){return(wd=cd(function*(e,t,r,n,o,i,a,c,l,s,u,d){if(Ks.removeThrottle(a,o.auth.clientId,e),t.accountId)return gl(vd,Jr,s,u,e.correlationId)(e,t.accountId,n,o,a,c,l,s,u,d);var h=od(od({},e),{},{code:t.code||"",codeVerifier:r}),f=new Lu(i,a,h,s,u);return yield gl(f.handleCodeResponse.bind(f),Qr,s,u,e.correlationId)(t,e)})).apply(this,arguments)}function Cd(e,t,r,n,o,i,a,c,l,s,u){return kd.apply(this,arguments)}function kd(){return(kd=cd(function*(e,t,r,n,o,i,a,c,l,s,u){if(Ks.removeThrottle(i,n.auth.clientId,e),Mu(t,e.state),!t.ear_jwe)throw Ri(Mo);if(!e.earJwk)throw Ri(xo);var d=JSON.parse(yield gl(Za,jn,l,s,e.correlationId)(e.earJwk,t.ear_jwe));if(d.accountId)return gl(vd,Jr,l,s,e.correlationId)(e,d.accountId,r,n,i,a,c,l,s,u);var h=new nu(n.auth.clientId,i,new hl(l,s),l,null,null,s);h.validateTokenResponse(d);var f={code:"",state:e.state,nonce:e.nonce,client_info:d.client_info,cloud_graph_host_name:d.cloud_graph_host_name,cloud_instance_host_name:d.cloud_instance_host_name,cloud_instance_name:d.cloud_instance_name,msgraph_host:d.msgraph_host};return yield gl(h.handleServerTokenResponse.bind(h),nn,l,s,e.correlationId)(d,o,bl(),e,f,void 0,void 0,void 0,void 0)})).apply(this,arguments)}function Id(e,t,r,n,o,i,a){try{var c=e[i](a),l=c.value}catch(e){return void r(e)}c.done?t(l):Promise.resolve(l).then(n,o)}function Sd(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var i=e.apply(t,r);function a(e){Id(i,n,o,a,c,"next",e)}function c(e){Id(i,n,o,a,c,"throw",e)}a(void 0)})}}function Td(e,t,r){return Ad.apply(this,arguments)}function Ad(){return(Ad=Sd(function*(e,t,r){e.addQueueMeasurement(An,r);var n=pl(Pd,Pn,t,e,r)(e,t,r);return{verifier:n,challenge:yield gl(Ed,En,t,e,r)(n,e,t,r)}})).apply(this,arguments)}function Pd(e,t,r){try{var n=new Uint8Array(32);return pl(za,_n,t,e,r)(n),Ia(n)}catch(e){throw Ri(Ro)}}function Ed(e,t,r,n){return Od.apply(this,arguments)}function Od(){return(Od=Sd(function*(e,t,r,n){t.addQueueMeasurement(En,n);try{var o=yield gl(Fa,On,r,t,n)(e,t,n);return Ia(new Uint8Array(o))}catch(e){throw Ri(Ro)}})).apply(this,arguments)}function _d(e,t,r,n,o,i,a){try{var c=e[i](a),l=c.value}catch(e){return void r(e)}c.done?t(l):Promise.resolve(l).then(n,o)}function Rd(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var i=e.apply(t,r);function a(e){_d(i,n,o,a,c,"next",e)}function c(e){_d(i,n,o,a,c,"throw",e)}a(void 0)})}}class xd{constructor(e,t,r,n){this.logger=e,this.handshakeTimeoutMs=t,this.extensionId=n,this.resolvers=new Map,this.handshakeResolvers=new Map,this.messageChannel=new MessageChannel,this.windowListener=this.onWindowMessage.bind(this),this.performanceClient=r,this.handshakeEvent=r.startMeasurement(bn),this.platformAuthType="PlatformAuthExtensionHandler"}sendMessage(e){var t=this;return Rd(function*(){t.logger.trace(t.platformAuthType+" - sendMessage called.");var r={method:"GetToken",request:e},n={channel:co,extensionId:t.extensionId,responseId:Ka(),body:r};t.logger.trace(t.platformAuthType+" - Sending request to browser extension"),t.logger.tracePii(t.platformAuthType+" - Sending request to browser extension: ".concat(JSON.stringify(n))),t.messageChannel.port1.postMessage(n);var o=yield new Promise((e,r)=>{t.resolvers.set(n.responseId,{resolve:e,reject:r})});return t.validatePlatformBrokerResponse(o)})()}static createProvider(e,t,r){return Rd(function*(){e.trace("PlatformAuthExtensionHandler - createProvider called.");try{var n=new xd(e,t,r,lo);return yield n.sendHandshakeRequest(),n}catch(n){var o=new xd(e,t,r);return yield o.sendHandshakeRequest(),o}})()}sendHandshakeRequest(){var e=this;return Rd(function*(){e.logger.trace(e.platformAuthType+" - sendHandshakeRequest called."),window.addEventListener("message",e.windowListener,!1);var t={channel:co,extensionId:e.extensionId,responseId:Ka(),body:{method:uo}};return e.handshakeEvent.add({extensionId:e.extensionId,extensionHandshakeTimeoutMs:e.handshakeTimeoutMs}),e.messageChannel.port1.onmessage=t=>{e.onChannelMessage(t)},window.postMessage(t,window.origin,[e.messageChannel.port2]),new Promise((r,n)=>{e.handshakeResolvers.set(t.responseId,{resolve:r,reject:n}),e.timeoutId=window.setTimeout(()=>{window.removeEventListener("message",e.windowListener,!1),e.messageChannel.port1.close(),e.messageChannel.port2.close(),e.handshakeEvent.end({extensionHandshakeTimedOut:!0,success:!1}),n(Ri(vi)),e.handshakeResolvers.delete(t.responseId)},e.handshakeTimeoutMs)})})()}onWindowMessage(e){if(this.logger.trace(this.platformAuthType+" - onWindowMessage called"),e.source===window){var t=e.data;if(t.channel&&t.channel===co&&(!t.extensionId||t.extensionId===this.extensionId)&&t.body.method===uo){var r=this.handshakeResolvers.get(t.responseId);if(!r)return void this.logger.trace(this.platformAuthType+".onWindowMessage - resolver can't be found for request ".concat(t.responseId));this.logger.verbose(t.extensionId?"Extension with id: ".concat(t.extensionId," not installed"):"No extension installed"),clearTimeout(this.timeoutId),this.messageChannel.port1.close(),this.messageChannel.port2.close(),window.removeEventListener("message",this.windowListener,!1),this.handshakeEvent.end({success:!1,extensionInstalled:!1}),r.reject(Ri(yi))}}}onChannelMessage(e){this.logger.trace(this.platformAuthType+" - onChannelMessage called.");var t=e.data,r=this.resolvers.get(t.responseId),n=this.handshakeResolvers.get(t.responseId);try{var o=t.body.method;if("Response"===o){if(!r)return;var i=t.body.response;if(this.logger.trace(this.platformAuthType+" - Received response from browser extension"),this.logger.tracePii(this.platformAuthType+" - Received response from browser extension: ".concat(JSON.stringify(i))),"Success"!==i.status)r.reject(Hu(i.code,i.description,i.ext));else{if(!i.result)throw G(K,"Event does not contain result.");i.result.code&&i.result.description?r.reject(Hu(i.result.code,i.result.description,i.result.ext)):r.resolve(i.result)}this.resolvers.delete(t.responseId)}else if("HandshakeResponse"===o){if(!n)return void this.logger.trace(this.platformAuthType+".onChannelMessage - resolver can't be found for request ".concat(t.responseId));clearTimeout(this.timeoutId),window.removeEventListener("message",this.windowListener,!1),this.extensionId=t.extensionId,this.extensionVersion=t.body.version,this.logger.verbose(this.platformAuthType+" - Received HandshakeResponse from extension: ".concat(this.extensionId)),this.handshakeEvent.end({extensionInstalled:!0,success:!0}),n.resolve(),this.handshakeResolvers.delete(t.responseId)}}catch(t){this.logger.error("Error parsing response from WAM Extension"),this.logger.errorPii("Error parsing response from WAM Extension: ".concat(t)),this.logger.errorPii("Unable to parse ".concat(e)),r?r.reject(t):n&&n.reject(t)}}validatePlatformBrokerResponse(e){if(e.hasOwnProperty("access_token")&&e.hasOwnProperty("id_token")&&e.hasOwnProperty("client_info")&&e.hasOwnProperty("account")&&e.hasOwnProperty("scope")&&e.hasOwnProperty("expires_in"))return e;throw G(K,"Response missing expected properties.")}getExtensionId(){return this.extensionId}getExtensionVersion(){return this.extensionVersion}getExtensionName(){var e;return this.getExtensionId()===lo?"chrome":null!==(e=this.getExtensionId())&&void 0!==e&&e.length?"unknown":void 0}}var Md=["accountId","clientId","authority","scope","redirectUri","correlationId","state","storeInCache","embeddedClientId","extraParameters"];function Nd(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Dd(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Nd(Object(r),!0).forEach(function(t){Ld(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Nd(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Ld(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qd(e,t,r,n,o,i,a){try{var c=e[i](a),l=c.value}catch(e){return void r(e)}c.done?t(l):Promise.resolve(l).then(n,o)}function jd(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var i=e.apply(t,r);function a(e){qd(i,n,o,a,c,"next",e)}function c(e){qd(i,n,o,a,c,"throw",e)}a(void 0)})}}class Ud{constructor(e,t,r){this.logger=e,this.performanceClient=t,this.correlationId=r,this.platformAuthType="PlatformAuthDOMHandler"}static createProvider(e,t,r){return jd(function*(){var n;if(e.trace("PlatformAuthDOMHandler: createProvider called"),null!==(n=window.navigator)&&void 0!==n&&n.platformAuthentication){var o=yield window.navigator.platformAuthentication.getSupportedContracts(so);if(null!=o&&o.includes("get-token-and-sign-out"))return e.trace("Platform auth api available in DOM"),new Ud(e,t,r)}})()}getExtensionId(){return so}getExtensionVersion(){return""}getExtensionName(){return"DOM API"}sendMessage(e){var t=this;return jd(function*(){t.logger.trace(t.platformAuthType+" - Sending request to browser DOM API");try{var r=t.initializePlatformDOMRequest(e),n=yield window.navigator.platformAuthentication.executeGetToken(r);return t.validatePlatformBrokerResponse(n)}catch(e){throw t.logger.error(t.platformAuthType+" - executeGetToken DOM API error"),e}})()}initializePlatformDOMRequest(e){this.logger.trace(this.platformAuthType+" - initializeNativeDOMRequest called");var{accountId:t,clientId:r,authority:n,scope:o,redirectUri:i,correlationId:a,state:c,storeInCache:l,embeddedClientId:s,extraParameters:u}=e,d=function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(e,Md),h=this.getDOMExtraParams(d);return{accountId:t,brokerId:this.getExtensionId(),authority:n,clientId:r,correlationId:a||this.correlationId,extraParameters:Dd(Dd({},u),h),isSecurityTokenService:!1,redirectUri:i,scope:o,state:c,storeInCache:l,embeddedClientId:s}}validatePlatformBrokerResponse(e){if(e.hasOwnProperty("isSuccess")){if(e.hasOwnProperty("accessToken")&&e.hasOwnProperty("idToken")&&e.hasOwnProperty("clientInfo")&&e.hasOwnProperty("account")&&e.hasOwnProperty("scopes")&&e.hasOwnProperty("expiresIn"))return this.logger.trace(this.platformAuthType+" - platform broker returned successful and valid response"),this.convertToPlatformBrokerResponse(e);if(e.hasOwnProperty("error")){var t=e;if(!1===t.isSuccess&&t.error&&t.error.code)throw this.logger.trace(this.platformAuthType+" - platform broker returned error response"),Hu(t.error.code,t.error.description,{error:parseInt(t.error.errorCode),protocol_error:t.error.protocolError,status:t.error.status,properties:t.error.properties})}}throw G(K,"Response missing expected properties.")}convertToPlatformBrokerResponse(e){var t;return this.logger.trace(this.platformAuthType+" - convertToNativeResponse called"),{access_token:e.accessToken,id_token:e.idToken,client_info:e.clientInfo,account:e.account,expires_in:e.expiresIn,scope:e.scopes,state:e.state||"",properties:e.properties||{},extendedLifetimeToken:null!==(t=e.extendedLifetimeToken)&&void 0!==t&&t,shr:e.proofOfPossessionPayload}}getDOMExtraParams(e){return Dd({},Object.entries(e).reduce((e,t)=>{var[r,n]=t;return e[r]=String(n),e},{}))}}function Fd(e,t,r,n,o,i,a){try{var c=e[i](a),l=c.value}catch(e){return void r(e)}c.done?t(l):Promise.resolve(l).then(n,o)}function Hd(){return(e=function*(e,t,r,n,o){var i;e.trace("getPlatformAuthProvider called",r),e.trace("Has client allowed platform auth via DOM API: "+o);try{o&&(i=yield Ud.createProvider(e,t,r)),i||(e.trace("Platform auth via DOM API not available, checking for extension"),i=yield xd.createProvider(e,n||2e3,t))}catch(t){e.trace("Platform auth not available",t)}return i},Hd=function(){var t=this,r=arguments;return new Promise(function(n,o){var i=e.apply(t,r);function a(e){Fd(i,n,o,a,c,"next",e)}function c(e){Fd(i,n,o,a,c,"throw",e)}a(void 0)})}).apply(this,arguments);var e}function zd(e,t,r,n){if(t.trace("isPlatformAuthAllowed called"),!e.system.allowPlatformBroker&&e.system.allowPlatformBrokerWithDOM)throw wt(vt);if(!e.system.allowPlatformBroker)return t.trace("isPlatformAuthAllowed: allowPlatformBroker is not enabled, returning false"),!1;if(!r)return t.trace("isPlatformAuthAllowed: Platform auth provider is not initialized, returning false"),!1;if(n)switch(n){case j.BEARER:case j.POP:return t.trace("isPlatformAuthAllowed: authenticationScheme is supported, returning true"),!0;default:return t.trace("isPlatformAuthAllowed: authenticationScheme is not supported, returning false"),!1}return!0}function Bd(e,t,r,n,o,i,a){try{var c=e[i](a),l=c.value}catch(e){return void r(e)}c.done?t(l):Promise.resolve(l).then(n,o)}function Kd(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var i=e.apply(t,r);function a(e){Bd(i,n,o,a,c,"next",e)}function c(e){Bd(i,n,o,a,c,"throw",e)}a(void 0)})}}function Vd(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Wd(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Vd(Object(r),!0).forEach(function(t){Qd(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Vd(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Qd(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Gd extends _u{constructor(e,t,r,n,o,i,a,c,l,s){super(e,t,r,n,o,i,a,l,s),this.unloadWindow=this.unloadWindow.bind(this),this.nativeStorage=c,this.eventHandler=o}acquireToken(e,t){var r=void 0;try{var n;if(r={popupName:this.generatePopupName(e.scopes||s,e.authority||this.config.auth.authority),popupWindowAttributes:e.popupWindowAttributes||{},popupWindowParent:null!==(n=e.popupWindowParent)&&void 0!==n?n:window},this.performanceClient.addFields({isAsyncPopup:this.config.system.asyncPopups},this.correlationId),this.config.system.asyncPopups)return this.logger.verbose("asyncPopups set to true, acquiring token"),this.acquireTokenPopupAsync(e,r,t);var o=Wd(Wd({},e),{},{httpMethod:Su(e,this.config.auth.protocolMode)});return this.logger.verbose("asyncPopup set to false, opening popup before acquiring token"),r.popup=this.openSizedPopup("about:blank",r),this.acquireTokenPopupAsync(o,r,t)}catch(e){return Promise.reject(e)}}logout(e){try{var t;this.logger.verbose("logoutPopup called");var r=this.initializeLogoutRequest(e),n={popupName:this.generateLogoutPopupName(r),popupWindowAttributes:(null==e?void 0:e.popupWindowAttributes)||{},popupWindowParent:null!==(t=null==e?void 0:e.popupWindowParent)&&void 0!==t?t:window},o=e&&e.authority,i=e&&e.mainWindowRedirectUri;return this.config.system.asyncPopups?(this.logger.verbose("asyncPopups set to true"),this.logoutPopupAsync(r,n,o,i)):(this.logger.verbose("asyncPopup set to false, opening popup"),n.popup=this.openSizedPopup("about:blank",n),this.logoutPopupAsync(r,n,o,i))}catch(e){return Promise.reject(e)}}acquireTokenPopupAsync(e,t,r){var n=this;return Kd(function*(){n.logger.verbose("acquireTokenPopupAsync called");var o=yield gl(n.initializeAuthorizationRequest.bind(n),Kr,n.logger,n.performanceClient,n.correlationId)(e,ro.Popup);t.popup&&Ac(o.authority);var i=zd(n.config,n.logger,n.platformAuthProvider,e.authenticationScheme);return o.platformBroker=i,n.config.auth.protocolMode===z?n.executeEarFlow(o,t,r):n.executeCodeFlow(o,t,r)})()}executeCodeFlow(e,t,r){var n=this;return Kd(function*(){var o=e.correlationId,i=n.initializeServerTelemetryManager(Ao),a=r||(yield gl(Td,An,n.logger,n.performanceClient,o)(n.performanceClient,n.logger,o)),c=Wd(Wd({},e),{},{codeChallenge:a.challenge});try{var s=yield gl(n.createAuthCodeClient.bind(n),zr,n.logger,n.performanceClient,o)({serverTelemetryManager:i,requestAuthority:c.authority,requestAzureCloudOptions:c.azureCloudOptions,requestExtraQueryParameters:c.extraQueryParameters,account:c.account});if(c.httpMethod===l)return yield n.executeCodeFlowWithPost(c,t,s,a.verifier);var u=yield gl(ud,Vr,n.logger,n.performanceClient,o)(n.config,s.authority,c,n.logger,n.performanceClient),d=n.initiateAuthRequest(u,t);n.eventHandler.emitEvent(Ps,ro.Popup,{popupWindow:d},null);var h=yield n.monitorPopupForHash(d,t.popupWindowParent),f=pl(Ru,on,n.logger,n.performanceClient,n.correlationId)(h,n.config.auth.OIDCOptions.serverResponseType,n.logger);return yield gl(bd,Yr,n.logger,n.performanceClient,o)(e,f,a.verifier,Ao,n.config,s,n.browserStorage,n.nativeStorage,n.eventHandler,n.logger,n.performanceClient,n.platformAuthProvider)}catch(e){var p;throw null===(p=t.popup)||void 0===p||p.close(),e instanceof Q&&(e.setCorrelationId(n.correlationId),i.cacheFailedRequest(e)),e}})()}executeEarFlow(e,t,r){var n=this;return Kd(function*(){var o=e.correlationId,i=yield gl(n.getDiscoveredAuthority.bind(n),br,n.logger,n.performanceClient,o)({requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account}),a=yield gl(Ya,qn,n.logger,n.performanceClient,o)(),c=r||(yield gl(Td,An,n.logger,n.performanceClient,o)(n.performanceClient,n.logger,o)),l=Wd(Wd({},e),{},{earJwk:a,codeChallenge:c.challenge}),s=t.popup||n.openPopup("about:blank",t);(yield hd(s.document,n.config,i,l,n.logger,n.performanceClient)).submit();var u=yield gl(n.monitorPopupForHash.bind(n),Ur,n.logger,n.performanceClient,o)(s,t.popupWindowParent),d=pl(Ru,on,n.logger,n.performanceClient,n.correlationId)(u,n.config.auth.OIDCOptions.serverResponseType,n.logger);if(!d.ear_jwe&&d.code){var h=yield gl(n.createAuthCodeClient.bind(n),zr,n.logger,n.performanceClient,o)({serverTelemetryManager:n.initializeServerTelemetryManager(Ao),requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account,authority:i});return gl(bd,Yr,n.logger,n.performanceClient,o)(l,d,c.verifier,Ao,n.config,h,n.browserStorage,n.nativeStorage,n.eventHandler,n.logger,n.performanceClient,n.platformAuthProvider)}return gl(Cd,Gr,n.logger,n.performanceClient,o)(l,d,Ao,n.config,i,n.browserStorage,n.nativeStorage,n.eventHandler,n.logger,n.performanceClient,n.platformAuthProvider)})()}executeCodeFlowWithPost(e,t,r,n){var o=this;return Kd(function*(){var i=e.correlationId,a=yield gl(o.getDiscoveredAuthority.bind(o),br,o.logger,o.performanceClient,i)({requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account}),c=t.popup||o.openPopup("about:blank",t);(yield pd(c.document,o.config,a,e,o.logger,o.performanceClient)).submit();var l=yield gl(o.monitorPopupForHash.bind(o),Ur,o.logger,o.performanceClient,i)(c,t.popupWindowParent),s=pl(Ru,on,o.logger,o.performanceClient,o.correlationId)(l,o.config.auth.OIDCOptions.serverResponseType,o.logger);return gl(bd,Yr,o.logger,o.performanceClient,i)(e,s,n,Ao,o.config,r,o.browserStorage,o.nativeStorage,o.eventHandler,o.logger,o.performanceClient,o.platformAuthProvider)})()}logoutPopupAsync(e,t,r,n){var o=this;return Kd(function*(){o.logger.verbose("logoutPopupAsync called"),o.eventHandler.emitEvent(Es,ro.Popup,e);var i=o.initializeServerTelemetryManager(962);try{yield o.clearCacheOnLogout(o.correlationId,e.account);var a=yield gl(o.createAuthCodeClient.bind(o),zr,o.logger,o.performanceClient,o.correlationId)({serverTelemetryManager:i,requestAuthority:r,account:e.account||void 0});try{a.authority.endSessionEndpoint}catch(r){var c;if(null!==(c=e.account)&&void 0!==c&&c.homeAccountId&&e.postLogoutRedirectUri&&a.authority.protocolMode===H){var l;if(o.eventHandler.emitEvent(Os,ro.Popup,e),n){var s={apiId:962,timeout:o.config.system.redirectNavigationTimeout,noHistory:!1},u=Kt.getAbsoluteUrl(n,Cc());yield o.navigationClient.navigateInternal(u,s)}return void(null===(l=t.popup)||void 0===l||l.close())}}var d=a.getLogoutUri(e);o.eventHandler.emitEvent(Os,ro.Popup,e);var h=o.openPopup(d,t);if(o.eventHandler.emitEvent(Ps,ro.Popup,{popupWindow:h},null),yield o.monitorPopupForHash(h,t.popupWindowParent).catch(()=>{}),n){var f={apiId:962,timeout:o.config.system.redirectNavigationTimeout,noHistory:!1},p=Kt.getAbsoluteUrl(n,Cc());o.logger.verbose("Redirecting main window to url specified in the request"),o.logger.verbosePii("Redirecting main window to: ".concat(p)),yield o.navigationClient.navigateInternal(p,f)}else o.logger.verbose("No main window navigation requested")}catch(e){var g;throw null===(g=t.popup)||void 0===g||g.close(),e instanceof Q&&(e.setCorrelationId(o.correlationId),i.cacheFailedRequest(e)),o.eventHandler.emitEvent(_s,ro.Popup,null,e),o.eventHandler.emitEvent(Rs,ro.Popup),e}o.eventHandler.emitEvent(Rs,ro.Popup)})()}initiateAuthRequest(e,t){if(e)return this.logger.infoPii("Navigate to: ".concat(e)),this.openPopup(e,t);throw this.logger.error("Navigate url is empty"),Ri(Do)}monitorPopupForHash(e,t){return new Promise((t,r)=>{this.logger.verbose("PopupHandler.monitorPopupForHash - polling started");var n=setInterval(()=>{if(e.closed)return this.logger.error("PopupHandler.monitorPopupForHash - window closed"),clearInterval(n),void r(Ri(Ko));var o="";try{o=e.location.href}catch(e){}if(o&&"about:blank"!==o){clearInterval(n);var i="",a=this.config.auth.OIDCOptions.serverResponseType;e&&(i=a===P?e.location.search:e.location.hash),this.logger.verbose("PopupHandler.monitorPopupForHash - popup window is on same origin as caller"),t(i)}},this.config.system.pollIntervalMilliseconds)}).finally(()=>{this.cleanPopup(e,t)})}openPopup(e,t){try{var r;if(t.popup?(r=t.popup,this.logger.verbosePii("Navigating popup window to: ".concat(e)),r.location.assign(e)):void 0===t.popup&&(this.logger.verbosePii("Opening popup window to: ".concat(e)),r=this.openSizedPopup(e,t)),!r)throw Ri(Bo);return r.focus&&r.focus(),this.currentWindow=r,t.popupWindowParent.addEventListener("beforeunload",this.unloadWindow),r}catch(e){throw this.logger.error("error opening popup "+e.message),Ri(zo)}}openSizedPopup(e,t){var r,n,o,i,{popupName:a,popupWindowAttributes:c,popupWindowParent:l}=t,s=l.screenLeft?l.screenLeft:l.screenX,u=l.screenTop?l.screenTop:l.screenY,d=l.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,h=l.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,f=null===(r=c.popupSize)||void 0===r?void 0:r.width,p=null===(n=c.popupSize)||void 0===n?void 0:n.height,g=null===(o=c.popupPosition)||void 0===o?void 0:o.top,m=null===(i=c.popupPosition)||void 0===i?void 0:i.left;return(!f||f<0||f>d)&&(this.logger.verbose("Default popup window width used. Window width not configured or invalid."),f=483),(!p||p<0||p>h)&&(this.logger.verbose("Default popup window height used. Window height not configured or invalid."),p=600),(!g||g<0||g>h)&&(this.logger.verbose("Default popup window top position used. Window top not configured or invalid."),g=Math.max(0,h/2-300+u)),(!m||m<0||m>d)&&(this.logger.verbose("Default popup window left position used. Window left not configured or invalid."),m=Math.max(0,d/2-241.5+s)),l.open(e,a,"width=".concat(f,", height=").concat(p,", top=").concat(g,", left=").concat(m,", scrollbars=yes"))}unloadWindow(e){this.currentWindow&&this.currentWindow.close(),e.preventDefault()}cleanPopup(e,t){e.close(),t.removeEventListener("beforeunload",this.unloadWindow)}generatePopupName(e,t){return"".concat(io,".").concat(this.config.auth.clientId,".").concat(e.join("-"),".").concat(t,".").concat(this.correlationId)}generateLogoutPopupName(e){var t=e.account&&e.account.homeAccountId;return"".concat(io,".").concat(this.config.auth.clientId,".").concat(t,".").concat(this.correlationId)}}function Jd(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Yd(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Jd(Object(r),!0).forEach(function(t){$d(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Jd(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function $d(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Xd(e,t,r,n,o,i,a){try{var c=e[i](a),l=c.value}catch(e){return void r(e)}c.done?t(l):Promise.resolve(l).then(n,o)}function Zd(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var i=e.apply(t,r);function a(e){Xd(i,n,o,a,c,"next",e)}function c(e){Xd(i,n,o,a,c,"throw",e)}a(void 0)})}}class eh extends _u{constructor(e,t,r,n,o,i,a,c,l,s){super(e,t,r,n,o,i,a,l,s),this.nativeStorage=c}acquireToken(e){var t=this;return Zd(function*(){var r=yield gl(t.initializeAuthorizationRequest.bind(t),Kr,t.logger,t.performanceClient,t.correlationId)(e,ro.Redirect);r.platformBroker=zd(t.config,t.logger,t.platformAuthProvider,e.authenticationScheme);var n=e=>{e.persisted&&(t.logger.verbose("Page was restored from back/forward cache. Clearing temporary cache."),t.browserStorage.resetRequestCache(),t.eventHandler.emitEvent("msal:restoreFromBFCache",ro.Redirect))},o=t.getRedirectStartPage(e.redirectStartPage);t.logger.verbosePii("Redirect start page: ".concat(o)),t.browserStorage.setTemporaryCache(vo,o,!0),window.addEventListener("pageshow",n);try{t.config.auth.protocolMode===z?yield t.executeEarFlow(r):yield t.executeCodeFlow(r,e.onRedirectNavigate)}catch(e){throw e instanceof Q&&e.setCorrelationId(t.correlationId),window.removeEventListener("pageshow",n),e}})()}executeCodeFlow(e,t){var r=this;return Zd(function*(){var n=e.correlationId,o=r.initializeServerTelemetryManager(To),i=yield gl(Td,An,r.logger,r.performanceClient,n)(r.performanceClient,r.logger,n),a=Yd(Yd({},e),{},{codeChallenge:i.challenge});r.browserStorage.cacheAuthorizeRequest(a,i.verifier);try{if(a.httpMethod===l)return yield r.executeCodeFlowWithPost(a);var c=yield gl(r.createAuthCodeClient.bind(r),zr,r.logger,r.performanceClient,r.correlationId)({serverTelemetryManager:o,requestAuthority:a.authority,requestAzureCloudOptions:a.azureCloudOptions,requestExtraQueryParameters:a.extraQueryParameters,account:a.account}),s=yield gl(ud,Vr,r.logger,r.performanceClient,e.correlationId)(r.config,c.authority,a,r.logger,r.performanceClient);return yield r.initiateAuthRequest(s,t)}catch(e){throw e instanceof Q&&(e.setCorrelationId(r.correlationId),o.cacheFailedRequest(e)),e}})()}executeEarFlow(e){var t=this;return Zd(function*(){var r=e.correlationId,n=yield gl(t.getDiscoveredAuthority.bind(t),br,t.logger,t.performanceClient,r)({requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account}),o=yield gl(Ya,qn,t.logger,t.performanceClient,r)(),i=yield gl(Td,An,t.logger,t.performanceClient,r)(t.performanceClient,t.logger,r),a=Yd(Yd({},e),{},{earJwk:o,codeChallenge:i.challenge});return t.browserStorage.cacheAuthorizeRequest(a,i.verifier),(yield hd(document,t.config,n,a,t.logger,t.performanceClient)).submit(),new Promise((e,r)=>{setTimeout(()=>{r(Ri(Pi,"failed_to_redirect"))},t.config.system.redirectNavigationTimeout)})})()}executeCodeFlowWithPost(e){var t=this;return Zd(function*(){var r=e.correlationId,n=yield gl(t.getDiscoveredAuthority.bind(t),br,t.logger,t.performanceClient,r)({requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account});return t.browserStorage.cacheAuthorizeRequest(e),(yield pd(document,t.config,n,e,t.logger,t.performanceClient)).submit(),new Promise((e,r)=>{setTimeout(()=>{r(Ri(Pi,"failed_to_redirect"))},t.config.system.redirectNavigationTimeout)})})()}handleRedirectPromise(){var e=arguments,t=this;return Zd(function*(){var r,n,o=e.length>0&&void 0!==e[0]?e[0]:"",i=e.length>1?e[1]:void 0,a=e.length>2?e[2]:void 0,l=e.length>3?e[3]:void 0,s=t.initializeServerTelemetryManager(865);try{var[u,d]=t.getRedirectResponse(o||"");if(!u)return t.logger.info("handleRedirectPromise did not detect a response as a result of a redirect. Cleaning temporary cache."),t.browserStorage.resetRequestCache(),"back_forward"!==function(){if("undefined"!=typeof window&&void 0!==window.performance&&"function"==typeof window.performance.getEntriesByType){var e=window.performance.getEntriesByType("navigation"),t=e.length?e[0]:void 0;return null==t?void 0:t.type}}()?l.event.errorCode="no_server_response":t.logger.verbose("Back navigation event detected. Muting no_server_response error"),null;var h=t.browserStorage.getTemporaryCache(vo,!0)||c.EMPTY_STRING;if(Bt(h)===Bt(window.location.href)&&t.config.auth.navigateToLoginRequestUrl)return t.logger.verbose("Current page is loginRequestUrl, handling response"),h.indexOf("#")>-1&&((n=h.split("#")).shift(),window.location.hash=n.length>0?n.join("#"):""),yield t.handleResponse(u,i,a,s);if(!t.config.auth.navigateToLoginRequestUrl)return t.logger.verbose("NavigateToLoginRequestUrl set to false, handling response"),yield t.handleResponse(u,i,a,s);if(!wc()||t.config.system.allowRedirectInIframe){t.browserStorage.setTemporaryCache(yo,d,!0);var f={apiId:865,timeout:t.config.system.redirectNavigationTimeout,noHistory:!0},p=!0;if(h&&"null"!==h)t.logger.verbose("Navigating to loginRequestUrl: ".concat(h)),p=yield t.navigationClient.navigateInternal(h,f);else{var g=(r=new Kt(window.location.href).getUrlComponents(),"".concat(r.Protocol,"//").concat(r.HostNameAndPort,"/"));t.browserStorage.setTemporaryCache(vo,g,!0),t.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),p=yield t.navigationClient.navigateInternal(g,f)}if(!p)return yield t.handleResponse(u,i,a,s)}return null}catch(e){throw e instanceof Q&&(e.setCorrelationId(t.correlationId),s.cacheFailedRequest(e)),e}})()}getRedirectResponse(e){this.logger.verbose("getRedirectResponseHash called");var t=e;t||(t=this.config.auth.OIDCOptions.serverResponseType===P?window.location.search:window.location.hash);var r=Ht(t);if(r){try{!function(e,t,r){if(!e.state)throw Ri(qo);var n=function(e,t){if(!t)return null;try{return Gs.parseRequestState(e,t).libraryState.meta}catch(e){throw ze(ne)}}(t,e.state);if(!n)throw Ri(Uo);if(n.interactionType!==r)throw Ri(Fo)}(r,this.browserCrypto,ro.Redirect)}catch(e){return e instanceof Q&&this.logger.error("Interaction type validation failed due to ".concat(e.errorCode,": ").concat(e.errorMessage)),[null,""]}return bc(window),this.logger.verbose("Hash contains known properties, returning response hash"),[r,t]}var n=this.browserStorage.getTemporaryCache(yo,!0);return this.browserStorage.removeItem(this.browserStorage.generateCacheKey(yo)),n&&(r=Ht(n))?(this.logger.verbose("Hash does not contain known properties, returning cached hash"),[r,n]):[null,""]}handleResponse(e,t,r,n){var o=this;return Zd(function*(){if(!e.state)throw Ri(qo);if(e.ear_jwe){var i=yield gl(o.getDiscoveredAuthority.bind(o),br,o.logger,o.performanceClient,t.correlationId)({requestAuthority:t.authority,requestAzureCloudOptions:t.azureCloudOptions,requestExtraQueryParameters:t.extraQueryParameters,account:t.account});return gl(Cd,Gr,o.logger,o.performanceClient,t.correlationId)(t,e,To,o.config,i,o.browserStorage,o.nativeStorage,o.eventHandler,o.logger,o.performanceClient,o.platformAuthProvider)}var a=yield gl(o.createAuthCodeClient.bind(o),zr,o.logger,o.performanceClient,o.correlationId)({serverTelemetryManager:n,requestAuthority:t.authority});return gl(bd,Yr,o.logger,o.performanceClient,t.correlationId)(t,e,r,To,o.config,a,o.browserStorage,o.nativeStorage,o.eventHandler,o.logger,o.performanceClient,o.platformAuthProvider)})()}initiateAuthRequest(e,t){var r=this;return Zd(function*(){if(r.logger.verbose("RedirectHandler.initiateAuthRequest called"),e){r.logger.infoPii("RedirectHandler.initiateAuthRequest: Navigate to: ".concat(e));var n={apiId:To,timeout:r.config.system.redirectNavigationTimeout,noHistory:!1},o=t||r.config.auth.onRedirectNavigate;return"function"==typeof o?(r.logger.verbose("RedirectHandler.initiateAuthRequest: Invoking onRedirectNavigate callback"),!1!==o(e)?(r.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate did not return false, navigating"),void(yield r.navigationClient.navigateExternal(e,n))):void r.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate returned false, stopping navigation")):(r.logger.verbose("RedirectHandler.initiateAuthRequest: Navigating window to navigate url"),void(yield r.navigationClient.navigateExternal(e,n)))}throw r.logger.info("RedirectHandler.initiateAuthRequest: Navigate url is empty"),Ri(Do)})()}logout(e){var t=this;return Zd(function*(){t.logger.verbose("logoutRedirect called");var r=t.initializeLogoutRequest(e),n=t.initializeServerTelemetryManager(961);try{t.eventHandler.emitEvent(Es,ro.Redirect,e),yield t.clearCacheOnLogout(t.correlationId,r.account);var o={apiId:961,timeout:t.config.system.redirectNavigationTimeout,noHistory:!1},i=yield gl(t.createAuthCodeClient.bind(t),zr,t.logger,t.performanceClient,t.correlationId)({serverTelemetryManager:n,requestAuthority:e&&e.authority,requestExtraQueryParameters:null==e?void 0:e.extraQueryParameters,account:e&&e.account||void 0});if(i.authority.protocolMode===H)try{i.authority.endSessionEndpoint}catch(e){var a;if(null!==(a=r.account)&&void 0!==a&&a.homeAccountId)return void t.eventHandler.emitEvent(Os,ro.Redirect,r)}var c=i.getLogoutUri(r);if(t.eventHandler.emitEvent(Os,ro.Redirect,r),!e||"function"!=typeof e.onRedirectNavigate)return t.browserStorage.getInteractionInProgress()||t.browserStorage.setInteractionInProgress(!0,mo),void(yield t.navigationClient.navigateExternal(c,o));if(!1!==e.onRedirectNavigate(c))return t.logger.verbose("Logout onRedirectNavigate did not return false, navigating"),t.browserStorage.getInteractionInProgress()||t.browserStorage.setInteractionInProgress(!0,mo),void(yield t.navigationClient.navigateExternal(c,o));t.browserStorage.setInteractionInProgress(!1),t.logger.verbose("Logout onRedirectNavigate returned false, stopping navigation")}catch(e){throw e instanceof Q&&(e.setCorrelationId(t.correlationId),n.cacheFailedRequest(e)),t.eventHandler.emitEvent(_s,ro.Redirect,null,e),t.eventHandler.emitEvent(Rs,ro.Redirect),e}t.eventHandler.emitEvent(Rs,ro.Redirect)})()}getRedirectStartPage(e){var t=e||window.location.href;return Kt.getAbsoluteUrl(t,Cc())}}function th(e,t,r,n,o,i,a){try{var c=e[i](a),l=c.value}catch(e){return void r(e)}c.done?t(l):Promise.resolve(l).then(n,o)}function rh(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var i=e.apply(t,r);function a(e){th(i,n,o,a,c,"next",e)}function c(e){th(i,n,o,a,c,"throw",e)}a(void 0)})}}function nh(e,t,r,n,o){return oh.apply(this,arguments)}function oh(){return(oh=rh(function*(e,t,r,n,o){if(t.addQueueMeasurement(jr,n),!e)throw r.info("Navigate url is empty"),Ri(Do);return o?gl(dh,Fr,r,t,n)(e,o,t,n):pl(hh,Hr,r,t,n)(e)})).apply(this,arguments)}function ih(e,t,r,n,o){return ah.apply(this,arguments)}function ah(){return(ah=rh(function*(e,t,r,n,o){var i=fh();if(!i.contentDocument)throw"No document associated with iframe!";return(yield pd(i.contentDocument,e,t,r,n,o)).submit(),i})).apply(this,arguments)}function ch(e,t,r,n,o){return lh.apply(this,arguments)}function lh(){return(lh=rh(function*(e,t,r,n,o){var i=fh();if(!i.contentDocument)throw"No document associated with iframe!";return(yield hd(i.contentDocument,e,t,r,n,o)).submit(),i})).apply(this,arguments)}function sh(e,t,r,n,o,i,a){return uh.apply(this,arguments)}function uh(){return(uh=rh(function*(e,t,r,n,o,i,a){return n.addQueueMeasurement(Ur,i),new Promise((n,i)=>{t<_c&&o.warning("system.loadFrameTimeout or system.iframeHashTimeout set to lower (".concat(t,"ms) than the default (").concat(_c,"ms). This may result in timeouts."));var c=window.setTimeout(()=>{window.clearInterval(l),i(Ri(Wo))},t),l=window.setInterval(()=>{var t="",r=e.contentWindow;try{t=r?r.location.href:""}catch(e){}if(t&&"about:blank"!==t){var o="";r&&(o=a===P?r.location.search:r.location.hash),window.clearTimeout(c),window.clearInterval(l),n(o)}},r)}).finally(()=>{pl(ph,wn,o,n,i)(e)})})).apply(this,arguments)}function dh(e,t,r,n){return r.addQueueMeasurement(Fr,n),new Promise((r,n)=>{var o=fh();window.setTimeout(()=>{o?(o.src=e,r(o)):n("Unable to load iframe")},t)})}function hh(e){var t=fh();return t.src=e,t}function fh(){var e=document.createElement("iframe");return e.className="msalSilentIframe",e.style.visibility="hidden",e.style.position="absolute",e.style.width=e.style.height="0",e.style.border="0",e.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),e.setAttribute("allow","local-network-access *"),document.body.appendChild(e),e}function ph(e){document.body===e.parentNode&&document.body.removeChild(e)}function gh(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function mh(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?gh(Object(r),!0).forEach(function(t){vh(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):gh(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function vh(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function yh(e,t,r,n,o,i,a){try{var c=e[i](a),l=c.value}catch(e){return void r(e)}c.done?t(l):Promise.resolve(l).then(n,o)}function bh(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var i=e.apply(t,r);function a(e){yh(i,n,o,a,c,"next",e)}function c(e){yh(i,n,o,a,c,"throw",e)}a(void 0)})}}class wh extends _u{constructor(e,t,r,n,o,i,a,c,l,s,u){super(e,t,r,n,o,i,c,s,u),this.apiId=a,this.nativeStorage=l}acquireToken(e){var t=this;return bh(function*(){t.performanceClient.addQueueMeasurement(mr,e.correlationId),e.loginHint||e.sid||e.account&&e.account.username||t.logger.warning("No user hint provided. The authorization server may need more information to complete this request.");var r=mh({},e);r.prompt?r.prompt!==T&&"no_session"!==r.prompt&&(t.logger.warning("SilentIframeClient. Replacing invalid prompt ".concat(r.prompt," with ").concat(T)),r.prompt=T):r.prompt=T;var n=yield gl(t.initializeAuthorizationRequest.bind(t),Kr,t.logger,t.performanceClient,e.correlationId)(r,ro.Silent);return n.platformBroker=zd(t.config,t.logger,t.platformAuthProvider,n.authenticationScheme),Ac(n.authority),t.config.auth.protocolMode===z?t.executeEarFlow(n):t.executeCodeFlow(n)})()}executeCodeFlow(e){var t=this;return bh(function*(){var r,n=t.initializeServerTelemetryManager(t.apiId);try{return r=yield gl(t.createAuthCodeClient.bind(t),zr,t.logger,t.performanceClient,e.correlationId)({serverTelemetryManager:n,requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account}),yield gl(t.silentTokenHelper.bind(t),qr,t.logger,t.performanceClient,e.correlationId)(r,e)}catch(o){if(o instanceof Q&&(o.setCorrelationId(t.correlationId),n.cacheFailedRequest(o)),!(r&&o instanceof Q&&o.errorCode===oo))throw o;return t.performanceClient.addFields({retryError:o.errorCode},t.correlationId),yield gl(t.silentTokenHelper.bind(t),qr,t.logger,t.performanceClient,t.correlationId)(r,e)}})()}executeEarFlow(e){var t=this;return bh(function*(){var r=e.correlationId,n=yield gl(t.getDiscoveredAuthority.bind(t),br,t.logger,t.performanceClient,r)({requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account}),o=yield gl(Ya,qn,t.logger,t.performanceClient,r)(),i=yield gl(Td,An,t.logger,t.performanceClient,r)(t.performanceClient,t.logger,r),a=mh(mh({},e),{},{earJwk:o,codeChallenge:i.challenge}),c=yield gl(ch,jr,t.logger,t.performanceClient,r)(t.config,n,a,t.logger,t.performanceClient),l=t.config.auth.OIDCOptions.serverResponseType,s=yield gl(sh,Ur,t.logger,t.performanceClient,r)(c,t.config.system.iframeHashTimeout,t.config.system.pollIntervalMilliseconds,t.performanceClient,t.logger,r,l),u=pl(Ru,on,t.logger,t.performanceClient,r)(s,l,t.logger);if(!u.ear_jwe&&u.code){var d=yield gl(t.createAuthCodeClient.bind(t),zr,t.logger,t.performanceClient,r)({serverTelemetryManager:t.initializeServerTelemetryManager(t.apiId),requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account,authority:n});return gl(bd,Yr,t.logger,t.performanceClient,r)(a,u,i.verifier,t.apiId,t.config,d,t.browserStorage,t.nativeStorage,t.eventHandler,t.logger,t.performanceClient,t.platformAuthProvider)}return gl(Cd,Gr,t.logger,t.performanceClient,r)(a,u,t.apiId,t.config,n,t.browserStorage,t.nativeStorage,t.eventHandler,t.logger,t.performanceClient,t.platformAuthProvider)})()}logout(){return Promise.reject(Ri($o))}silentTokenHelper(e,t){var r=this;return bh(function*(){var n=t.correlationId;r.performanceClient.addQueueMeasurement(qr,n);var o,i=yield gl(Td,An,r.logger,r.performanceClient,n)(r.performanceClient,r.logger,n),a=mh(mh({},t),{},{codeChallenge:i.challenge});if(t.httpMethod===l)o=yield gl(ih,jr,r.logger,r.performanceClient,n)(r.config,e.authority,a,r.logger,r.performanceClient);else{var c=yield gl(ud,Vr,r.logger,r.performanceClient,n)(r.config,e.authority,a,r.logger,r.performanceClient);o=yield gl(nh,jr,r.logger,r.performanceClient,n)(c,r.performanceClient,r.logger,n,r.config.system.navigateFrameWait)}var s=r.config.auth.OIDCOptions.serverResponseType,u=yield gl(sh,Ur,r.logger,r.performanceClient,n)(o,r.config.system.iframeHashTimeout,r.config.system.pollIntervalMilliseconds,r.performanceClient,r.logger,n,s),d=pl(Ru,on,r.logger,r.performanceClient,n)(u,s,r.logger);return gl(bd,Yr,r.logger,r.performanceClient,n)(t,d,i.verifier,r.apiId,r.config,e,r.browserStorage,r.nativeStorage,r.eventHandler,r.logger,r.performanceClient,r.platformAuthProvider)})()}}function Ch(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function kh(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ch(Object(r),!0).forEach(function(t){Ih(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ch(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Ih(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Sh(e,t,r,n,o,i,a){try{var c=e[i](a),l=c.value}catch(e){return void r(e)}c.done?t(l):Promise.resolve(l).then(n,o)}function Th(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var i=e.apply(t,r);function a(e){Sh(i,n,o,a,c,"next",e)}function c(e){Sh(i,n,o,a,c,"throw",e)}a(void 0)})}}class Ah extends Qs{constructor(e,t){super(e,t)}acquireToken(e){var t=this;return Th(function*(){var r,n;null===(r=t.performanceClient)||void 0===r||r.addQueueMeasurement(Tr,e.correlationId);var o=bl(),i=yield gl(t.executeTokenRequest.bind(t),Sr,t.logger,t.performanceClient,e.correlationId)(e,t.authority),a=null===(n=i.headers)||void 0===n?void 0:n[p],c=new nu(t.config.authOptions.clientId,t.cacheManager,t.cryptoUtils,t.logger,t.config.serializableCache,t.config.persistencePlugin);return c.validateTokenResponse(i.body),gl(c.handleServerTokenResponse.bind(c),nn,t.logger,t.performanceClient,e.correlationId)(i.body,t.authority,o,e,void 0,void 0,!0,e.forceCache,a)})()}acquireTokenByRefreshToken(e){var t=this;return Th(function*(){var r;if(!e)throw wt(tt);if(null===(r=t.performanceClient)||void 0===r||r.addQueueMeasurement(Pr,e.correlationId),!e.account)throw ze(be);if(t.cacheManager.isAppMetadataFOCI(e.account.environment))try{return yield gl(t.acquireTokenWithCachedRefreshToken.bind(t),Ar,t.logger,t.performanceClient,e.correlationId)(e,!0)}catch(r){var n=r instanceof Jl&&r.errorCode===Hl,o=r instanceof Bs&&"invalid_grant"===r.errorCode&&"client_mismatch"===r.subError;if(n||o)return gl(t.acquireTokenWithCachedRefreshToken.bind(t),Ar,t.logger,t.performanceClient,e.correlationId)(e,!1);throw r}return gl(t.acquireTokenWithCachedRefreshToken.bind(t),Ar,t.logger,t.performanceClient,e.correlationId)(e,!1)})()}acquireTokenWithCachedRefreshToken(e,t){var r=this;return Th(function*(){var n;null===(n=r.performanceClient)||void 0===n||n.addQueueMeasurement(Ar,e.correlationId);var o,i=pl(r.cacheManager.getRefreshToken.bind(r.cacheManager),kn,r.logger,r.performanceClient,e.correlationId)(e.account,t,e.correlationId,void 0,r.performanceClient);if(!i)throw $l(Hl);if(i.expiresOn&&kl(i.expiresOn,e.refreshTokenExpirationOffsetSeconds||300))throw null===(o=r.performanceClient)||void 0===o||o.addFields({rtExpiresOnMs:Number(i.expiresOn)},e.correlationId),$l(Bl);var a=kh(kh({},e),{},{refreshToken:i.secret,authenticationScheme:e.authenticationScheme||j.BEARER,ccsCredential:{credential:e.account.homeAccountId,type:js}});try{return yield gl(r.acquireToken.bind(r),Tr,r.logger,r.performanceClient,e.correlationId)(a)}catch(t){var c;if(t instanceof Jl&&(null===(c=r.performanceClient)||void 0===c||c.addFields({rtExpiresOnMs:Number(i.expiresOn)},e.correlationId),t.subError===Vl)){r.logger.verbose("acquireTokenWithRefreshToken: bad refresh token, removing from cache");var l=r.cacheManager.generateCredentialKey(i);r.cacheManager.removeRefreshToken(l,e.correlationId)}throw t}})()}executeTokenRequest(e,t){var r=this;return Th(function*(){var n;null===(n=r.performanceClient)||void 0===n||n.addQueueMeasurement(Sr,e.correlationId);var o=r.createTokenQueryParameters(e),i=Kt.appendQueryString(t.tokenEndpoint,o),a=yield gl(r.createTokenRequestBody.bind(r),Er,r.logger,r.performanceClient,e.correlationId)(e),c=r.createTokenRequestHeaders(e.ccsCredential),l=Xl(r.config.authOptions.clientId,e);return gl(r.executePostToTokenEndpoint.bind(r),kr,r.logger,r.performanceClient,e.correlationId)(i,a,c,l,e.correlationId,kr)})()}createTokenRequestBody(e){var t=this;return Th(function*(){var r,n,o;null===(r=t.performanceClient)||void 0===r||r.addQueueMeasurement(Er,e.correlationId);var i=new Map;if(Xi(i,e.embeddedClientId||(null===(n=e.tokenBodyParameters)||void 0===n?void 0:n[Fi])||t.config.authOptions.clientId),e.redirectUri&&Zi(i,e.redirectUri),$i(i,e.scopes,!0,null===(o=t.config.authOptions.authority.options.OIDCOptions)||void 0===o?void 0:o.defaultScopes),fa(i,"refresh_token"),pa(i),aa(i,t.config.libraryInfo),ca(i,t.config.telemetry.application),wa(i),t.serverTelemetryManager&&!to(t.config)&&ba(i,t.serverTelemetryManager),function(e,t){e.set("refresh_token",t)}(i,e.refreshToken),t.config.clientCredentials.clientSecret&&ua(i,t.config.clientCredentials.clientSecret),t.config.clientCredentials.clientAssertion){var a=t.config.clientCredentials.clientAssertion;da(i,yield au(a.assertion,t.config.authOptions.clientId,e.resourceRequestUri)),ha(i,a.assertionType)}if(e.authenticationScheme===j.POP){var c=new Zs(t.cryptoUtils,t.performanceClient);va(i,e.popKid?t.cryptoUtils.encodeKid(e.popKid):(yield gl(c.generateCnf.bind(c),tn,t.logger,t.performanceClient,e.correlationId)(e,t.logger)).reqCnfString)}else if(e.authenticationScheme===j.SSH){if(!e.sshJwk)throw wt(lt);ya(i,e.sshJwk)}if((!Ct.isEmptyObj(e.claims)||t.config.authOptions.clientCapabilities&&t.config.authOptions.clientCapabilities.length>0)&&oa(i,e.claims,t.config.authOptions.clientCapabilities),t.config.systemOptions.preventCorsPreflight&&e.ccsCredential)switch(e.ccsCredential.type){case js:try{ra(i,St(e.ccsCredential.credential))}catch(e){t.logger.verbose("Could not parse home account ID for CCS Header: "+e)}break;case Us:ta(i,e.ccsCredential.credential)}return e.embeddedClientId&&Ca(i,t.config.authOptions.clientId,t.config.authOptions.redirectUri),e.tokenBodyParameters&&ma(i,e.tokenBodyParameters),Ji(i,e.correlationId,t.performanceClient),zt(i)})()}}function Ph(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Eh(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ph(Object(r),!0).forEach(function(t){Oh(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ph(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Oh(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _h(e,t,r,n,o,i,a){try{var c=e[i](a),l=c.value}catch(e){return void r(e)}c.done?t(l):Promise.resolve(l).then(n,o)}function Rh(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var i=e.apply(t,r);function a(e){_h(i,n,o,a,c,"next",e)}function c(e){_h(i,n,o,a,c,"throw",e)}a(void 0)})}}class xh extends _u{acquireToken(e){var t=this;return Rh(function*(){t.performanceClient.addQueueMeasurement(vr,e.correlationId);var r=yield gl(wu,Mr,t.logger,t.performanceClient,e.correlationId)(e,t.config,t.performanceClient,t.logger),n=Eh(Eh({},e),r);e.redirectUri&&(n.redirectUri=t.getRedirectUri(e.redirectUri));var o=t.initializeServerTelemetryManager(61),i=yield t.createRefreshTokenClient({serverTelemetryManager:o,authorityUrl:n.authority,azureCloudOptions:n.azureCloudOptions,account:n.account});return gl(i.acquireTokenByRefreshToken.bind(i),Pr,t.logger,t.performanceClient,e.correlationId)(n).catch(e=>{throw e.setCorrelationId(t.correlationId),o.cacheFailedRequest(e),e})})()}logout(){return Promise.reject(Ri($o))}createRefreshTokenClient(e){var t=this;return Rh(function*(){var r=yield gl(t.getClientConfiguration.bind(t),Br,t.logger,t.performanceClient,t.correlationId)({serverTelemetryManager:e.serverTelemetryManager,requestAuthority:e.authorityUrl,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account});return new Ah(r,t.performanceClient)})()}}function Mh(e,t,r,n,o,i,a){try{var c=e[i](a),l=c.value}catch(e){return void r(e)}c.done?t(l):Promise.resolve(l).then(n,o)}function Nh(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var i=e.apply(t,r);function a(e){Mh(i,n,o,a,c,"next",e)}function c(e){Mh(i,n,o,a,c,"throw",e)}a(void 0)})}}class Dh{constructor(e,t,r,n){this.isBrowserEnvironment="undefined"!=typeof window,this.config=e,this.storage=t,this.logger=r,this.cryptoObj=n}loadExternalTokens(e,t,r){var n=this;return Nh(function*(){if(!n.isBrowserEnvironment)throw Ri(oi);var o=e.correlationId||Ka(),i=t.id_token?Lt(t.id_token,Aa):void 0,a=qt(i||{}),c={protocolMode:n.config.auth.protocolMode,knownAuthorities:n.config.auth.knownAuthorities,cloudDiscoveryMetadata:n.config.auth.cloudDiscoveryMetadata,authorityMetadata:n.config.auth.authorityMetadata,skipAuthorityMetadataCache:n.config.auth.skipAuthorityMetadataCache},l=e.authority?new Ul(Ul.generateAuthority(e.authority,e.azureCloudOptions),n.config.system.networkClient,n.storage,c,n.logger,e.correlationId||Ka()):void 0,s=yield n.loadAccount(e,r.clientInfo||t.client_info||"",o,i,l),u=yield n.loadIdToken(t,s.homeAccountId,s.environment,s.realm,o,a),d=yield n.loadAccessToken(e,t,s.homeAccountId,s.environment,s.realm,r,o,a),h=yield n.loadRefreshToken(t,s.homeAccountId,s.environment,o,a);return n.generateAuthenticationResult(e,{account:s,idToken:u,accessToken:d,refreshToken:h},i,l)})()}loadAccount(e,t,r,n,o){var i=this;return Nh(function*(){if(i.logger.verbose("TokenCache - loading account"),e.account){var a=Dt.createFromAccountInfo(e.account);return yield i.storage.setAccount(a,r,qt(n||{})),a}if(!o||!t&&!n)throw i.logger.error("TokenCache - if an account is not provided on the request, authority and either clientInfo or idToken must be provided instead."),Ri(ui);var c=Dt.generateHomeAccountId(t,o.authorityType,i.logger,i.cryptoObj,n),l=null==n?void 0:n.tid,s=ou(i.storage,o,c,Aa,r,n,t,o.hostnameAndPort,l,void 0,void 0,i.logger);return yield i.storage.setAccount(s,r,qt(n||{})),s})()}loadIdToken(e,t,r,n,o,i){var a=this;return Nh(function*(){if(!e.id_token)return a.logger.verbose("TokenCache - no id token found in response"),null;a.logger.verbose("TokenCache - loading id token");var c=Sl(t,r,e.id_token,a.config.auth.clientId,n);return yield a.storage.setIdTokenCredential(c,o,i),c})()}loadAccessToken(e,t,r,n,o,i,a,c){var l=this;return Nh(function*(){if(!t.access_token)return l.logger.verbose("TokenCache - no access token found in response"),null;if(!t.expires_in)return l.logger.error("TokenCache - no expiration set on the access token. Cannot add it to the cache."),null;if(!(t.scope||e.scopes&&e.scopes.length))return l.logger.error("TokenCache - scopes not specified in the request or response. Cannot add token to the cache."),null;l.logger.verbose("TokenCache - loading access token");var s=t.scope?kt.fromString(t.scope):new kt(e.scopes),u=i.expiresOn||t.expires_in+bl(),d=i.extendedExpiresOn||(t.ext_expires_in||t.expires_in)+bl(),h=Tl(r,n,t.access_token,l.config.auth.clientId,o,s.printScopes(),u,d,Aa);return yield l.storage.setAccessTokenCredential(h,a,c),h})()}loadRefreshToken(e,t,r,n,o){var i=this;return Nh(function*(){if(!e.refresh_token)return i.logger.verbose("TokenCache - no refresh token found in response"),null;i.logger.verbose("TokenCache - loading refresh token");var a=Al(t,r,e.refresh_token,i.config.auth.clientId,e.foci,void 0,e.refresh_token_expires_in);return yield i.storage.setRefreshTokenCredential(a,n,o),a})()}generateAuthenticationResult(e,t,r,n){var o,i,a,c,l="",s=[],u=null;null!=t&&t.accessToken&&(l=t.accessToken.secret,s=kt.fromString(t.accessToken.target).asArray(),u=Cl(t.accessToken.expiresOn),c=Cl(t.accessToken.extendedExpiresOn));var d=t.account;return{authority:n?n.canonicalAuthority:"",uniqueId:t.account.localAccountId,tenantId:t.account.realm,scopes:s,account:Dt.getAccountInfo(d),idToken:(null===(o=t.idToken)||void 0===o?void 0:o.secret)||"",idTokenClaims:r||{},accessToken:l,fromCache:!0,expiresOn:u,correlationId:e.correlationId||"",requestId:"",extExpiresOn:c,familyId:(null===(i=t.refreshToken)||void 0===i?void 0:i.familyId)||"",tokenType:(null==t||null===(a=t.accessToken)||void 0===a?void 0:a.tokenType)||"",state:e.state||"",cloudGraphHostName:d.cloudGraphHostName||"",msGraphHost:d.msGraphHost||"",fromNativeBroker:!1}}}class Lh extends uu{constructor(e){super(e),this.includeRedirectUri=!1}}function qh(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function jh(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?qh(Object(r),!0).forEach(function(t){Uh(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):qh(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Uh(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Fh(e,t,r,n,o,i,a){try{var c=e[i](a),l=c.value}catch(e){return void r(e)}c.done?t(l):Promise.resolve(l).then(n,o)}class Hh extends _u{constructor(e,t,r,n,o,i,a,c,l,s){super(e,t,r,n,o,i,c,l,s),this.apiId=a}acquireToken(e){var t,r=this;return(t=function*(){if(!e.code)throw Ri(hi);var t=yield gl(r.initializeAuthorizationRequest.bind(r),Kr,r.logger,r.performanceClient,e.correlationId)(e,ro.Silent),n=r.initializeServerTelemetryManager(r.apiId);try{var o=jh(jh({},t),{},{code:e.code}),i=yield gl(r.getClientConfiguration.bind(r),Br,r.logger,r.performanceClient,e.correlationId)({serverTelemetryManager:n,requestAuthority:t.authority,requestAzureCloudOptions:t.azureCloudOptions,requestExtraQueryParameters:t.extraQueryParameters,account:t.account}),a=new Lh(i);r.logger.verbose("Auth code client created");var c=new Lu(a,r.browserStorage,o,r.logger,r.performanceClient);return yield gl(c.handleCodeResponseFromServer.bind(c),Wr,r.logger,r.performanceClient,e.correlationId)({code:e.code,msgraph_host:e.msGraphHost,cloud_graph_host_name:e.cloudGraphHostName,cloud_instance_host_name:e.cloudInstanceHostName},t,!1)}catch(e){throw e instanceof Q&&(e.setCorrelationId(r.correlationId),n.cacheFailedRequest(e)),e}},function(){var e=this,r=arguments;return new Promise(function(n,o){var i=t.apply(e,r);function a(e){Fh(i,n,o,a,c,"next",e)}function c(e){Fh(i,n,o,a,c,"throw",e)}a(void 0)})})()}logout(){return Promise.reject(Ri($o))}}function zh(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Bh(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?zh(Object(r),!0).forEach(function(t){Kh(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):zh(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Kh(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Vh(e,t,r,n,o,i,a){try{var c=e[i](a),l=c.value}catch(e){return void r(e)}c.done?t(l):Promise.resolve(l).then(n,o)}function Wh(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var i=e.apply(t,r);function a(e){Vh(i,n,o,a,c,"next",e)}function c(e){Vh(i,n,o,a,c,"throw",e)}a(void 0)})}}function Qh(e,t,r){try{Sc(e)}catch(e){throw t.end({success:!1},e,r),e}}class Gh{constructor(e){var t,r,n,o;this.operatingContext=e,this.isBrowserEnvironment=this.operatingContext.isBrowserEnvironment(),this.config=e.getConfig(),this.initialized=!1,this.logger=this.operatingContext.getLogger(),this.networkClient=this.config.system.networkClient,this.navigationClient=this.config.system.navigationClient,this.redirectResponse=new Map,this.hybridAuthCodeResponses=new Map,this.performanceClient=this.config.telemetry.client,this.browserCrypto=this.isBrowserEnvironment?new hl(this.logger,this.performanceClient):Ve,this.eventHandler=new qs(this.logger),this.browserStorage=this.isBrowserEnvironment?new Ds(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger,this.performanceClient,this.eventHandler,function(e){var t=e.cloudDiscoveryMetadata,r=void 0;if(t)try{r=JSON.parse(t)}catch(e){throw wt(it)}return{canonicalAuthority:e.authority?Fl(e.authority):void 0,knownAuthorities:e.knownAuthorities,cloudDiscoveryMetadata:r}}(this.config.auth)):(t=this.config.auth.clientId,r=this.logger,n=this.performanceClient,o=this.eventHandler,new Ds(t,{cacheLocation:po,cacheRetentionDays:5,temporaryCacheLocation:po,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1},Ve,r,n,o));var i={cacheLocation:po,cacheRetentionDays:5,temporaryCacheLocation:po,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1};this.nativeInternalStorage=new Ds(this.config.auth.clientId,i,this.browserCrypto,this.logger,this.performanceClient,this.eventHandler),this.tokenCache=new Dh(this.config,this.browserStorage,this.logger,this.browserCrypto),this.activeSilentTokenRequests=new Map,this.trackPageVisibility=this.trackPageVisibility.bind(this),this.trackPageVisibilityWithMeasurement=this.trackPageVisibilityWithMeasurement.bind(this)}static createController(e,t){return Wh(function*(){var r=new Gh(e);return yield r.initialize(t),r})()}trackPageVisibility(e){e&&(this.logger.info("Perf: Visibility change detected"),this.performanceClient.incrementFields({visibilityChangeCount:1},e))}initialize(e,t){var r=this;return Wh(function*(){if(r.logger.trace("initialize called"),r.initialized)r.logger.info("initialize has already been called, exiting early.");else{if(!r.isBrowserEnvironment)return r.logger.info("in non-browser environment, exiting early."),r.initialized=!0,void r.eventHandler.emitEvent(gs);var n=(null==e?void 0:e.correlationId)||r.getRequestCorrelationId(),o=r.config.system.allowPlatformBroker,i=r.performanceClient.startMeasurement(Dr,n);if(r.eventHandler.emitEvent("msal:initializeStart"),!t)try{r.logMultipleInstances(i)}catch(e){}if(yield gl(r.browserStorage.initialize.bind(r.browserStorage),Lr,r.logger,r.performanceClient,n)(n),o)try{r.platformAuthProvider=yield function(e,t,r,n,o){return Hd.apply(this,arguments)}(r.logger,r.performanceClient,n,r.config.system.nativeBrokerHandshakeTimeout,r.config.system.allowPlatformBrokerWithDOM)}catch(e){r.logger.verbose(e)}r.config.cache.claimsBasedCachingEnabled||(r.logger.verbose("Claims-based caching is disabled. Clearing the previous cache with claims"),pl(r.browserStorage.clearTokensAndKeysWithClaims.bind(r.browserStorage),Cn,r.logger,r.performanceClient,n)(n)),r.config.system.asyncPopups&&(yield r.preGeneratePkceCodes(n)),r.initialized=!0,r.eventHandler.emitEvent(gs),i.end({allowPlatformBroker:o,success:!0})}})()}handleRedirectPromise(e){var t=this;return Wh(function*(){if(t.logger.verbose("handleRedirectPromise called"),Ic(t.initialized),t.isBrowserEnvironment){var r=e||"",n=t.redirectResponse.get(r);return void 0===n?(n=t.handleRedirectPromiseInternal(e),t.redirectResponse.set(r,n),t.logger.verbose("handleRedirectPromise has been called for the first time, storing the promise")):t.logger.verbose("handleRedirectPromise has been called previously, returning the result from the first call"),n}return t.logger.verbose("handleRedirectPromise returns null, not browser environment"),null})()}handleRedirectPromiseInternal(e){var t=this;return Wh(function*(){var r;if(!t.browserStorage.isInteractionInProgress(!0))return t.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;if((null===(r=t.browserStorage.getInteractionInProgress())||void 0===r?void 0:r.type)===mo)return t.logger.verbose("handleRedirectPromise removing interaction_in_progress flag and returning null after sign-out"),t.browserStorage.setInteractionInProgress(!1),Promise.resolve(null);var n,o,i=t.getAllAccounts(),a=t.browserStorage.getCachedNativeRequest(),c=a&&t.platformAuthProvider&&!e;t.eventHandler.emitEvent("msal:handleRedirectStart",ro.Redirect);try{if(c&&t.platformAuthProvider){n=t.performanceClient.startMeasurement(hr,(null==a?void 0:a.correlationId)||""),t.logger.trace("handleRedirectPromise - acquiring token from native platform"),n.add({isPlatformBrokerRequest:!0});var l=new rd(t.config,t.browserStorage,t.browserCrypto,t.logger,t.eventHandler,t.navigationClient,865,t.performanceClient,t.platformAuthProvider,a.accountId,t.nativeInternalStorage,a.correlationId);o=gl(l.handleRedirectPromise.bind(l),yn,t.logger,t.performanceClient,n.event.correlationId)(t.performanceClient,n.event.correlationId)}else{var[s,u]=t.browserStorage.getCachedRequest(),d=s.correlationId;n=t.performanceClient.startMeasurement(hr,d),t.logger.trace("handleRedirectPromise - acquiring token from web flow");var h=t.createRedirectClient(d);o=gl(h.handleRedirectPromise.bind(h),vn,t.logger,t.performanceClient,n.event.correlationId)(e,s,u,n)}}catch(e){throw t.browserStorage.resetRequestCache(),e}return o.then(e=>(e?(t.browserStorage.resetRequestCache(),i.length<t.getAllAccounts().length?(t.eventHandler.emitEvent(ws,ro.Redirect,e),t.logger.verbose("handleRedirectResponse returned result, login success")):(t.eventHandler.emitEvent(Is,ro.Redirect,e),t.logger.verbose("handleRedirectResponse returned result, acquire token success")),n.end({success:!0},void 0,e.account)):n.event.errorCode?n.end({success:!1},void 0):n.discard(),t.eventHandler.emitEvent(As,ro.Redirect),e)).catch(e=>{t.browserStorage.resetRequestCache();var r=e;throw i.length>0?t.eventHandler.emitEvent(Ss,ro.Redirect,null,r):t.eventHandler.emitEvent(Cs,ro.Redirect,null,r),t.eventHandler.emitEvent(As,ro.Redirect),n.end({success:!1},r),e})})()}acquireTokenRedirect(e){var t=this;return Wh(function*(){var r=t.getRequestCorrelationId(e);t.logger.verbose("acquireTokenRedirect called",r);var n=t.performanceClient.startMeasurement("acquireTokenPreRedirect",r);n.add({scenarioId:e.scenarioId});var o=e.onRedirectNavigate;if(o)e.onRedirectNavigate=t=>{var r="function"==typeof o?o(t):void 0;return n.add({navigateCallbackResult:!1!==r}),n.event=n.end({success:!0},void 0,e.account)||n.event,r};else{var i=t.config.auth.onRedirectNavigate;t.config.auth.onRedirectNavigate=t=>{var r="function"==typeof i?i(t):void 0;return n.add({navigateCallbackResult:!1!==r}),n.event=n.end({success:!0},void 0,e.account)||n.event,r}}var a=t.getAllAccounts().length>0;try{var c;return Tc(t.initialized,t.config),t.browserStorage.setInteractionInProgress(!0,go),a?t.eventHandler.emitEvent(ks,ro.Redirect,e):t.eventHandler.emitEvent(bs,ro.Redirect,e),c=t.platformAuthProvider&&t.canUsePlatformBroker(e)?new rd(t.config,t.browserStorage,t.browserCrypto,t.logger,t.eventHandler,t.navigationClient,To,t.performanceClient,t.platformAuthProvider,t.getNativeAccountId(e),t.nativeInternalStorage,r).acquireTokenRedirect(e,n).catch(o=>{if(n.add({brokerErrorName:o.name,brokerErrorCode:o.errorCode}),o instanceof Uu&&Fu(o))return t.platformAuthProvider=void 0,t.createRedirectClient(r).acquireToken(e);if(o instanceof Jl)return t.logger.verbose("acquireTokenRedirect - Resolving interaction required error thrown by native broker by falling back to web flow"),t.createRedirectClient(r).acquireToken(e);throw o}):t.createRedirectClient(r).acquireToken(e),yield c}catch(o){throw t.browserStorage.resetRequestCache(),2===n.event.status?t.performanceClient.startMeasurement(hr,r).end({success:!1},o,e.account):n.end({success:!1},o,e.account),a?t.eventHandler.emitEvent(Ss,ro.Redirect,null,o):t.eventHandler.emitEvent(Cs,ro.Redirect,null,o),o}})()}acquireTokenPopup(e){var t=this,r=this.getRequestCorrelationId(e),n=this.performanceClient.startMeasurement(dr,r);n.add({scenarioId:e.scenarioId});try{this.logger.verbose("acquireTokenPopup called",r),Qh(this.initialized,n,e.account),this.browserStorage.setInteractionInProgress(!0,go)}catch(e){return Promise.reject(e)}var o,i=this.getAllAccounts();i.length>0?this.eventHandler.emitEvent(ks,ro.Popup,e):this.eventHandler.emitEvent(bs,ro.Popup,e);var a=this.getPreGeneratedPkceCodes(r);return this.canUsePlatformBroker(e)?(n.add({isPlatformBrokerRequest:!0}),o=this.acquireTokenNative(Bh(Bh({},e),{},{correlationId:r}),Ao).then(e=>(n.end({success:!0},void 0,e.account),e)).catch(t=>{if(n.add({brokerErrorName:t.name,brokerErrorCode:t.errorCode}),t instanceof Uu&&Fu(t))return this.platformAuthProvider=void 0,this.createPopupClient(r).acquireToken(e,a);if(t instanceof Jl)return this.logger.verbose("acquireTokenPopup - Resolving interaction required error thrown by native broker by falling back to web flow"),this.createPopupClient(r).acquireToken(e,a);throw t})):o=this.createPopupClient(r).acquireToken(e,a),o.then(e=>(i.length<this.getAllAccounts().length?this.eventHandler.emitEvent(ws,ro.Popup,e):this.eventHandler.emitEvent(Is,ro.Popup,e),n.end({success:!0,accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length},void 0,e.account),e)).catch(t=>(i.length>0?this.eventHandler.emitEvent(Ss,ro.Popup,null,t):this.eventHandler.emitEvent(Cs,ro.Popup,null,t),n.end({success:!1},t,e.account),Promise.reject(t))).finally(Wh(function*(){t.browserStorage.setInteractionInProgress(!1),t.config.system.asyncPopups&&(yield t.preGeneratePkceCodes(r))}))}trackPageVisibilityWithMeasurement(){var e=this.ssoSilentMeasurement||this.acquireTokenByCodeAsyncMeasurement;e&&(this.logger.info("Perf: Visibility change detected in ",e.event.name),e.increment({visibilityChangeCount:1}))}ssoSilent(e){var t=this;return Wh(function*(){var r,n,o,i,a=t.getRequestCorrelationId(e),c=Bh(Bh({},e),{},{prompt:e.prompt,correlationId:a});return t.ssoSilentMeasurement=t.performanceClient.startMeasurement(yr,a),null===(r=t.ssoSilentMeasurement)||void 0===r||r.add({scenarioId:e.scenarioId}),Qh(t.initialized,t.ssoSilentMeasurement,e.account),null===(n=t.ssoSilentMeasurement)||void 0===n||n.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",t.trackPageVisibilityWithMeasurement),t.logger.verbose("ssoSilent called",a),t.eventHandler.emitEvent("msal:ssoSilentStart",ro.Silent,c),t.canUsePlatformBroker(c)?(null===(i=t.ssoSilentMeasurement)||void 0===i||i.add({isPlatformBrokerRequest:!0}),o=t.acquireTokenNative(c,863).catch(e=>{var r;if(null===(r=t.ssoSilentMeasurement)||void 0===r||r.add({brokerErrorName:e.name,brokerErrorCode:e.errorCode}),e instanceof Uu&&Fu(e))return t.platformAuthProvider=void 0,t.createSilentIframeClient(c.correlationId).acquireToken(c);throw e})):o=t.createSilentIframeClient(c.correlationId).acquireToken(c),o.then(e=>{var r;return t.eventHandler.emitEvent("msal:ssoSilentSuccess",ro.Silent,e),null===(r=t.ssoSilentMeasurement)||void 0===r||r.end({success:!0,accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length},void 0,e.account),e}).catch(r=>{var n;throw t.eventHandler.emitEvent("msal:ssoSilentFailure",ro.Silent,null,r),null===(n=t.ssoSilentMeasurement)||void 0===n||n.end({success:!1},r,e.account),r}).finally(()=>{document.removeEventListener("visibilitychange",t.trackPageVisibilityWithMeasurement)})})()}acquireTokenByCode(e){var t=this;return Wh(function*(){var r=t.getRequestCorrelationId(e);t.logger.trace("acquireTokenByCode called",r);var n=t.performanceClient.startMeasurement(cr,r);Qh(t.initialized,n),t.eventHandler.emitEvent("msal:acquireTokenByCodeStart",ro.Silent,e),n.add({scenarioId:e.scenarioId});try{if(e.code&&e.nativeAccountId)throw Ri(pi);if(e.code){var o=e.code,i=t.hybridAuthCodeResponses.get(o);return i?(t.logger.verbose("Existing acquireTokenByCode request found",r),n.discard()):(t.logger.verbose("Initiating new acquireTokenByCode request",r),i=t.acquireTokenByCodeAsync(Bh(Bh({},e),{},{correlationId:r})).then(e=>(t.eventHandler.emitEvent("msal:acquireTokenByCodeSuccess",ro.Silent,e),t.hybridAuthCodeResponses.delete(o),n.end({success:!0,accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length},void 0,e.account),e)).catch(e=>{throw t.hybridAuthCodeResponses.delete(o),t.eventHandler.emitEvent(Ts,ro.Silent,null,e),n.end({success:!1},e),e}),t.hybridAuthCodeResponses.set(o,i)),yield i}if(e.nativeAccountId){if(t.canUsePlatformBroker(e,e.nativeAccountId)){n.add({isPlatformBrokerRequest:!0});var a=yield t.acquireTokenNative(Bh(Bh({},e),{},{correlationId:r}),866,e.nativeAccountId).catch(e=>{throw e instanceof Uu&&Fu(e)&&(t.platformAuthProvider=void 0),n.add({brokerErrorName:e.name,brokerErrorCode:e.errorCode}),e});return n.end({success:!0},void 0,a.account),a}throw Ri(mi)}throw Ri(fi)}catch(e){throw t.eventHandler.emitEvent(Ts,ro.Silent,null,e),n.end({success:!1},e),e}})()}acquireTokenByCodeAsync(e){var t=this;return Wh(function*(){var r;t.logger.trace("acquireTokenByCodeAsync called",e.correlationId),t.acquireTokenByCodeAsyncMeasurement=t.performanceClient.startMeasurement(mn,e.correlationId),null===(r=t.acquireTokenByCodeAsyncMeasurement)||void 0===r||r.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",t.trackPageVisibilityWithMeasurement);var n=t.createSilentAuthCodeClient(e.correlationId);return yield n.acquireToken(e).then(e=>{var r;return null===(r=t.acquireTokenByCodeAsyncMeasurement)||void 0===r||r.end({success:!0,fromCache:e.fromCache}),e}).catch(e=>{var r;throw null===(r=t.acquireTokenByCodeAsyncMeasurement)||void 0===r||r.end({success:!1},e),e}).finally(()=>{document.removeEventListener("visibilitychange",t.trackPageVisibilityWithMeasurement)})})()}acquireTokenFromCache(e,t){var r=this;return Wh(function*(){switch(r.performanceClient.addQueueMeasurement(Or,e.correlationId),t){case 0:case 1:case 2:var n=r.createSilentCacheClient(e.correlationId);return gl(n.acquireToken.bind(n),gr,r.logger,r.performanceClient,e.correlationId)(e);default:throw ze(Pe)}})()}acquireTokenByRefreshToken(e,t){var r=this;return Wh(function*(){switch(r.performanceClient.addQueueMeasurement(lr,e.correlationId),t){case 0:case 2:case 3:case 4:var n=r.createSilentRefreshClient(e.correlationId);return gl(n.acquireToken.bind(n),vr,r.logger,r.performanceClient,e.correlationId)(e);default:throw ze(Pe)}})()}acquireTokenBySilentIframe(e){var t=this;return Wh(function*(){t.performanceClient.addQueueMeasurement(xr,e.correlationId);var r=t.createSilentIframeClient(e.correlationId);return gl(r.acquireToken.bind(r),mr,t.logger,t.performanceClient,e.correlationId)(e)})()}logout(e){var t=this;return Wh(function*(){var r=t.getRequestCorrelationId(e);return t.logger.warning("logout API is deprecated and will be removed in msal-browser v3.0.0. Use logoutRedirect instead.",r),t.logoutRedirect(Bh({correlationId:r},e))})()}logoutRedirect(e){var t=this;return Wh(function*(){var r=t.getRequestCorrelationId(e);return Tc(t.initialized,t.config),t.browserStorage.setInteractionInProgress(!0,mo),t.createRedirectClient(r).logout(e)})()}logoutPopup(e){try{var t=this.getRequestCorrelationId(e);return Sc(this.initialized),this.browserStorage.setInteractionInProgress(!0,mo),this.createPopupClient(t).logout(e).finally(()=>{this.browserStorage.setInteractionInProgress(!1)})}catch(e){return Promise.reject(e)}}clearCache(e){var t=this;return Wh(function*(){if(t.isBrowserEnvironment){var r=t.getRequestCorrelationId(e);return t.createSilentCacheClient(r).logout(e)}t.logger.info("in non-browser environment, returning early.")})()}getAllAccounts(e){var t=this.getRequestCorrelationId();return function(e,t,r,n,o){return e.verbose("getAllAccounts called"),r?t.getAllAccounts(o||{},n):[]}(this.logger,this.browserStorage,this.isBrowserEnvironment,t,e)}getAccount(e){var t=this.getRequestCorrelationId();return function(e,t,r,n){var o=r.getAccountInfoFilteredBy(e,n);return o?(t.verbose("getAccount: Account matching provided filter found, returning"),o):(t.verbose("getAccount: No matching account found, returning null"),null)}(e,this.logger,this.browserStorage,t)}getAccountByUsername(e){var t=this.getRequestCorrelationId();return function(e,t,r,n){if(t.trace("getAccountByUsername called"),!e)return t.warning("getAccountByUsername: No username provided"),null;var o=r.getAccountInfoFilteredBy({username:e},n);return o?(t.verbose("getAccountByUsername: Account matching username found, returning"),t.verbosePii("getAccountByUsername: Returning signed-in accounts matching username: ".concat(e)),o):(t.verbose("getAccountByUsername: No matching account found, returning null"),null)}(e,this.logger,this.browserStorage,t)}getAccountByHomeId(e){var t=this.getRequestCorrelationId();return function(e,t,r,n){if(t.trace("getAccountByHomeId called"),!e)return t.warning("getAccountByHomeId: No homeAccountId provided"),null;var o=r.getAccountInfoFilteredBy({homeAccountId:e},n);return o?(t.verbose("getAccountByHomeId: Account matching homeAccountId found, returning"),t.verbosePii("getAccountByHomeId: Returning signed-in accounts matching homeAccountId: ".concat(e)),o):(t.verbose("getAccountByHomeId: No matching account found, returning null"),null)}(e,this.logger,this.browserStorage,t)}getAccountByLocalId(e){var t=this.getRequestCorrelationId();return function(e,t,r,n){if(t.trace("getAccountByLocalId called"),!e)return t.warning("getAccountByLocalId: No localAccountId provided"),null;var o=r.getAccountInfoFilteredBy({localAccountId:e},n);return o?(t.verbose("getAccountByLocalId: Account matching localAccountId found, returning"),t.verbosePii("getAccountByLocalId: Returning signed-in accounts matching localAccountId: ".concat(e)),o):(t.verbose("getAccountByLocalId: No matching account found, returning null"),null)}(e,this.logger,this.browserStorage,t)}setActiveAccount(e){var t=this.getRequestCorrelationId();!function(e,t,r){t.setActiveAccount(e,r)}(e,this.browserStorage,t)}getActiveAccount(){var e=this.getRequestCorrelationId();return function(e,t){return e.getActiveAccount(t)}(this.browserStorage,e)}hydrateCache(e,t){var r=this;return Wh(function*(){r.logger.verbose("hydrateCache called");var n=Dt.createFromAccountInfo(e.account,e.cloudGraphHostName,e.msGraphHost);return yield r.browserStorage.setAccount(n,e.correlationId,qt(e.idTokenClaims)),e.fromNativeBroker?(r.logger.verbose("Response was from native broker, storing in-memory"),r.nativeInternalStorage.hydrateCache(e,t)):r.browserStorage.hydrateCache(e,t)})()}acquireTokenNative(e,t,r,n){var o=this;return Wh(function*(){if(o.logger.trace("acquireTokenNative called"),!o.platformAuthProvider)throw Ri(bi);return new rd(o.config,o.browserStorage,o.browserCrypto,o.logger,o.eventHandler,o.navigationClient,t,o.performanceClient,o.platformAuthProvider,r||o.getNativeAccountId(e),o.nativeInternalStorage,e.correlationId).acquireToken(e,n)})()}canUsePlatformBroker(e,t){if(this.logger.trace("canUsePlatformBroker called"),!this.platformAuthProvider)return this.logger.trace("canUsePlatformBroker: platform broker unavilable, returning false"),!1;if(!zd(this.config,this.logger,this.platformAuthProvider,e.authenticationScheme))return this.logger.trace("canUsePlatformBroker: isBrokerAvailable returned false, returning false"),!1;if(e.prompt)switch(e.prompt){case T:case S:case k:case I:this.logger.trace("canUsePlatformBroker: prompt is compatible with platform broker flow");break;default:return this.logger.trace("canUsePlatformBroker: prompt = ".concat(e.prompt," is not compatible with platform broker flow, returning false")),!1}return!(!t&&!this.getNativeAccountId(e)&&(this.logger.trace("canUsePlatformBroker: nativeAccountId is not available, returning false"),1))}getNativeAccountId(e){var t=e.account||this.getAccount({loginHint:e.loginHint,sid:e.sid})||this.getActiveAccount();return t&&t.nativeAccountId||""}createPopupClient(e){return new Gd(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.platformAuthProvider,e)}createRedirectClient(e){return new eh(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.platformAuthProvider,e)}createSilentIframeClient(e){return new wh(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,863,this.performanceClient,this.nativeInternalStorage,this.platformAuthProvider,e)}createSilentCacheClient(e){return new Wu(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.platformAuthProvider,e)}createSilentRefreshClient(e){return new xh(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.platformAuthProvider,e)}createSilentAuthCodeClient(e){return new Hh(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,866,this.performanceClient,this.platformAuthProvider,e)}addEventCallback(e,t){return this.eventHandler.addEventCallback(e,t)}removeEventCallback(e){this.eventHandler.removeEventCallback(e)}addPerformanceCallback(e){return kc(),this.performanceClient.addPerformanceCallback(e)}removePerformanceCallback(e){return this.performanceClient.removePerformanceCallback(e)}enableAccountStorageEvents(){this.config.cache.cacheLocation===ho?this.eventHandler.subscribeCrossTab():this.logger.info("Account storage events are only available when cacheLocation is set to localStorage")}disableAccountStorageEvents(){this.config.cache.cacheLocation===ho?this.eventHandler.unsubscribeCrossTab():this.logger.info("Account storage events are only available when cacheLocation is set to localStorage")}getTokenCache(){return this.tokenCache}getLogger(){return this.logger}setLogger(e){this.logger=e}initializeWrapperLibrary(e,t){this.browserStorage.setWrapperMetadata(e,t)}setNavigationClient(e){this.navigationClient=e}getConfiguration(){return this.config}getPerformanceClient(){return this.performanceClient}isBrowserEnv(){return this.isBrowserEnvironment}getRequestCorrelationId(e){return null!=e&&e.correlationId?e.correlationId:this.isBrowserEnvironment?Ka():c.EMPTY_STRING}loginRedirect(e){var t=this;return Wh(function*(){var r=t.getRequestCorrelationId(e);return t.logger.verbose("loginRedirect called",r),t.acquireTokenRedirect(Bh({correlationId:r},e||Po))})()}loginPopup(e){var t=this.getRequestCorrelationId(e);return this.logger.verbose("loginPopup called",t),this.acquireTokenPopup(Bh({correlationId:t},e||Po))}acquireTokenSilent(e){var t=this;return Wh(function*(){var r=t.getRequestCorrelationId(e),n=t.performanceClient.startMeasurement(sr,r);n.add({cacheLookupPolicy:e.cacheLookupPolicy,scenarioId:e.scenarioId}),Qh(t.initialized,n,e.account),t.logger.verbose("acquireTokenSilent called",r);var o=e.account||t.getActiveAccount();if(!o)throw Ri(Xo);return t.acquireTokenSilentDeduped(e,o,r).then(t=>(n.end({success:!0,fromCache:t.fromCache,accessTokenSize:t.accessToken.length,idTokenSize:t.idToken.length},void 0,t.account),Bh(Bh({},t),{},{state:e.state,correlationId:r}))).catch(e=>{throw e instanceof Q&&e.setCorrelationId(r),n.end({success:!1},e,o),e})})()}acquireTokenSilentDeduped(e,t,r){var n=this;return Wh(function*(){var o=Xl(n.config.auth.clientId,Bh(Bh({},e),{},{authority:e.authority||n.config.auth.authority,correlationId:r}),t.homeAccountId),i=JSON.stringify(o),a=n.activeSilentTokenRequests.get(i);if(void 0===a){n.logger.verbose("acquireTokenSilent called for the first time, storing active request",r),n.performanceClient.addFields({deduped:!1},r);var c=gl(n.acquireTokenSilentAsync.bind(n),ur,n.logger,n.performanceClient,r)(Bh(Bh({},e),{},{correlationId:r}),t);return n.activeSilentTokenRequests.set(i,c),c.finally(()=>{n.activeSilentTokenRequests.delete(i)})}return n.logger.verbose("acquireTokenSilent has been called previously, returning the result from the first call",r),n.performanceClient.addFields({deduped:!0},r),a})()}acquireTokenSilentAsync(e,t){var r=this;return Wh(function*(){var n=()=>r.trackPageVisibility(e.correlationId);r.performanceClient.addQueueMeasurement(ur,e.correlationId),r.eventHandler.emitEvent(ks,ro.Silent,e),e.correlationId&&r.performanceClient.incrementFields({visibilityChangeCount:0},e.correlationId),document.addEventListener("visibilitychange",n);var o=yield gl(ku,Nr,r.logger,r.performanceClient,e.correlationId)(e,t,r.config,r.performanceClient,r.logger),i=e.cacheLookupPolicy||0,a=r.acquireTokenSilentNoIframe(o,i).catch(function(){var e=Wh(function*(e){var t=function(e,t){var r=!(e instanceof Jl&&e.subError!==Vl),n=e.errorCode===oo||e.errorCode===Pe,o=r&&n||e.errorCode===Hl||e.errorCode===Bl,i=_o.includes(t);return o&&i}(e,i);if(t){if(r.activeIframeRequest){if(5!==i){var[n,a]=r.activeIframeRequest;r.logger.verbose("Iframe request is already in progress, awaiting resolution for request with correlationId: ".concat(a),o.correlationId);var c=r.performanceClient.startMeasurement("awaitConcurrentIframe",o.correlationId);c.add({awaitIframeCorrelationId:a});var l=yield n;if(c.end({success:l}),l)return r.logger.verbose("Parallel iframe request with correlationId: ".concat(a," succeeded. Retrying cache and/or RT redemption"),o.correlationId),r.acquireTokenSilentNoIframe(o,i);throw r.logger.info("Iframe request with correlationId: ".concat(a," failed. Interaction is required.")),e}return r.logger.warning("Another iframe request is currently in progress and CacheLookupPolicy is set to Skip. This may result in degraded performance and/or reliability for both calls. Please consider changing the CacheLookupPolicy to take advantage of request queuing and token cache.",o.correlationId),gl(r.acquireTokenBySilentIframe.bind(r),xr,r.logger,r.performanceClient,o.correlationId)(o)}var s;return r.activeIframeRequest=[new Promise(e=>{s=e}),o.correlationId],r.logger.verbose("Refresh token expired/invalid or CacheLookupPolicy is set to Skip, attempting acquire token by iframe.",o.correlationId),gl(r.acquireTokenBySilentIframe.bind(r),xr,r.logger,r.performanceClient,o.correlationId)(o).then(e=>(s(!0),e)).catch(e=>{throw s(!1),e}).finally(()=>{r.activeIframeRequest=void 0})}throw e});return function(t){return e.apply(this,arguments)}}());return a.then(t=>(r.eventHandler.emitEvent(Is,ro.Silent,t),r.performanceClient.addFields({fromCache:t.fromCache},e.correlationId),t)).catch(e=>{throw r.eventHandler.emitEvent(Ss,ro.Silent,null,e),e}).finally(()=>{document.removeEventListener("visibilitychange",n)})})()}acquireTokenSilentNoIframe(e,t){var r=this;return Wh(function*(){return zd(r.config,r.logger,r.platformAuthProvider,e.authenticationScheme)&&e.account.nativeAccountId?(r.logger.verbose("acquireTokenSilent - attempting to acquire token from native platform"),r.performanceClient.addFields({isPlatformBrokerRequest:!0},e.correlationId),r.acquireTokenNative(e,61,e.account.nativeAccountId,t).catch(function(){var t=Wh(function*(t){if(r.performanceClient.addFields({brokerErrorName:t.name,brokerErrorCode:t.errorCode},e.correlationId),t instanceof Uu&&Fu(t))throw r.logger.verbose("acquireTokenSilent - native platform unavailable, falling back to web flow"),r.platformAuthProvider=void 0,ze(Pe);throw t});return function(e){return t.apply(this,arguments)}}())):(r.logger.verbose("acquireTokenSilent - attempting to acquire token from web flow"),1===t&&r.logger.verbose("acquireTokenSilent - cache lookup policy set to AccessToken, attempting to acquire token from local cache"),gl(r.acquireTokenFromCache.bind(r),Or,r.logger,r.performanceClient,e.correlationId)(e,t).catch(n=>{if(1===t)throw n;return r.eventHandler.emitEvent("msal:acquireTokenFromNetworkStart",ro.Silent,e),gl(r.acquireTokenByRefreshToken.bind(r),lr,r.logger,r.performanceClient,e.correlationId)(e,t)}))})()}preGeneratePkceCodes(e){var t=this;return Wh(function*(){return t.logger.verbose("Generating new PKCE codes"),t.pkceCode=yield gl(Td,An,t.logger,t.performanceClient,e)(t.performanceClient,t.logger,e),Promise.resolve()})()}getPreGeneratedPkceCodes(e){this.logger.verbose("Attempting to pick up pre-generated PKCE codes");var t=this.pkceCode?Bh({},this.pkceCode):void 0;return this.pkceCode=void 0,this.logger.verbose("".concat(t?"Found":"Did not find"," pre-generated PKCE codes")),this.performanceClient.addFields({usePreGeneratedPkce:!!t},e),t}logMultipleInstances(e){var t=this.config.auth.clientId;window&&(window.msal=window.msal||{},window.msal.clientIds=window.msal.clientIds||[],window.msal.clientIds.length>0&&this.logger.verbose("There is already an instance of MSAL.js in the window."),window.msal.clientIds.push(t),function(e,t,r){var n,o=(null===(n=window.msal)||void 0===n?void 0:n.clientIds)||[],i=o.length,a=o.filter(t=>t===e).length;a>1&&r.warning("There is already an instance of MSAL.js in the window with the same client id."),t.add({msalInstanceCount:i,sameClientIdInstanceCount:a})}(t,e,this.logger))}}function Jh(e,t,r,n,o,i,a){try{var c=e[i](a),l=c.value}catch(e){return void r(e)}c.done?t(l):Promise.resolve(l).then(n,o)}function Yh(){return(e=function*(e,t){var r=new Vc(e);return yield r.initialize(),Gh.createController(r,t)},Yh=function(){var t=this,r=arguments;return new Promise(function(n,o){var i=e.apply(t,r);function a(e){Jh(i,n,o,a,c,"next",e)}function c(e){Jh(i,n,o,a,c,"throw",e)}a(void 0)})}).apply(this,arguments);var e}function $h(e,t,r,n,o,i,a){try{var c=e[i](a),l=c.value}catch(e){return void r(e)}c.done?t(l):Promise.resolve(l).then(n,o)}function Xh(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var i=e.apply(t,r);function a(e){$h(i,n,o,a,c,"next",e)}function c(e){$h(i,n,o,a,c,"throw",e)}a(void 0)})}}class Zh{static createPublicClientApplication(e){return Xh(function*(){var t=yield function(e,t){return Yh.apply(this,arguments)}(e);return new Zh(e,t)})()}constructor(e,t){this.isBroker=!1,this.controller=t||new Gh(new Vc(e))}initialize(e){var t=this;return Xh(function*(){return t.controller.initialize(e,t.isBroker)})()}acquireTokenPopup(e){var t=this;return Xh(function*(){return t.controller.acquireTokenPopup(e)})()}acquireTokenRedirect(e){return this.controller.acquireTokenRedirect(e)}acquireTokenSilent(e){return this.controller.acquireTokenSilent(e)}acquireTokenByCode(e){return this.controller.acquireTokenByCode(e)}addEventCallback(e,t){return this.controller.addEventCallback(e,t)}removeEventCallback(e){return this.controller.removeEventCallback(e)}addPerformanceCallback(e){return this.controller.addPerformanceCallback(e)}removePerformanceCallback(e){return this.controller.removePerformanceCallback(e)}enableAccountStorageEvents(){this.controller.enableAccountStorageEvents()}disableAccountStorageEvents(){this.controller.disableAccountStorageEvents()}getAccount(e){return this.controller.getAccount(e)}getAccountByHomeId(e){return this.controller.getAccountByHomeId(e)}getAccountByLocalId(e){return this.controller.getAccountByLocalId(e)}getAccountByUsername(e){return this.controller.getAccountByUsername(e)}getAllAccounts(e){return this.controller.getAllAccounts(e)}handleRedirectPromise(e){return this.controller.handleRedirectPromise(e)}loginPopup(e){return this.controller.loginPopup(e)}loginRedirect(e){return this.controller.loginRedirect(e)}logout(e){return this.controller.logout(e)}logoutRedirect(e){return this.controller.logoutRedirect(e)}logoutPopup(e){return this.controller.logoutPopup(e)}ssoSilent(e){return this.controller.ssoSilent(e)}getTokenCache(){return this.controller.getTokenCache()}getLogger(){return this.controller.getLogger()}setLogger(e){this.controller.setLogger(e)}setActiveAccount(e){this.controller.setActiveAccount(e)}getActiveAccount(){return this.controller.getActiveAccount()}initializeWrapperLibrary(e,t){return this.controller.initializeWrapperLibrary(e,t)}setNavigationClient(e){this.controller.setNavigationClient(e)}getConfiguration(){return this.controller.getConfiguration()}hydrateCache(e,t){var r=this;return Xh(function*(){return r.controller.hydrateCache(e,t)})()}clearCache(e){return this.controller.clearCache(e)}}var ef=function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function a(e){try{l(n.next(e))}catch(e){i(e)}}function c(e){try{l(n.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(a,c)}l((n=n.apply(e,t||[])).next())})};class tf{constructor(e,t,r){this.currentAccount=null,this.bffAppId=r,this.namedScope="api://".concat(r,"/SDAP.Access"),this.msalInstance=new Zh({auth:{clientId:t,authority:"https://login.microsoftonline.com/".concat(e),redirectUri:"https://spaarkedev1.crm.dynamics.com",navigateToLoginRequestUrl:!1},cache:{cacheLocation:"sessionStorage",storeAuthStateInCookie:!1},system:{loggerOptions:{loggerCallback:(e,t,r)=>{r||console.log("[MSAL] ".concat(t))},logLevel:3}}})}initialize(){return ef(this,void 0,void 0,function*(){console.info("[AuthService] Initializing MSAL..."),yield this.msalInstance.initialize(),console.info("[AuthService] MSAL instance initialized");var e=yield this.msalInstance.handleRedirectPromise();if(e&&(console.info("[AuthService] Redirect response processed, user authenticated via redirect"),this.currentAccount=e.account),!this.currentAccount){var t=this.msalInstance.getAllAccounts();t.length>0?(this.currentAccount=t[0],console.info("[AuthService] Active account found: ".concat(this.currentAccount.username))):console.info("[AuthService] No active account found")}console.info("[AuthService] MSAL initialization complete")})}getAccessToken(){return ef(this,void 0,void 0,function*(){try{if(this.currentAccount){console.log("[AuthService] Attempting acquireTokenSilent with cached account...");try{var e={scopes:[this.namedScope],account:this.currentAccount},t=yield this.msalInstance.acquireTokenSilent(e);return console.log("[AuthService] acquireTokenSilent succeeded"),t.accessToken}catch(e){console.log("[AuthService] acquireTokenSilent failed, trying ssoSilent...")}}console.log("[AuthService] Attempting ssoSilent authentication...");var r=yield this.attemptSsoSilent();if(r)return console.log("[AuthService] ssoSilent succeeded"),r.account&&(this.currentAccount=r.account),r.accessToken;console.log("[AuthService] Falling back to popup authentication...");var n=yield this.attemptPopupAuth();return console.log("[AuthService] Popup authentication succeeded"),n.account&&(this.currentAccount=n.account),n.accessToken}catch(e){throw console.error("[AuthService] Token acquisition failed:",e),new Error("Failed to acquire access token: ".concat(e instanceof Error?e.message:String(e)))}})}attemptSsoSilent(){return ef(this,void 0,void 0,function*(){try{var e={scopes:[this.namedScope]};return yield this.msalInstance.ssoSilent(e)}catch(e){return console.log("[AuthService] ssoSilent not available:",e instanceof Error?e.message:String(e)),null}})}attemptPopupAuth(){return ef(this,void 0,void 0,function*(){var e,t={scopes:[this.namedScope],loginHint:null===(e=this.currentAccount)||void 0===e?void 0:e.username};try{return yield this.msalInstance.acquireTokenPopup(t)}catch(e){if(e instanceof Error){if(e.message.includes("popup_window_error")||e.message.includes("BrowserAuthError"))throw new Error("Popup blocked. Please allow popups for this site and try again.");if(e.message.includes("user_cancelled")||e.message.includes("popup_window_closed"))throw new Error("Authentication cancelled by user")}throw e}})}getCurrentAccount(){return this.currentAccount}logout(){return ef(this,void 0,void 0,function*(){var e=this.getCurrentAccount();e&&(yield this.msalInstance.logoutPopup({account:e})),this.currentAccount=null})}getScope(){return this.namedScope}}const rf=FluentUIReactv940;var nf="undefined"==typeof window?r.g:window,of="@griffel/";function af(e,t){return nf[Symbol.for(of+e)]||(nf[Symbol.for(of+e)]=t),nf[Symbol.for(of+e)]}var cf=af("DEFINITION_LOOKUP_TABLE",{}),lf="data-make-styles-bucket";function sf(e,t){return"___"+function(e){var t=e.length;if(7===t)return e;for(var r=t;r<7;r++)e+="0";return e}(function(e){for(var t,r=0,n=0,o=e.length;o>=4;++n,o-=4)t=1540483477*(65535&(t=255&e.charCodeAt(n)|(255&e.charCodeAt(++n))<<8|(255&e.charCodeAt(++n))<<16|(255&e.charCodeAt(++n))<<24))+(59797*(t>>>16)<<16),r=1540483477*(65535&(t^=t>>>24))+(59797*(t>>>16)<<16)^1540483477*(65535&r)+(59797*(r>>>16)<<16);switch(o){case 3:r^=(255&e.charCodeAt(n+2))<<16;case 2:r^=(255&e.charCodeAt(n+1))<<8;case 1:r=1540483477*(65535&(r^=255&e.charCodeAt(n)))+(59797*(r>>>16)<<16)}return(((r=1540483477*(65535&(r^=r>>>13))+(59797*(r>>>16)<<16))^r>>>15)>>>0).toString(36)}(e+t))}function uf(e,t){var r="",n="";for(var o in e){var i=e[o];if(0!==i){var a=Array.isArray(i),c="rtl"===t?(a?i[1]:i)+" ":(a?i[0]:i)+" ";r+=c,n+=c}else n+=o+" "}return[r.slice(0,-1),n.slice(0,-1)]}function df(e,t){var r={};for(var n in e){var[o,i]=uf(e[n],t);if(""!==i){var a=sf(i,t),c=a+(""===o?"":" "+o);cf[a]=[e[n],t],r[n]=c}else r[n]=""}return r}var hf={};function ff(){for(var e=arguments,t=null,r="",n="",o=new Array(arguments.length),i=function(){var t=e[a];if("string"==typeof t&&""!==t){var i=t.indexOf("___");if(-1===i)r+=t+" ";else{var c=t.substr(i,10);i>0&&(r+=t.slice(0,i)),n+=c,o[a]=c}}},a=0;a<arguments.length;a++)i();if(""===n)return r.slice(0,-1);var c=hf[n];if(void 0!==c)return r+c;for(var l=[],s=0;s<arguments.length;s++){var u=o[s];if(u){var d=cf[u];d&&(l.push(d[0]),t=d[1])}}var h=Object.assign.apply(Object,[{}].concat(l)),[f,p]=uf(h,t),g=sf(p,t),m=g+" "+f;return hf[n]=m,cf[g]=[h,t],r+m}var pf=i.createContext(void 0),gf={},mf=(pf.Provider,()=>{var e={};return function(t,r){void 0===e[t.id]&&(t.insertCSSRules(r),e[t.id]=!0)}}),vf=i.useInsertionEffect?i.useInsertionEffect:void 0,yf=()=>{var e={};return function(t,r){vf&&"undefined"!=typeof window&&window.document&&window.document.createElement?vf(()=>{t.insertCSSRules(r)},[t,r]):void 0===e[t.id]&&(t.insertCSSRules(r),e[t.id]=!0)}};function bf(e){return Array.isArray(e)?e:[e]}var wf=["r","d","l","v","w","f","i","h","a","s","k","t","m","c"].reduce((e,t,r)=>(e[t]=r,e),{});function Cf(e,t,r,n){var o,i,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},c="m"===e,l=null!==(o=a.m)&&void 0!==o?o:"0",s=null!==(i=a.p)&&void 0!==i?i:0,u=function(e,t,r){return("m"===e?e+t:e)+r}(e,l,s);if(!n.stylesheets[u]){var d=t&&t.createElement("style"),h=function(e,t,r,n){var o=[];if(n[lf]=t,n["data-priority"]=String(r),e)for(var i in n)e.setAttribute(i,n[i]);return{elementAttributes:n,insertRule:function(t){return(null==e?void 0:e.sheet)?e.sheet.insertRule(t,e.sheet.cssRules.length):o.push(t)},element:e,bucketName:t,cssRules:()=>(null==e?void 0:e.sheet)?Array.from(e.sheet.cssRules).map(e=>e.cssText):o}}(d,e,s,Object.assign({},n.styleElementAttributes,c&&{media:l}));n.stylesheets[u]=h,(null==t?void 0:t.head)&&d&&t.head.insertBefore(d,function(e,t,r,n){var o,i,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},c=wf[r],l=null!==(o=a.m)&&void 0!==o?o:"",s=null!==(i=a.p)&&void 0!==i?i:0,u=e=>c-wf[e.getAttribute(lf)],d=e.head.querySelectorAll("[".concat(lf,"]"));if("m"===r){var h=e.head.querySelectorAll("[".concat(lf,'="').concat(r,'"]'));h.length&&(d=h,u=e=>n.compareMediaQueries(l,e.media))}for(var f=e=>function(e,t,r){var n,o;return t+(null!==(n=r.m)&&void 0!==n?n:"")===e.getAttribute(lf)+(null!==(o=e.media)&&void 0!==o?o:"")}(e,r,a)?s-Number(e.getAttribute("data-priority")):u(e),p=d.length,g=p-1;g>=0;){var m=d.item(g);if(f(m)>0)return m.nextSibling;g--}return p>0?d.item(0):t?t.nextSibling:null}(t,r,e,n,a))}return n.stylesheets[u]}function kf(e,t){try{e.insertRule(t)}catch(e){}}":(".concat(["-moz-placeholder","-moz-focus-inner","-moz-focusring","-ms-input-placeholder","-moz-read-write","-moz-read-only"].join("|"),")");var If=0,Sf=(e,t)=>e<t?-1:e>t?1:0;function Tf(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"undefined"==typeof document?void 0:document,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{classNameHashSalt:r,unstable_filterCSSRule:n,insertionPoint:o,styleElementAttributes:i,compareMediaQueries:a=Sf}=t,c={classNameHashSalt:r,insertionCache:{},stylesheets:{},styleElementAttributes:Object.freeze(i),compareMediaQueries:a,id:"d".concat(If++),insertCSSRules(t){for(var r in t)for(var i=t[r],a=0,l=i.length;a<l;a++){var[s,u]=bf(i[a]),d=Cf(r,e,o||null,c,u);c.insertionCache[s]||(c.insertionCache[s]=r,n?n(s)&&kf(d,s):kf(d,s))}}};return c}var Af=i.createContext(Tf()),Pf=i.createContext("ltr");function Ef(e,t){var r=function(e,t){var r=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:mf)(),n=null,o=null;return function(i){var{dir:a,renderer:c}=i,l="ltr"===a;return l?null===n&&(n=df(e,a)):null===o&&(o=df(e,a)),r(c,t),l?n:o}}(e,t,yf);return function(){var e=i.useContext(Pf),t=i.useContext(Af);return r({dir:e,renderer:t})}}var Of=Ef({root:{mc9l5x:"f1w7gpdv",Bg96gwp:"fez10in"},rtl:{Bz10aip:"f13rod7r"}},{d:[".f1w7gpdv{display:inline;}",".fez10in{line-height:0;}",".f13rod7r{transform:scaleX(-1);}"]}),_f=["title","primaryFill"];function Rf(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function xf(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Rf(Object(r),!0).forEach(function(t){Mf(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Rf(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Mf(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Nf=Ef({root:{B8gzw0y:"f1dd5bof"}},{m:[["@media (forced-colors: active){.f1dd5bof{forced-color-adjust:auto;}}",{m:"(forced-colors: active)"}]]});function Df(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Lf(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Df(Object(r),!0).forEach(function(t){qf(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Df(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function qf(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var jf=(e,t,r,n)=>{var o="1em"===t?"20":t,a=i.forwardRef((e,a)=>{var c=Nf(),l=((e,t)=>{var r,{title:n,primaryFill:o="currentColor"}=e,a=function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(e,_f),c=xf(xf({},a),{},{title:void 0,fill:o}),l=Of(),s=null!=(r=i.useContext(pf))?r:gf;return c.className=ff(l.root,(null==t?void 0:t.flipInRtl)&&"rtl"===(null==s?void 0:s.textDirection)&&l.rtl,c.className),n&&(c["aria-label"]=n),c["aria-label"]||c["aria-labelledby"]?c.role="img":c["aria-hidden"]=!0,c})(e,{flipInRtl:null==n?void 0:n.flipInRtl}),s=Lf(Lf({},l),{},{className:ff(l.className,c.root),ref:a,width:t,height:t,viewBox:"0 0 ".concat(o," ").concat(o),xmlns:"http://www.w3.org/2000/svg"});return"string"==typeof r?i.createElement("svg",Lf(Lf({},s),{},{dangerouslySetInnerHTML:{__html:r}})):i.createElement("svg",s,...r.map(e=>i.createElement("path",{d:e,fill:s.fill})))});return a.displayName=e,a},Uf=jf("ArrowClockwise24Regular","24",["M12 4.5a7.5 7.5 0 1 0 7.42 6.4c-.07-.46.26-.9.72-.9.37 0 .7.26.76.62A9 9 0 1 1 18 5.3V4.25a.75.75 0 0 1 1.5 0v3c0 .41-.34.75-.75.75h-3a.75.75 0 0 1 0-1.5h1.35a7.47 7.47 0 0 0-5.1-2Z"]),Ff=jf("ArrowDownload24Regular","24",["M18.25 20.5a.75.75 0 1 1 0 1.5h-13a.75.75 0 1 1 0-1.5h13Zm-6.6-18.49h.1c.38 0 .7.28.74.64l.01.1v13.7l3.72-3.73a.75.75 0 0 1 .98-.07l.08.07c.27.27.3.68.07.98l-.07.08-5 5a.75.75 0 0 1-.97.07l-.09-.07-5-5a.75.75 0 0 1 .98-1.13l.08.07L11 16.43V2.76c0-.38.28-.7.65-.75h.1-.1Z"]),Hf=function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function a(e){try{l(n.next(e))}catch(e){i(e)}}function c(e){try{l(n.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(a,c)}l((n=n.apply(e,t||[])).next())})};class zf{constructor(e){this.baseUrl=e.endsWith("/")?e.slice(0,-1):e}getPreviewUrl(e,t,r){return Hf(this,void 0,void 0,function*(){var n="".concat(this.baseUrl,"/api/documents/").concat(e,"/preview-url");console.log("[BffClient] GET ".concat(n));var o=yield fetch(n,{method:"GET",headers:{Authorization:"Bearer ".concat(t),"X-Correlation-Id":r,Accept:"application/json"},mode:"cors",credentials:"omit"});return o.ok||(yield this.handleErrorResponse(o,r)),yield o.json()})}checkout(e,t,r){return Hf(this,void 0,void 0,function*(){var n="".concat(this.baseUrl,"/api/documents/").concat(e,"/checkout");console.log("[BffClient] POST ".concat(n));var o=yield fetch(n,{method:"POST",headers:{Authorization:"Bearer ".concat(t),"X-Correlation-Id":r,Accept:"application/json","Content-Type":"application/json"},mode:"cors",credentials:"omit"});if(!o.ok){if(409===o.status){var i=yield o.json();throw new Bf(i)}yield this.handleErrorResponse(o,r)}return yield o.json()})}checkIn(e,t,r,n){return Hf(this,void 0,void 0,function*(){var o="".concat(this.baseUrl,"/api/documents/").concat(e,"/checkin");console.log("[BffClient] POST ".concat(o));var i=yield fetch(o,{method:"POST",headers:{Authorization:"Bearer ".concat(t),"X-Correlation-Id":r,Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({comment:n}),mode:"cors",credentials:"omit"});return i.ok||(yield this.handleErrorResponse(i,r)),yield i.json()})}discard(e,t,r){return Hf(this,void 0,void 0,function*(){var n="".concat(this.baseUrl,"/api/documents/").concat(e,"/discard");console.log("[BffClient] POST ".concat(n));var o=yield fetch(n,{method:"POST",headers:{Authorization:"Bearer ".concat(t),"X-Correlation-Id":r,Accept:"application/json","Content-Type":"application/json"},mode:"cors",credentials:"omit"});return o.ok||(yield this.handleErrorResponse(o,r)),yield o.json()})}deleteDocument(e,t,r){return Hf(this,void 0,void 0,function*(){var n="".concat(this.baseUrl,"/api/documents/").concat(e);console.log("[BffClient] DELETE ".concat(n));var o=yield fetch(n,{method:"DELETE",headers:{Authorization:"Bearer ".concat(t),"X-Correlation-Id":r,Accept:"application/json"},mode:"cors",credentials:"omit"});if(!o.ok){if(409===o.status){var i=yield o.json();throw new Bf(i)}yield this.handleErrorResponse(o,r)}return yield o.json()})}getOpenLinks(e,t,r){return Hf(this,void 0,void 0,function*(){var n="".concat(this.baseUrl,"/api/documents/").concat(e,"/open-links");console.log("[BffClient] GET ".concat(n));var o=yield fetch(n,{method:"GET",headers:{Authorization:"Bearer ".concat(t),"X-Correlation-Id":r,Accept:"application/json"},mode:"cors",credentials:"omit"});return o.ok||(yield this.handleErrorResponse(o,r)),yield o.json()})}handleErrorResponse(e,t){return Hf(this,void 0,void 0,function*(){var r,n=yield e.text(),o=null;try{o=JSON.parse(n)}catch(e){}var i=null===(r=null==o?void 0:o.extensions)||void 0===r?void 0:r.code,a=(null==o?void 0:o.title)||"HTTP ".concat(e.status),c=(null==o?void 0:o.detail)||"";switch(console.error("[BffClient] BFF API Error:",{status:e.status,code:i,title:a,detail:c,correlationId:(null==o?void 0:o.correlationId)||t}),i){case"invalid_id":throw new Error("Invalid document ID format.");case"document_not_found":throw new Error("Document not found. It may have been deleted.");case"document_locked":throw new Error("Document is locked by another user.");case"not_checked_out":throw new Error("Document is not checked out.");case"not_authorized":throw new Error("You are not authorized to perform this action.");default:switch(e.status){case 401:throw new Error("Authentication failed. Please refresh the page.");case 403:throw new Error("You do not have permission to access this file.");case 404:throw new Error("Document not found.");case 409:throw new Error("Document is currently locked.");case 500:case 502:case 503:case 504:throw new Error("Server error (".concat(e.status,"). Please try again later."));default:throw new Error(c||a||"An unexpected error occurred.")}}})}}class Bf extends Error{constructor(e){super(e.detail),this.name="DocumentLockedException",this.lockedError=e}}var Kf,Vf;function Wf(e,t,r,n){var[o,a]=(0,i.useState)({previewUrl:null,documentInfo:null,checkoutStatus:null,isLoading:!0,isIframeLoading:!0,error:null,isIframeTimedOut:!1}),c=(0,i.useRef)(new zf(t)),l=(0,i.useRef)(null),s=(0,i.useRef)(!0);(0,i.useEffect)(()=>{c.current=new zf(t)},[t]),(0,i.useEffect)(()=>(s.current=!0,()=>{s.current=!1}),[]);var u=(0,i.useCallback)(()=>{l.current&&(clearTimeout(l.current),l.current=null)},[]),d=(0,i.useCallback)(()=>{u(),l.current=setTimeout(()=>{s.current&&(console.warn("[useDocumentPreview] Iframe load timeout after 15 seconds"),a(e=>Object.assign(Object.assign({},e),{isIframeLoading:!1,isIframeTimedOut:!0,error:"Document preview timed out. The document may be too large or the connection is slow. Please try again."})))},15e3)},[u]),h=(0,i.useCallback)(()=>{return t=this,o=void 0,l=function*(){var t,o;if(e){a(e=>Object.assign(Object.assign({},e),{isLoading:!0,isIframeLoading:!0,isIframeTimedOut:!1,error:null}));try{console.log("[useDocumentPreview] Fetching preview for document: ".concat(e));var i=yield c.current.getPreviewUrl(e,r,n);if(!s.current)return;console.log("[useDocumentPreview] Preview URL received:",{hasUrl:!!i.previewUrl,documentName:null===(t=i.documentInfo)||void 0===t?void 0:t.name,isCheckedOut:null===(o=i.checkoutStatus)||void 0===o?void 0:o.isCheckedOut}),a(e=>{var t,r;return Object.assign(Object.assign({},e),{isLoading:!1,previewUrl:i.previewUrl,documentInfo:null!==(t=i.documentInfo)&&void 0!==t?t:null,checkoutStatus:null!==(r=i.checkoutStatus)&&void 0!==r?r:null,error:null})}),i.previewUrl&&d()}catch(e){if(!s.current)return;console.error("[useDocumentPreview] Failed to load preview:",e),a(t=>Object.assign(Object.assign({},t),{isLoading:!1,isIframeLoading:!1,error:e instanceof Error?e.message:"Failed to load document preview"}))}}else a(e=>Object.assign(Object.assign({},e),{isLoading:!1,isIframeLoading:!1,error:null,previewUrl:null,documentInfo:null,checkoutStatus:null}))},new((i=void 0)||(i=Promise))(function(e,r){function n(e){try{c(l.next(e))}catch(e){r(e)}}function a(e){try{c(l.throw(e))}catch(e){r(e)}}function c(t){var r;t.done?e(t.value):(r=t.value,r instanceof i?r:new i(function(e){e(r)})).then(n,a)}c((l=l.apply(t,o||[])).next())});var t,o,i,l},[e,r,n,d]),f=(0,i.useCallback)(()=>{console.log("[useDocumentPreview] Iframe loaded successfully"),u(),s.current&&a(e=>Object.assign(Object.assign({},e),{isIframeLoading:!1,isIframeTimedOut:!1}))},[u]),p=(0,i.useCallback)(()=>{console.error("[useDocumentPreview] Iframe failed to load"),u(),s.current&&a(e=>Object.assign(Object.assign({},e),{isIframeLoading:!1,error:"Failed to load document preview. Please try again."}))},[u]),g=(0,i.useCallback)(()=>{u(),a(e=>Object.assign(Object.assign({},e),{isIframeLoading:!0,isIframeTimedOut:!1,error:null})),d()},[u,d]),m=(0,i.useCallback)(()=>{u(),h()},[u,h]);return(0,i.useEffect)(()=>(h(),()=>{u()}),[h,u]),Object.assign(Object.assign({},o),{refresh:m,onIframeLoad:f,onIframeError:p,resetIframeState:g})}!function(e){e.Loading="loading",e.Ready="ready",e.Error="error"}(Kf||(Kf={})),function(e){e.Preview="preview",e.Edit="edit",e.Processing="processing"}(Vf||(Vf={}));var Qf=function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function a(e){try{l(n.next(e))}catch(e){i(e)}}function c(e){try{l(n.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(a,c)}l((n=n.apply(e,t||[])).next())})},Gf=jf("Edit24Regular","24",["M20.95 3.05a3.58 3.58 0 0 0-5.06 0L3.94 15c-.4.4-.7.92-.82 1.48l-1.1 4.6a.75.75 0 0 0 .9.9l4.6-1.1A3.1 3.1 0 0 0 9 20.07L20.95 8.11a3.58 3.58 0 0 0 0-5.06Zm-4 1.06a2.08 2.08 0 1 1 2.94 2.94l-.89.89L16.06 5l.9-.9ZM15 6.06 17.94 9l-10 10a1.6 1.6 0 0 1-.76.43l-3.42.8.82-3.4c.06-.3.21-.56.42-.77l10-10Z"]),Jf=jf("Delete24Regular","24",["M10 5h4a2 2 0 1 0-4 0ZM8.5 5a3.5 3.5 0 1 1 7 0h5.75a.75.75 0 0 1 0 1.5h-1.32l-1.17 12.11A3.75 3.75 0 0 1 15.03 22H8.97a3.75 3.75 0 0 1-3.73-3.39L4.07 6.5H2.75a.75.75 0 0 1 0-1.5H8.5Zm2 4.75a.75.75 0 0 0-1.5 0v7.5a.75.75 0 0 0 1.5 0v-7.5ZM14.25 9c.41 0 .75.34.75.75v7.5a.75.75 0 0 1-1.5 0v-7.5c0-.41.34-.75.75-.75Zm-7.52 9.47a2.25 2.25 0 0 0 2.24 2.03h6.06c1.15 0 2.12-.88 2.24-2.03L18.42 6.5H5.58l1.15 11.97Z"]),Yf=jf("FullScreenMaximize24Regular","24",["M4.5 5.75c0-.69.56-1.25 1.25-1.25h2a.75.75 0 0 0 0-1.5h-2A2.75 2.75 0 0 0 3 5.75v2a.75.75 0 0 0 1.5 0v-2Zm0 12.5c0 .69.56 1.25 1.25 1.25h2a.75.75 0 0 1 0 1.5h-2A2.75 2.75 0 0 1 3 18.25v-2a.75.75 0 0 1 1.5 0v2ZM18.25 4.5c.69 0 1.25.56 1.25 1.25v2a.75.75 0 0 0 1.5 0v-2A2.75 2.75 0 0 0 18.25 3h-2a.75.75 0 0 0 0 1.5h2Zm1.25 13.75c0 .69-.56 1.25-1.25 1.25h-2a.75.75 0 0 0 0 1.5h2A2.75 2.75 0 0 0 21 18.25v-2a.75.75 0 0 0-1.5 0v2Z"]),$f=jf("Desktop24Regular","24",["M6.75 22a.75.75 0 0 1-.1-1.5H8.5V18H4.25c-1.2 0-2.17-.92-2.24-2.1L2 15.76V5.25c0-1.2.93-2.17 2.1-2.24L4.25 3h15.5c1.19 0 2.16.93 2.24 2.1v10.65c0 1.2-.92 2.17-2.09 2.25h-4.4v2.5h1.75a.75.75 0 0 1 .1 1.5H6.75ZM14 18h-4v2.5h4V18Zm5.75-13.5H4.25c-.38 0-.7.28-.74.65l-.01.1v10.5c0 .38.28.7.65.75h15.6c.38 0 .7-.28.74-.65V5.25c0-.38-.27-.7-.64-.74l-.1-.01Z"]),Xf=jf("Checkmark24Regular","24",["M4.53 12.97a.75.75 0 0 0-1.06 1.06l4.5 4.5c.3.3.77.3 1.06 0l11-11a.75.75 0 0 0-1.06-1.06L8.5 16.94l-3.97-3.97Z"]),Zf=jf("Dismiss24Regular","24",["m4.4 4.55.07-.08a.75.75 0 0 1 .98-.07l.08.07L12 10.94l6.47-6.47a.75.75 0 1 1 1.06 1.06L13.06 12l6.47 6.47c.27.27.3.68.07.98l-.07.08a.75.75 0 0 1-.98.07l-.08-.07L12 13.06l-6.47 6.47a.75.75 0 0 1-1.06-1.06L10.94 12 4.47 5.53a.75.75 0 0 1-.07-.98l.07-.08-.07.08Z"]),ep=jf("LockClosed16Regular","16",["M9 9a1 1 0 1 1-2 0 1 1 0 0 1 2 0ZM5 4h-.5A2.5 2.5 0 0 0 2 6.5v5A2.5 2.5 0 0 0 4.5 14h7a2.5 2.5 0 0 0 2.5-2.5v-5A2.5 2.5 0 0 0 11.5 4H11v-.5a3 3 0 0 0-6 0V4Zm1-.5a2 2 0 1 1 4 0V4H6v-.5ZM11.5 5c.83 0 1.5.67 1.5 1.5v5c0 .83-.67 1.5-1.5 1.5h-7A1.5 1.5 0 0 1 3 11.5v-5C3 5.67 3.67 5 4.5 5h7Z"]),tp=(0,rf.makeStyles)({badge:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({display:"flex",alignItems:"center"},rf.shorthands.gap("4px")),rf.shorthands.padding("4px","8px")),{backgroundColor:rf.tokens.colorPaletteYellowBackground2}),rf.shorthands.borderRadius("4px")),{fontSize:"12px",color:rf.tokens.colorPaletteYellowForeground2,flexShrink:0}),badgeDark:{backgroundColor:rf.tokens.colorPaletteYellowBackground1,color:rf.tokens.colorPaletteYellowForeground1},icon:{flexShrink:0},text:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"150px"}}),rp=e=>{var t,{checkoutStatus:r,isDarkTheme:n=!1}=e,o=tp();if(!(null==r?void 0:r.isCheckedOut))return null;var a=(null===(t=r.checkedOutBy)||void 0===t?void 0:t.name)||"Unknown user",c=function(e){if(!e)return"";try{var t=new Date(e),r=(new Date).getTime()-t.getTime(),n=Math.floor(r/6e4),o=Math.floor(n/60),i=Math.floor(o/24);return n<1?"just now":n<60?"".concat(n,"m ago"):o<24?"".concat(o,"h ago"):i<7?"".concat(i,"d ago"):t.toLocaleDateString()}catch(e){return""}}(r.checkedOutAt),l=r.isCurrentUser,s=l?"Checked out by you":"Checked out by ".concat(a),u=l?"You checked out this document".concat(c?" ".concat(c):""):"".concat(a," has this document locked").concat(c?" (".concat(c,")"):"");return i.createElement(rf.Tooltip,{content:u,relationship:"description"},i.createElement("div",{className:"".concat(o.badge," ").concat(n?o.badgeDark:"")},i.createElement(ep,{className:o.icon}),i.createElement(rf.Text,{size:200,className:o.text},s)))},np=(0,rf.makeStyles)({toolbar:Object.assign(Object.assign({display:"flex",alignItems:"center",justifyContent:"space-between"},rf.shorthands.padding("8px","12px")),{backgroundColor:rf.tokens.colorNeutralBackground2,borderBottomWidth:"1px",borderBottomStyle:"solid",borderBottomColor:rf.tokens.colorNeutralStroke1,minHeight:"48px",flexShrink:0}),leftSection:Object.assign(Object.assign(Object.assign({display:"flex",alignItems:"center"},rf.shorthands.gap("8px")),rf.shorthands.overflow("hidden")),{flex:1,minWidth:0}),centerSection:{display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},rightSection:Object.assign(Object.assign({display:"flex",alignItems:"center"},rf.shorthands.gap("4px")),{flexShrink:0}),docName:Object.assign(Object.assign({fontWeight:rf.tokens.fontWeightSemibold,fontSize:"14px",color:rf.tokens.colorNeutralForeground1},rf.shorthands.overflow("hidden")),{textOverflow:"ellipsis",whiteSpace:"nowrap"}),docSize:{color:rf.tokens.colorNeutralForeground3,fontSize:"12px",flexShrink:0},divider:{width:"1px",height:"24px",backgroundColor:rf.tokens.colorNeutralStroke2,marginLeft:"8px",marginRight:"8px"}}),op=e=>{var t,{documentInfo:r,checkoutStatus:n,viewMode:o,isDarkTheme:a=!1,enableEdit:c=!0,enableDownload:l=!0,enableDelete:s=!1,isLoading:u=!1,isEditLoading:d=!1,isCheckInLoading:h=!1,isDeleteLoading:f=!1,onRefresh:p,onEdit:g,onDownload:m,onDelete:v,onFullscreen:y,onOpenDesktop:b,onCheckIn:w,onDiscard:C}=e,k=np(),I=(null==r?void 0:r.name)||"Document",S=function(e){if(null==e||0===e)return"";var t=Math.floor(Math.log(e)/Math.log(1024));return"".concat(parseFloat((e/Math.pow(1024,t)).toFixed(1))," ").concat(["B","KB","MB","GB"][t])}(null==r?void 0:r.size),T=(null==n?void 0:n.isCheckedOut)&&!n.isCurrentUser,A=u||d||T,P=T?"Checked out by ".concat((null===(t=null==n?void 0:n.checkedOutBy)||void 0===t?void 0:t.name)||"another user"):"Edit document (check out for editing)",E=u||f||(null==n?void 0:n.isCheckedOut),O=(null==n?void 0:n.isCheckedOut)?"Cannot delete while document is checked out":"Delete document and file",_=u||h;return i.createElement("div",{className:k.toolbar},i.createElement("div",{className:k.leftSection},i.createElement(rf.Text,{className:k.docName,title:I},I),S&&i.createElement(rf.Text,{className:k.docSize},"(",S,")")),i.createElement("div",{className:k.centerSection},i.createElement(rp,{checkoutStatus:n,isDarkTheme:a})),i.createElement("div",{className:k.rightSection},o===Vf.Preview&&i.createElement(i.Fragment,null,i.createElement(rf.Tooltip,{content:"Refresh preview",relationship:"label"},i.createElement(rf.Button,{appearance:"subtle",size:"small",icon:i.createElement(Uf,null),onClick:p,disabled:u,"aria-label":"Refresh"})),c&&i.createElement(rf.Tooltip,{content:P,relationship:"label"},i.createElement(rf.Button,{appearance:"subtle",size:"small",icon:d?i.createElement(rf.Spinner,{size:"tiny"}):i.createElement(Gf,null),onClick:g,disabled:A,"aria-label":"Edit"})),l&&i.createElement(rf.Tooltip,{content:"Download document",relationship:"label"},i.createElement(rf.Button,{appearance:"subtle",size:"small",icon:i.createElement(Ff,null),onClick:m,disabled:u,"aria-label":"Download"})),s&&i.createElement(rf.Dialog,null,i.createElement(rf.DialogTrigger,{disableButtonEnhancement:!0},i.createElement(rf.Tooltip,{content:O,relationship:"label"},i.createElement(rf.Button,{appearance:"subtle",size:"small",icon:f?i.createElement(rf.Spinner,{size:"tiny"}):i.createElement(Jf,null),disabled:E,"aria-label":"Delete"}))),i.createElement(rf.DialogSurface,null,i.createElement(rf.DialogBody,null,i.createElement(rf.DialogTitle,null,"Delete Document?"),i.createElement(rf.DialogContent,null,i.createElement(rf.Text,null,'This will permanently delete "',I,'" and the associated file. This action cannot be undone.')),i.createElement(rf.DialogActions,null,i.createElement(rf.DialogTrigger,{disableButtonEnhancement:!0},i.createElement(rf.Button,{appearance:"secondary"},"Cancel")),i.createElement(rf.Button,{appearance:"primary",onClick:v},"Delete"))))),y&&i.createElement("div",{className:k.divider}),y&&i.createElement(rf.Tooltip,{content:"Open in larger view",relationship:"label"},i.createElement(rf.Button,{appearance:"subtle",size:"small",icon:i.createElement(Yf,null),onClick:y,disabled:u,"aria-label":"Expand"}))),o===Vf.Edit&&i.createElement(i.Fragment,null,i.createElement(rf.Tooltip,{content:"Open in desktop application",relationship:"label"},i.createElement(rf.Button,{appearance:"subtle",size:"small",icon:i.createElement($f,null),onClick:b,disabled:u,"aria-label":"Open in Desktop"})),i.createElement("div",{className:k.divider}),i.createElement(rf.Tooltip,{content:"Save changes and release lock",relationship:"label"},i.createElement(rf.Button,{appearance:"primary",size:"small",icon:h?i.createElement(rf.Spinner,{size:"tiny"}):i.createElement(Xf,null),onClick:w,disabled:_},"Check In")),i.createElement(rf.Tooltip,{content:"Discard changes and release lock",relationship:"label"},i.createElement(rf.Button,{appearance:"subtle",size:"small",icon:i.createElement(Zf,null),onClick:C,disabled:u},"Discard"))),o===Vf.Processing&&i.createElement(rf.Spinner,{size:"small",label:"Processing..."})))},ip=(0,rf.makeStyles)({content:{display:"flex",flexDirection:"column",gap:rf.tokens.spacingVerticalM},commentField:{minHeight:"80px"},hint:{color:rf.tokens.colorNeutralForeground3,fontSize:rf.tokens.fontSizeBase200}}),ap=e=>{var{isOpen:t,documentName:r,isLoading:n=!1,onConfirm:o,onCancel:a}=e,c=ip(),[l,s]=(0,i.useState)(""),u=(0,i.useRef)(null);(0,i.useEffect)(()=>{if(t&&u.current){var e=setTimeout(()=>{var e;null===(e=u.current)||void 0===e||e.focus()},100);return()=>clearTimeout(e)}},[t]),(0,i.useEffect)(()=>{t&&s("")},[t]);var d=()=>{o(l.trim())};return i.createElement(rf.Dialog,{open:t,onOpenChange:(e,t)=>!t.open&&a()},i.createElement(rf.DialogSurface,null,i.createElement(rf.DialogBody,null,i.createElement(rf.DialogTitle,null,"Check In Document"),i.createElement(rf.DialogContent,{className:c.content},i.createElement("p",null,'You are about to check in "',r,'". This will save your changes and create a new version.'),i.createElement("div",null,i.createElement(rf.Label,{htmlFor:"checkin-comment"},"Version comment (optional)"),i.createElement(rf.Textarea,{ref:u,id:"checkin-comment",className:c.commentField,placeholder:"Describe the changes you made...",value:l,onChange:(e,t)=>s(t.value),onKeyDown:e=>{"Enter"===e.key&&(e.ctrlKey||e.metaKey)&&(e.preventDefault(),d())},disabled:n,resize:"vertical"}),i.createElement("span",{className:c.hint},"Press Ctrl+Enter to submit"))),i.createElement(rf.DialogActions,null,i.createElement(rf.Button,{appearance:"secondary",onClick:a,disabled:n},"Cancel"),i.createElement(rf.Button,{appearance:"primary",onClick:d,disabled:n,icon:n?i.createElement(rf.Spinner,{size:"tiny"}):void 0},n?"Checking in...":"Check In")))))},cp=jf("Warning24Regular","24",["M13 17a1 1 0 1 0-2 0 1 1 0 0 0 2 0Zm-.26-7.85a.75.75 0 0 0-1.5.1l.01 4.5v.1a.75.75 0 0 0 1.5-.1v-4.5l-.01-.1Zm1.23-5.5a2.25 2.25 0 0 0-3.94 0L2.3 17.67A2.25 2.25 0 0 0 4.26 21h15.49c1.71 0 2.8-1.84 1.96-3.34l-7.74-14Zm-2.63.74a.75.75 0 0 1 1.32 0l7.74 14a.75.75 0 0 1-.65 1.11H4.25a.75.75 0 0 1-.65-1.11l7.74-14Z"]),lp=(0,rf.makeStyles)({content:{display:"flex",flexDirection:"column",gap:rf.tokens.spacingVerticalM},warningRow:{display:"flex",alignItems:"flex-start",gap:rf.tokens.spacingHorizontalS,padding:rf.tokens.spacingVerticalS,backgroundColor:rf.tokens.colorPaletteYellowBackground1,borderRadius:rf.tokens.borderRadiusMedium},warningIcon:{color:rf.tokens.colorPaletteYellowForeground2,flexShrink:0,marginTop:"2px"},warningText:{color:rf.tokens.colorNeutralForeground1,fontSize:rf.tokens.fontSizeBase300}}),sp=e=>{var{isOpen:t,documentName:r,isLoading:n=!1,onConfirm:o,onCancel:a}=e,c=lp();return i.createElement(rf.Dialog,{open:t,onOpenChange:(e,t)=>!t.open&&a()},i.createElement(rf.DialogSurface,null,i.createElement(rf.DialogBody,null,i.createElement(rf.DialogTitle,null,"Discard Changes?"),i.createElement(rf.DialogContent,{className:c.content},i.createElement("p",null,'You are about to discard your changes to "',r,'" and release the document lock.'),i.createElement("div",{className:c.warningRow},i.createElement(cp,{className:c.warningIcon}),i.createElement("span",{className:c.warningText},"Any unsaved changes will be permanently lost. This action cannot be undone."))),i.createElement(rf.DialogActions,null,i.createElement(rf.Button,{appearance:"secondary",onClick:a,disabled:n},"Keep Editing"),i.createElement(rf.Button,{appearance:"primary",onClick:o,disabled:n,icon:n?i.createElement(rf.Spinner,{size:"tiny"}):void 0},n?"Discarding...":"Discard Changes")))))},up=r(72),dp=r.n(up),hp=r(825),fp=r.n(hp),pp=r(659),gp=r.n(pp),mp=r(56),vp=r.n(mp),yp=r(540),bp=r.n(yp),wp=r(113),Cp=r.n(wp),kp=r(457),Ip={};Ip.styleTagTransform=Cp(),Ip.setAttributes=vp(),Ip.insert=gp().bind(null,"head"),Ip.domAPI=fp(),Ip.insertStyleElement=bp(),dp()(kp.A,Ip),kp.A&&kp.A.locals&&kp.A.locals;var Sp=function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function a(e){try{l(n.next(e))}catch(e){i(e)}}function c(e){try{l(n.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(a,c)}l((n=n.apply(e,t||[])).next())})},Tp=e=>{var{documentId:t,bffApiUrl:r,accessToken:n,correlationId:o,isDarkTheme:a,enableEdit:c,enableDelete:l,enableDownload:s,onRefresh:u,onDeleted:d}=e,h=(0,i.useRef)(null),f=(0,i.useRef)(new zf(r)),[p,g]=(0,i.useState)(!1),[m,v]=(0,i.useState)(!1),[y,b]=(0,i.useState)(!1),{previewUrl:w,documentInfo:C,checkoutStatus:k,isLoading:I,isIframeLoading:S,isIframeTimedOut:T,error:A,refresh:P,onIframeLoad:E,onIframeError:O,resetIframeState:_}=Wf(t,r,n,o),{viewMode:R,editUrl:x,isCheckoutLoading:M,isCheckInLoading:N,isDiscardLoading:D,error:L,lockError:q,checkout:j,checkIn:U,discard:F,clearError:H,resetToPreview:z,updateCheckoutStatus:B}=function(e){var{documentId:t,bffApiUrl:r,accessToken:n,correlationId:o,onCheckoutSuccess:a,onCheckInSuccess:c,onDiscardSuccess:l}=e,[s,u]=(0,i.useState)(Vf.Preview),[d,h]=(0,i.useState)(null),[f,p]=(0,i.useState)(!1),[g,m]=(0,i.useState)(!1),[v,y]=(0,i.useState)(!1),[b,w]=(0,i.useState)(null),[C,k]=(0,i.useState)(null),I=(0,i.useRef)(new zf(r));I.current.baseUrl!==r.replace(/\/$/,"")&&(I.current=new zf(r));var S=(0,i.useCallback)(()=>Qf(this,void 0,void 0,function*(){if(!t)return w("No document ID provided"),null;p(!0),w(null),k(null),console.log("[useCheckoutFlow] Starting checkout for document:",t);try{var e=yield I.current.checkout(t,n,o);return console.log("[useCheckoutFlow] Checkout successful:",e),h(e.editUrl),u(Vf.Edit),null==a||a(e),e}catch(e){if(console.error("[useCheckoutFlow] Checkout failed:",e),e instanceof Bf){var r=e.lockedError.checkedOutBy;k({lockedByName:r.name,lockedAt:e.lockedError.checkedOutAt}),w("Document is locked by ".concat(r.name))}else e instanceof Error?w(e.message):w("Checkout failed");return null}finally{p(!1)}}),[t,n,o,a]),T=(0,i.useCallback)(e=>Qf(this,void 0,void 0,function*(){if(!t)return w("No document ID provided"),!1;m(!0),u(Vf.Processing),w(null),console.log("[useCheckoutFlow] Starting check-in for document:",t,"comment:",e);try{var r=yield I.current.checkIn(t,n,o,e);return console.log("[useCheckoutFlow] Check-in successful:",r),h(null),u(Vf.Preview),null==c||c(),!0}catch(e){return console.error("[useCheckoutFlow] Check-in failed:",e),u(Vf.Edit),e instanceof Error?w(e.message):w("Check-in failed"),!1}finally{m(!1)}}),[t,n,o,c]),A=(0,i.useCallback)(()=>Qf(this,void 0,void 0,function*(){if(!t)return w("No document ID provided"),!1;y(!0),w(null),console.log("[useCheckoutFlow] Starting discard for document:",t);try{var e=yield I.current.discard(t,n,o);return console.log("[useCheckoutFlow] Discard successful:",e),h(null),u(Vf.Preview),null==l||l(),!0}catch(e){return console.error("[useCheckoutFlow] Discard failed:",e),e instanceof Error?w(e.message):w("Discard failed"),!1}finally{y(!1)}}),[t,n,o,l]),P=(0,i.useCallback)(()=>{w(null),k(null)},[]),E=(0,i.useCallback)(()=>{u(Vf.Preview),h(null),w(null),k(null)},[]),O=(0,i.useCallback)(e=>{s===Vf.Edit&&e&&!e.isCurrentUser&&e.isCheckedOut&&(console.log("[useCheckoutFlow] Checkout lost to another user, reverting to preview"),u(Vf.Preview),h(null))},[s]);return{viewMode:s,editUrl:d,isCheckoutLoading:f,isCheckInLoading:g,isDiscardLoading:v,error:b,lockError:C,checkout:S,checkIn:T,discard:A,clearError:P,resetToPreview:E,updateCheckoutStatus:O}}({documentId:t,bffApiUrl:r,accessToken:n,correlationId:o,onCheckoutSuccess:()=>{console.log("[SpeDocumentViewer] Checkout succeeded")},onCheckInSuccess:()=>{console.log("[SpeDocumentViewer] Check-in succeeded, refreshing preview"),P()},onDiscardSuccess:()=>{console.log("[SpeDocumentViewer] Discard succeeded, refreshing preview"),P()}});(0,i.useEffect)(()=>{B(k)},[k,B]);var K=A||L,V=(0,i.useCallback)(()=>{H(),P(),null==u||u()},[P,u,H]),W=(0,i.useCallback)(()=>{h.current&&w?(_(),h.current.src=w):P()},[w,_,P]),Q=(0,i.useCallback)(()=>{E()},[E]),G=(0,i.useCallback)(()=>{O()},[O]),J=(0,i.useCallback)(()=>Sp(void 0,void 0,void 0,function*(){t&&(yield j())}),[t,j]),Y=(0,i.useCallback)(()=>{g(!0)},[]),$=(0,i.useCallback)(e=>Sp(void 0,void 0,void 0,function*(){(yield U(e))&&g(!1)}),[U]),X=(0,i.useCallback)(()=>{g(!1)},[]),Z=(0,i.useCallback)(()=>{v(!0)},[]),ee=(0,i.useCallback)(()=>Sp(void 0,void 0,void 0,function*(){(yield F())&&v(!1)}),[F]),te=(0,i.useCallback)(()=>{v(!1)},[]),re=(0,i.useCallback)(()=>Sp(void 0,void 0,void 0,function*(){if(t){console.log("[SpeDocumentViewer] Open in desktop clicked");try{var e=yield f.current.getOpenLinks(t,n,o);e.desktopUrl?window.location.href=e.desktopUrl:console.warn("[SpeDocumentViewer] No desktop URL available")}catch(e){console.error("[SpeDocumentViewer] Get open links failed:",e)}}}),[t,n,o]),ne=(0,i.useCallback)(()=>Sp(void 0,void 0,void 0,function*(){if(t){console.log("[SpeDocumentViewer] Download button clicked");try{var e=yield f.current.getOpenLinks(t,n,o);e.webUrl&&window.open(e.webUrl,"_blank","noopener,noreferrer")}catch(e){console.error("[SpeDocumentViewer] Download failed:",e)}}}),[t,n,o]),oe=(0,i.useCallback)(()=>Sp(void 0,void 0,void 0,function*(){if(t){b(!0),console.log("[SpeDocumentViewer] Delete confirmed");try{yield f.current.deleteDocument(t,n,o),console.log("[SpeDocumentViewer] Document deleted successfully"),null==d||d()}catch(e){console.error("[SpeDocumentViewer] Delete failed:",e)}finally{b(!1)}}}),[t,n,o,d]),ie=a?rf.webDarkTheme:rf.webLightTheme;if(I)return i.createElement(rf.FluentProvider,{theme:ie},i.createElement("div",{className:"spe-document-viewer-container","data-theme":a?"dark":"light"},i.createElement("div",{className:"spe-document-viewer-loading"},i.createElement(rf.Spinner,{size:"large",label:"Loading document..."}))));if(K&&!T)return i.createElement(rf.FluentProvider,{theme:ie},i.createElement("div",{className:"spe-document-viewer-container","data-theme":a?"dark":"light"},i.createElement("div",{className:"spe-document-viewer-error"},i.createElement(rf.MessageBar,{intent:"error"},i.createElement(rf.MessageBarBody,null,i.createElement(rf.MessageBarTitle,null,"Error"),K),i.createElement(rf.MessageBarActions,null,i.createElement(rf.Button,{appearance:"transparent",icon:i.createElement(Uf,null),onClick:V},"Retry"))))));if(!t)return i.createElement(rf.FluentProvider,{theme:ie},i.createElement("div",{className:"spe-document-viewer-container","data-theme":a?"dark":"light"},i.createElement("div",{className:"spe-document-viewer-error"},i.createElement(rf.MessageBar,{intent:"warning"},i.createElement(rf.MessageBarBody,null,i.createElement(rf.MessageBarTitle,null,"No Document"),"No document ID provided. Save the form to view the document.")))));var ae="edit"===R?x:w;return i.createElement(rf.FluentProvider,{theme:ie},i.createElement("div",{className:"spe-document-viewer-container","data-theme":a?"dark":"light"},i.createElement(op,{documentInfo:C,checkoutStatus:k,viewMode:R,isDarkTheme:a,enableEdit:c,enableDownload:s,enableDelete:l,isLoading:S,isEditLoading:M,isCheckInLoading:N,isDeleteLoading:y,onRefresh:V,onEdit:J,onDownload:ne,onDelete:oe,onOpenDesktop:re,onCheckIn:Y,onDiscard:Z}),q&&i.createElement("div",{className:"spe-document-viewer-banner"},i.createElement(rf.MessageBar,{intent:"warning",style:{margin:"8px"}},i.createElement(rf.MessageBarBody,null,i.createElement(rf.MessageBarTitle,null,"Document Locked"),"This document is currently being edited by ",q.lockedByName,". You can view but not edit until they release it."),i.createElement(rf.MessageBarActions,null,i.createElement(rf.Button,{appearance:"transparent",icon:i.createElement(Uf,null),onClick:V},"Refresh")))),i.createElement("div",{className:"spe-document-viewer-preview"},T&&i.createElement("div",{className:"spe-document-viewer-iframe-loading"},i.createElement(rf.MessageBar,{intent:"warning",style:{maxWidth:"400px"}},i.createElement(rf.MessageBarBody,null,i.createElement(rf.MessageBarTitle,null,"Preview Timed Out"),"The document preview took too long to load. This may be due to a slow connection or a large file."),i.createElement(rf.MessageBarActions,null,i.createElement(rf.Button,{appearance:"transparent",icon:i.createElement(Uf,null),onClick:W},"Retry")))),S&&!T&&i.createElement("div",{className:"spe-document-viewer-iframe-loading"},i.createElement(rf.Spinner,{size:"medium",label:"edit"===R?"Loading editor...":"Loading preview..."})),ae&&i.createElement("iframe",{ref:h,src:ae,className:"spe-document-viewer-iframe",style:{visibility:S||T?"hidden":"visible"},onLoad:Q,onError:G,title:(null==C?void 0:C.name)||"Document",sandbox:"allow-same-origin allow-scripts allow-forms allow-popups allow-popups-to-escape-sandbox",allow:"autoplay"})),i.createElement("div",{className:"spe-document-viewer-footer"},i.createElement("span",{className:"spe-document-viewer-version"},"v","1.0.4"," - Built ","2025-12-18"))),i.createElement(ap,{isOpen:p,documentName:(null==C?void 0:C.name)||"Document",isLoading:N,onConfirm:$,onCancel:X}),i.createElement(sp,{isOpen:m,documentName:(null==C?void 0:C.name)||"Document",isLoading:D,onConfirm:ee,onCancel:te}))};const Ap={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};for(var Pp,Ep=new Uint8Array(16),Op=[],_p=0;_p<256;++_p)Op.push((_p+256).toString(16).slice(1));function Rp(e,t,r){var n,o,i,a,c=null!==(n=null!==(o=(e=e||{}).random)&&void 0!==o?o:null===(i=(a=e).rng)||void 0===i?void 0:i.call(a))&&void 0!==n?n:function(){if(!Pp){if("undefined"==typeof crypto||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");Pp=crypto.getRandomValues.bind(crypto)}return Pp(Ep)}();if(c.length<16)throw new Error("Random bytes length must be >= 16");if(c[6]=15&c[6]|64,c[8]=63&c[8]|128,t){if((r=r||0)<0||r+16>t.length)throw new RangeError("UUID byte range ".concat(r,":").concat(r+15," is out of buffer bounds"));for(var l=0;l<16;++l)t[r+l]=c[l];return t}return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(Op[e[t+0]]+Op[e[t+1]]+Op[e[t+2]]+Op[e[t+3]]+"-"+Op[e[t+4]]+Op[e[t+5]]+"-"+Op[e[t+6]]+Op[e[t+7]]+"-"+Op[e[t+8]]+Op[e[t+9]]+"-"+Op[e[t+10]]+Op[e[t+11]]+Op[e[t+12]]+Op[e[t+13]]+Op[e[t+14]]+Op[e[t+15]]).toLowerCase()}(c)}var xp="spaarke-theme",Mp="spaarke-theme-change";function Np(){var e=localStorage.getItem(xp);return"light"===e||"dark"===e||"auto"===e?e:"auto"}function Dp(e){var t,r,n,o=Np();if("dark"===o)return!0;if("light"===o)return!1;if(void 0!==(null===(t=null==e?void 0:e.fluentDesignLanguage)||void 0===t?void 0:t.isDarkTheme))return e.fluentDesignLanguage.isDarkTheme;var i=document.querySelector("[data-id='navbar-container']");if(i){var a=getComputedStyle(i).backgroundColor;if("rgb(10, 10, 10)"===a)return!0;if("rgb(240, 240, 240)"===a)return!1}return null!==(n=null===(r=window.matchMedia)||void 0===r?void 0:r.call(window,"(prefers-color-scheme: dark)").matches)&&void 0!==n&&n}class Lp{constructor(){this.root=null,this.authService=null,this.accessToken=null,this.bffApiUrl="",this.clientAppId="",this.bffAppId="",this.tenantId="",this.enableEdit=!0,this.enableDelete=!1,this.enableDownload=!0,this._state=Kf.Loading,this._notifyOutputChanged=null,this._context=null,this._errorMessage=null,this._previousDocumentId=null,this._cleanupThemeListener=null,this.correlationId=function(e,t,r){return!Ap.randomUUID||t||e?Rp(e,t,r):Ap.randomUUID()}(),console.log("[SpeDocumentViewer] Control instance created. Correlation ID: ".concat(this.correlationId))}init(e,t,r,n){return o=this,i=void 0,c=function*(){var r,o,i,a,c,l,s,u;this.container=n,this._notifyOutputChanged=t,this._context=e,this.transitionTo(Kf.Loading),this.renderLoading();var d=null!==(o=null===(r=e.parameters.controlHeight)||void 0===r?void 0:r.raw)&&void 0!==o?o:600;this.container.style.minHeight="".concat(d,"px"),this.container.style.height="100%",this.container.style.display="flex",this.container.style.flexDirection="column",console.log("[SpeDocumentViewer] Initializing control...");try{if(this.tenantId=e.parameters.tenantId.raw||"",this.clientAppId=e.parameters.clientAppId.raw||"",this.bffAppId=e.parameters.bffAppId.raw||"",this.bffApiUrl=e.parameters.bffApiUrl.raw||"https://spe-api-dev-67e2xz.azurewebsites.net",this.enableEdit=null===(a=null===(i=e.parameters.enableEdit)||void 0===i?void 0:i.raw)||void 0===a||a,this.enableDelete=null!==(l=null===(c=e.parameters.enableDelete)||void 0===c?void 0:c.raw)&&void 0!==l&&l,this.enableDownload=null===(u=null===(s=e.parameters.enableDownload)||void 0===s?void 0:s.raw)||void 0===u||u,!this.tenantId||!this.clientAppId||!this.bffAppId)throw new Error("Missing required configuration: tenantId, clientAppId, and bffAppId must be provided");console.log("[SpeDocumentViewer] Configuration:",{tenantId:this.tenantId,clientAppId:this.clientAppId,bffAppId:this.bffAppId,bffApiUrl:this.bffApiUrl,enableEdit:this.enableEdit,enableDelete:this.enableDelete,enableDownload:this.enableDownload}),this.authService=new tf(this.tenantId,this.clientAppId,this.bffAppId),yield this.authService.initialize(),console.log("[SpeDocumentViewer] MSAL initialized. Scope: ".concat(this.authService.getScope())),this.accessToken=yield this.authService.getAccessToken(),console.log("[SpeDocumentViewer] Access token acquired");try{this._previousDocumentId=this.extractDocumentId(e)}catch(e){this._previousDocumentId=null}this._cleanupThemeListener=function(e,t){var r,n=r=>{r.key===xp&&e(Dp(t))},o=()=>{e(Dp(t))},i=t=>{"auto"===Np()&&e(t.matches)};window.addEventListener("storage",n),window.addEventListener(Mp,o);var a=null===(r=window.matchMedia)||void 0===r?void 0:r.call(window,"(prefers-color-scheme: dark)");return null==a||a.addEventListener("change",i),()=>{window.removeEventListener("storage",n),window.removeEventListener(Mp,o),null==a||a.removeEventListener("change",i)}}(e=>{console.log("[SpeDocumentViewer] Theme changed: isDark=".concat(e)),this._context&&this._state===Kf.Ready&&this.renderControl(this._context)},e),this.transitionTo(Kf.Ready),this.renderControl(e)}catch(e){console.error("[SpeDocumentViewer] Initialization failed:",e),this._errorMessage=e instanceof Error?e.message:String(e),this.transitionTo(Kf.Error),this.renderError(this._errorMessage)}},new((a=void 0)||(a=Promise))(function(e,t){function r(e){try{l(c.next(e))}catch(e){t(e)}}function n(e){try{l(c.throw(e))}catch(e){t(e)}}function l(t){var o;t.done?e(t.value):(o=t.value,o instanceof a?o:new a(function(e){e(o)})).then(r,n)}l((c=c.apply(o,i||[])).next())});var o,i,a,c}updateView(e){var t,r,n,o,i,a;if(this._context=e,this._state===Kf.Ready){this.enableEdit=null===(r=null===(t=e.parameters.enableEdit)||void 0===t?void 0:t.raw)||void 0===r||r,this.enableDelete=null!==(o=null===(n=e.parameters.enableDelete)||void 0===n?void 0:n.raw)&&void 0!==o&&o,this.enableDownload=null===(a=null===(i=e.parameters.enableDownload)||void 0===i?void 0:i.raw)||void 0===a||a;var c=null;try{c=this.extractDocumentId(e)}catch(e){c=null}c!==this._previousDocumentId&&(console.log("[SpeDocumentViewer] Document ID changed: ".concat(this._previousDocumentId," -> ").concat(c)),this._previousDocumentId=c),this.renderControl(e)}}transitionTo(e){var t,r=this._state;this._state=e,console.log("[SpeDocumentViewer] State: ".concat(r," -> ").concat(e)),null===(t=this._notifyOutputChanged)||void 0===t||t.call(this)}extractDocumentId(e){var t,r=e.parameters.documentId.raw;if(r&&"string"==typeof r&&""!==r.trim()){var n=r.trim();if(!this.isValidGuid(n))throw new Error("Document ID must be a GUID format.");return n}var o=null===(t=e.mode.contextInfo)||void 0===t?void 0:t.entityId;if(o&&"string"==typeof o){if(!this.isValidGuid(o))throw new Error("Form context did not provide a valid GUID.");return o}return""}isValidGuid(e){return/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/.test(e)}renderLoading(){var e=document.createElement("div");e.className="spe-document-viewer-loading-overlay",e.setAttribute("role","status"),e.setAttribute("aria-busy","true");var t=document.createElement("div");t.className="spe-document-viewer-loading-spinner";var r=document.createElement("span");r.className="spe-document-viewer-loading-text",r.textContent="Loading document viewer...",e.appendChild(t),e.appendChild(r),this.container.innerHTML="",this.container.appendChild(e)}renderControl(e){var t=this.extractDocumentId(e);if(this.accessToken){var r=Dp(e);console.log("[SpeDocumentViewer] Rendering for document: ".concat(t||"(none)")),this.root||(this.root=(0,a.H)(this.container)),this.root.render(i.createElement(Tp,{documentId:t,bffApiUrl:this.bffApiUrl,accessToken:this.accessToken,correlationId:this.correlationId,isDarkTheme:r,enableEdit:this.enableEdit,enableDelete:this.enableDelete,enableDownload:this.enableDownload,onRefresh:()=>{console.log("[SpeDocumentViewer] Refresh requested")},onDeleted:()=>{console.log("[SpeDocumentViewer] Document deleted")}}))}else console.warn("[SpeDocumentViewer] No access token available")}renderError(e){this.container.innerHTML='\n            <div style="padding: 20px; border: 2px solid #d32f2f; background-color: #ffebee; color: #c62828; border-radius: 4px;">\n                <strong>SpeDocumentViewer Error</strong>\n                <p>'.concat(this.escapeHtml(e),"</p>\n                <p><small>Correlation ID: ").concat(this.correlationId,"</small></p>\n            </div>\n        ")}escapeHtml(e){var t=document.createElement("div");return t.textContent=e,t.innerHTML}getOutputs(){return{}}destroy(){console.log("[SpeDocumentViewer] Destroying control..."),this._cleanupThemeListener&&(this._cleanupThemeListener(),this._cleanupThemeListener=null),this.root&&(this.root.unmount(),this.root=null),this.accessToken=null,this.authService=null}}pcf_tools_652ac3f36e1e4bca82eb3c1dc44e6fad=n})();
if (window.ComponentFramework && window.ComponentFramework.registerControl) {
	ComponentFramework.registerControl('Spaarke.SpeDocumentViewer', pcf_tools_652ac3f36e1e4bca82eb3c1dc44e6fad.SpeDocumentViewer);
} else {
	var Spaarke = Spaarke || {};
	Spaarke.SpeDocumentViewer = pcf_tools_652ac3f36e1e4bca82eb3c1dc44e6fad.SpeDocumentViewer;
	pcf_tools_652ac3f36e1e4bca82eb3c1dc44e6fad = undefined;
}