<?xml version="1.0" encoding="utf-8" ?>
<manifest>
  <control namespace="Spaarke" constructor="SpeDocumentViewer" version="1.0.10" display-name-key="SpeDocumentViewer" description-key="SpeDocumentViewer_Desc" control-type="standard">
    <external-service-usage enabled="false">
    </external-service-usage>

    <!-- REQUIRED: At least one bound property for field control discoverability -->
    <property name="value"
              display-name-key="Value_Display_Key"
              description-key="Value_Desc_Key"
              of-type="SingleLine.Text"
              usage="bound"
              required="true" />

    <!-- Document ID (optional - defaults to form record ID) -->
    <property name="documentId"
              display-name-key="DocumentId_Display_Key"
              description-key="Document ID (GUID). If empty, uses form record ID."
              of-type="SingleLine.Text"
              usage="input"
              required="false" />

    <!-- BFF API Configuration -->
    <property name="bffApiUrl"
              display-name-key="BffApiUrl_Display_Key"
              description-key="BFF API base URL"
              of-type="SingleLine.Text"
              usage="input"
              required="false"
              default-value="https://spe-api-dev-67e2xz.azurewebsites.net" />

    <property name="clientAppId"
              display-name-key="ClientAppId_Display_Key"
              description-key="PCF Client Application ID for MSAL"
              of-type="SingleLine.Text"
              usage="input"
              required="true" />

    <property name="bffAppId"
              display-name-key="BffAppId_Display_Key"
              description-key="BFF Application ID for scope construction"
              of-type="SingleLine.Text"
              usage="input"
              required="true" />

    <property name="tenantId"
              display-name-key="TenantId_Display_Key"
              description-key="Azure AD Tenant ID"
              of-type="SingleLine.Text"
              usage="input"
              required="true" />

    <!-- Feature Flags -->
    <property name="enableEdit"
              display-name-key="EnableEdit_Display_Key"
              description-key="Enable check-out/check-in editing workflow"
              of-type="TwoOptions"
              usage="input"
              required="false"
              default-value="true" />

    <property name="enableDelete"
              display-name-key="EnableDelete_Display_Key"
              description-key="Enable delete document button"
              of-type="TwoOptions"
              usage="input"
              required="false"
              default-value="false" />

    <property name="enableDownload"
              display-name-key="EnableDownload_Display_Key"
              description-key="Enable download document button"
              of-type="TwoOptions"
              usage="input"
              required="false"
              default-value="true" />

    <!-- UI Configuration -->
    <property name="controlHeight"
              display-name-key="ControlHeight_Display_Key"
              description-key="Minimum height in pixels (responsive)"
              of-type="Whole.None"
              usage="input"
              required="false"
              default-value="600" />

    <resources>
      <code path="index.ts" order="1"/>
      <css path="css/SpeDocumentViewer.css" order="1" />
      <resx path="strings/SpeDocumentViewer.1033.resx" version="1.0.0" />
      <!-- Host-provided libraries: DO NOT bundle React/Fluent -->
      <platform-library name="React" version="16.14.0" />
      <platform-library name="Fluent" version="9.46.2" />
    </resources>

    <feature-usage>
      <uses-feature name="WebAPI" required="true" />
      <uses-feature name="Utility" required="true" />
    </feature-usage>
  </control>
</manifest>
