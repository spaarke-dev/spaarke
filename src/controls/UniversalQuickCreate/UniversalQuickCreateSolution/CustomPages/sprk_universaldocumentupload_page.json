{
  "$schema": "https://schema.powerapps.com/custompages/v1.0/schema.json",
  "name": "sprk_universaldocumentupload_page",
  "displayName": "Universal Document Upload",
  "description": "Upload multiple documents to SharePoint Embedded - Universal entity support",
  "type": "ModelDrivenApp",
  "customPageType": "Dialog",
  "parameters": [
    {
      "name": "parentEntityName",
      "displayName": "Parent Entity Name",
      "dataType": "String",
      "required": true,
      "description": "Logical name of parent entity (e.g., sprk_matter, account, contact)"
    },
    {
      "name": "parentRecordId",
      "displayName": "Parent Record ID",
      "dataType": "String",
      "required": true,
      "description": "GUID of parent record (without curly braces)"
    },
    {
      "name": "containerId",
      "displayName": "Container ID",
      "dataType": "String",
      "required": true,
      "description": "SharePoint Embedded Container ID for file uploads"
    },
    {
      "name": "parentDisplayName",
      "displayName": "Parent Display Name",
      "dataType": "String",
      "required": false,
      "description": "Display name of parent record (e.g., 'Matter #12345')"
    }
  ],
  "pages": [
    {
      "id": "mainPage",
      "displayName": "Document Upload",
      "layout": {
        "type": "Stack",
        "direction": "Vertical",
        "width": "100%",
        "height": "100%"
      },
      "controls": [
        {
          "id": "universalDocumentUploadControl",
          "type": "pcfcontrol",
          "controlName": "Spaarke.Controls.UniversalDocumentUpload",
          "position": {
            "row": 0,
            "column": 0,
            "rowSpan": 1,
            "columnSpan": 1
          },
          "properties": {
            "parentEntityName": {
              "expr": "Parameters.parentEntityName"
            },
            "parentRecordId": {
              "expr": "Parameters.parentRecordId"
            },
            "containerId": {
              "expr": "Parameters.containerId"
            },
            "parentDisplayName": {
              "expr": "Parameters.parentDisplayName"
            },
            "sdapApiBaseUrl": {
              "value": "spe-api-dev-67e2xz.azurewebsites.net/api"
            }
          }
        }
      ]
    }
  ],
  "style": {
    "backgroundColor": "#FFFFFF",
    "fontFamily": "Segoe UI, sans-serif"
  }
}
