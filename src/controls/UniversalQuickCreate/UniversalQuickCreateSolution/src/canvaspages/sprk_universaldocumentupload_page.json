{
  "$schema": "https://schema.powerapps.com/custompages/v1.0/schema.json",
  "name": "sprk_documentuploaddialog_e52db",
  "displayName": "Universal Document Upload v3.0.4 - Exit Fix",
  "description": "Upload multiple documents to SharePoint Embedded - Universal entity support - Exit() on shouldClose",
  "type": "ModelDrivenApp",
  "customPageType": "Dialog",
  "pages": [
    {
      "id": "mainPage",
      "displayName": "Document Upload",
      "layout": {
        "type": "Stack",
        "direction": "Vertical",
        "width": "100%",
        "height": "100%"
      },
      "events": {
        "onVisible": {
          "formula": "If(Not(varInit), Set(varInit, true); Set(_raw, Param(\"data\")); If(Not(IsBlank(_raw)), Set(varParentEntityName, _raw.parentEntityName); Set(varParentRecordId, _raw.parentRecordId); Set(varContainerId, _raw.containerId); Set(varParentDisplayName, _raw.parentDisplayName)))"
        }
      },
      "controls": [
        {
          "id": "universalDocumentUploadControl",
          "type": "pcfcontrol",
          "controlName": "Spaarke.Controls.UniversalDocumentUpload",
          "position": {
            "row": 0,
            "column": 0,
            "rowSpan": 1,
            "columnSpan": 1
          },
          "properties": {
            "Visible": {
              "expr": "true"
            },
            "parentEntityName": {
              "expr": "varParentEntityName"
            },
            "parentRecordId": {
              "expr": "varParentRecordId"
            },
            "containerId": {
              "expr": "varContainerId"
            },
            "parentDisplayName": {
              "expr": "varParentDisplayName"
            },
            "sdapApiBaseUrl": {
              "value": "https://spe-api-dev-67e2xz.azurewebsites.net/api"
            }
          },
          "events": {
            "onChange": {
              "formula": "If(universalDocumentUploadControl.shouldClose, Exit())"
            }
          }
        }
      ]
    }
  ],
  "style": {
    "backgroundColor": "#FFFFFF",
    "fontFamily": "Segoe UI, sans-serif"
  }
}
