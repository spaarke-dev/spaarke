<Events><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1032</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-17T13:46:57Z"/><EventRecordID>1196293718</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Application 'C:\home\site\wwwroot\' started successfully.</Data><Data>Process Id: 6516.</Data><Data>File Version: 18.0.25232.20. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-17T13:47:12Z"/><EventRecordID>1196309062</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Spe.Bff.Api.Infrastructure.Graph.UploadSessionManager
EventId: 0
SpanId: 77a8a8f48a9bec7c
TraceId: f6b9064102fe1b56181b0c07b8eb5261
ParentId: 0000000000000000
RequestId: 40002ace-0000-db00-b63f-84710c7967bb
RequestPath: /api/obo/containers/b!21yLRdWEOAdkaWXskuRfByIRiz1S9kb_xPveFbearu6y9k1_PqePezTIDObGJTYq50/files/B%20MRT.P0046WO01_WO2025024521-DECLA-20250130-5048.pdf

Failed to upload to path B MRT.P0046WO01_WO2025024521-DECLA-20250130-5048.pdf in container b!21yLRdWEOAdkaWXskuRfByIRiz1S9kb_xPveFbearu6y9k1_PqePezTIDObGJTYq50

Exception: 
Microsoft.Graph.Models.ODataErrors.ODataError: Item not found
   at Microsoft.Kiota.Http.HttpClientLibrary.HttpClientRequestAdapter.ThrowIfFailedResponseAsync(HttpResponseMessage response, Dictionary`2 errorMapping, Activity activityForAttributes, CancellationToken cancellationToken)
   at Microsoft.Kiota.Http.HttpClientLibrary.HttpClientRequestAdapter.SendAsync[ModelType](RequestInformation requestInfo, ParsableFactory`1 factory, Dictionary`2 errorMapping, CancellationToken cancellationToken)
   at Microsoft.Kiota.Http.HttpClientLibrary.HttpClientRequestAdapter.SendAsync[ModelType](RequestInformation requestInfo, ParsableFactory`1 factory, Dictionary`2 errorMapping, CancellationToken cancellationToken)
   at Microsoft.Graph.Storage.FileStorage.Containers.Item.Drive.DriveRequestBuilder.GetAsync(Action`1 requestConfiguration, CancellationToken cancellationToken)
   at Spe.Bff.Api.Infrastructure.Graph.UploadSessionManager.UploadSmallAsUserAsync(String userToken, String containerId, String path, Stream content, CancellationToken ct) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Infrastructure\Graph\UploadSessionManager.cs:line 241
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-17T13:47:13Z"/><EventRecordID>1196309156</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Program
EventId: 0
SpanId: 77a8a8f48a9bec7c
TraceId: f6b9064102fe1b56181b0c07b8eb5261
ParentId: 0000000000000000
RequestId: 40002ace-0000-db00-b63f-84710c7967bb
RequestPath: /api/obo/containers/b!21yLRdWEOAdkaWXskuRfByIRiz1S9kb_xPveFbearu6y9k1_PqePezTIDObGJTYq50/files/B%20MRT.P0046WO01_WO2025024521-DECLA-20250130-5048.pdf

OBO upload failed - Unexpected error: Item not found

Exception: 
Microsoft.Graph.Models.ODataErrors.ODataError: Item not found
   at Microsoft.Kiota.Http.HttpClientLibrary.HttpClientRequestAdapter.ThrowIfFailedResponseAsync(HttpResponseMessage response, Dictionary`2 errorMapping, Activity activityForAttributes, CancellationToken cancellationToken)
   at Microsoft.Kiota.Http.HttpClientLibrary.HttpClientRequestAdapter.SendAsync[ModelType](RequestInformation requestInfo, ParsableFactory`1 factory, Dictionary`2 errorMapping, CancellationToken cancellationToken)
   at Microsoft.Kiota.Http.HttpClientLibrary.HttpClientRequestAdapter.SendAsync[ModelType](RequestInformation requestInfo, ParsableFactory`1 factory, Dictionary`2 errorMapping, CancellationToken cancellationToken)
   at Microsoft.Graph.Storage.FileStorage.Containers.Item.Drive.DriveRequestBuilder.GetAsync(Action`1 requestConfiguration, CancellationToken cancellationToken)
   at Spe.Bff.Api.Infrastructure.Graph.UploadSessionManager.UploadSmallAsUserAsync(String userToken, String containerId, String path, Stream content, CancellationToken ct) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Infrastructure\Graph\UploadSessionManager.cs:line 241
   at Spe.Bff.Api.Api.OBOEndpoints.&lt;&gt;c.&lt;&lt;MapOBOEndpoints&gt;b__0_1&gt;d.MoveNext() in C:\code_files\spaarke\src\api\Spe.Bff.Api\Api\OBOEndpoints.cs:line 68
</Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1012</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-17T14:08:15Z"/><EventRecordID>1197571250</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Application 'C:\home\site\wwwroot\' was recycled after detecting app_offline.htm.</Data><Data>Process Id: 6516.</Data><Data>File Version: 18.0.25232.20. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-17T14:08:16Z"/><EventRecordID>1197572937</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 9

BackgroundService failed

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\ServiceBusJobProcessor.cs:line 72
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-17T14:08:16Z"/><EventRecordID>1197573015</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 10

The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\ServiceBusJobProcessor.cs:line 72
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-17T14:08:19Z"/><EventRecordID>1197575453</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 9

BackgroundService failed

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.DocumentEventProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\DocumentEventProcessor.cs:line 68
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-17T14:08:19Z"/><EventRecordID>1197575484</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 10

The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.DocumentEventProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\DocumentEventProcessor.cs:line 68
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1033</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-17T14:08:23Z"/><EventRecordID>1197579718</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Application 'MACHINE/WEBROOT/APPHOST/SPE-API-DEV-67E2XZ' has shutdown.</Data><Data>Process Id: 6516.</Data><Data>File Version: 18.0.25232.20. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1032</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-17T14:13:51Z"/><EventRecordID>1197907656</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Application 'C:\home\site\wwwroot\' started successfully.</Data><Data>Process Id: 6652.</Data><Data>File Version: 18.0.25232.20. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-17T14:14:08Z"/><EventRecordID>1197924656</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Spe.Bff.Api.Infrastructure.Graph.UploadSessionManager
EventId: 0
SpanId: 906dca10e0c6fb29
TraceId: a94f6f7ca1d3205c3d043c931e03053e
ParentId: 0000000000000000
RequestId: 40000f78-0000-eb00-b63f-84710c7967bb
RequestPath: /api/obo/containers/b!21yLRdWEOAdkaWXskuRfByIRiz1S9kb_xPveFbearu6y9k1_PqePezTIDObGJTYq50/files/1%20MRT.P0043WO01_US2024029650-IASR.pdf

Failed to upload to path 1 MRT.P0043WO01_US2024029650-IASR.pdf in container b!21yLRdWEOAdkaWXskuRfByIRiz1S9kb_xPveFbearu6y9k1_PqePezTIDObGJTYq50

Exception: 
Microsoft.Graph.Models.ODataErrors.ODataError: Item not found
   at Microsoft.Kiota.Http.HttpClientLibrary.HttpClientRequestAdapter.ThrowIfFailedResponseAsync(HttpResponseMessage response, Dictionary`2 errorMapping, Activity activityForAttributes, CancellationToken cancellationToken)
   at Microsoft.Kiota.Http.HttpClientLibrary.HttpClientRequestAdapter.SendAsync[ModelType](RequestInformation requestInfo, ParsableFactory`1 factory, Dictionary`2 errorMapping, CancellationToken cancellationToken)
   at Microsoft.Kiota.Http.HttpClientLibrary.HttpClientRequestAdapter.SendAsync[ModelType](RequestInformation requestInfo, ParsableFactory`1 factory, Dictionary`2 errorMapping, CancellationToken cancellationToken)
   at Microsoft.Graph.Drives.Item.Items.Item.Content.ContentRequestBuilder.PutAsync(Stream body, Action`1 requestConfiguration, CancellationToken cancellationToken)
   at Spe.Bff.Api.Infrastructure.Graph.UploadSessionManager.UploadSmallAsUserAsync(String userToken, String containerId, String path, Stream content, CancellationToken ct) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Infrastructure\Graph\UploadSessionManager.cs:line 254
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-17T14:14:08Z"/><EventRecordID>1197924734</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Program
EventId: 0
SpanId: 906dca10e0c6fb29
TraceId: a94f6f7ca1d3205c3d043c931e03053e
ParentId: 0000000000000000
RequestId: 40000f78-0000-eb00-b63f-84710c7967bb
RequestPath: /api/obo/containers/b!21yLRdWEOAdkaWXskuRfByIRiz1S9kb_xPveFbearu6y9k1_PqePezTIDObGJTYq50/files/1%20MRT.P0043WO01_US2024029650-IASR.pdf

OBO upload failed - Unexpected error: Item not found

Exception: 
Microsoft.Graph.Models.ODataErrors.ODataError: Item not found
   at Microsoft.Kiota.Http.HttpClientLibrary.HttpClientRequestAdapter.ThrowIfFailedResponseAsync(HttpResponseMessage response, Dictionary`2 errorMapping, Activity activityForAttributes, CancellationToken cancellationToken)
   at Microsoft.Kiota.Http.HttpClientLibrary.HttpClientRequestAdapter.SendAsync[ModelType](RequestInformation requestInfo, ParsableFactory`1 factory, Dictionary`2 errorMapping, CancellationToken cancellationToken)
   at Microsoft.Kiota.Http.HttpClientLibrary.HttpClientRequestAdapter.SendAsync[ModelType](RequestInformation requestInfo, ParsableFactory`1 factory, Dictionary`2 errorMapping, CancellationToken cancellationToken)
   at Microsoft.Graph.Drives.Item.Items.Item.Content.ContentRequestBuilder.PutAsync(Stream body, Action`1 requestConfiguration, CancellationToken cancellationToken)
   at Spe.Bff.Api.Infrastructure.Graph.UploadSessionManager.UploadSmallAsUserAsync(String userToken, String containerId, String path, Stream content, CancellationToken ct) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Infrastructure\Graph\UploadSessionManager.cs:line 254
   at Spe.Bff.Api.Api.OBOEndpoints.&lt;&gt;c.&lt;&lt;MapOBOEndpoints&gt;b__0_1&gt;d.MoveNext() in C:\code_files\spaarke\src\api\Spe.Bff.Api\Api\OBOEndpoints.cs:line 68
</Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1012</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-17T14:26:19Z"/><EventRecordID>1198655765</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Application 'C:\home\site\wwwroot\' was recycled after detecting app_offline.htm.</Data><Data>Process Id: 6652.</Data><Data>File Version: 18.0.25232.20. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-17T14:26:21Z"/><EventRecordID>1198657796</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 9

BackgroundService failed

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\ServiceBusJobProcessor.cs:line 72
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-17T14:26:21Z"/><EventRecordID>1198658000</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 10

The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\ServiceBusJobProcessor.cs:line 72
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-17T14:26:24Z"/><EventRecordID>1198660328</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 9

BackgroundService failed

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.DocumentEventProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\DocumentEventProcessor.cs:line 68
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-17T14:26:24Z"/><EventRecordID>1198660375</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 10

The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.DocumentEventProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\DocumentEventProcessor.cs:line 68
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1005</EventID><Level>2</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-17T14:26:30Z"/><EventRecordID>1198666718</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Failed to gracefully shutdown application 'MACHINE/WEBROOT/APPHOST/SPE-API-DEV-67E2XZ'.</Data><Data>Process Id: 6652.</Data><Data>File Version: 18.0.25232.20. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1032</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-17T14:38:46Z"/><EventRecordID>1199403078</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Application 'C:\home\site\wwwroot\' started successfully.</Data><Data>Process Id: 5228.</Data><Data>File Version: 18.0.25232.20. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-17T14:38:58Z"/><EventRecordID>1199414250</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Spe.Bff.Api.Infrastructure.Graph.UploadSessionManager
EventId: 0
SpanId: 6b854a2561ed8bb2
TraceId: 9d5642151a707aab0bab95c83a4fe1bd
ParentId: 0000000000000000
RequestId: 400030be-0000-fe00-b63f-84710c7967bb
RequestPath: /api/obo/containers/b!21yLRdWEOAdkaWXskuRfByIRiz1S9kb_xPveFbearu6y9k1_PqePezTIDObGJTYq50/files/1%20MRT.P0043WO01_US2024029650-IASR.pdf

Failed to upload to path 1 MRT.P0043WO01_US2024029650-IASR.pdf in container b!21yLRdWEOAdkaWXskuRfByIRiz1S9kb_xPveFbearu6y9k1_PqePezTIDObGJTYq50

Exception: 
Microsoft.Graph.Models.ODataErrors.ODataError: Item not found
   at Microsoft.Kiota.Http.HttpClientLibrary.HttpClientRequestAdapter.ThrowIfFailedResponseAsync(HttpResponseMessage response, Dictionary`2 errorMapping, Activity activityForAttributes, CancellationToken cancellationToken)
   at Microsoft.Kiota.Http.HttpClientLibrary.HttpClientRequestAdapter.SendAsync[ModelType](RequestInformation requestInfo, ParsableFactory`1 factory, Dictionary`2 errorMapping, CancellationToken cancellationToken)
   at Microsoft.Kiota.Http.HttpClientLibrary.HttpClientRequestAdapter.SendAsync[ModelType](RequestInformation requestInfo, ParsableFactory`1 factory, Dictionary`2 errorMapping, CancellationToken cancellationToken)
   at Microsoft.Graph.Drives.Item.Items.Item.Content.ContentRequestBuilder.PutAsync(Stream body, Action`1 requestConfiguration, CancellationToken cancellationToken)
   at Spe.Bff.Api.Infrastructure.Graph.UploadSessionManager.UploadSmallAsUserAsync(String userToken, String containerId, String path, Stream content, CancellationToken ct) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Infrastructure\Graph\UploadSessionManager.cs:line 254
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-17T14:38:58Z"/><EventRecordID>1199414328</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Program
EventId: 0
SpanId: 6b854a2561ed8bb2
TraceId: 9d5642151a707aab0bab95c83a4fe1bd
ParentId: 0000000000000000
RequestId: 400030be-0000-fe00-b63f-84710c7967bb
RequestPath: /api/obo/containers/b!21yLRdWEOAdkaWXskuRfByIRiz1S9kb_xPveFbearu6y9k1_PqePezTIDObGJTYq50/files/1%20MRT.P0043WO01_US2024029650-IASR.pdf

OBO upload failed - Unexpected error: Item not found

Exception: 
Microsoft.Graph.Models.ODataErrors.ODataError: Item not found
   at Microsoft.Kiota.Http.HttpClientLibrary.HttpClientRequestAdapter.ThrowIfFailedResponseAsync(HttpResponseMessage response, Dictionary`2 errorMapping, Activity activityForAttributes, CancellationToken cancellationToken)
   at Microsoft.Kiota.Http.HttpClientLibrary.HttpClientRequestAdapter.SendAsync[ModelType](RequestInformation requestInfo, ParsableFactory`1 factory, Dictionary`2 errorMapping, CancellationToken cancellationToken)
   at Microsoft.Kiota.Http.HttpClientLibrary.HttpClientRequestAdapter.SendAsync[ModelType](RequestInformation requestInfo, ParsableFactory`1 factory, Dictionary`2 errorMapping, CancellationToken cancellationToken)
   at Microsoft.Graph.Drives.Item.Items.Item.Content.ContentRequestBuilder.PutAsync(Stream body, Action`1 requestConfiguration, CancellationToken cancellationToken)
   at Spe.Bff.Api.Infrastructure.Graph.UploadSessionManager.UploadSmallAsUserAsync(String userToken, String containerId, String path, Stream content, CancellationToken ct) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Infrastructure\Graph\UploadSessionManager.cs:line 254
   at Spe.Bff.Api.Api.OBOEndpoints.&lt;&gt;c.&lt;&lt;MapOBOEndpoints&gt;b__0_1&gt;d.MoveNext() in C:\code_files\spaarke\src\api\Spe.Bff.Api\Api\OBOEndpoints.cs:line 68
</Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1012</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-17T15:03:40Z"/><EventRecordID>1200897046</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Application 'C:\home\site\wwwroot\' was recycled after detecting app_offline.htm.</Data><Data>Process Id: 5228.</Data><Data>File Version: 18.0.25232.20. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-17T15:03:44Z"/><EventRecordID>1200900406</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 9

BackgroundService failed

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\ServiceBusJobProcessor.cs:line 72
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-17T15:03:44Z"/><EventRecordID>1200900718</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 10

The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\ServiceBusJobProcessor.cs:line 72
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-17T15:03:47Z"/><EventRecordID>1200904031</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 9

BackgroundService failed

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.DocumentEventProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\DocumentEventProcessor.cs:line 68
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-17T15:03:47Z"/><EventRecordID>1200904062</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 10

The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.DocumentEventProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\DocumentEventProcessor.cs:line 68
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1005</EventID><Level>2</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-17T15:03:52Z"/><EventRecordID>1200908250</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Failed to gracefully shutdown application 'MACHINE/WEBROOT/APPHOST/SPE-API-DEV-67E2XZ'.</Data><Data>Process Id: 5228.</Data><Data>File Version: 18.0.25232.20. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1032</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-17T15:07:22Z"/><EventRecordID>1201118640</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Application 'C:\home\site\wwwroot\' started successfully.</Data><Data>Process Id: 7224.</Data><Data>File Version: 18.0.25232.20. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-17T15:07:38Z"/><EventRecordID>1201134171</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Spe.Bff.Api.Infrastructure.Graph.UploadSessionManager
EventId: 0
SpanId: 0c316573a45dbc6a
TraceId: b2b3e19a19ab1b9b497f324801a1c913
ParentId: 0000000000000000
RequestId: 40003a0b-0000-c100-b63f-84710c7967bb
RequestPath: /api/obo/containers/b!21yLRdWEOAdkaWXskuRfByIRiz1S9kb_xPveFbearu6y9k1_PqePezTIDObGJTYq50/files/1%20MRT.P0043WO01_US2024029650-IASR.pdf

Failed to upload to path 1 MRT.P0043WO01_US2024029650-IASR.pdf in container b!21yLRdWEOAdkaWXskuRfByIRiz1S9kb_xPveFbearu6y9k1_PqePezTIDObGJTYq50

Exception: 
Microsoft.Graph.Models.ODataErrors.ODataError: Item not found
   at Microsoft.Kiota.Http.HttpClientLibrary.HttpClientRequestAdapter.ThrowIfFailedResponseAsync(HttpResponseMessage response, Dictionary`2 errorMapping, Activity activityForAttributes, CancellationToken cancellationToken)
   at Microsoft.Kiota.Http.HttpClientLibrary.HttpClientRequestAdapter.SendAsync[ModelType](RequestInformation requestInfo, ParsableFactory`1 factory, Dictionary`2 errorMapping, CancellationToken cancellationToken)
   at Microsoft.Kiota.Http.HttpClientLibrary.HttpClientRequestAdapter.SendAsync[ModelType](RequestInformation requestInfo, ParsableFactory`1 factory, Dictionary`2 errorMapping, CancellationToken cancellationToken)
   at Microsoft.Graph.Storage.FileStorage.Containers.Item.Drive.DriveRequestBuilder.GetAsync(Action`1 requestConfiguration, CancellationToken cancellationToken)
   at Spe.Bff.Api.Infrastructure.Graph.UploadSessionManager.UploadSmallAsUserAsync(String userToken, String containerId, String path, Stream content, CancellationToken ct) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Infrastructure\Graph\UploadSessionManager.cs:line 241
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-17T15:07:38Z"/><EventRecordID>1201134265</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Program
EventId: 0
SpanId: 0c316573a45dbc6a
TraceId: b2b3e19a19ab1b9b497f324801a1c913
ParentId: 0000000000000000
RequestId: 40003a0b-0000-c100-b63f-84710c7967bb
RequestPath: /api/obo/containers/b!21yLRdWEOAdkaWXskuRfByIRiz1S9kb_xPveFbearu6y9k1_PqePezTIDObGJTYq50/files/1%20MRT.P0043WO01_US2024029650-IASR.pdf

OBO upload failed - Unexpected error: Item not found

Exception: 
Microsoft.Graph.Models.ODataErrors.ODataError: Item not found
   at Microsoft.Kiota.Http.HttpClientLibrary.HttpClientRequestAdapter.ThrowIfFailedResponseAsync(HttpResponseMessage response, Dictionary`2 errorMapping, Activity activityForAttributes, CancellationToken cancellationToken)
   at Microsoft.Kiota.Http.HttpClientLibrary.HttpClientRequestAdapter.SendAsync[ModelType](RequestInformation requestInfo, ParsableFactory`1 factory, Dictionary`2 errorMapping, CancellationToken cancellationToken)
   at Microsoft.Kiota.Http.HttpClientLibrary.HttpClientRequestAdapter.SendAsync[ModelType](RequestInformation requestInfo, ParsableFactory`1 factory, Dictionary`2 errorMapping, CancellationToken cancellationToken)
   at Microsoft.Graph.Storage.FileStorage.Containers.Item.Drive.DriveRequestBuilder.GetAsync(Action`1 requestConfiguration, CancellationToken cancellationToken)
   at Spe.Bff.Api.Infrastructure.Graph.UploadSessionManager.UploadSmallAsUserAsync(String userToken, String containerId, String path, Stream content, CancellationToken ct) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Infrastructure\Graph\UploadSessionManager.cs:line 241
   at Spe.Bff.Api.Api.OBOEndpoints.&lt;&gt;c.&lt;&lt;MapOBOEndpoints&gt;b__0_1&gt;d.MoveNext() in C:\code_files\spaarke\src\api\Spe.Bff.Api\Api\OBOEndpoints.cs:line 68
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-17T20:32:01Z"/><EventRecordID>1220597812</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Spe.Bff.Api.Infrastructure.Graph.UploadSessionManager
EventId: 0
SpanId: 3894a9bc5a35a80e
TraceId: 1bba32d0ba303ba0ff353d02130ce3f1
ParentId: 0000000000000000
RequestId: 40002f75-0000-d400-b63f-84710c7967bb
RequestPath: /api/obo/containers/b!21yLRdWEOAdkaWXskuRfByIRiz1S9kb_xPveFbearu6y9k1_PqePezTIDObGJTYq50/files/1%20MRT.P0043WO01_US2024029650-IASR.pdf

Failed to upload to path 1 MRT.P0043WO01_US2024029650-IASR.pdf in container b!21yLRdWEOAdkaWXskuRfByIRiz1S9kb_xPveFbearu6y9k1_PqePezTIDObGJTYq50

Exception: 
Microsoft.Graph.Models.ODataErrors.ODataError: Item not found
   at Microsoft.Kiota.Http.HttpClientLibrary.HttpClientRequestAdapter.ThrowIfFailedResponseAsync(HttpResponseMessage response, Dictionary`2 errorMapping, Activity activityForAttributes, CancellationToken cancellationToken)
   at Microsoft.Kiota.Http.HttpClientLibrary.HttpClientRequestAdapter.SendAsync[ModelType](RequestInformation requestInfo, ParsableFactory`1 factory, Dictionary`2 errorMapping, CancellationToken cancellationToken)
   at Microsoft.Kiota.Http.HttpClientLibrary.HttpClientRequestAdapter.SendAsync[ModelType](RequestInformation requestInfo, ParsableFactory`1 factory, Dictionary`2 errorMapping, CancellationToken cancellationToken)
   at Microsoft.Graph.Storage.FileStorage.Containers.Item.Drive.DriveRequestBuilder.GetAsync(Action`1 requestConfiguration, CancellationToken cancellationToken)
   at Spe.Bff.Api.Infrastructure.Graph.UploadSessionManager.UploadSmallAsUserAsync(String userToken, String containerId, String path, Stream content, CancellationToken ct) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Infrastructure\Graph\UploadSessionManager.cs:line 241
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-17T20:32:01Z"/><EventRecordID>1220597984</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Program
EventId: 0
SpanId: 3894a9bc5a35a80e
TraceId: 1bba32d0ba303ba0ff353d02130ce3f1
ParentId: 0000000000000000
RequestId: 40002f75-0000-d400-b63f-84710c7967bb
RequestPath: /api/obo/containers/b!21yLRdWEOAdkaWXskuRfByIRiz1S9kb_xPveFbearu6y9k1_PqePezTIDObGJTYq50/files/1%20MRT.P0043WO01_US2024029650-IASR.pdf

OBO upload failed - Unexpected error: Item not found

Exception: 
Microsoft.Graph.Models.ODataErrors.ODataError: Item not found
   at Microsoft.Kiota.Http.HttpClientLibrary.HttpClientRequestAdapter.ThrowIfFailedResponseAsync(HttpResponseMessage response, Dictionary`2 errorMapping, Activity activityForAttributes, CancellationToken cancellationToken)
   at Microsoft.Kiota.Http.HttpClientLibrary.HttpClientRequestAdapter.SendAsync[ModelType](RequestInformation requestInfo, ParsableFactory`1 factory, Dictionary`2 errorMapping, CancellationToken cancellationToken)
   at Microsoft.Kiota.Http.HttpClientLibrary.HttpClientRequestAdapter.SendAsync[ModelType](RequestInformation requestInfo, ParsableFactory`1 factory, Dictionary`2 errorMapping, CancellationToken cancellationToken)
   at Microsoft.Graph.Storage.FileStorage.Containers.Item.Drive.DriveRequestBuilder.GetAsync(Action`1 requestConfiguration, CancellationToken cancellationToken)
   at Spe.Bff.Api.Infrastructure.Graph.UploadSessionManager.UploadSmallAsUserAsync(String userToken, String containerId, String path, Stream content, CancellationToken ct) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Infrastructure\Graph\UploadSessionManager.cs:line 241
   at Spe.Bff.Api.Api.OBOEndpoints.&lt;&gt;c.&lt;&lt;MapOBOEndpoints&gt;b__0_1&gt;d.MoveNext() in C:\code_files\spaarke\src\api\Spe.Bff.Api\Api\OBOEndpoints.cs:line 68
</Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1012</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-17T20:36:02Z"/><EventRecordID>1220839015</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Application 'C:\home\site\wwwroot\' was recycled after detecting app_offline.htm.</Data><Data>Process Id: 7224.</Data><Data>File Version: 18.0.25232.20. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-17T20:36:06Z"/><EventRecordID>1220842437</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 9

BackgroundService failed

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\ServiceBusJobProcessor.cs:line 72
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-17T20:36:06Z"/><EventRecordID>1220842734</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 10

The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\ServiceBusJobProcessor.cs:line 72
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-17T20:36:12Z"/><EventRecordID>1220848656</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 9

BackgroundService failed

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.DocumentEventProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\DocumentEventProcessor.cs:line 68
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-17T20:36:13Z"/><EventRecordID>1220849390</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 10

The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.DocumentEventProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\DocumentEventProcessor.cs:line 68
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1005</EventID><Level>2</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-17T20:36:13Z"/><EventRecordID>1220850125</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Failed to gracefully shutdown application 'MACHINE/WEBROOT/APPHOST/SPE-API-DEV-67E2XZ'.</Data><Data>Process Id: 7224.</Data><Data>File Version: 18.0.25232.20. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1032</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-18T01:54:16Z"/><EventRecordID>1239932484</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Application 'C:\home\site\wwwroot\' started successfully.</Data><Data>Process Id: 3088.</Data><Data>File Version: 18.0.25232.20. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-18T01:54:29Z"/><EventRecordID>1239946109</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Spe.Bff.Api.Infrastructure.Graph.UploadSessionManager
EventId: 0
SpanId: c975af1ca191b9bf
TraceId: 5673c91bf625becaa188a3a2eadebc67
ParentId: 0000000000000000
RequestId: 40003461-0000-cd00-b63f-84710c7967bb
RequestPath: /api/obo/containers/b!21yLRdWEOAdkaWXskuRfByIRiz1S9kb_xPveFbearu6y9k1_PqePezTIDObGJTYq50/files/1%20MRT.P0043WO01_US2024029650-IASR.pdf

Failed to upload to path 1 MRT.P0043WO01_US2024029650-IASR.pdf in container b!21yLRdWEOAdkaWXskuRfByIRiz1S9kb_xPveFbearu6y9k1_PqePezTIDObGJTYq50

Exception: 
Microsoft.Graph.Models.ODataErrors.ODataError: Item not found
   at Microsoft.Kiota.Http.HttpClientLibrary.HttpClientRequestAdapter.ThrowIfFailedResponseAsync(HttpResponseMessage response, Dictionary`2 errorMapping, Activity activityForAttributes, CancellationToken cancellationToken)
   at Microsoft.Kiota.Http.HttpClientLibrary.HttpClientRequestAdapter.SendAsync[ModelType](RequestInformation requestInfo, ParsableFactory`1 factory, Dictionary`2 errorMapping, CancellationToken cancellationToken)
   at Microsoft.Kiota.Http.HttpClientLibrary.HttpClientRequestAdapter.SendAsync[ModelType](RequestInformation requestInfo, ParsableFactory`1 factory, Dictionary`2 errorMapping, CancellationToken cancellationToken)
   at Microsoft.Graph.Storage.FileStorage.Containers.Item.Drive.DriveRequestBuilder.GetAsync(Action`1 requestConfiguration, CancellationToken cancellationToken)
   at Spe.Bff.Api.Infrastructure.Graph.UploadSessionManager.UploadSmallAsUserAsync(String userToken, String containerId, String path, Stream content, CancellationToken ct) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Infrastructure\Graph\UploadSessionManager.cs:line 241
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-18T01:54:30Z"/><EventRecordID>1239946203</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Program
EventId: 0
SpanId: c975af1ca191b9bf
TraceId: 5673c91bf625becaa188a3a2eadebc67
ParentId: 0000000000000000
RequestId: 40003461-0000-cd00-b63f-84710c7967bb
RequestPath: /api/obo/containers/b!21yLRdWEOAdkaWXskuRfByIRiz1S9kb_xPveFbearu6y9k1_PqePezTIDObGJTYq50/files/1%20MRT.P0043WO01_US2024029650-IASR.pdf

OBO upload failed - Unexpected error: Item not found

Exception: 
Microsoft.Graph.Models.ODataErrors.ODataError: Item not found
   at Microsoft.Kiota.Http.HttpClientLibrary.HttpClientRequestAdapter.ThrowIfFailedResponseAsync(HttpResponseMessage response, Dictionary`2 errorMapping, Activity activityForAttributes, CancellationToken cancellationToken)
   at Microsoft.Kiota.Http.HttpClientLibrary.HttpClientRequestAdapter.SendAsync[ModelType](RequestInformation requestInfo, ParsableFactory`1 factory, Dictionary`2 errorMapping, CancellationToken cancellationToken)
   at Microsoft.Kiota.Http.HttpClientLibrary.HttpClientRequestAdapter.SendAsync[ModelType](RequestInformation requestInfo, ParsableFactory`1 factory, Dictionary`2 errorMapping, CancellationToken cancellationToken)
   at Microsoft.Graph.Storage.FileStorage.Containers.Item.Drive.DriveRequestBuilder.GetAsync(Action`1 requestConfiguration, CancellationToken cancellationToken)
   at Spe.Bff.Api.Infrastructure.Graph.UploadSessionManager.UploadSmallAsUserAsync(String userToken, String containerId, String path, Stream content, CancellationToken ct) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Infrastructure\Graph\UploadSessionManager.cs:line 241
   at Spe.Bff.Api.Api.OBOEndpoints.&lt;&gt;c.&lt;&lt;MapOBOEndpoints&gt;b__0_1&gt;d.MoveNext() in C:\code_files\spaarke\src\api\Spe.Bff.Api\Api\OBOEndpoints.cs:line 68
</Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1012</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-18T02:00:09Z"/><EventRecordID>1240285625</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Application 'C:\home\site\wwwroot\' was recycled after detecting app_offline.htm.</Data><Data>Process Id: 3088.</Data><Data>File Version: 18.0.25232.20. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-18T02:00:11Z"/><EventRecordID>1240287859</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 9

BackgroundService failed

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\ServiceBusJobProcessor.cs:line 72
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-18T02:00:11Z"/><EventRecordID>1240288125</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 10

The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\ServiceBusJobProcessor.cs:line 72
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-18T02:00:14Z"/><EventRecordID>1240290484</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 9

BackgroundService failed

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.DocumentEventProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\DocumentEventProcessor.cs:line 68
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-18T02:00:14Z"/><EventRecordID>1240290531</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 10

The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.DocumentEventProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\DocumentEventProcessor.cs:line 68
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1005</EventID><Level>2</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-18T02:00:20Z"/><EventRecordID>1240296640</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Failed to gracefully shutdown application 'MACHINE/WEBROOT/APPHOST/SPE-API-DEV-67E2XZ'.</Data><Data>Process Id: 3088.</Data><Data>File Version: 18.0.25232.20. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1032</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-18T02:06:01Z"/><EventRecordID>1240638000</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Application 'C:\home\site\wwwroot\' started successfully.</Data><Data>Process Id: 3592.</Data><Data>File Version: 18.0.25232.20. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-18T02:06:15Z"/><EventRecordID>1240652000</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Spe.Bff.Api.Infrastructure.Graph.UploadSessionManager
EventId: 0
SpanId: 84452dd8a4379db9
TraceId: 0f1df2f7cc3104a27494f33237399cba
ParentId: 0000000000000000
RequestId: 40002d42-0000-c600-b63f-84710c7967bb
RequestPath: /api/obo/containers/b!21yLRdWEOAdkaWXskuRfByIRiz1S9kb_xPveFbearu6y9k1_PqePezTIDObGJTYq50/files/2%20MRT.P0043WO01_WO2024238766-ISR-20250308-2294.pdf

Failed to upload to path 2 MRT.P0043WO01_WO2024238766-ISR-20250308-2294.pdf in container b!21yLRdWEOAdkaWXskuRfByIRiz1S9kb_xPveFbearu6y9k1_PqePezTIDObGJTYq50

Exception: 
Microsoft.Graph.Models.ODataErrors.ODataError: Item not found
   at Microsoft.Kiota.Http.HttpClientLibrary.HttpClientRequestAdapter.ThrowIfFailedResponseAsync(HttpResponseMessage response, Dictionary`2 errorMapping, Activity activityForAttributes, CancellationToken cancellationToken)
   at Microsoft.Kiota.Http.HttpClientLibrary.HttpClientRequestAdapter.SendAsync[ModelType](RequestInformation requestInfo, ParsableFactory`1 factory, Dictionary`2 errorMapping, CancellationToken cancellationToken)
   at Microsoft.Kiota.Http.HttpClientLibrary.HttpClientRequestAdapter.SendAsync[ModelType](RequestInformation requestInfo, ParsableFactory`1 factory, Dictionary`2 errorMapping, CancellationToken cancellationToken)
   at Microsoft.Graph.Drives.Item.Items.Item.Content.ContentRequestBuilder.PutAsync(Stream body, Action`1 requestConfiguration, CancellationToken cancellationToken)
   at Spe.Bff.Api.Infrastructure.Graph.UploadSessionManager.UploadSmallAsUserAsync(String userToken, String containerId, String path, Stream content, CancellationToken ct) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Infrastructure\Graph\UploadSessionManager.cs:line 253
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-18T02:06:15Z"/><EventRecordID>1240652093</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Program
EventId: 0
SpanId: 84452dd8a4379db9
TraceId: 0f1df2f7cc3104a27494f33237399cba
ParentId: 0000000000000000
RequestId: 40002d42-0000-c600-b63f-84710c7967bb
RequestPath: /api/obo/containers/b!21yLRdWEOAdkaWXskuRfByIRiz1S9kb_xPveFbearu6y9k1_PqePezTIDObGJTYq50/files/2%20MRT.P0043WO01_WO2024238766-ISR-20250308-2294.pdf

OBO upload failed - Unexpected error: Item not found

Exception: 
Microsoft.Graph.Models.ODataErrors.ODataError: Item not found
   at Microsoft.Kiota.Http.HttpClientLibrary.HttpClientRequestAdapter.ThrowIfFailedResponseAsync(HttpResponseMessage response, Dictionary`2 errorMapping, Activity activityForAttributes, CancellationToken cancellationToken)
   at Microsoft.Kiota.Http.HttpClientLibrary.HttpClientRequestAdapter.SendAsync[ModelType](RequestInformation requestInfo, ParsableFactory`1 factory, Dictionary`2 errorMapping, CancellationToken cancellationToken)
   at Microsoft.Kiota.Http.HttpClientLibrary.HttpClientRequestAdapter.SendAsync[ModelType](RequestInformation requestInfo, ParsableFactory`1 factory, Dictionary`2 errorMapping, CancellationToken cancellationToken)
   at Microsoft.Graph.Drives.Item.Items.Item.Content.ContentRequestBuilder.PutAsync(Stream body, Action`1 requestConfiguration, CancellationToken cancellationToken)
   at Spe.Bff.Api.Infrastructure.Graph.UploadSessionManager.UploadSmallAsUserAsync(String userToken, String containerId, String path, Stream content, CancellationToken ct) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Infrastructure\Graph\UploadSessionManager.cs:line 253
   at Spe.Bff.Api.Api.OBOEndpoints.&lt;&gt;c.&lt;&lt;MapOBOEndpoints&gt;b__0_1&gt;d.MoveNext() in C:\code_files\spaarke\src\api\Spe.Bff.Api\Api\OBOEndpoints.cs:line 68
</Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1012</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-18T02:08:59Z"/><EventRecordID>1240815421</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Application 'C:\home\site\wwwroot\' was recycled after detecting app_offline.htm.</Data><Data>Process Id: 3592.</Data><Data>File Version: 18.0.25232.20. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-18T02:09:00Z"/><EventRecordID>1240817000</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 9

BackgroundService failed

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\ServiceBusJobProcessor.cs:line 72
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-18T02:09:00Z"/><EventRecordID>1240817109</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 10

The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\ServiceBusJobProcessor.cs:line 72
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-18T02:09:04Z"/><EventRecordID>1240820953</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 9

BackgroundService failed

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.DocumentEventProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\DocumentEventProcessor.cs:line 68
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-18T02:09:05Z"/><EventRecordID>1240821687</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 10

The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.DocumentEventProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\DocumentEventProcessor.cs:line 68
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1033</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-18T02:09:06Z"/><EventRecordID>1240822750</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Application 'MACHINE/WEBROOT/APPHOST/SPE-API-DEV-67E2XZ' has shutdown.</Data><Data>Process Id: 3592.</Data><Data>File Version: 18.0.25232.20. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1032</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-18T02:12:42Z"/><EventRecordID>1241038546</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Application 'C:\home\site\wwwroot\' started successfully.</Data><Data>Process Id: 2656.</Data><Data>File Version: 18.0.25232.20. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-18T02:13:55Z"/><EventRecordID>1241111171</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Spe.Bff.Api.Infrastructure.Graph.UploadSessionManager
EventId: 0
SpanId: f1e6794110c81bf2
TraceId: 4f0a68beaf71a1e08f1d187a06c65306
ParentId: 0000000000000000
RequestId: 40002353-0000-fd00-b63f-84710c7967bb
RequestPath: /api/obo/containers/b!21yLRdWEOAdkaWXskuRfByIRiz1S9kb_xPveFbearu6y9k1_PqePezTIDObGJTYq50/files/1%20MRT.P0043WO01_US2024029650-IASR.pdf

Failed to upload to path 1 MRT.P0043WO01_US2024029650-IASR.pdf in container b!21yLRdWEOAdkaWXskuRfByIRiz1S9kb_xPveFbearu6y9k1_PqePezTIDObGJTYq50

Exception: 
Microsoft.Graph.Models.ODataErrors.ODataError: Item not found
   at Microsoft.Kiota.Http.HttpClientLibrary.HttpClientRequestAdapter.ThrowIfFailedResponseAsync(HttpResponseMessage response, Dictionary`2 errorMapping, Activity activityForAttributes, CancellationToken cancellationToken)
   at Microsoft.Kiota.Http.HttpClientLibrary.HttpClientRequestAdapter.SendAsync[ModelType](RequestInformation requestInfo, ParsableFactory`1 factory, Dictionary`2 errorMapping, CancellationToken cancellationToken)
   at Microsoft.Kiota.Http.HttpClientLibrary.HttpClientRequestAdapter.SendAsync[ModelType](RequestInformation requestInfo, ParsableFactory`1 factory, Dictionary`2 errorMapping, CancellationToken cancellationToken)
   at Microsoft.Graph.Drives.Item.Items.Item.Content.ContentRequestBuilder.PutAsync(Stream body, Action`1 requestConfiguration, CancellationToken cancellationToken)
   at Spe.Bff.Api.Infrastructure.Graph.UploadSessionManager.UploadSmallAsUserAsync(String userToken, String containerId, String path, Stream content, CancellationToken ct) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Infrastructure\Graph\UploadSessionManager.cs:line 253
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-18T02:13:55Z"/><EventRecordID>1241111250</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Program
EventId: 0
SpanId: f1e6794110c81bf2
TraceId: 4f0a68beaf71a1e08f1d187a06c65306
ParentId: 0000000000000000
RequestId: 40002353-0000-fd00-b63f-84710c7967bb
RequestPath: /api/obo/containers/b!21yLRdWEOAdkaWXskuRfByIRiz1S9kb_xPveFbearu6y9k1_PqePezTIDObGJTYq50/files/1%20MRT.P0043WO01_US2024029650-IASR.pdf

OBO upload failed - Unexpected error: Item not found

Exception: 
Microsoft.Graph.Models.ODataErrors.ODataError: Item not found
   at Microsoft.Kiota.Http.HttpClientLibrary.HttpClientRequestAdapter.ThrowIfFailedResponseAsync(HttpResponseMessage response, Dictionary`2 errorMapping, Activity activityForAttributes, CancellationToken cancellationToken)
   at Microsoft.Kiota.Http.HttpClientLibrary.HttpClientRequestAdapter.SendAsync[ModelType](RequestInformation requestInfo, ParsableFactory`1 factory, Dictionary`2 errorMapping, CancellationToken cancellationToken)
   at Microsoft.Kiota.Http.HttpClientLibrary.HttpClientRequestAdapter.SendAsync[ModelType](RequestInformation requestInfo, ParsableFactory`1 factory, Dictionary`2 errorMapping, CancellationToken cancellationToken)
   at Microsoft.Graph.Drives.Item.Items.Item.Content.ContentRequestBuilder.PutAsync(Stream body, Action`1 requestConfiguration, CancellationToken cancellationToken)
   at Spe.Bff.Api.Infrastructure.Graph.UploadSessionManager.UploadSmallAsUserAsync(String userToken, String containerId, String path, Stream content, CancellationToken ct) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Infrastructure\Graph\UploadSessionManager.cs:line 253
   at Spe.Bff.Api.Api.OBOEndpoints.&lt;&gt;c.&lt;&lt;MapOBOEndpoints&gt;b__0_1&gt;d.MoveNext() in C:\code_files\spaarke\src\api\Spe.Bff.Api\Api\OBOEndpoints.cs:line 68
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-18T02:26:58Z"/><EventRecordID>1241895015</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 9

BackgroundService failed

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\ServiceBusJobProcessor.cs:line 72
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-18T02:26:58Z"/><EventRecordID>1241895078</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 10

The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\ServiceBusJobProcessor.cs:line 72
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-18T02:26:59Z"/><EventRecordID>1241895234</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 9

BackgroundService failed

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.CheckDispose()
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.DocumentEventProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\DocumentEventProcessor.cs:line 68
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-18T02:26:59Z"/><EventRecordID>1241895250</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 10

The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.CheckDispose()
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.DocumentEventProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\DocumentEventProcessor.cs:line 68
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1033</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-18T02:27:01Z"/><EventRecordID>1241897250</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Application 'MACHINE/WEBROOT/APPHOST/SPE-API-DEV-67E2XZ' has shutdown.</Data><Data>Process Id: 2656.</Data><Data>File Version: 18.0.25232.20. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1032</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-18T14:14:32Z"/><EventRecordID>1284349000</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Application 'C:\home\site\wwwroot\' started successfully.</Data><Data>Process Id: 4864.</Data><Data>File Version: 18.0.25232.20. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-18T15:42:43Z"/><EventRecordID>1289639906</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Spe.Bff.Api.Infrastructure.Graph.UploadSessionManager
EventId: 0
SpanId: f1ac5a5692b2f011
TraceId: 044c1f27bc44e3ceeea5d63a8522e40d
ParentId: 0000000000000000
RequestId: 400027ae-0000-c300-b63f-84710c7967bb
RequestPath: /api/obo/containers/b!21yLRdWEOAdkaWXskuRfByIRiz1S9kb_xPveFbearu6y9k1_PqePezTIDObGJTYq50/files/1%20MRT.P0043WO01_US2024029650-IASR.pdf

Failed to upload to path 1 MRT.P0043WO01_US2024029650-IASR.pdf in container b!21yLRdWEOAdkaWXskuRfByIRiz1S9kb_xPveFbearu6y9k1_PqePezTIDObGJTYq50

Exception: 
Microsoft.Graph.Models.ODataErrors.ODataError: Item not found
   at Microsoft.Kiota.Http.HttpClientLibrary.HttpClientRequestAdapter.ThrowIfFailedResponseAsync(HttpResponseMessage response, Dictionary`2 errorMapping, Activity activityForAttributes, CancellationToken cancellationToken)
   at Microsoft.Kiota.Http.HttpClientLibrary.HttpClientRequestAdapter.SendAsync[ModelType](RequestInformation requestInfo, ParsableFactory`1 factory, Dictionary`2 errorMapping, CancellationToken cancellationToken)
   at Microsoft.Kiota.Http.HttpClientLibrary.HttpClientRequestAdapter.SendAsync[ModelType](RequestInformation requestInfo, ParsableFactory`1 factory, Dictionary`2 errorMapping, CancellationToken cancellationToken)
   at Microsoft.Graph.Drives.Item.Items.Item.Content.ContentRequestBuilder.PutAsync(Stream body, Action`1 requestConfiguration, CancellationToken cancellationToken)
   at Spe.Bff.Api.Infrastructure.Graph.UploadSessionManager.UploadSmallAsUserAsync(String userToken, String containerId, String path, Stream content, CancellationToken ct) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Infrastructure\Graph\UploadSessionManager.cs:line 253
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-18T15:42:43Z"/><EventRecordID>1289640015</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Program
EventId: 0
SpanId: f1ac5a5692b2f011
TraceId: 044c1f27bc44e3ceeea5d63a8522e40d
ParentId: 0000000000000000
RequestId: 400027ae-0000-c300-b63f-84710c7967bb
RequestPath: /api/obo/containers/b!21yLRdWEOAdkaWXskuRfByIRiz1S9kb_xPveFbearu6y9k1_PqePezTIDObGJTYq50/files/1%20MRT.P0043WO01_US2024029650-IASR.pdf

OBO upload failed - Unexpected error: Item not found

Exception: 
Microsoft.Graph.Models.ODataErrors.ODataError: Item not found
   at Microsoft.Kiota.Http.HttpClientLibrary.HttpClientRequestAdapter.ThrowIfFailedResponseAsync(HttpResponseMessage response, Dictionary`2 errorMapping, Activity activityForAttributes, CancellationToken cancellationToken)
   at Microsoft.Kiota.Http.HttpClientLibrary.HttpClientRequestAdapter.SendAsync[ModelType](RequestInformation requestInfo, ParsableFactory`1 factory, Dictionary`2 errorMapping, CancellationToken cancellationToken)
   at Microsoft.Kiota.Http.HttpClientLibrary.HttpClientRequestAdapter.SendAsync[ModelType](RequestInformation requestInfo, ParsableFactory`1 factory, Dictionary`2 errorMapping, CancellationToken cancellationToken)
   at Microsoft.Graph.Drives.Item.Items.Item.Content.ContentRequestBuilder.PutAsync(Stream body, Action`1 requestConfiguration, CancellationToken cancellationToken)
   at Spe.Bff.Api.Infrastructure.Graph.UploadSessionManager.UploadSmallAsUserAsync(String userToken, String containerId, String path, Stream content, CancellationToken ct) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Infrastructure\Graph\UploadSessionManager.cs:line 253
   at Spe.Bff.Api.Api.OBOEndpoints.&lt;&gt;c.&lt;&lt;MapOBOEndpoints&gt;b__0_1&gt;d.MoveNext() in C:\code_files\spaarke\src\api\Spe.Bff.Api\Api\OBOEndpoints.cs:line 68
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-19T02:26:55Z"/><EventRecordID>1328292187</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 9

BackgroundService failed

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\ServiceBusJobProcessor.cs:line 72
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-19T02:26:56Z"/><EventRecordID>1328292250</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 10

The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\ServiceBusJobProcessor.cs:line 72
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-19T02:26:56Z"/><EventRecordID>1328292562</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 9

BackgroundService failed

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.DocumentEventProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\DocumentEventProcessor.cs:line 68
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-19T02:26:56Z"/><EventRecordID>1328292593</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 10

The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.DocumentEventProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\DocumentEventProcessor.cs:line 68
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1033</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-19T02:26:58Z"/><EventRecordID>1328295031</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Application 'MACHINE/WEBROOT/APPHOST/SPE-API-DEV-67E2XZ' has shutdown.</Data><Data>Process Id: 4864.</Data><Data>File Version: 18.0.25232.20. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1032</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-19T11:55:00Z"/><EventRecordID>1362376265</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Application 'C:\home\site\wwwroot\' started successfully.</Data><Data>Process Id: 2932.</Data><Data>File Version: 18.0.25232.20. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T02:27:10Z"/><EventRecordID>1414706781</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 9

BackgroundService failed

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\ServiceBusJobProcessor.cs:line 72
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T02:27:11Z"/><EventRecordID>1414707359</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 10

The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\ServiceBusJobProcessor.cs:line 72
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T02:27:11Z"/><EventRecordID>1414708031</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 9

BackgroundService failed

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.DocumentEventProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\DocumentEventProcessor.cs:line 68
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T02:27:11Z"/><EventRecordID>1414708062</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 10

The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.DocumentEventProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\DocumentEventProcessor.cs:line 68
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1033</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T02:27:15Z"/><EventRecordID>1414712000</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Application 'MACHINE/WEBROOT/APPHOST/SPE-API-DEV-67E2XZ' has shutdown.</Data><Data>Process Id: 2932.</Data><Data>File Version: 18.0.25232.20. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1032</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T02:33:59Z"/><EventRecordID>1415115703</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Application 'C:\home\site\wwwroot\' started successfully.</Data><Data>Process Id: 4400.</Data><Data>File Version: 18.0.25232.20. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T10:27:02Z"/><EventRecordID>1443498640</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 9

BackgroundService failed

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\ServiceBusJobProcessor.cs:line 72
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T10:27:02Z"/><EventRecordID>1443498906</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 10

The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\ServiceBusJobProcessor.cs:line 72
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T10:27:03Z"/><EventRecordID>1443499484</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 9

BackgroundService failed

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.DocumentEventProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\DocumentEventProcessor.cs:line 68
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T10:27:03Z"/><EventRecordID>1443499515</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 10

The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.DocumentEventProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\DocumentEventProcessor.cs:line 68
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1033</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T10:27:05Z"/><EventRecordID>1443501625</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Application 'MACHINE/WEBROOT/APPHOST/SPE-API-DEV-67E2XZ' has shutdown.</Data><Data>Process Id: 4400.</Data><Data>File Version: 18.0.25232.20. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1032</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T13:42:34Z"/><EventRecordID>1455230468</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Application 'C:\home\site\wwwroot\' started successfully.</Data><Data>Process Id: 4392.</Data><Data>File Version: 18.0.25232.20. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1012</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T13:52:42Z"/><EventRecordID>1455839031</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Application 'C:\home\site\wwwroot\' was recycled after detecting app_offline.htm.</Data><Data>Process Id: 4392.</Data><Data>File Version: 18.0.25232.20. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T13:52:44Z"/><EventRecordID>1455840390</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 9

BackgroundService failed

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\ServiceBusJobProcessor.cs:line 72
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T13:52:44Z"/><EventRecordID>1455840718</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 10

The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\ServiceBusJobProcessor.cs:line 72
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T13:52:46Z"/><EventRecordID>1455843296</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 9

BackgroundService failed

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.DocumentEventProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\DocumentEventProcessor.cs:line 68
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T13:52:47Z"/><EventRecordID>1455843359</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 10

The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.DocumentEventProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\DocumentEventProcessor.cs:line 68
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1005</EventID><Level>2</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T13:52:52Z"/><EventRecordID>1455849156</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Failed to gracefully shutdown application 'MACHINE/WEBROOT/APPHOST/SPE-API-DEV-67E2XZ'.</Data><Data>Process Id: 4392.</Data><Data>File Version: 18.0.25232.20. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1032</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T13:54:48Z"/><EventRecordID>1455964640</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Application 'C:\home\site\wwwroot\' started successfully.</Data><Data>Process Id: 3304.</Data><Data>File Version: 18.0.25232.20. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T13:55:07Z"/><EventRecordID>1455983890</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Spaarke.Dataverse.DataverseServiceClientImpl
EventId: 0
SpanId: c41d723116ee71f4
TraceId: 88569ebcf16ce4f28e099a3d82251956
ParentId: 0000000000000000
RequestId: 40003f70-0000-cd00-b63f-84710c7967bb
RequestPath: /healthz/dataverse

Exception initializing Dataverse ServiceClient

Exception: 
Microsoft.PowerPlatform.Dataverse.Client.Utils.DataverseConnectionException: Failed to connect to Dataverse
 ---&gt; System.Exception: ExternalTokenManagement Authentication Requested but not configured correctly. 003
 ---&gt; Azure.Identity.AuthenticationFailedException: ManagedIdentityCredential authentication failed: Service request failed.
Status: 400 (Bad Request)

Content:
{"statusCode":400,"message":"No User Assigned or Delegated Managed Identity found for specified ClientId/ResourceId/PrincipalId.","correlationId":"367834ff-ab07-435c-a6ce-402e0afe3726"}

Headers:
Date: Mon, 20 Oct 2025 13:55:06 GMT
Server: Kestrel
Transfer-Encoding: chunked
X-CORRELATION-ID: REDACTED
Content-Type: application/json; charset=utf-8

See the troubleshooting guide for more information. https://aka.ms/azsdk/net/identity/managedidentitycredential/troubleshoot
 ---&gt; Azure.RequestFailedException: Service request failed.
Status: 400 (Bad Request)

Content:
{"statusCode":400,"message":"No User Assigned or Delegated Managed Identity found for specified ClientId/ResourceId/PrincipalId.","correlationId":"367834ff-ab07-435c-a6ce-402e0afe3726"}

Headers:
Date: Mon, 20 Oct 2025 13:55:06 GMT
Server: Kestrel
Transfer-Encoding: chunked
X-CORRELATION-ID: REDACTED
Content-Type: application/json; charset=utf-8

   at Azure.Identity.ManagedIdentitySource.HandleResponseAsync(Boolean async, TokenRequestContext context, HttpMessage message, CancellationToken cancellationToken)
   at Azure.Identity.ManagedIdentitySource.AuthenticateAsync(Boolean async, TokenRequestContext context, CancellationToken cancellationToken)
   at Azure.Identity.ManagedIdentityClient.AuthenticateCoreAsync(Boolean async, TokenRequestContext context, CancellationToken cancellationToken)
   at Azure.Identity.ManagedIdentityClient.AppTokenProviderImpl(AppTokenProviderParameters parameters)
   at Microsoft.Identity.Client.Internal.Requests.ClientCredentialRequest.SendTokenRequestToAppTokenProviderAsync(ILoggerAdapter logger, CancellationToken cancellationToken)
   at Microsoft.Identity.Client.Internal.Requests.ClientCredentialRequest.GetAccessTokenAsync(CancellationToken cancellationToken, ILoggerAdapter logger)
   at Microsoft.Identity.Client.Internal.Requests.ClientCredentialRequest.ExecuteAsync(CancellationToken cancellationToken)
   at Microsoft.Identity.Client.Internal.Requests.RequestBase.&lt;&gt;c__DisplayClass11_1.&lt;&lt;RunAsync&gt;b__1&gt;d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.Identity.Client.Utils.StopwatchService.MeasureCodeBlockAsync(Func`1 codeBlock)
   at Microsoft.Identity.Client.Internal.Requests.RequestBase.RunAsync(CancellationToken cancellationToken)
   at Microsoft.Identity.Client.ApiConfig.Executors.ConfidentialClientExecutor.ExecuteAsync(AcquireTokenCommonParameters commonParameters, AcquireTokenForClientParameters clientParameters, CancellationToken cancellationToken)
   at Azure.Identity.AbstractAcquireTokenParameterBuilderExtensions.ExecuteAsync[T](AbstractAcquireTokenParameterBuilder`1 builder, Boolean async, CancellationToken cancellationToken)
   at Azure.Identity.MsalConfidentialClient.AcquireTokenForClientCoreAsync(String[] scopes, String tenantId, String claims, Boolean enableCae, Boolean async, CancellationToken cancellationToken)
   at Azure.Identity.MsalConfidentialClient.AcquireTokenForClientAsync(String[] scopes, String tenantId, String claims, Boolean enableCae, Boolean async, CancellationToken cancellationToken)
   at Azure.Identity.ManagedIdentityClient.AuthenticateAsync(Boolean async, TokenRequestContext context, CancellationToken cancellationToken)
   at Azure.Identity.ManagedIdentityCredential.GetTokenImplAsync(Boolean async, TokenRequestContext requestContext, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Azure.Identity.CredentialDiagnosticScope.FailWrapAndThrow(Exception ex, String additionalMessage, Boolean isCredentialUnavailable)
   at Azure.Identity.ManagedIdentityCredential.GetTokenImplAsync(Boolean async, TokenRequestContext requestContext, CancellationToken cancellationToken)
   at Azure.Identity.ManagedIdentityCredential.GetTokenAsync(TokenRequestContext requestContext, CancellationToken cancellationToken)
   at Spaarke.Dataverse.DataverseServiceClientImpl.&lt;&gt;c__DisplayClass3_0.&lt;&lt;-ctor&gt;b__0&gt;d.MoveNext() in C:\code_files\spaarke\src\shared\Spaarke.Dataverse\DataverseServiceClientImpl.cs:line 61
--- End of stack trace from previous location ---
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.ConnectAndInitServiceAsync(OrganizationDetail orgdata, Boolean IsOnPrem, Uri homeRealmUri)
   --- End of inner exception stack trace ---
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.ConnectAndInitServiceAsync(OrganizationDetail orgdata, Boolean IsOnPrem, Uri homeRealmUri)
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.DoDirectLoginAsync(Boolean IsOnPrem)
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.InitServiceAsync()
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.GetCachedService(ConnectionService&amp; ConnectionObject)
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.IntilizeService(ConnectionService&amp; ConnectionObject)
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.DoLogin(ConnectionService&amp; ConnectionObject)
   at Microsoft.PowerPlatform.Dataverse.Client.ServiceClient.CreateServiceConnection(Object externalOrgServiceProxy, AuthenticationType requestedAuthType, String hostName, String port, String orgName, NetworkCredential credential, String userId, SecureString password, String domain, String Geo, String claimsHomeRealm, Boolean useSsl, Boolean useUniqueInstance, OrganizationDetail orgDetail, String clientId, Uri redirectUri, PromptBehavior promptBehavior, OrganizationWebProxyClientAsync externalOrgWebProxyClient, String certificateThumbPrint, StoreName certificateStoreName, X509Certificate2 certificate, Uri instanceUrl, Boolean isCloned, Boolean useDefaultCreds, Version incomingOrgVersion, ILogger externalLogger, String tokenCacheStorePath)
   --- End of inner exception stack trace ---
   at Microsoft.PowerPlatform.Dataverse.Client.ServiceClient.CreateServiceConnection(Object externalOrgServiceProxy, AuthenticationType requestedAuthType, String hostName, String port, String orgName, NetworkCredential credential, String userId, SecureString password, String domain, String Geo, String claimsHomeRealm, Boolean useSsl, Boolean useUniqueInstance, OrganizationDetail orgDetail, String clientId, Uri redirectUri, PromptBehavior promptBehavior, OrganizationWebProxyClientAsync externalOrgWebProxyClient, String certificateThumbPrint, StoreName certificateStoreName, X509Certificate2 certificate, Uri instanceUrl, Boolean isCloned, Boolean useDefaultCreds, Version incomingOrgVersion, ILogger externalLogger, String tokenCacheStorePath)
   at Microsoft.PowerPlatform.Dataverse.Client.ServiceClient..ctor(Uri instanceUrl, Func`2 tokenProviderFunction, Boolean useUniqueInstance, ILogger logger)
   at Spaarke.Dataverse.DataverseServiceClientImpl..ctor(IConfiguration configuration, ILogger`1 logger) in C:\code_files\spaarke\src\shared\Spaarke.Dataverse\DataverseServiceClientImpl.cs:line 56
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T13:55:07Z"/><EventRecordID>1455984015</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware
EventId: 1
SpanId: c41d723116ee71f4
TraceId: 88569ebcf16ce4f28e099a3d82251956
ParentId: 0000000000000000
RequestId: 40003f70-0000-cd00-b63f-84710c7967bb
RequestPath: /healthz/dataverse

An unhandled exception has occurred while executing the request.

Exception: 
Microsoft.PowerPlatform.Dataverse.Client.Utils.DataverseConnectionException: Failed to connect to Dataverse
 ---&gt; System.Exception: ExternalTokenManagement Authentication Requested but not configured correctly. 003
 ---&gt; Azure.Identity.AuthenticationFailedException: ManagedIdentityCredential authentication failed: Service request failed.
Status: 400 (Bad Request)

Content:
{"statusCode":400,"message":"No User Assigned or Delegated Managed Identity found for specified ClientId/ResourceId/PrincipalId.","correlationId":"367834ff-ab07-435c-a6ce-402e0afe3726"}

Headers:
Date: Mon, 20 Oct 2025 13:55:06 GMT
Server: Kestrel
Transfer-Encoding: chunked
X-CORRELATION-ID: REDACTED
Content-Type: application/json; charset=utf-8

See the troubleshooting guide for more information. https://aka.ms/azsdk/net/identity/managedidentitycredential/troubleshoot
 ---&gt; Azure.RequestFailedException: Service request failed.
Status: 400 (Bad Request)

Content:
{"statusCode":400,"message":"No User Assigned or Delegated Managed Identity found for specified ClientId/ResourceId/PrincipalId.","correlationId":"367834ff-ab07-435c-a6ce-402e0afe3726"}

Headers:
Date: Mon, 20 Oct 2025 13:55:06 GMT
Server: Kestrel
Transfer-Encoding: chunked
X-CORRELATION-ID: REDACTED
Content-Type: application/json; charset=utf-8

   at Azure.Identity.ManagedIdentitySource.HandleResponseAsync(Boolean async, TokenRequestContext context, HttpMessage message, CancellationToken cancellationToken)
   at Azure.Identity.ManagedIdentitySource.AuthenticateAsync(Boolean async, TokenRequestContext context, CancellationToken cancellationToken)
   at Azure.Identity.ManagedIdentityClient.AuthenticateCoreAsync(Boolean async, TokenRequestContext context, CancellationToken cancellationToken)
   at Azure.Identity.ManagedIdentityClient.AppTokenProviderImpl(AppTokenProviderParameters parameters)
   at Microsoft.Identity.Client.Internal.Requests.ClientCredentialRequest.SendTokenRequestToAppTokenProviderAsync(ILoggerAdapter logger, CancellationToken cancellationToken)
   at Microsoft.Identity.Client.Internal.Requests.ClientCredentialRequest.GetAccessTokenAsync(CancellationToken cancellationToken, ILoggerAdapter logger)
   at Microsoft.Identity.Client.Internal.Requests.ClientCredentialRequest.ExecuteAsync(CancellationToken cancellationToken)
   at Microsoft.Identity.Client.Internal.Requests.RequestBase.&lt;&gt;c__DisplayClass11_1.&lt;&lt;RunAsync&gt;b__1&gt;d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.Identity.Client.Utils.StopwatchService.MeasureCodeBlockAsync(Func`1 codeBlock)
   at Microsoft.Identity.Client.Internal.Requests.RequestBase.RunAsync(CancellationToken cancellationToken)
   at Microsoft.Identity.Client.ApiConfig.Executors.ConfidentialClientExecutor.ExecuteAsync(AcquireTokenCommonParameters commonParameters, AcquireTokenForClientParameters clientParameters, CancellationToken cancellationToken)
   at Azure.Identity.AbstractAcquireTokenParameterBuilderExtensions.ExecuteAsync[T](AbstractAcquireTokenParameterBuilder`1 builder, Boolean async, CancellationToken cancellationToken)
   at Azure.Identity.MsalConfidentialClient.AcquireTokenForClientCoreAsync(String[] scopes, String tenantId, String claims, Boolean enableCae, Boolean async, CancellationToken cancellationToken)
   at Azure.Identity.MsalConfidentialClient.AcquireTokenForClientAsync(String[] scopes, String tenantId, String claims, Boolean enableCae, Boolean async, CancellationToken cancellationToken)
   at Azure.Identity.ManagedIdentityClient.AuthenticateAsync(Boolean async, TokenRequestContext context, CancellationToken cancellationToken)
   at Azure.Identity.ManagedIdentityCredential.GetTokenImplAsync(Boolean async, TokenRequestContext requestContext, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Azure.Identity.CredentialDiagnosticScope.FailWrapAndThrow(Exception ex, String additionalMessage, Boolean isCredentialUnavailable)
   at Azure.Identity.ManagedIdentityCredential.GetTokenImplAsync(Boolean async, TokenRequestContext requestContext, CancellationToken cancellationToken)
   at Azure.Identity.ManagedIdentityCredential.GetTokenAsync(TokenRequestContext requestContext, CancellationToken cancellationToken)
   at Spaarke.Dataverse.DataverseServiceClientImpl.&lt;&gt;c__DisplayClass3_0.&lt;&lt;-ctor&gt;b__0&gt;d.MoveNext() in C:\code_files\spaarke\src\shared\Spaarke.Dataverse\DataverseServiceClientImpl.cs:line 61
--- End of stack trace from previous location ---
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.ConnectAndInitServiceAsync(OrganizationDetail orgdata, Boolean IsOnPrem, Uri homeRealmUri)
   --- End of inner exception stack trace ---
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.ConnectAndInitServiceAsync(OrganizationDetail orgdata, Boolean IsOnPrem, Uri homeRealmUri)
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.DoDirectLoginAsync(Boolean IsOnPrem)
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.InitServiceAsync()
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.GetCachedService(ConnectionService&amp; ConnectionObject)
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.IntilizeService(ConnectionService&amp; ConnectionObject)
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.DoLogin(ConnectionService&amp; ConnectionObject)
   at Microsoft.PowerPlatform.Dataverse.Client.ServiceClient.CreateServiceConnection(Object externalOrgServiceProxy, AuthenticationType requestedAuthType, String hostName, String port, String orgName, NetworkCredential credential, String userId, SecureString password, String domain, String Geo, String claimsHomeRealm, Boolean useSsl, Boolean useUniqueInstance, OrganizationDetail orgDetail, String clientId, Uri redirectUri, PromptBehavior promptBehavior, OrganizationWebProxyClientAsync externalOrgWebProxyClient, String certificateThumbPrint, StoreName certificateStoreName, X509Certificate2 certificate, Uri instanceUrl, Boolean isCloned, Boolean useDefaultCreds, Version incomingOrgVersion, ILogger externalLogger, String tokenCacheStorePath)
   --- End of inner exception stack trace ---
   at Microsoft.PowerPlatform.Dataverse.Client.ServiceClient.CreateServiceConnection(Object externalOrgServiceProxy, AuthenticationType requestedAuthType, String hostName, String port, String orgName, NetworkCredential credential, String userId, SecureString password, String domain, String Geo, String claimsHomeRealm, Boolean useSsl, Boolean useUniqueInstance, OrganizationDetail orgDetail, String clientId, Uri redirectUri, PromptBehavior promptBehavior, OrganizationWebProxyClientAsync externalOrgWebProxyClient, String certificateThumbPrint, StoreName certificateStoreName, X509Certificate2 certificate, Uri instanceUrl, Boolean isCloned, Boolean useDefaultCreds, Version incomingOrgVersion, ILogger externalLogger, String tokenCacheStorePath)
   at Microsoft.PowerPlatform.Dataverse.Client.ServiceClient..ctor(Uri instanceUrl, Func`2 tokenProviderFunction, Boolean useUniqueInstance, ILogger logger)
   at Spaarke.Dataverse.DataverseServiceClientImpl..ctor(IConfiguration configuration, ILogger`1 logger) in C:\code_files\spaarke\src\shared\Spaarke.Dataverse\DataverseServiceClientImpl.cs:line 56
   at Program.&lt;&gt;c.&lt;&lt;Main&gt;$&gt;b__0_2(IServiceProvider sp) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Program.cs:line 267
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitRootCache(ServiceCallSite callSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.Resolve(ServiceCallSite callSite, ServiceProviderEngineScope scope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at lambda_method36(Closure, Object, HttpContext)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Spe.Bff.Api.Api.SecurityHeadersMiddleware.Invoke(HttpContext ctx) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Api\SecurityHeadersMiddleware.cs:line 21
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T14:53:08Z"/><EventRecordID>1459465140</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Spaarke.Dataverse.DataverseServiceClientImpl
EventId: 0
SpanId: 838a3b2c8e272cfe
TraceId: b909d17a0802fac1f4bee7e08fd808e7
ParentId: 0000000000000000
RequestId: 400047cf-0000-dd00-b63f-84710c7967bb
RequestPath: /api/navmap/sprk_document/sprk_matter_document/lookup

Exception initializing Dataverse ServiceClient

Exception: 
Microsoft.PowerPlatform.Dataverse.Client.Utils.DataverseConnectionException: Failed to connect to Dataverse
 ---&gt; System.Exception: ExternalTokenManagement Authentication Requested but not configured correctly. 003
 ---&gt; Azure.Identity.AuthenticationFailedException: ManagedIdentityCredential authentication failed: Service request failed.
Status: 400 (Bad Request)

Content:
{"statusCode":400,"message":"No User Assigned or Delegated Managed Identity found for specified ClientId/ResourceId/PrincipalId.","correlationId":"aa7bc179-e900-493c-8af1-dbc82a15e87e"}

Headers:
Date: Mon, 20 Oct 2025 14:53:06 GMT
Server: Kestrel
Transfer-Encoding: chunked
X-CORRELATION-ID: REDACTED
Content-Type: application/json; charset=utf-8

See the troubleshooting guide for more information. https://aka.ms/azsdk/net/identity/managedidentitycredential/troubleshoot
 ---&gt; Azure.RequestFailedException: Service request failed.
Status: 400 (Bad Request)

Content:
{"statusCode":400,"message":"No User Assigned or Delegated Managed Identity found for specified ClientId/ResourceId/PrincipalId.","correlationId":"aa7bc179-e900-493c-8af1-dbc82a15e87e"}

Headers:
Date: Mon, 20 Oct 2025 14:53:06 GMT
Server: Kestrel
Transfer-Encoding: chunked
X-CORRELATION-ID: REDACTED
Content-Type: application/json; charset=utf-8

   at Azure.Identity.ManagedIdentitySource.HandleResponseAsync(Boolean async, TokenRequestContext context, HttpMessage message, CancellationToken cancellationToken)
   at Azure.Identity.ManagedIdentitySource.AuthenticateAsync(Boolean async, TokenRequestContext context, CancellationToken cancellationToken)
   at Azure.Identity.ManagedIdentityClient.AuthenticateCoreAsync(Boolean async, TokenRequestContext context, CancellationToken cancellationToken)
   at Azure.Identity.ManagedIdentityClient.AppTokenProviderImpl(AppTokenProviderParameters parameters)
   at Microsoft.Identity.Client.Internal.Requests.ClientCredentialRequest.SendTokenRequestToAppTokenProviderAsync(ILoggerAdapter logger, CancellationToken cancellationToken)
   at Microsoft.Identity.Client.Internal.Requests.ClientCredentialRequest.GetAccessTokenAsync(CancellationToken cancellationToken, ILoggerAdapter logger)
   at Microsoft.Identity.Client.Internal.Requests.ClientCredentialRequest.ExecuteAsync(CancellationToken cancellationToken)
   at Microsoft.Identity.Client.Internal.Requests.RequestBase.&lt;&gt;c__DisplayClass11_1.&lt;&lt;RunAsync&gt;b__1&gt;d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.Identity.Client.Utils.StopwatchService.MeasureCodeBlockAsync(Func`1 codeBlock)
   at Microsoft.Identity.Client.Internal.Requests.RequestBase.RunAsync(CancellationToken cancellationToken)
   at Microsoft.Identity.Client.ApiConfig.Executors.ConfidentialClientExecutor.ExecuteAsync(AcquireTokenCommonParameters commonParameters, AcquireTokenForClientParameters clientParameters, CancellationToken cancellationToken)
   at Azure.Identity.AbstractAcquireTokenParameterBuilderExtensions.ExecuteAsync[T](AbstractAcquireTokenParameterBuilder`1 builder, Boolean async, CancellationToken cancellationToken)
   at Azure.Identity.MsalConfidentialClient.AcquireTokenForClientCoreAsync(String[] scopes, String tenantId, String claims, Boolean enableCae, Boolean async, CancellationToken cancellationToken)
   at Azure.Identity.MsalConfidentialClient.AcquireTokenForClientAsync(String[] scopes, String tenantId, String claims, Boolean enableCae, Boolean async, CancellationToken cancellationToken)
   at Azure.Identity.ManagedIdentityClient.AuthenticateAsync(Boolean async, TokenRequestContext context, CancellationToken cancellationToken)
   at Azure.Identity.ManagedIdentityCredential.GetTokenImplAsync(Boolean async, TokenRequestContext requestContext, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Azure.Identity.CredentialDiagnosticScope.FailWrapAndThrow(Exception ex, String additionalMessage, Boolean isCredentialUnavailable)
   at Azure.Identity.ManagedIdentityCredential.GetTokenImplAsync(Boolean async, TokenRequestContext requestContext, CancellationToken cancellationToken)
   at Azure.Identity.ManagedIdentityCredential.GetTokenAsync(TokenRequestContext requestContext, CancellationToken cancellationToken)
   at Spaarke.Dataverse.DataverseServiceClientImpl.&lt;&gt;c__DisplayClass3_0.&lt;&lt;-ctor&gt;b__0&gt;d.MoveNext() in C:\code_files\spaarke\src\shared\Spaarke.Dataverse\DataverseServiceClientImpl.cs:line 61
--- End of stack trace from previous location ---
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.ConnectAndInitServiceAsync(OrganizationDetail orgdata, Boolean IsOnPrem, Uri homeRealmUri)
   --- End of inner exception stack trace ---
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.ConnectAndInitServiceAsync(OrganizationDetail orgdata, Boolean IsOnPrem, Uri homeRealmUri)
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.DoDirectLoginAsync(Boolean IsOnPrem)
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.InitServiceAsync()
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.GetCachedService(ConnectionService&amp; ConnectionObject)
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.IntilizeService(ConnectionService&amp; ConnectionObject)
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.DoLogin(ConnectionService&amp; ConnectionObject)
   at Microsoft.PowerPlatform.Dataverse.Client.ServiceClient.CreateServiceConnection(Object externalOrgServiceProxy, AuthenticationType requestedAuthType, String hostName, String port, String orgName, NetworkCredential credential, String userId, SecureString password, String domain, String Geo, String claimsHomeRealm, Boolean useSsl, Boolean useUniqueInstance, OrganizationDetail orgDetail, String clientId, Uri redirectUri, PromptBehavior promptBehavior, OrganizationWebProxyClientAsync externalOrgWebProxyClient, String certificateThumbPrint, StoreName certificateStoreName, X509Certificate2 certificate, Uri instanceUrl, Boolean isCloned, Boolean useDefaultCreds, Version incomingOrgVersion, ILogger externalLogger, String tokenCacheStorePath)
   --- End of inner exception stack trace ---
   at Microsoft.PowerPlatform.Dataverse.Client.ServiceClient.CreateServiceConnection(Object externalOrgServiceProxy, AuthenticationType requestedAuthType, String hostName, String port, String orgName, NetworkCredential credential, String userId, SecureString password, String domain, String Geo, String claimsHomeRealm, Boolean useSsl, Boolean useUniqueInstance, OrganizationDetail orgDetail, String clientId, Uri redirectUri, PromptBehavior promptBehavior, OrganizationWebProxyClientAsync externalOrgWebProxyClient, String certificateThumbPrint, StoreName certificateStoreName, X509Certificate2 certificate, Uri instanceUrl, Boolean isCloned, Boolean useDefaultCreds, Version incomingOrgVersion, ILogger externalLogger, String tokenCacheStorePath)
   at Microsoft.PowerPlatform.Dataverse.Client.ServiceClient..ctor(Uri instanceUrl, Func`2 tokenProviderFunction, Boolean useUniqueInstance, ILogger logger)
   at Spaarke.Dataverse.DataverseServiceClientImpl..ctor(IConfiguration configuration, ILogger`1 logger) in C:\code_files\spaarke\src\shared\Spaarke.Dataverse\DataverseServiceClientImpl.cs:line 56
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T14:53:09Z"/><EventRecordID>1459465640</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware
EventId: 1
SpanId: 838a3b2c8e272cfe
TraceId: b909d17a0802fac1f4bee7e08fd808e7
ParentId: 0000000000000000
RequestId: 400047cf-0000-dd00-b63f-84710c7967bb
RequestPath: /api/navmap/sprk_document/sprk_matter_document/lookup

An unhandled exception has occurred while executing the request.

Exception: 
Microsoft.PowerPlatform.Dataverse.Client.Utils.DataverseConnectionException: Failed to connect to Dataverse
 ---&gt; System.Exception: ExternalTokenManagement Authentication Requested but not configured correctly. 003
 ---&gt; Azure.Identity.AuthenticationFailedException: ManagedIdentityCredential authentication failed: Service request failed.
Status: 400 (Bad Request)

Content:
{"statusCode":400,"message":"No User Assigned or Delegated Managed Identity found for specified ClientId/ResourceId/PrincipalId.","correlationId":"aa7bc179-e900-493c-8af1-dbc82a15e87e"}

Headers:
Date: Mon, 20 Oct 2025 14:53:06 GMT
Server: Kestrel
Transfer-Encoding: chunked
X-CORRELATION-ID: REDACTED
Content-Type: application/json; charset=utf-8

See the troubleshooting guide for more information. https://aka.ms/azsdk/net/identity/managedidentitycredential/troubleshoot
 ---&gt; Azure.RequestFailedException: Service request failed.
Status: 400 (Bad Request)

Content:
{"statusCode":400,"message":"No User Assigned or Delegated Managed Identity found for specified ClientId/ResourceId/PrincipalId.","correlationId":"aa7bc179-e900-493c-8af1-dbc82a15e87e"}

Headers:
Date: Mon, 20 Oct 2025 14:53:06 GMT
Server: Kestrel
Transfer-Encoding: chunked
X-CORRELATION-ID: REDACTED
Content-Type: application/json; charset=utf-8

   at Azure.Identity.ManagedIdentitySource.HandleResponseAsync(Boolean async, TokenRequestContext context, HttpMessage message, CancellationToken cancellationToken)
   at Azure.Identity.ManagedIdentitySource.AuthenticateAsync(Boolean async, TokenRequestContext context, CancellationToken cancellationToken)
   at Azure.Identity.ManagedIdentityClient.AuthenticateCoreAsync(Boolean async, TokenRequestContext context, CancellationToken cancellationToken)
   at Azure.Identity.ManagedIdentityClient.AppTokenProviderImpl(AppTokenProviderParameters parameters)
   at Microsoft.Identity.Client.Internal.Requests.ClientCredentialRequest.SendTokenRequestToAppTokenProviderAsync(ILoggerAdapter logger, CancellationToken cancellationToken)
   at Microsoft.Identity.Client.Internal.Requests.ClientCredentialRequest.GetAccessTokenAsync(CancellationToken cancellationToken, ILoggerAdapter logger)
   at Microsoft.Identity.Client.Internal.Requests.ClientCredentialRequest.ExecuteAsync(CancellationToken cancellationToken)
   at Microsoft.Identity.Client.Internal.Requests.RequestBase.&lt;&gt;c__DisplayClass11_1.&lt;&lt;RunAsync&gt;b__1&gt;d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.Identity.Client.Utils.StopwatchService.MeasureCodeBlockAsync(Func`1 codeBlock)
   at Microsoft.Identity.Client.Internal.Requests.RequestBase.RunAsync(CancellationToken cancellationToken)
   at Microsoft.Identity.Client.ApiConfig.Executors.ConfidentialClientExecutor.ExecuteAsync(AcquireTokenCommonParameters commonParameters, AcquireTokenForClientParameters clientParameters, CancellationToken cancellationToken)
   at Azure.Identity.AbstractAcquireTokenParameterBuilderExtensions.ExecuteAsync[T](AbstractAcquireTokenParameterBuilder`1 builder, Boolean async, CancellationToken cancellationToken)
   at Azure.Identity.MsalConfidentialClient.AcquireTokenForClientCoreAsync(String[] scopes, String tenantId, String claims, Boolean enableCae, Boolean async, CancellationToken cancellationToken)
   at Azure.Identity.MsalConfidentialClient.AcquireTokenForClientAsync(String[] scopes, String tenantId, String claims, Boolean enableCae, Boolean async, CancellationToken cancellationToken)
   at Azure.Identity.ManagedIdentityClient.AuthenticateAsync(Boolean async, TokenRequestContext context, CancellationToken cancellationToken)
   at Azure.Identity.ManagedIdentityCredential.GetTokenImplAsync(Boolean async, TokenRequestContext requestContext, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Azure.Identity.CredentialDiagnosticScope.FailWrapAndThrow(Exception ex, String additionalMessage, Boolean isCredentialUnavailable)
   at Azure.Identity.ManagedIdentityCredential.GetTokenImplAsync(Boolean async, TokenRequestContext requestContext, CancellationToken cancellationToken)
   at Azure.Identity.ManagedIdentityCredential.GetTokenAsync(TokenRequestContext requestContext, CancellationToken cancellationToken)
   at Spaarke.Dataverse.DataverseServiceClientImpl.&lt;&gt;c__DisplayClass3_0.&lt;&lt;-ctor&gt;b__0&gt;d.MoveNext() in C:\code_files\spaarke\src\shared\Spaarke.Dataverse\DataverseServiceClientImpl.cs:line 61
--- End of stack trace from previous location ---
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.ConnectAndInitServiceAsync(OrganizationDetail orgdata, Boolean IsOnPrem, Uri homeRealmUri)
   --- End of inner exception stack trace ---
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.ConnectAndInitServiceAsync(OrganizationDetail orgdata, Boolean IsOnPrem, Uri homeRealmUri)
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.DoDirectLoginAsync(Boolean IsOnPrem)
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.InitServiceAsync()
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.GetCachedService(ConnectionService&amp; ConnectionObject)
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.IntilizeService(ConnectionService&amp; ConnectionObject)
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.DoLogin(ConnectionService&amp; ConnectionObject)
   at Microsoft.PowerPlatform.Dataverse.Client.ServiceClient.CreateServiceConnection(Object externalOrgServiceProxy, AuthenticationType requestedAuthType, String hostName, String port, String orgName, NetworkCredential credential, String userId, SecureString password, String domain, String Geo, String claimsHomeRealm, Boolean useSsl, Boolean useUniqueInstance, OrganizationDetail orgDetail, String clientId, Uri redirectUri, PromptBehavior promptBehavior, OrganizationWebProxyClientAsync externalOrgWebProxyClient, String certificateThumbPrint, StoreName certificateStoreName, X509Certificate2 certificate, Uri instanceUrl, Boolean isCloned, Boolean useDefaultCreds, Version incomingOrgVersion, ILogger externalLogger, String tokenCacheStorePath)
   --- End of inner exception stack trace ---
   at Microsoft.PowerPlatform.Dataverse.Client.ServiceClient.CreateServiceConnection(Object externalOrgServiceProxy, AuthenticationType requestedAuthType, String hostName, String port, String orgName, NetworkCredential credential, String userId, SecureString password, String domain, String Geo, String claimsHomeRealm, Boolean useSsl, Boolean useUniqueInstance, OrganizationDetail orgDetail, String clientId, Uri redirectUri, PromptBehavior promptBehavior, OrganizationWebProxyClientAsync externalOrgWebProxyClient, String certificateThumbPrint, StoreName certificateStoreName, X509Certificate2 certificate, Uri instanceUrl, Boolean isCloned, Boolean useDefaultCreds, Version incomingOrgVersion, ILogger externalLogger, String tokenCacheStorePath)
   at Microsoft.PowerPlatform.Dataverse.Client.ServiceClient..ctor(Uri instanceUrl, Func`2 tokenProviderFunction, Boolean useUniqueInstance, ILogger logger)
   at Spaarke.Dataverse.DataverseServiceClientImpl..ctor(IConfiguration configuration, ILogger`1 logger) in C:\code_files\spaarke\src\shared\Spaarke.Dataverse\DataverseServiceClientImpl.cs:line 56
   at Program.&lt;&gt;c.&lt;&lt;Main&gt;$&gt;b__0_2(IServiceProvider sp) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Program.cs:line 267
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitRootCache(ServiceCallSite callSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.Resolve(ServiceCallSite callSite, ServiceProviderEngineScope scope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method70(Closure, IServiceProvider, Object[])
   at Microsoft.Extensions.Http.DefaultTypedHttpClientFactory`1.CreateClient(HttpClient httpClient)
   at Microsoft.Extensions.DependencyInjection.HttpClientBuilderExtensions.AddTransientHelper[TClient,TImplementation](IServiceProvider s, IHttpClientBuilder builder)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitCache(ServiceCallSite callSite, RuntimeResolverContext context, ServiceProviderEngineScope serviceProviderEngine, RuntimeResolverLock lockType)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitCache(ServiceCallSite callSite, RuntimeResolverContext context, ServiceProviderEngineScope serviceProviderEngine, RuntimeResolverLock lockType)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitIEnumerable(IEnumerableCallSite enumerableCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.Resolve(ServiceCallSite callSite, ServiceProviderEngineScope scope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.DynamicServiceProviderEngine.&lt;&gt;c__DisplayClass2_0.&lt;RealizeService&gt;b__0(ServiceProviderEngineScope scope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Spe.Bff.Api.Api.SecurityHeadersMiddleware.Invoke(HttpContext ctx) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Api\SecurityHeadersMiddleware.cs:line 21
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T14:53:47Z"/><EventRecordID>1459503890</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.IdentityModel.LoggingExtensions.IdentityLoggerAdapter
EventId: 0
SpanId: 9b80e52d29a2b863
TraceId: 6bde3db535b87d7dc5e68093dacb7bb7
ParentId: 0000000000000000
RequestId: 40003cdd-0000-cf00-b63f-84710c7967bb
RequestPath: /api/navmap/sprk_document/sprk_matter_document/lookup

IDX14100: JWT is not well formed, there are no dots (.).
The token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EncodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T14:53:51Z"/><EventRecordID>1459507906</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Spaarke.Dataverse.DataverseServiceClientImpl
EventId: 0
SpanId: 9b80e52d29a2b863
TraceId: 6bde3db535b87d7dc5e68093dacb7bb7
ParentId: 0000000000000000
RequestId: 40003cdd-0000-cf00-b63f-84710c7967bb
RequestPath: /api/navmap/sprk_document/sprk_matter_document/lookup

Exception initializing Dataverse ServiceClient

Exception: 
Microsoft.PowerPlatform.Dataverse.Client.Utils.DataverseConnectionException: Failed to connect to Dataverse
 ---&gt; System.Exception: ExternalTokenManagement Authentication Requested but not configured correctly. 003
 ---&gt; Azure.Identity.AuthenticationFailedException: ManagedIdentityCredential authentication failed: Service request failed.
Status: 400 (Bad Request)

Content:
{"statusCode":400,"message":"No User Assigned or Delegated Managed Identity found for specified ClientId/ResourceId/PrincipalId.","correlationId":"3de9da3a-31d6-4151-8f65-dfe84f19332e"}

Headers:
Date: Mon, 20 Oct 2025 14:53:46 GMT
Server: Kestrel
Transfer-Encoding: chunked
X-CORRELATION-ID: REDACTED
Content-Type: application/json; charset=utf-8

See the troubleshooting guide for more information. https://aka.ms/azsdk/net/identity/managedidentitycredential/troubleshoot
 ---&gt; Azure.RequestFailedException: Service request failed.
Status: 400 (Bad Request)

Content:
{"statusCode":400,"message":"No User Assigned or Delegated Managed Identity found for specified ClientId/ResourceId/PrincipalId.","correlationId":"3de9da3a-31d6-4151-8f65-dfe84f19332e"}

Headers:
Date: Mon, 20 Oct 2025 14:53:46 GMT
Server: Kestrel
Transfer-Encoding: chunked
X-CORRELATION-ID: REDACTED
Content-Type: application/json; charset=utf-8

   at Azure.Identity.ManagedIdentitySource.HandleResponseAsync(Boolean async, TokenRequestContext context, HttpMessage message, CancellationToken cancellationToken)
   at Azure.Identity.ManagedIdentitySource.AuthenticateAsync(Boolean async, TokenRequestContext context, CancellationToken cancellationToken)
   at Azure.Identity.ManagedIdentityClient.AuthenticateCoreAsync(Boolean async, TokenRequestContext context, CancellationToken cancellationToken)
   at Azure.Identity.ManagedIdentityClient.AppTokenProviderImpl(AppTokenProviderParameters parameters)
   at Microsoft.Identity.Client.Internal.Requests.ClientCredentialRequest.SendTokenRequestToAppTokenProviderAsync(ILoggerAdapter logger, CancellationToken cancellationToken)
   at Microsoft.Identity.Client.Internal.Requests.ClientCredentialRequest.GetAccessTokenAsync(CancellationToken cancellationToken, ILoggerAdapter logger)
   at Microsoft.Identity.Client.Internal.Requests.ClientCredentialRequest.ExecuteAsync(CancellationToken cancellationToken)
   at Microsoft.Identity.Client.Internal.Requests.RequestBase.&lt;&gt;c__DisplayClass11_1.&lt;&lt;RunAsync&gt;b__1&gt;d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.Identity.Client.Utils.StopwatchService.MeasureCodeBlockAsync(Func`1 codeBlock)
   at Microsoft.Identity.Client.Internal.Requests.RequestBase.RunAsync(CancellationToken cancellationToken)
   at Microsoft.Identity.Client.ApiConfig.Executors.ConfidentialClientExecutor.ExecuteAsync(AcquireTokenCommonParameters commonParameters, AcquireTokenForClientParameters clientParameters, CancellationToken cancellationToken)
   at Azure.Identity.AbstractAcquireTokenParameterBuilderExtensions.ExecuteAsync[T](AbstractAcquireTokenParameterBuilder`1 builder, Boolean async, CancellationToken cancellationToken)
   at Azure.Identity.MsalConfidentialClient.AcquireTokenForClientCoreAsync(String[] scopes, String tenantId, String claims, Boolean enableCae, Boolean async, CancellationToken cancellationToken)
   at Azure.Identity.MsalConfidentialClient.AcquireTokenForClientAsync(String[] scopes, String tenantId, String claims, Boolean enableCae, Boolean async, CancellationToken cancellationToken)
   at Azure.Identity.ManagedIdentityClient.AuthenticateAsync(Boolean async, TokenRequestContext context, CancellationToken cancellationToken)
   at Azure.Identity.ManagedIdentityCredential.GetTokenImplAsync(Boolean async, TokenRequestContext requestContext, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Azure.Identity.CredentialDiagnosticScope.FailWrapAndThrow(Exception ex, String additionalMessage, Boolean isCredentialUnavailable)
   at Azure.Identity.ManagedIdentityCredential.GetTokenImplAsync(Boolean async, TokenRequestContext requestContext, CancellationToken cancellationToken)
   at Azure.Identity.ManagedIdentityCredential.GetTokenAsync(TokenRequestContext requestContext, CancellationToken cancellationToken)
   at Spaarke.Dataverse.DataverseServiceClientImpl.&lt;&gt;c__DisplayClass3_0.&lt;&lt;-ctor&gt;b__0&gt;d.MoveNext() in C:\code_files\spaarke\src\shared\Spaarke.Dataverse\DataverseServiceClientImpl.cs:line 61
--- End of stack trace from previous location ---
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.ConnectAndInitServiceAsync(OrganizationDetail orgdata, Boolean IsOnPrem, Uri homeRealmUri)
   --- End of inner exception stack trace ---
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.ConnectAndInitServiceAsync(OrganizationDetail orgdata, Boolean IsOnPrem, Uri homeRealmUri)
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.DoDirectLoginAsync(Boolean IsOnPrem)
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.InitServiceAsync()
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.GetCachedService(ConnectionService&amp; ConnectionObject)
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.IntilizeService(ConnectionService&amp; ConnectionObject)
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.DoLogin(ConnectionService&amp; ConnectionObject)
   at Microsoft.PowerPlatform.Dataverse.Client.ServiceClient.CreateServiceConnection(Object externalOrgServiceProxy, AuthenticationType requestedAuthType, String hostName, String port, String orgName, NetworkCredential credential, String userId, SecureString password, String domain, String Geo, String claimsHomeRealm, Boolean useSsl, Boolean useUniqueInstance, OrganizationDetail orgDetail, String clientId, Uri redirectUri, PromptBehavior promptBehavior, OrganizationWebProxyClientAsync externalOrgWebProxyClient, String certificateThumbPrint, StoreName certificateStoreName, X509Certificate2 certificate, Uri instanceUrl, Boolean isCloned, Boolean useDefaultCreds, Version incomingOrgVersion, ILogger externalLogger, String tokenCacheStorePath)
   --- End of inner exception stack trace ---
   at Microsoft.PowerPlatform.Dataverse.Client.ServiceClient.CreateServiceConnection(Object externalOrgServiceProxy, AuthenticationType requestedAuthType, String hostName, String port, String orgName, NetworkCredential credential, String userId, SecureString password, String domain, String Geo, String claimsHomeRealm, Boolean useSsl, Boolean useUniqueInstance, OrganizationDetail orgDetail, String clientId, Uri redirectUri, PromptBehavior promptBehavior, OrganizationWebProxyClientAsync externalOrgWebProxyClient, String certificateThumbPrint, StoreName certificateStoreName, X509Certificate2 certificate, Uri instanceUrl, Boolean isCloned, Boolean useDefaultCreds, Version incomingOrgVersion, ILogger externalLogger, String tokenCacheStorePath)
   at Microsoft.PowerPlatform.Dataverse.Client.ServiceClient..ctor(Uri instanceUrl, Func`2 tokenProviderFunction, Boolean useUniqueInstance, ILogger logger)
   at Spaarke.Dataverse.DataverseServiceClientImpl..ctor(IConfiguration configuration, ILogger`1 logger) in C:\code_files\spaarke\src\shared\Spaarke.Dataverse\DataverseServiceClientImpl.cs:line 56
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T14:53:52Z"/><EventRecordID>1459509031</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware
EventId: 1
SpanId: 9b80e52d29a2b863
TraceId: 6bde3db535b87d7dc5e68093dacb7bb7
ParentId: 0000000000000000
RequestId: 40003cdd-0000-cf00-b63f-84710c7967bb
RequestPath: /api/navmap/sprk_document/sprk_matter_document/lookup

An unhandled exception has occurred while executing the request.

Exception: 
Microsoft.PowerPlatform.Dataverse.Client.Utils.DataverseConnectionException: Failed to connect to Dataverse
 ---&gt; System.Exception: ExternalTokenManagement Authentication Requested but not configured correctly. 003
 ---&gt; Azure.Identity.AuthenticationFailedException: ManagedIdentityCredential authentication failed: Service request failed.
Status: 400 (Bad Request)

Content:
{"statusCode":400,"message":"No User Assigned or Delegated Managed Identity found for specified ClientId/ResourceId/PrincipalId.","correlationId":"3de9da3a-31d6-4151-8f65-dfe84f19332e"}

Headers:
Date: Mon, 20 Oct 2025 14:53:46 GMT
Server: Kestrel
Transfer-Encoding: chunked
X-CORRELATION-ID: REDACTED
Content-Type: application/json; charset=utf-8

See the troubleshooting guide for more information. https://aka.ms/azsdk/net/identity/managedidentitycredential/troubleshoot
 ---&gt; Azure.RequestFailedException: Service request failed.
Status: 400 (Bad Request)

Content:
{"statusCode":400,"message":"No User Assigned or Delegated Managed Identity found for specified ClientId/ResourceId/PrincipalId.","correlationId":"3de9da3a-31d6-4151-8f65-dfe84f19332e"}

Headers:
Date: Mon, 20 Oct 2025 14:53:46 GMT
Server: Kestrel
Transfer-Encoding: chunked
X-CORRELATION-ID: REDACTED
Content-Type: application/json; charset=utf-8

   at Azure.Identity.ManagedIdentitySource.HandleResponseAsync(Boolean async, TokenRequestContext context, HttpMessage message, CancellationToken cancellationToken)
   at Azure.Identity.ManagedIdentitySource.AuthenticateAsync(Boolean async, TokenRequestContext context, CancellationToken cancellationToken)
   at Azure.Identity.ManagedIdentityClient.AuthenticateCoreAsync(Boolean async, TokenRequestContext context, CancellationToken cancellationToken)
   at Azure.Identity.ManagedIdentityClient.AppTokenProviderImpl(AppTokenProviderParameters parameters)
   at Microsoft.Identity.Client.Internal.Requests.ClientCredentialRequest.SendTokenRequestToAppTokenProviderAsync(ILoggerAdapter logger, CancellationToken cancellationToken)
   at Microsoft.Identity.Client.Internal.Requests.ClientCredentialRequest.GetAccessTokenAsync(CancellationToken cancellationToken, ILoggerAdapter logger)
   at Microsoft.Identity.Client.Internal.Requests.ClientCredentialRequest.ExecuteAsync(CancellationToken cancellationToken)
   at Microsoft.Identity.Client.Internal.Requests.RequestBase.&lt;&gt;c__DisplayClass11_1.&lt;&lt;RunAsync&gt;b__1&gt;d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.Identity.Client.Utils.StopwatchService.MeasureCodeBlockAsync(Func`1 codeBlock)
   at Microsoft.Identity.Client.Internal.Requests.RequestBase.RunAsync(CancellationToken cancellationToken)
   at Microsoft.Identity.Client.ApiConfig.Executors.ConfidentialClientExecutor.ExecuteAsync(AcquireTokenCommonParameters commonParameters, AcquireTokenForClientParameters clientParameters, CancellationToken cancellationToken)
   at Azure.Identity.AbstractAcquireTokenParameterBuilderExtensions.ExecuteAsync[T](AbstractAcquireTokenParameterBuilder`1 builder, Boolean async, CancellationToken cancellationToken)
   at Azure.Identity.MsalConfidentialClient.AcquireTokenForClientCoreAsync(String[] scopes, String tenantId, String claims, Boolean enableCae, Boolean async, CancellationToken cancellationToken)
   at Azure.Identity.MsalConfidentialClient.AcquireTokenForClientAsync(String[] scopes, String tenantId, String claims, Boolean enableCae, Boolean async, CancellationToken cancellationToken)
   at Azure.Identity.ManagedIdentityClient.AuthenticateAsync(Boolean async, TokenRequestContext context, CancellationToken cancellationToken)
   at Azure.Identity.ManagedIdentityCredential.GetTokenImplAsync(Boolean async, TokenRequestContext requestContext, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Azure.Identity.CredentialDiagnosticScope.FailWrapAndThrow(Exception ex, String additionalMessage, Boolean isCredentialUnavailable)
   at Azure.Identity.ManagedIdentityCredential.GetTokenImplAsync(Boolean async, TokenRequestContext requestContext, CancellationToken cancellationToken)
   at Azure.Identity.ManagedIdentityCredential.GetTokenAsync(TokenRequestContext requestContext, CancellationToken cancellationToken)
   at Spaarke.Dataverse.DataverseServiceClientImpl.&lt;&gt;c__DisplayClass3_0.&lt;&lt;-ctor&gt;b__0&gt;d.MoveNext() in C:\code_files\spaarke\src\shared\Spaarke.Dataverse\DataverseServiceClientImpl.cs:line 61
--- End of stack trace from previous location ---
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.ConnectAndInitServiceAsync(OrganizationDetail orgdata, Boolean IsOnPrem, Uri homeRealmUri)
   --- End of inner exception stack trace ---
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.ConnectAndInitServiceAsync(OrganizationDetail orgdata, Boolean IsOnPrem, Uri homeRealmUri)
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.DoDirectLoginAsync(Boolean IsOnPrem)
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.InitServiceAsync()
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.GetCachedService(ConnectionService&amp; ConnectionObject)
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.IntilizeService(ConnectionService&amp; ConnectionObject)
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.DoLogin(ConnectionService&amp; ConnectionObject)
   at Microsoft.PowerPlatform.Dataverse.Client.ServiceClient.CreateServiceConnection(Object externalOrgServiceProxy, AuthenticationType requestedAuthType, String hostName, String port, String orgName, NetworkCredential credential, String userId, SecureString password, String domain, String Geo, String claimsHomeRealm, Boolean useSsl, Boolean useUniqueInstance, OrganizationDetail orgDetail, String clientId, Uri redirectUri, PromptBehavior promptBehavior, OrganizationWebProxyClientAsync externalOrgWebProxyClient, String certificateThumbPrint, StoreName certificateStoreName, X509Certificate2 certificate, Uri instanceUrl, Boolean isCloned, Boolean useDefaultCreds, Version incomingOrgVersion, ILogger externalLogger, String tokenCacheStorePath)
   --- End of inner exception stack trace ---
   at Microsoft.PowerPlatform.Dataverse.Client.ServiceClient.CreateServiceConnection(Object externalOrgServiceProxy, AuthenticationType requestedAuthType, String hostName, String port, String orgName, NetworkCredential credential, String userId, SecureString password, String domain, String Geo, String claimsHomeRealm, Boolean useSsl, Boolean useUniqueInstance, OrganizationDetail orgDetail, String clientId, Uri redirectUri, PromptBehavior promptBehavior, OrganizationWebProxyClientAsync externalOrgWebProxyClient, String certificateThumbPrint, StoreName certificateStoreName, X509Certificate2 certificate, Uri instanceUrl, Boolean isCloned, Boolean useDefaultCreds, Version incomingOrgVersion, ILogger externalLogger, String tokenCacheStorePath)
   at Microsoft.PowerPlatform.Dataverse.Client.ServiceClient..ctor(Uri instanceUrl, Func`2 tokenProviderFunction, Boolean useUniqueInstance, ILogger logger)
   at Spaarke.Dataverse.DataverseServiceClientImpl..ctor(IConfiguration configuration, ILogger`1 logger) in C:\code_files\spaarke\src\shared\Spaarke.Dataverse\DataverseServiceClientImpl.cs:line 56
   at Program.&lt;&gt;c.&lt;&lt;Main&gt;$&gt;b__0_2(IServiceProvider sp) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Program.cs:line 267
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitRootCache(ServiceCallSite callSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.Resolve(ServiceCallSite callSite, ServiceProviderEngineScope scope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method70(Closure, IServiceProvider, Object[])
   at Microsoft.Extensions.Http.DefaultTypedHttpClientFactory`1.CreateClient(HttpClient httpClient)
   at Microsoft.Extensions.DependencyInjection.HttpClientBuilderExtensions.AddTransientHelper[TClient,TImplementation](IServiceProvider s, IHttpClientBuilder builder)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitCache(ServiceCallSite callSite, RuntimeResolverContext context, ServiceProviderEngineScope serviceProviderEngine, RuntimeResolverLock lockType)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitCache(ServiceCallSite callSite, RuntimeResolverContext context, ServiceProviderEngineScope serviceProviderEngine, RuntimeResolverLock lockType)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitIEnumerable(IEnumerableCallSite enumerableCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.Resolve(ServiceCallSite callSite, ServiceProviderEngineScope scope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.DynamicServiceProviderEngine.&lt;&gt;c__DisplayClass2_0.&lt;RealizeService&gt;b__0(ServiceProviderEngineScope scope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Spe.Bff.Api.Api.SecurityHeadersMiddleware.Invoke(HttpContext ctx) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Api\SecurityHeadersMiddleware.cs:line 21
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T15:09:53Z"/><EventRecordID>1460470312</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 9

BackgroundService failed

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\ServiceBusJobProcessor.cs:line 72
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T15:09:54Z"/><EventRecordID>1460470359</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 10

The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\ServiceBusJobProcessor.cs:line 72
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T15:09:57Z"/><EventRecordID>1460473343</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 9

BackgroundService failed

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.DocumentEventProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\DocumentEventProcessor.cs:line 68
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T15:09:57Z"/><EventRecordID>1460473703</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 10

The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.DocumentEventProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\DocumentEventProcessor.cs:line 68
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1005</EventID><Level>2</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T15:10:02Z"/><EventRecordID>1460479218</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Failed to gracefully shutdown application 'MACHINE/WEBROOT/APPHOST/SPE-API-DEV-67E2XZ'.</Data><Data>Process Id: 3304.</Data><Data>File Version: 18.0.25232.20. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1032</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T15:10:52Z"/><EventRecordID>1460528562</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Application 'C:\home\site\wwwroot\' started successfully.</Data><Data>Process Id: 8176.</Data><Data>File Version: 18.0.25232.20. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T15:10:57Z"/><EventRecordID>1460533765</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Spaarke.Dataverse.DataverseServiceClientImpl
EventId: 0
SpanId: 435d623499eccb55
TraceId: 8be28026aef0abf38d4a410b6b54746b
ParentId: 0000000000000000
RequestId: 40001e70-0000-e200-b63f-84710c7967bb
RequestPath: /api/navmap/sprk_document/sprk_matter_document/lookup

Exception initializing Dataverse ServiceClient

Exception: 
Microsoft.PowerPlatform.Dataverse.Client.Utils.DataverseConnectionException: Failed to connect to Dataverse
 ---&gt; System.Exception: ExternalTokenManagement Authentication Requested but not configured correctly. 003
 ---&gt; Azure.Identity.AuthenticationFailedException: ManagedIdentityCredential authentication failed: Service request failed.
Status: 400 (Bad Request)

Content:
{"statusCode":400,"message":"No User Assigned or Delegated Managed Identity found for specified ClientId/ResourceId/PrincipalId.","correlationId":"a10ef9f9-bd29-4475-a492-34ca33c9aa7d"}

Headers:
Date: Mon, 20 Oct 2025 15:10:55 GMT
Server: Kestrel
Transfer-Encoding: chunked
X-CORRELATION-ID: REDACTED
Content-Type: application/json; charset=utf-8

See the troubleshooting guide for more information. https://aka.ms/azsdk/net/identity/managedidentitycredential/troubleshoot
 ---&gt; Azure.RequestFailedException: Service request failed.
Status: 400 (Bad Request)

Content:
{"statusCode":400,"message":"No User Assigned or Delegated Managed Identity found for specified ClientId/ResourceId/PrincipalId.","correlationId":"a10ef9f9-bd29-4475-a492-34ca33c9aa7d"}

Headers:
Date: Mon, 20 Oct 2025 15:10:55 GMT
Server: Kestrel
Transfer-Encoding: chunked
X-CORRELATION-ID: REDACTED
Content-Type: application/json; charset=utf-8

   at Azure.Identity.ManagedIdentitySource.HandleResponseAsync(Boolean async, TokenRequestContext context, HttpMessage message, CancellationToken cancellationToken)
   at Azure.Identity.ManagedIdentitySource.AuthenticateAsync(Boolean async, TokenRequestContext context, CancellationToken cancellationToken)
   at Azure.Identity.ManagedIdentityClient.AuthenticateCoreAsync(Boolean async, TokenRequestContext context, CancellationToken cancellationToken)
   at Azure.Identity.ManagedIdentityClient.AppTokenProviderImpl(AppTokenProviderParameters parameters)
   at Microsoft.Identity.Client.Internal.Requests.ClientCredentialRequest.SendTokenRequestToAppTokenProviderAsync(ILoggerAdapter logger, CancellationToken cancellationToken)
   at Microsoft.Identity.Client.Internal.Requests.ClientCredentialRequest.GetAccessTokenAsync(CancellationToken cancellationToken, ILoggerAdapter logger)
   at Microsoft.Identity.Client.Internal.Requests.ClientCredentialRequest.ExecuteAsync(CancellationToken cancellationToken)
   at Microsoft.Identity.Client.Internal.Requests.RequestBase.&lt;&gt;c__DisplayClass11_1.&lt;&lt;RunAsync&gt;b__1&gt;d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.Identity.Client.Utils.StopwatchService.MeasureCodeBlockAsync(Func`1 codeBlock)
   at Microsoft.Identity.Client.Internal.Requests.RequestBase.RunAsync(CancellationToken cancellationToken)
   at Microsoft.Identity.Client.ApiConfig.Executors.ConfidentialClientExecutor.ExecuteAsync(AcquireTokenCommonParameters commonParameters, AcquireTokenForClientParameters clientParameters, CancellationToken cancellationToken)
   at Azure.Identity.AbstractAcquireTokenParameterBuilderExtensions.ExecuteAsync[T](AbstractAcquireTokenParameterBuilder`1 builder, Boolean async, CancellationToken cancellationToken)
   at Azure.Identity.MsalConfidentialClient.AcquireTokenForClientCoreAsync(String[] scopes, String tenantId, String claims, Boolean enableCae, Boolean async, CancellationToken cancellationToken)
   at Azure.Identity.MsalConfidentialClient.AcquireTokenForClientAsync(String[] scopes, String tenantId, String claims, Boolean enableCae, Boolean async, CancellationToken cancellationToken)
   at Azure.Identity.ManagedIdentityClient.AuthenticateAsync(Boolean async, TokenRequestContext context, CancellationToken cancellationToken)
   at Azure.Identity.ManagedIdentityCredential.GetTokenImplAsync(Boolean async, TokenRequestContext requestContext, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Azure.Identity.CredentialDiagnosticScope.FailWrapAndThrow(Exception ex, String additionalMessage, Boolean isCredentialUnavailable)
   at Azure.Identity.ManagedIdentityCredential.GetTokenImplAsync(Boolean async, TokenRequestContext requestContext, CancellationToken cancellationToken)
   at Azure.Identity.ManagedIdentityCredential.GetTokenAsync(TokenRequestContext requestContext, CancellationToken cancellationToken)
   at Spaarke.Dataverse.DataverseServiceClientImpl.&lt;&gt;c__DisplayClass3_0.&lt;&lt;-ctor&gt;b__0&gt;d.MoveNext() in C:\code_files\spaarke\src\shared\Spaarke.Dataverse\DataverseServiceClientImpl.cs:line 61
--- End of stack trace from previous location ---
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.ConnectAndInitServiceAsync(OrganizationDetail orgdata, Boolean IsOnPrem, Uri homeRealmUri)
   --- End of inner exception stack trace ---
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.ConnectAndInitServiceAsync(OrganizationDetail orgdata, Boolean IsOnPrem, Uri homeRealmUri)
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.DoDirectLoginAsync(Boolean IsOnPrem)
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.InitServiceAsync()
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.GetCachedService(ConnectionService&amp; ConnectionObject)
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.IntilizeService(ConnectionService&amp; ConnectionObject)
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.DoLogin(ConnectionService&amp; ConnectionObject)
   at Microsoft.PowerPlatform.Dataverse.Client.ServiceClient.CreateServiceConnection(Object externalOrgServiceProxy, AuthenticationType requestedAuthType, String hostName, String port, String orgName, NetworkCredential credential, String userId, SecureString password, String domain, String Geo, String claimsHomeRealm, Boolean useSsl, Boolean useUniqueInstance, OrganizationDetail orgDetail, String clientId, Uri redirectUri, PromptBehavior promptBehavior, OrganizationWebProxyClientAsync externalOrgWebProxyClient, String certificateThumbPrint, StoreName certificateStoreName, X509Certificate2 certificate, Uri instanceUrl, Boolean isCloned, Boolean useDefaultCreds, Version incomingOrgVersion, ILogger externalLogger, String tokenCacheStorePath)
   --- End of inner exception stack trace ---
   at Microsoft.PowerPlatform.Dataverse.Client.ServiceClient.CreateServiceConnection(Object externalOrgServiceProxy, AuthenticationType requestedAuthType, String hostName, String port, String orgName, NetworkCredential credential, String userId, SecureString password, String domain, String Geo, String claimsHomeRealm, Boolean useSsl, Boolean useUniqueInstance, OrganizationDetail orgDetail, String clientId, Uri redirectUri, PromptBehavior promptBehavior, OrganizationWebProxyClientAsync externalOrgWebProxyClient, String certificateThumbPrint, StoreName certificateStoreName, X509Certificate2 certificate, Uri instanceUrl, Boolean isCloned, Boolean useDefaultCreds, Version incomingOrgVersion, ILogger externalLogger, String tokenCacheStorePath)
   at Microsoft.PowerPlatform.Dataverse.Client.ServiceClient..ctor(Uri instanceUrl, Func`2 tokenProviderFunction, Boolean useUniqueInstance, ILogger logger)
   at Spaarke.Dataverse.DataverseServiceClientImpl..ctor(IConfiguration configuration, ILogger`1 logger) in C:\code_files\spaarke\src\shared\Spaarke.Dataverse\DataverseServiceClientImpl.cs:line 56
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T15:10:58Z"/><EventRecordID>1460534734</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware
EventId: 1
SpanId: 435d623499eccb55
TraceId: 8be28026aef0abf38d4a410b6b54746b
ParentId: 0000000000000000
RequestId: 40001e70-0000-e200-b63f-84710c7967bb
RequestPath: /api/navmap/sprk_document/sprk_matter_document/lookup

An unhandled exception has occurred while executing the request.

Exception: 
Microsoft.PowerPlatform.Dataverse.Client.Utils.DataverseConnectionException: Failed to connect to Dataverse
 ---&gt; System.Exception: ExternalTokenManagement Authentication Requested but not configured correctly. 003
 ---&gt; Azure.Identity.AuthenticationFailedException: ManagedIdentityCredential authentication failed: Service request failed.
Status: 400 (Bad Request)

Content:
{"statusCode":400,"message":"No User Assigned or Delegated Managed Identity found for specified ClientId/ResourceId/PrincipalId.","correlationId":"a10ef9f9-bd29-4475-a492-34ca33c9aa7d"}

Headers:
Date: Mon, 20 Oct 2025 15:10:55 GMT
Server: Kestrel
Transfer-Encoding: chunked
X-CORRELATION-ID: REDACTED
Content-Type: application/json; charset=utf-8

See the troubleshooting guide for more information. https://aka.ms/azsdk/net/identity/managedidentitycredential/troubleshoot
 ---&gt; Azure.RequestFailedException: Service request failed.
Status: 400 (Bad Request)

Content:
{"statusCode":400,"message":"No User Assigned or Delegated Managed Identity found for specified ClientId/ResourceId/PrincipalId.","correlationId":"a10ef9f9-bd29-4475-a492-34ca33c9aa7d"}

Headers:
Date: Mon, 20 Oct 2025 15:10:55 GMT
Server: Kestrel
Transfer-Encoding: chunked
X-CORRELATION-ID: REDACTED
Content-Type: application/json; charset=utf-8

   at Azure.Identity.ManagedIdentitySource.HandleResponseAsync(Boolean async, TokenRequestContext context, HttpMessage message, CancellationToken cancellationToken)
   at Azure.Identity.ManagedIdentitySource.AuthenticateAsync(Boolean async, TokenRequestContext context, CancellationToken cancellationToken)
   at Azure.Identity.ManagedIdentityClient.AuthenticateCoreAsync(Boolean async, TokenRequestContext context, CancellationToken cancellationToken)
   at Azure.Identity.ManagedIdentityClient.AppTokenProviderImpl(AppTokenProviderParameters parameters)
   at Microsoft.Identity.Client.Internal.Requests.ClientCredentialRequest.SendTokenRequestToAppTokenProviderAsync(ILoggerAdapter logger, CancellationToken cancellationToken)
   at Microsoft.Identity.Client.Internal.Requests.ClientCredentialRequest.GetAccessTokenAsync(CancellationToken cancellationToken, ILoggerAdapter logger)
   at Microsoft.Identity.Client.Internal.Requests.ClientCredentialRequest.ExecuteAsync(CancellationToken cancellationToken)
   at Microsoft.Identity.Client.Internal.Requests.RequestBase.&lt;&gt;c__DisplayClass11_1.&lt;&lt;RunAsync&gt;b__1&gt;d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.Identity.Client.Utils.StopwatchService.MeasureCodeBlockAsync(Func`1 codeBlock)
   at Microsoft.Identity.Client.Internal.Requests.RequestBase.RunAsync(CancellationToken cancellationToken)
   at Microsoft.Identity.Client.ApiConfig.Executors.ConfidentialClientExecutor.ExecuteAsync(AcquireTokenCommonParameters commonParameters, AcquireTokenForClientParameters clientParameters, CancellationToken cancellationToken)
   at Azure.Identity.AbstractAcquireTokenParameterBuilderExtensions.ExecuteAsync[T](AbstractAcquireTokenParameterBuilder`1 builder, Boolean async, CancellationToken cancellationToken)
   at Azure.Identity.MsalConfidentialClient.AcquireTokenForClientCoreAsync(String[] scopes, String tenantId, String claims, Boolean enableCae, Boolean async, CancellationToken cancellationToken)
   at Azure.Identity.MsalConfidentialClient.AcquireTokenForClientAsync(String[] scopes, String tenantId, String claims, Boolean enableCae, Boolean async, CancellationToken cancellationToken)
   at Azure.Identity.ManagedIdentityClient.AuthenticateAsync(Boolean async, TokenRequestContext context, CancellationToken cancellationToken)
   at Azure.Identity.ManagedIdentityCredential.GetTokenImplAsync(Boolean async, TokenRequestContext requestContext, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Azure.Identity.CredentialDiagnosticScope.FailWrapAndThrow(Exception ex, String additionalMessage, Boolean isCredentialUnavailable)
   at Azure.Identity.ManagedIdentityCredential.GetTokenImplAsync(Boolean async, TokenRequestContext requestContext, CancellationToken cancellationToken)
   at Azure.Identity.ManagedIdentityCredential.GetTokenAsync(TokenRequestContext requestContext, CancellationToken cancellationToken)
   at Spaarke.Dataverse.DataverseServiceClientImpl.&lt;&gt;c__DisplayClass3_0.&lt;&lt;-ctor&gt;b__0&gt;d.MoveNext() in C:\code_files\spaarke\src\shared\Spaarke.Dataverse\DataverseServiceClientImpl.cs:line 61
--- End of stack trace from previous location ---
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.ConnectAndInitServiceAsync(OrganizationDetail orgdata, Boolean IsOnPrem, Uri homeRealmUri)
   --- End of inner exception stack trace ---
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.ConnectAndInitServiceAsync(OrganizationDetail orgdata, Boolean IsOnPrem, Uri homeRealmUri)
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.DoDirectLoginAsync(Boolean IsOnPrem)
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.InitServiceAsync()
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.GetCachedService(ConnectionService&amp; ConnectionObject)
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.IntilizeService(ConnectionService&amp; ConnectionObject)
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.DoLogin(ConnectionService&amp; ConnectionObject)
   at Microsoft.PowerPlatform.Dataverse.Client.ServiceClient.CreateServiceConnection(Object externalOrgServiceProxy, AuthenticationType requestedAuthType, String hostName, String port, String orgName, NetworkCredential credential, String userId, SecureString password, String domain, String Geo, String claimsHomeRealm, Boolean useSsl, Boolean useUniqueInstance, OrganizationDetail orgDetail, String clientId, Uri redirectUri, PromptBehavior promptBehavior, OrganizationWebProxyClientAsync externalOrgWebProxyClient, String certificateThumbPrint, StoreName certificateStoreName, X509Certificate2 certificate, Uri instanceUrl, Boolean isCloned, Boolean useDefaultCreds, Version incomingOrgVersion, ILogger externalLogger, String tokenCacheStorePath)
   --- End of inner exception stack trace ---
   at Microsoft.PowerPlatform.Dataverse.Client.ServiceClient.CreateServiceConnection(Object externalOrgServiceProxy, AuthenticationType requestedAuthType, String hostName, String port, String orgName, NetworkCredential credential, String userId, SecureString password, String domain, String Geo, String claimsHomeRealm, Boolean useSsl, Boolean useUniqueInstance, OrganizationDetail orgDetail, String clientId, Uri redirectUri, PromptBehavior promptBehavior, OrganizationWebProxyClientAsync externalOrgWebProxyClient, String certificateThumbPrint, StoreName certificateStoreName, X509Certificate2 certificate, Uri instanceUrl, Boolean isCloned, Boolean useDefaultCreds, Version incomingOrgVersion, ILogger externalLogger, String tokenCacheStorePath)
   at Microsoft.PowerPlatform.Dataverse.Client.ServiceClient..ctor(Uri instanceUrl, Func`2 tokenProviderFunction, Boolean useUniqueInstance, ILogger logger)
   at Spaarke.Dataverse.DataverseServiceClientImpl..ctor(IConfiguration configuration, ILogger`1 logger) in C:\code_files\spaarke\src\shared\Spaarke.Dataverse\DataverseServiceClientImpl.cs:line 56
   at Program.&lt;&gt;c.&lt;&lt;Main&gt;$&gt;b__0_2(IServiceProvider sp) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Program.cs:line 267
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitRootCache(ServiceCallSite callSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.Resolve(ServiceCallSite callSite, ServiceProviderEngineScope scope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method70(Closure, IServiceProvider, Object[])
   at Microsoft.Extensions.Http.DefaultTypedHttpClientFactory`1.CreateClient(HttpClient httpClient)
   at Microsoft.Extensions.DependencyInjection.HttpClientBuilderExtensions.AddTransientHelper[TClient,TImplementation](IServiceProvider s, IHttpClientBuilder builder)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitDisposeCache(ServiceCallSite transientCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitCache(ServiceCallSite callSite, RuntimeResolverContext context, ServiceProviderEngineScope serviceProviderEngine, RuntimeResolverLock lockType)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitScopeCache(ServiceCallSite callSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitCache(ServiceCallSite callSite, RuntimeResolverContext context, ServiceProviderEngineScope serviceProviderEngine, RuntimeResolverLock lockType)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitScopeCache(ServiceCallSite callSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitIEnumerable(IEnumerableCallSite enumerableCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitDisposeCache(ServiceCallSite transientCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitDisposeCache(ServiceCallSite transientCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitDisposeCache(ServiceCallSite transientCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.Resolve(ServiceCallSite callSite, ServiceProviderEngineScope scope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.DynamicServiceProviderEngine.&lt;&gt;c__DisplayClass2_0.&lt;RealizeService&gt;b__0(ServiceProviderEngineScope scope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Spe.Bff.Api.Api.SecurityHeadersMiddleware.Invoke(HttpContext ctx) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Api\SecurityHeadersMiddleware.cs:line 21
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T15:11:10Z"/><EventRecordID>1460547234</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Spaarke.Dataverse.DataverseServiceClientImpl
EventId: 0
SpanId: 9716667a24766ecd
TraceId: bc937367ea44b6433b5e428f97b23305
ParentId: 0000000000000000
RequestId: 40003628-0000-f100-b63f-84710c7967bb
RequestPath: /api/navmap/sprk_document/sprk_matter_document/lookup

Exception initializing Dataverse ServiceClient

Exception: 
Microsoft.PowerPlatform.Dataverse.Client.Utils.DataverseConnectionException: Failed to connect to Dataverse
 ---&gt; System.Exception: ExternalTokenManagement Authentication Requested but not configured correctly. 003
 ---&gt; Azure.Identity.AuthenticationFailedException: ManagedIdentityCredential authentication failed: Service request failed.
Status: 400 (Bad Request)

Content:
{"statusCode":400,"message":"No User Assigned or Delegated Managed Identity found for specified ClientId/ResourceId/PrincipalId.","correlationId":"4c0de274-7deb-4bde-8270-05b866ab92ab"}

Headers:
Date: Mon, 20 Oct 2025 15:11:08 GMT
Server: Kestrel
Transfer-Encoding: chunked
X-CORRELATION-ID: REDACTED
Content-Type: application/json; charset=utf-8

See the troubleshooting guide for more information. https://aka.ms/azsdk/net/identity/managedidentitycredential/troubleshoot
 ---&gt; Azure.RequestFailedException: Service request failed.
Status: 400 (Bad Request)

Content:
{"statusCode":400,"message":"No User Assigned or Delegated Managed Identity found for specified ClientId/ResourceId/PrincipalId.","correlationId":"4c0de274-7deb-4bde-8270-05b866ab92ab"}

Headers:
Date: Mon, 20 Oct 2025 15:11:08 GMT
Server: Kestrel
Transfer-Encoding: chunked
X-CORRELATION-ID: REDACTED
Content-Type: application/json; charset=utf-8

   at Azure.Identity.ManagedIdentitySource.HandleResponseAsync(Boolean async, TokenRequestContext context, HttpMessage message, CancellationToken cancellationToken)
   at Azure.Identity.ManagedIdentitySource.AuthenticateAsync(Boolean async, TokenRequestContext context, CancellationToken cancellationToken)
   at Azure.Identity.ManagedIdentityClient.AuthenticateCoreAsync(Boolean async, TokenRequestContext context, CancellationToken cancellationToken)
   at Azure.Identity.ManagedIdentityClient.AppTokenProviderImpl(AppTokenProviderParameters parameters)
   at Microsoft.Identity.Client.Internal.Requests.ClientCredentialRequest.SendTokenRequestToAppTokenProviderAsync(ILoggerAdapter logger, CancellationToken cancellationToken)
   at Microsoft.Identity.Client.Internal.Requests.ClientCredentialRequest.GetAccessTokenAsync(CancellationToken cancellationToken, ILoggerAdapter logger)
   at Microsoft.Identity.Client.Internal.Requests.ClientCredentialRequest.ExecuteAsync(CancellationToken cancellationToken)
   at Microsoft.Identity.Client.Internal.Requests.RequestBase.&lt;&gt;c__DisplayClass11_1.&lt;&lt;RunAsync&gt;b__1&gt;d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.Identity.Client.Utils.StopwatchService.MeasureCodeBlockAsync(Func`1 codeBlock)
   at Microsoft.Identity.Client.Internal.Requests.RequestBase.RunAsync(CancellationToken cancellationToken)
   at Microsoft.Identity.Client.ApiConfig.Executors.ConfidentialClientExecutor.ExecuteAsync(AcquireTokenCommonParameters commonParameters, AcquireTokenForClientParameters clientParameters, CancellationToken cancellationToken)
   at Azure.Identity.AbstractAcquireTokenParameterBuilderExtensions.ExecuteAsync[T](AbstractAcquireTokenParameterBuilder`1 builder, Boolean async, CancellationToken cancellationToken)
   at Azure.Identity.MsalConfidentialClient.AcquireTokenForClientCoreAsync(String[] scopes, String tenantId, String claims, Boolean enableCae, Boolean async, CancellationToken cancellationToken)
   at Azure.Identity.MsalConfidentialClient.AcquireTokenForClientAsync(String[] scopes, String tenantId, String claims, Boolean enableCae, Boolean async, CancellationToken cancellationToken)
   at Azure.Identity.ManagedIdentityClient.AuthenticateAsync(Boolean async, TokenRequestContext context, CancellationToken cancellationToken)
   at Azure.Identity.ManagedIdentityCredential.GetTokenImplAsync(Boolean async, TokenRequestContext requestContext, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Azure.Identity.CredentialDiagnosticScope.FailWrapAndThrow(Exception ex, String additionalMessage, Boolean isCredentialUnavailable)
   at Azure.Identity.ManagedIdentityCredential.GetTokenImplAsync(Boolean async, TokenRequestContext requestContext, CancellationToken cancellationToken)
   at Azure.Identity.ManagedIdentityCredential.GetTokenAsync(TokenRequestContext requestContext, CancellationToken cancellationToken)
   at Spaarke.Dataverse.DataverseServiceClientImpl.&lt;&gt;c__DisplayClass3_0.&lt;&lt;-ctor&gt;b__0&gt;d.MoveNext() in C:\code_files\spaarke\src\shared\Spaarke.Dataverse\DataverseServiceClientImpl.cs:line 61
--- End of stack trace from previous location ---
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.ConnectAndInitServiceAsync(OrganizationDetail orgdata, Boolean IsOnPrem, Uri homeRealmUri)
   --- End of inner exception stack trace ---
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.ConnectAndInitServiceAsync(OrganizationDetail orgdata, Boolean IsOnPrem, Uri homeRealmUri)
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.DoDirectLoginAsync(Boolean IsOnPrem)
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.InitServiceAsync()
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.GetCachedService(ConnectionService&amp; ConnectionObject)
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.IntilizeService(ConnectionService&amp; ConnectionObject)
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.DoLogin(ConnectionService&amp; ConnectionObject)
   at Microsoft.PowerPlatform.Dataverse.Client.ServiceClient.CreateServiceConnection(Object externalOrgServiceProxy, AuthenticationType requestedAuthType, String hostName, String port, String orgName, NetworkCredential credential, String userId, SecureString password, String domain, String Geo, String claimsHomeRealm, Boolean useSsl, Boolean useUniqueInstance, OrganizationDetail orgDetail, String clientId, Uri redirectUri, PromptBehavior promptBehavior, OrganizationWebProxyClientAsync externalOrgWebProxyClient, String certificateThumbPrint, StoreName certificateStoreName, X509Certificate2 certificate, Uri instanceUrl, Boolean isCloned, Boolean useDefaultCreds, Version incomingOrgVersion, ILogger externalLogger, String tokenCacheStorePath)
   --- End of inner exception stack trace ---
   at Microsoft.PowerPlatform.Dataverse.Client.ServiceClient.CreateServiceConnection(Object externalOrgServiceProxy, AuthenticationType requestedAuthType, String hostName, String port, String orgName, NetworkCredential credential, String userId, SecureString password, String domain, String Geo, String claimsHomeRealm, Boolean useSsl, Boolean useUniqueInstance, OrganizationDetail orgDetail, String clientId, Uri redirectUri, PromptBehavior promptBehavior, OrganizationWebProxyClientAsync externalOrgWebProxyClient, String certificateThumbPrint, StoreName certificateStoreName, X509Certificate2 certificate, Uri instanceUrl, Boolean isCloned, Boolean useDefaultCreds, Version incomingOrgVersion, ILogger externalLogger, String tokenCacheStorePath)
   at Microsoft.PowerPlatform.Dataverse.Client.ServiceClient..ctor(Uri instanceUrl, Func`2 tokenProviderFunction, Boolean useUniqueInstance, ILogger logger)
   at Spaarke.Dataverse.DataverseServiceClientImpl..ctor(IConfiguration configuration, ILogger`1 logger) in C:\code_files\spaarke\src\shared\Spaarke.Dataverse\DataverseServiceClientImpl.cs:line 56
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T15:11:11Z"/><EventRecordID>1460548125</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware
EventId: 1
SpanId: 9716667a24766ecd
TraceId: bc937367ea44b6433b5e428f97b23305
ParentId: 0000000000000000
RequestId: 40003628-0000-f100-b63f-84710c7967bb
RequestPath: /api/navmap/sprk_document/sprk_matter_document/lookup

An unhandled exception has occurred while executing the request.

Exception: 
Microsoft.PowerPlatform.Dataverse.Client.Utils.DataverseConnectionException: Failed to connect to Dataverse
 ---&gt; System.Exception: ExternalTokenManagement Authentication Requested but not configured correctly. 003
 ---&gt; Azure.Identity.AuthenticationFailedException: ManagedIdentityCredential authentication failed: Service request failed.
Status: 400 (Bad Request)

Content:
{"statusCode":400,"message":"No User Assigned or Delegated Managed Identity found for specified ClientId/ResourceId/PrincipalId.","correlationId":"4c0de274-7deb-4bde-8270-05b866ab92ab"}

Headers:
Date: Mon, 20 Oct 2025 15:11:08 GMT
Server: Kestrel
Transfer-Encoding: chunked
X-CORRELATION-ID: REDACTED
Content-Type: application/json; charset=utf-8

See the troubleshooting guide for more information. https://aka.ms/azsdk/net/identity/managedidentitycredential/troubleshoot
 ---&gt; Azure.RequestFailedException: Service request failed.
Status: 400 (Bad Request)

Content:
{"statusCode":400,"message":"No User Assigned or Delegated Managed Identity found for specified ClientId/ResourceId/PrincipalId.","correlationId":"4c0de274-7deb-4bde-8270-05b866ab92ab"}

Headers:
Date: Mon, 20 Oct 2025 15:11:08 GMT
Server: Kestrel
Transfer-Encoding: chunked
X-CORRELATION-ID: REDACTED
Content-Type: application/json; charset=utf-8

   at Azure.Identity.ManagedIdentitySource.HandleResponseAsync(Boolean async, TokenRequestContext context, HttpMessage message, CancellationToken cancellationToken)
   at Azure.Identity.ManagedIdentitySource.AuthenticateAsync(Boolean async, TokenRequestContext context, CancellationToken cancellationToken)
   at Azure.Identity.ManagedIdentityClient.AuthenticateCoreAsync(Boolean async, TokenRequestContext context, CancellationToken cancellationToken)
   at Azure.Identity.ManagedIdentityClient.AppTokenProviderImpl(AppTokenProviderParameters parameters)
   at Microsoft.Identity.Client.Internal.Requests.ClientCredentialRequest.SendTokenRequestToAppTokenProviderAsync(ILoggerAdapter logger, CancellationToken cancellationToken)
   at Microsoft.Identity.Client.Internal.Requests.ClientCredentialRequest.GetAccessTokenAsync(CancellationToken cancellationToken, ILoggerAdapter logger)
   at Microsoft.Identity.Client.Internal.Requests.ClientCredentialRequest.ExecuteAsync(CancellationToken cancellationToken)
   at Microsoft.Identity.Client.Internal.Requests.RequestBase.&lt;&gt;c__DisplayClass11_1.&lt;&lt;RunAsync&gt;b__1&gt;d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.Identity.Client.Utils.StopwatchService.MeasureCodeBlockAsync(Func`1 codeBlock)
   at Microsoft.Identity.Client.Internal.Requests.RequestBase.RunAsync(CancellationToken cancellationToken)
   at Microsoft.Identity.Client.ApiConfig.Executors.ConfidentialClientExecutor.ExecuteAsync(AcquireTokenCommonParameters commonParameters, AcquireTokenForClientParameters clientParameters, CancellationToken cancellationToken)
   at Azure.Identity.AbstractAcquireTokenParameterBuilderExtensions.ExecuteAsync[T](AbstractAcquireTokenParameterBuilder`1 builder, Boolean async, CancellationToken cancellationToken)
   at Azure.Identity.MsalConfidentialClient.AcquireTokenForClientCoreAsync(String[] scopes, String tenantId, String claims, Boolean enableCae, Boolean async, CancellationToken cancellationToken)
   at Azure.Identity.MsalConfidentialClient.AcquireTokenForClientAsync(String[] scopes, String tenantId, String claims, Boolean enableCae, Boolean async, CancellationToken cancellationToken)
   at Azure.Identity.ManagedIdentityClient.AuthenticateAsync(Boolean async, TokenRequestContext context, CancellationToken cancellationToken)
   at Azure.Identity.ManagedIdentityCredential.GetTokenImplAsync(Boolean async, TokenRequestContext requestContext, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Azure.Identity.CredentialDiagnosticScope.FailWrapAndThrow(Exception ex, String additionalMessage, Boolean isCredentialUnavailable)
   at Azure.Identity.ManagedIdentityCredential.GetTokenImplAsync(Boolean async, TokenRequestContext requestContext, CancellationToken cancellationToken)
   at Azure.Identity.ManagedIdentityCredential.GetTokenAsync(TokenRequestContext requestContext, CancellationToken cancellationToken)
   at Spaarke.Dataverse.DataverseServiceClientImpl.&lt;&gt;c__DisplayClass3_0.&lt;&lt;-ctor&gt;b__0&gt;d.MoveNext() in C:\code_files\spaarke\src\shared\Spaarke.Dataverse\DataverseServiceClientImpl.cs:line 61
--- End of stack trace from previous location ---
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.ConnectAndInitServiceAsync(OrganizationDetail orgdata, Boolean IsOnPrem, Uri homeRealmUri)
   --- End of inner exception stack trace ---
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.ConnectAndInitServiceAsync(OrganizationDetail orgdata, Boolean IsOnPrem, Uri homeRealmUri)
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.DoDirectLoginAsync(Boolean IsOnPrem)
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.InitServiceAsync()
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.GetCachedService(ConnectionService&amp; ConnectionObject)
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.IntilizeService(ConnectionService&amp; ConnectionObject)
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.DoLogin(ConnectionService&amp; ConnectionObject)
   at Microsoft.PowerPlatform.Dataverse.Client.ServiceClient.CreateServiceConnection(Object externalOrgServiceProxy, AuthenticationType requestedAuthType, String hostName, String port, String orgName, NetworkCredential credential, String userId, SecureString password, String domain, String Geo, String claimsHomeRealm, Boolean useSsl, Boolean useUniqueInstance, OrganizationDetail orgDetail, String clientId, Uri redirectUri, PromptBehavior promptBehavior, OrganizationWebProxyClientAsync externalOrgWebProxyClient, String certificateThumbPrint, StoreName certificateStoreName, X509Certificate2 certificate, Uri instanceUrl, Boolean isCloned, Boolean useDefaultCreds, Version incomingOrgVersion, ILogger externalLogger, String tokenCacheStorePath)
   --- End of inner exception stack trace ---
   at Microsoft.PowerPlatform.Dataverse.Client.ServiceClient.CreateServiceConnection(Object externalOrgServiceProxy, AuthenticationType requestedAuthType, String hostName, String port, String orgName, NetworkCredential credential, String userId, SecureString password, String domain, String Geo, String claimsHomeRealm, Boolean useSsl, Boolean useUniqueInstance, OrganizationDetail orgDetail, String clientId, Uri redirectUri, PromptBehavior promptBehavior, OrganizationWebProxyClientAsync externalOrgWebProxyClient, String certificateThumbPrint, StoreName certificateStoreName, X509Certificate2 certificate, Uri instanceUrl, Boolean isCloned, Boolean useDefaultCreds, Version incomingOrgVersion, ILogger externalLogger, String tokenCacheStorePath)
   at Microsoft.PowerPlatform.Dataverse.Client.ServiceClient..ctor(Uri instanceUrl, Func`2 tokenProviderFunction, Boolean useUniqueInstance, ILogger logger)
   at Spaarke.Dataverse.DataverseServiceClientImpl..ctor(IConfiguration configuration, ILogger`1 logger) in C:\code_files\spaarke\src\shared\Spaarke.Dataverse\DataverseServiceClientImpl.cs:line 56
   at Program.&lt;&gt;c.&lt;&lt;Main&gt;$&gt;b__0_2(IServiceProvider sp) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Program.cs:line 267
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitRootCache(ServiceCallSite callSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.Resolve(ServiceCallSite callSite, ServiceProviderEngineScope scope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method70(Closure, IServiceProvider, Object[])
   at Microsoft.Extensions.Http.DefaultTypedHttpClientFactory`1.CreateClient(HttpClient httpClient)
   at Microsoft.Extensions.DependencyInjection.HttpClientBuilderExtensions.AddTransientHelper[TClient,TImplementation](IServiceProvider s, IHttpClientBuilder builder)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitDisposeCache(ServiceCallSite transientCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitCache(ServiceCallSite callSite, RuntimeResolverContext context, ServiceProviderEngineScope serviceProviderEngine, RuntimeResolverLock lockType)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitScopeCache(ServiceCallSite callSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitCache(ServiceCallSite callSite, RuntimeResolverContext context, ServiceProviderEngineScope serviceProviderEngine, RuntimeResolverLock lockType)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitScopeCache(ServiceCallSite callSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitIEnumerable(IEnumerableCallSite enumerableCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitDisposeCache(ServiceCallSite transientCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitDisposeCache(ServiceCallSite transientCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitDisposeCache(ServiceCallSite transientCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.Resolve(ServiceCallSite callSite, ServiceProviderEngineScope scope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.DynamicServiceProviderEngine.&lt;&gt;c__DisplayClass2_0.&lt;RealizeService&gt;b__0(ServiceProviderEngineScope scope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Spe.Bff.Api.Api.SecurityHeadersMiddleware.Invoke(HttpContext ctx) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Api\SecurityHeadersMiddleware.cs:line 21
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
</Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1012</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T15:23:52Z"/><EventRecordID>1461308796</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Application 'C:\home\site\wwwroot\' was recycled after detecting app_offline.htm.</Data><Data>Process Id: 8176.</Data><Data>File Version: 18.0.25232.20. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T15:23:54Z"/><EventRecordID>1461310687</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 9

BackgroundService failed

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\ServiceBusJobProcessor.cs:line 72
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T15:23:54Z"/><EventRecordID>1461310953</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 10

The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\ServiceBusJobProcessor.cs:line 72
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T15:23:57Z"/><EventRecordID>1461313953</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 9

BackgroundService failed

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.DocumentEventProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\DocumentEventProcessor.cs:line 68
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T15:23:58Z"/><EventRecordID>1461314328</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 10

The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.DocumentEventProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\DocumentEventProcessor.cs:line 68
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1033</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T15:24:00Z"/><EventRecordID>1461316890</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Application 'MACHINE/WEBROOT/APPHOST/SPE-API-DEV-67E2XZ' has shutdown.</Data><Data>Process Id: 8176.</Data><Data>File Version: 18.0.25232.20. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1032</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T15:25:40Z"/><EventRecordID>1461417203</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Application 'C:\home\site\wwwroot\' started successfully.</Data><Data>Process Id: 4628.</Data><Data>File Version: 18.0.25232.20. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T15:25:51Z"/><EventRecordID>1461428078</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Spaarke.Dataverse.DataverseServiceClientImpl
EventId: 0
SpanId: 91edde195f57125f
TraceId: f142d1ca73b57bd936ea4af034cb63c3
ParentId: 0000000000000000
RequestId: 4000f740-0000-ec00-b63f-84710c7967bb
RequestPath: /api/navmap/sprk_document/sprk_matter_document/lookup

Exception initializing Dataverse ServiceClient

Exception: 
Microsoft.PowerPlatform.Dataverse.Client.Utils.DataverseConnectionException: Failed to connect to Dataverse
 ---&gt; System.Exception: ExternalTokenManagement Authentication Requested but not configured correctly. 003
 ---&gt; Azure.Identity.AuthenticationFailedException: ClientSecretCredential authentication failed: AADSTS500011: The resource principal named https://spaarkedev1.api.crm.dynamics.com/XRMServices/2011/Organization.svc/web?SDKClientVersion=9.2.49.11611 was not found in the tenant named Spaarke Inc.. This can happen if the application has not been installed by the administrator of the tenant or consented to by any user in the tenant. You might have sent your authentication request to the wrong tenant. Trace ID: 1bd51776-40d0-42db-858e-3483a131b300 Correlation ID: fc068755-7e3d-4f83-833d-4a87da96512e Timestamp: 2025-10-20 15:25:51Z
 ---&gt; MSAL.NetCore.4.65.0.0.MsalServiceException:
	ErrorCode: invalid_resource
Microsoft.Identity.Client.MsalServiceException: AADSTS500011: The resource principal named https://spaarkedev1.api.crm.dynamics.com/XRMServices/2011/Organization.svc/web?SDKClientVersion=9.2.49.11611 was not found in the tenant named Spaarke Inc.. This can happen if the application has not been installed by the administrator of the tenant or consented to by any user in the tenant. You might have sent your authentication request to the wrong tenant. Trace ID: 1bd51776-40d0-42db-858e-3483a131b300 Correlation ID: fc068755-7e3d-4f83-833d-4a87da96512e Timestamp: 2025-10-20 15:25:51Z
   at Microsoft.Identity.Client.OAuth2.OAuth2Client.ThrowServerException(HttpResponse response, RequestContext requestContext)
   at Microsoft.Identity.Client.OAuth2.OAuth2Client.CreateResponse[T](HttpResponse response, RequestContext requestContext)
   at Microsoft.Identity.Client.OAuth2.OAuth2Client.ExecuteRequestAsync[T](Uri endPoint, HttpMethod method, RequestContext requestContext, Boolean expectErrorsOn200OK, Boolean addCommonHeaders, Func`2 onBeforePostRequestData)
   at Microsoft.Identity.Client.OAuth2.TokenClient.SendHttpAndClearTelemetryAsync(String tokenEndpoint, ILoggerAdapter logger)
   at Microsoft.Identity.Client.OAuth2.TokenClient.SendHttpAndClearTelemetryAsync(String tokenEndpoint, ILoggerAdapter logger)
   at Microsoft.Identity.Client.OAuth2.TokenClient.SendTokenRequestAsync(IDictionary`2 additionalBodyParameters, String scopeOverride, String tokenEndpointOverride, CancellationToken cancellationToken)
   at Microsoft.Identity.Client.Internal.Requests.RequestBase.SendTokenRequestAsync(IDictionary`2 additionalBodyParameters, CancellationToken cancellationToken)
   at Microsoft.Identity.Client.Internal.Requests.ClientCredentialRequest.GetAccessTokenAsync(CancellationToken cancellationToken, ILoggerAdapter logger)
   at Microsoft.Identity.Client.Internal.Requests.ClientCredentialRequest.ExecuteAsync(CancellationToken cancellationToken)
   at Microsoft.Identity.Client.Internal.Requests.RequestBase.&lt;&gt;c__DisplayClass11_1.&lt;&lt;RunAsync&gt;b__1&gt;d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.Identity.Client.Utils.StopwatchService.MeasureCodeBlockAsync(Func`1 codeBlock)
   at Microsoft.Identity.Client.Internal.Requests.RequestBase.RunAsync(CancellationToken cancellationToken)
   at Microsoft.Identity.Client.ApiConfig.Executors.ConfidentialClientExecutor.ExecuteAsync(AcquireTokenCommonParameters commonParameters, AcquireTokenForClientParameters clientParameters, CancellationToken cancellationToken)
   at Azure.Identity.AbstractAcquireTokenParameterBuilderExtensions.ExecuteAsync[T](AbstractAcquireTokenParameterBuilder`1 builder, Boolean async, CancellationToken cancellationToken)
   at Azure.Identity.MsalConfidentialClient.AcquireTokenForClientCoreAsync(String[] scopes, String tenantId, String claims, Boolean enableCae, Boolean async, CancellationToken cancellationToken)
   at Azure.Identity.MsalConfidentialClient.AcquireTokenForClientAsync(String[] scopes, String tenantId, String claims, Boolean enableCae, Boolean async, CancellationToken cancellationToken)
   at Azure.Identity.ClientSecretCredential.GetTokenAsync(TokenRequestContext requestContext, CancellationToken cancellationToken)
	StatusCode: 400 
	ResponseBody: {"error":"invalid_resource","error_description":"AADSTS500011: The resource principal named https://spaarkedev1.api.crm.dynamics.com/XRMServices/2011/Organization.svc/web?SDKClientVersion=9.2.49.11611 was not found in the tenant named Spaarke Inc.. This can happen if the application has not been installed by the administrator of the tenant or consented to by any user in the tenant. You might have sent your authentication request to the wrong tenant. Trace ID: 1bd51776-40d0-42db-858e-3483a131b300 Correlation ID: fc068755-7e3d-4f83-833d-4a87da96512e Timestamp: 2025-10-20 15:25:51Z","error_codes":[500011],"timestamp":"2025-10-20 15:25:51Z","trace_id":"1bd51776-40d0-42db-858e-3483a131b300","correlation_id":"fc068755-7e3d-4f83-833d-4a87da96512e","error_uri":"https://login.microsoftonline.com/error?code=500011"} 
	Headers: Cache-Control: no-store, no-cache
Pragma: no-cache
Strict-Transport-Security: max-age=31536000; includeSubDomains
X-Content-Type-Options: nosniff
P3P: CP="DSP CUR OTPi IND OTRi ONL FIN"
client-request-id: fc068755-7e3d-4f83-833d-4a87da96512e
x-ms-request-id: 1bd51776-40d0-42db-858e-3483a131b300
x-ms-ests-server: 2.1.22170.4 - WUS3 ProdSlices
x-ms-clitelem: 1,500011,0,,
x-ms-srs: 1.P
Content-Security-Policy-Report-Only: object-src 'none'; base-uri 'self'; script-src 'self' 'nonce-anPs0ctYCUqON9M_1Vvylw' 'unsafe-inline' 'unsafe-eval' https://*.msauth.net https://*.msftauth.net https://*.msftauthimages.net https://*.msauthimages.net https://*.msidentity.com https://*.microsoftonline-p.com https://*.microsoftazuread-sso.com https://*.azureedge.net https://*.outlook.com https://*.office.com https://*.office365.com https://*.microsoft.com https://*.bing.com 'report-sample'; report-uri https://csp.microsoft.com/report/ESTS-UX-All
Cross-Origin-Opener-Policy-Report-Only: same-origin; report-to="coop-endpoint"
Reporting-Endpoints: coop-endpoint="https://idux.azurewebsites.net/api/coopReport"
X-XSS-Protection: 0
Set-Cookie: fpc=AoZExvvaSLdFkNE5Z_wlx_YUL0t-AQAAAH5LiOAOAAAA; expires=Wed, 19-Nov-2025 15:25:51 GMT; path=/; secure; HttpOnly; SameSite=None, x-ms-gateway-slice=estsfd; path=/; secure; samesite=none; httponly, stsservicecookie=estsfd; path=/; secure; samesite=none; httponly
Date: Mon, 20 Oct 2025 15:25:50 GMT

   --- End of inner exception stack trace ---
   at Azure.Identity.CredentialDiagnosticScope.FailWrapAndThrow(Exception ex, String additionalMessage, Boolean isCredentialUnavailable)
   at Azure.Identity.ClientSecretCredential.GetTokenAsync(TokenRequestContext requestContext, CancellationToken cancellationToken)
   at Spaarke.Dataverse.DataverseServiceClientImpl.&lt;&gt;c__DisplayClass3_0.&lt;&lt;-ctor&gt;b__0&gt;d.MoveNext() in C:\code_files\spaarke\src\shared\Spaarke.Dataverse\DataverseServiceClientImpl.cs:line 60
--- End of stack trace from previous location ---
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.ConnectAndInitServiceAsync(OrganizationDetail orgdata, Boolean IsOnPrem, Uri homeRealmUri)
   --- End of inner exception stack trace ---
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.ConnectAndInitServiceAsync(OrganizationDetail orgdata, Boolean IsOnPrem, Uri homeRealmUri)
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.DoDirectLoginAsync(Boolean IsOnPrem)
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.InitServiceAsync()
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.GetCachedService(ConnectionService&amp; ConnectionObject)
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.IntilizeService(ConnectionService&amp; ConnectionObject)
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.DoLogin(ConnectionService&amp; ConnectionObject)
   at Microsoft.PowerPlatform.Dataverse.Client.ServiceClient.CreateServiceConnection(Object externalOrgServiceProxy, AuthenticationType requestedAuthType, String hostName, String port, String orgName, NetworkCredential credential, String userId, SecureString password, String domain, String Geo, String claimsHomeRealm, Boolean useSsl, Boolean useUniqueInstance, OrganizationDetail orgDetail, String clientId, Uri redirectUri, PromptBehavior promptBehavior, OrganizationWebProxyClientAsync externalOrgWebProxyClient, String certificateThumbPrint, StoreName certificateStoreName, X509Certificate2 certificate, Uri instanceUrl, Boolean isCloned, Boolean useDefaultCreds, Version incomingOrgVersion, ILogger externalLogger, String tokenCacheStorePath)
   --- End of inner exception stack trace ---
   at Microsoft.PowerPlatform.Dataverse.Client.ServiceClient.CreateServiceConnection(Object externalOrgServiceProxy, AuthenticationType requestedAuthType, String hostName, String port, String orgName, NetworkCredential credential, String userId, SecureString password, String domain, String Geo, String claimsHomeRealm, Boolean useSsl, Boolean useUniqueInstance, OrganizationDetail orgDetail, String clientId, Uri redirectUri, PromptBehavior promptBehavior, OrganizationWebProxyClientAsync externalOrgWebProxyClient, String certificateThumbPrint, StoreName certificateStoreName, X509Certificate2 certificate, Uri instanceUrl, Boolean isCloned, Boolean useDefaultCreds, Version incomingOrgVersion, ILogger externalLogger, String tokenCacheStorePath)
   at Microsoft.PowerPlatform.Dataverse.Client.ServiceClient..ctor(Uri instanceUrl, Func`2 tokenProviderFunction, Boolean useUniqueInstance, ILogger logger)
   at Spaarke.Dataverse.DataverseServiceClientImpl..ctor(IConfiguration configuration, ILogger`1 logger) in C:\code_files\spaarke\src\shared\Spaarke.Dataverse\DataverseServiceClientImpl.cs:line 55
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T15:25:51Z"/><EventRecordID>1461428281</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware
EventId: 1
SpanId: 91edde195f57125f
TraceId: f142d1ca73b57bd936ea4af034cb63c3
ParentId: 0000000000000000
RequestId: 4000f740-0000-ec00-b63f-84710c7967bb
RequestPath: /api/navmap/sprk_document/sprk_matter_document/lookup

An unhandled exception has occurred while executing the request.

Exception: 
Microsoft.PowerPlatform.Dataverse.Client.Utils.DataverseConnectionException: Failed to connect to Dataverse
 ---&gt; System.Exception: ExternalTokenManagement Authentication Requested but not configured correctly. 003
 ---&gt; Azure.Identity.AuthenticationFailedException: ClientSecretCredential authentication failed: AADSTS500011: The resource principal named https://spaarkedev1.api.crm.dynamics.com/XRMServices/2011/Organization.svc/web?SDKClientVersion=9.2.49.11611 was not found in the tenant named Spaarke Inc.. This can happen if the application has not been installed by the administrator of the tenant or consented to by any user in the tenant. You might have sent your authentication request to the wrong tenant. Trace ID: 1bd51776-40d0-42db-858e-3483a131b300 Correlation ID: fc068755-7e3d-4f83-833d-4a87da96512e Timestamp: 2025-10-20 15:25:51Z
 ---&gt; MSAL.NetCore.4.65.0.0.MsalServiceException:
	ErrorCode: invalid_resource
Microsoft.Identity.Client.MsalServiceException: AADSTS500011: The resource principal named https://spaarkedev1.api.crm.dynamics.com/XRMServices/2011/Organization.svc/web?SDKClientVersion=9.2.49.11611 was not found in the tenant named Spaarke Inc.. This can happen if the application has not been installed by the administrator of the tenant or consented to by any user in the tenant. You might have sent your authentication request to the wrong tenant. Trace ID: 1bd51776-40d0-42db-858e-3483a131b300 Correlation ID: fc068755-7e3d-4f83-833d-4a87da96512e Timestamp: 2025-10-20 15:25:51Z
   at Microsoft.Identity.Client.OAuth2.OAuth2Client.ThrowServerException(HttpResponse response, RequestContext requestContext)
   at Microsoft.Identity.Client.OAuth2.OAuth2Client.CreateResponse[T](HttpResponse response, RequestContext requestContext)
   at Microsoft.Identity.Client.OAuth2.OAuth2Client.ExecuteRequestAsync[T](Uri endPoint, HttpMethod method, RequestContext requestContext, Boolean expectErrorsOn200OK, Boolean addCommonHeaders, Func`2 onBeforePostRequestData)
   at Microsoft.Identity.Client.OAuth2.TokenClient.SendHttpAndClearTelemetryAsync(String tokenEndpoint, ILoggerAdapter logger)
   at Microsoft.Identity.Client.OAuth2.TokenClient.SendHttpAndClearTelemetryAsync(String tokenEndpoint, ILoggerAdapter logger)
   at Microsoft.Identity.Client.OAuth2.TokenClient.SendTokenRequestAsync(IDictionary`2 additionalBodyParameters, String scopeOverride, String tokenEndpointOverride, CancellationToken cancellationToken)
   at Microsoft.Identity.Client.Internal.Requests.RequestBase.SendTokenRequestAsync(IDictionary`2 additionalBodyParameters, CancellationToken cancellationToken)
   at Microsoft.Identity.Client.Internal.Requests.ClientCredentialRequest.GetAccessTokenAsync(CancellationToken cancellationToken, ILoggerAdapter logger)
   at Microsoft.Identity.Client.Internal.Requests.ClientCredentialRequest.ExecuteAsync(CancellationToken cancellationToken)
   at Microsoft.Identity.Client.Internal.Requests.RequestBase.&lt;&gt;c__DisplayClass11_1.&lt;&lt;RunAsync&gt;b__1&gt;d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.Identity.Client.Utils.StopwatchService.MeasureCodeBlockAsync(Func`1 codeBlock)
   at Microsoft.Identity.Client.Internal.Requests.RequestBase.RunAsync(CancellationToken cancellationToken)
   at Microsoft.Identity.Client.ApiConfig.Executors.ConfidentialClientExecutor.ExecuteAsync(AcquireTokenCommonParameters commonParameters, AcquireTokenForClientParameters clientParameters, CancellationToken cancellationToken)
   at Azure.Identity.AbstractAcquireTokenParameterBuilderExtensions.ExecuteAsync[T](AbstractAcquireTokenParameterBuilder`1 builder, Boolean async, CancellationToken cancellationToken)
   at Azure.Identity.MsalConfidentialClient.AcquireTokenForClientCoreAsync(String[] scopes, String tenantId, String claims, Boolean enableCae, Boolean async, CancellationToken cancellationToken)
   at Azure.Identity.MsalConfidentialClient.AcquireTokenForClientAsync(String[] scopes, String tenantId, String claims, Boolean enableCae, Boolean async, CancellationToken cancellationToken)
   at Azure.Identity.ClientSecretCredential.GetTokenAsync(TokenRequestContext requestContext, CancellationToken cancellationToken)
	StatusCode: 400 
	ResponseBody: {"error":"invalid_resource","error_description":"AADSTS500011: The resource principal named https://spaarkedev1.api.crm.dynamics.com/XRMServices/2011/Organization.svc/web?SDKClientVersion=9.2.49.11611 was not found in the tenant named Spaarke Inc.. This can happen if the application has not been installed by the administrator of the tenant or consented to by any user in the tenant. You might have sent your authentication request to the wrong tenant. Trace ID: 1bd51776-40d0-42db-858e-3483a131b300 Correlation ID: fc068755-7e3d-4f83-833d-4a87da96512e Timestamp: 2025-10-20 15:25:51Z","error_codes":[500011],"timestamp":"2025-10-20 15:25:51Z","trace_id":"1bd51776-40d0-42db-858e-3483a131b300","correlation_id":"fc068755-7e3d-4f83-833d-4a87da96512e","error_uri":"https://login.microsoftonline.com/error?code=500011"} 
	Headers: Cache-Control: no-store, no-cache
Pragma: no-cache
Strict-Transport-Security: max-age=31536000; includeSubDomains
X-Content-Type-Options: nosniff
P3P: CP="DSP CUR OTPi IND OTRi ONL FIN"
client-request-id: fc068755-7e3d-4f83-833d-4a87da96512e
x-ms-request-id: 1bd51776-40d0-42db-858e-3483a131b300
x-ms-ests-server: 2.1.22170.4 - WUS3 ProdSlices
x-ms-clitelem: 1,500011,0,,
x-ms-srs: 1.P
Content-Security-Policy-Report-Only: object-src 'none'; base-uri 'self'; script-src 'self' 'nonce-anPs0ctYCUqON9M_1Vvylw' 'unsafe-inline' 'unsafe-eval' https://*.msauth.net https://*.msftauth.net https://*.msftauthimages.net https://*.msauthimages.net https://*.msidentity.com https://*.microsoftonline-p.com https://*.microsoftazuread-sso.com https://*.azureedge.net https://*.outlook.com https://*.office.com https://*.office365.com https://*.microsoft.com https://*.bing.com 'report-sample'; report-uri https://csp.microsoft.com/report/ESTS-UX-All
Cross-Origin-Opener-Policy-Report-Only: same-origin; report-to="coop-endpoint"
Reporting-Endpoints: coop-endpoint="https://idux.azurewebsites.net/api/coopReport"
X-XSS-Protection: 0
Set-Cookie: fpc=AoZExvvaSLdFkNE5Z_wlx_YUL0t-AQAAAH5LiOAOAAAA; expires=Wed, 19-Nov-2025 15:25:51 GMT; path=/; secure; HttpOnly; SameSite=None, x-ms-gateway-slice=estsfd; path=/; secure; samesite=none; httponly, stsservicecookie=estsfd; path=/; secure; samesite=none; httponly
Date: Mon, 20 Oct 2025 15:25:50 GMT

   --- End of inner exception stack trace ---
   at Azure.Identity.CredentialDiagnosticScope.FailWrapAndThrow(Exception ex, String additionalMessage, Boolean isCredentialUnavailable)
   at Azure.Identity.ClientSecretCredential.GetTokenAsync(TokenRequestContext requestContext, CancellationToken cancellationToken)
   at Spaarke.Dataverse.DataverseServiceClientImpl.&lt;&gt;c__DisplayClass3_0.&lt;&lt;-ctor&gt;b__0&gt;d.MoveNext() in C:\code_files\spaarke\src\shared\Spaarke.Dataverse\DataverseServiceClientImpl.cs:line 60
--- End of stack trace from previous location ---
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.ConnectAndInitServiceAsync(OrganizationDetail orgdata, Boolean IsOnPrem, Uri homeRealmUri)
   --- End of inner exception stack trace ---
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.ConnectAndInitServiceAsync(OrganizationDetail orgdata, Boolean IsOnPrem, Uri homeRealmUri)
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.DoDirectLoginAsync(Boolean IsOnPrem)
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.InitServiceAsync()
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.GetCachedService(ConnectionService&amp; ConnectionObject)
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.IntilizeService(ConnectionService&amp; ConnectionObject)
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.DoLogin(ConnectionService&amp; ConnectionObject)
   at Microsoft.PowerPlatform.Dataverse.Client.ServiceClient.CreateServiceConnection(Object externalOrgServiceProxy, AuthenticationType requestedAuthType, String hostName, String port, String orgName, NetworkCredential credential, String userId, SecureString password, String domain, String Geo, String claimsHomeRealm, Boolean useSsl, Boolean useUniqueInstance, OrganizationDetail orgDetail, String clientId, Uri redirectUri, PromptBehavior promptBehavior, OrganizationWebProxyClientAsync externalOrgWebProxyClient, String certificateThumbPrint, StoreName certificateStoreName, X509Certificate2 certificate, Uri instanceUrl, Boolean isCloned, Boolean useDefaultCreds, Version incomingOrgVersion, ILogger externalLogger, String tokenCacheStorePath)
   --- End of inner exception stack trace ---
   at Microsoft.PowerPlatform.Dataverse.Client.ServiceClient.CreateServiceConnection(Object externalOrgServiceProxy, AuthenticationType requestedAuthType, String hostName, String port, String orgName, NetworkCredential credential, String userId, SecureString password, String domain, String Geo, String claimsHomeRealm, Boolean useSsl, Boolean useUniqueInstance, OrganizationDetail orgDetail, String clientId, Uri redirectUri, PromptBehavior promptBehavior, OrganizationWebProxyClientAsync externalOrgWebProxyClient, String certificateThumbPrint, StoreName certificateStoreName, X509Certificate2 certificate, Uri instanceUrl, Boolean isCloned, Boolean useDefaultCreds, Version incomingOrgVersion, ILogger externalLogger, String tokenCacheStorePath)
   at Microsoft.PowerPlatform.Dataverse.Client.ServiceClient..ctor(Uri instanceUrl, Func`2 tokenProviderFunction, Boolean useUniqueInstance, ILogger logger)
   at Spaarke.Dataverse.DataverseServiceClientImpl..ctor(IConfiguration configuration, ILogger`1 logger) in C:\code_files\spaarke\src\shared\Spaarke.Dataverse\DataverseServiceClientImpl.cs:line 55
   at Program.&lt;&gt;c.&lt;&lt;Main&gt;$&gt;b__0_2(IServiceProvider sp) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Program.cs:line 267
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitRootCache(ServiceCallSite callSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.Resolve(ServiceCallSite callSite, ServiceProviderEngineScope scope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method70(Closure, IServiceProvider, Object[])
   at Microsoft.Extensions.Http.DefaultTypedHttpClientFactory`1.CreateClient(HttpClient httpClient)
   at Microsoft.Extensions.DependencyInjection.HttpClientBuilderExtensions.AddTransientHelper[TClient,TImplementation](IServiceProvider s, IHttpClientBuilder builder)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitDisposeCache(ServiceCallSite transientCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitCache(ServiceCallSite callSite, RuntimeResolverContext context, ServiceProviderEngineScope serviceProviderEngine, RuntimeResolverLock lockType)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitScopeCache(ServiceCallSite callSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitCache(ServiceCallSite callSite, RuntimeResolverContext context, ServiceProviderEngineScope serviceProviderEngine, RuntimeResolverLock lockType)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitScopeCache(ServiceCallSite callSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitIEnumerable(IEnumerableCallSite enumerableCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitDisposeCache(ServiceCallSite transientCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitDisposeCache(ServiceCallSite transientCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitDisposeCache(ServiceCallSite transientCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.Resolve(ServiceCallSite callSite, ServiceProviderEngineScope scope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.DynamicServiceProviderEngine.&lt;&gt;c__DisplayClass2_0.&lt;RealizeService&gt;b__0(ServiceProviderEngineScope scope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Spe.Bff.Api.Api.SecurityHeadersMiddleware.Invoke(HttpContext ctx) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Api\SecurityHeadersMiddleware.cs:line 21
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T17:11:56Z"/><EventRecordID>1467792468</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 9

BackgroundService failed

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\ServiceBusJobProcessor.cs:line 72
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T17:11:56Z"/><EventRecordID>1467792515</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 10

The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\ServiceBusJobProcessor.cs:line 72
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T17:11:58Z"/><EventRecordID>1467794906</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 9

BackgroundService failed

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.DocumentEventProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\DocumentEventProcessor.cs:line 68
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T17:11:58Z"/><EventRecordID>1467794937</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 10

The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.DocumentEventProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\DocumentEventProcessor.cs:line 68
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1033</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T17:12:01Z"/><EventRecordID>1467797812</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Application 'MACHINE/WEBROOT/APPHOST/SPE-API-DEV-67E2XZ' has shutdown.</Data><Data>Process Id: 4628.</Data><Data>File Version: 18.0.25232.20. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1032</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T17:13:12Z"/><EventRecordID>1467868531</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Application 'C:\home\site\wwwroot\' started successfully.</Data><Data>Process Id: 5292.</Data><Data>File Version: 18.0.25232.20. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T17:13:21Z"/><EventRecordID>1467877921</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Spaarke.Dataverse.DataverseServiceClientImpl
EventId: 0
SpanId: 048149a95916b6a6
TraceId: 9c6a7ddad20943e8bad73c9eee87a966
ParentId: 0000000000000000
RequestId: 40003635-0000-f100-b63f-84710c7967bb
RequestPath: /api/navmap/sprk_document/sprk_matter_document/lookup

Exception initializing Dataverse ServiceClient

Exception: 
Microsoft.PowerPlatform.Dataverse.Client.Utils.DataverseConnectionException: Failed to connect to Dataverse
 ---&gt; System.Exception: ExternalTokenManagement Authentication Requested but not configured correctly. 003
 ---&gt; Azure.Identity.AuthenticationFailedException: ClientSecretCredential authentication failed: AADSTS500011: The resource principal named https://spaarkedev1.api.crm.dynamics.com/XRMServices/2011/Organization.svc/web?SDKClientVersion=9.2.49.11611 was not found in the tenant named Spaarke Inc.. This can happen if the application has not been installed by the administrator of the tenant or consented to by any user in the tenant. You might have sent your authentication request to the wrong tenant. Trace ID: 7e6a4ca2-e209-4114-9b32-b1dc2949ec00 Correlation ID: 1b20edf9-b3e7-44a3-bcd4-a4a233db97f2 Timestamp: 2025-10-20 17:13:21Z
 ---&gt; MSAL.NetCore.4.65.0.0.MsalServiceException:
	ErrorCode: invalid_resource
Microsoft.Identity.Client.MsalServiceException: AADSTS500011: The resource principal named https://spaarkedev1.api.crm.dynamics.com/XRMServices/2011/Organization.svc/web?SDKClientVersion=9.2.49.11611 was not found in the tenant named Spaarke Inc.. This can happen if the application has not been installed by the administrator of the tenant or consented to by any user in the tenant. You might have sent your authentication request to the wrong tenant. Trace ID: 7e6a4ca2-e209-4114-9b32-b1dc2949ec00 Correlation ID: 1b20edf9-b3e7-44a3-bcd4-a4a233db97f2 Timestamp: 2025-10-20 17:13:21Z
   at Microsoft.Identity.Client.OAuth2.OAuth2Client.ThrowServerException(HttpResponse response, RequestContext requestContext)
   at Microsoft.Identity.Client.OAuth2.OAuth2Client.CreateResponse[T](HttpResponse response, RequestContext requestContext)
   at Microsoft.Identity.Client.OAuth2.OAuth2Client.ExecuteRequestAsync[T](Uri endPoint, HttpMethod method, RequestContext requestContext, Boolean expectErrorsOn200OK, Boolean addCommonHeaders, Func`2 onBeforePostRequestData)
   at Microsoft.Identity.Client.OAuth2.TokenClient.SendHttpAndClearTelemetryAsync(String tokenEndpoint, ILoggerAdapter logger)
   at Microsoft.Identity.Client.OAuth2.TokenClient.SendHttpAndClearTelemetryAsync(String tokenEndpoint, ILoggerAdapter logger)
   at Microsoft.Identity.Client.OAuth2.TokenClient.SendTokenRequestAsync(IDictionary`2 additionalBodyParameters, String scopeOverride, String tokenEndpointOverride, CancellationToken cancellationToken)
   at Microsoft.Identity.Client.Internal.Requests.RequestBase.SendTokenRequestAsync(IDictionary`2 additionalBodyParameters, CancellationToken cancellationToken)
   at Microsoft.Identity.Client.Internal.Requests.ClientCredentialRequest.GetAccessTokenAsync(CancellationToken cancellationToken, ILoggerAdapter logger)
   at Microsoft.Identity.Client.Internal.Requests.ClientCredentialRequest.ExecuteAsync(CancellationToken cancellationToken)
   at Microsoft.Identity.Client.Internal.Requests.RequestBase.&lt;&gt;c__DisplayClass11_1.&lt;&lt;RunAsync&gt;b__1&gt;d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.Identity.Client.Utils.StopwatchService.MeasureCodeBlockAsync(Func`1 codeBlock)
   at Microsoft.Identity.Client.Internal.Requests.RequestBase.RunAsync(CancellationToken cancellationToken)
   at Microsoft.Identity.Client.ApiConfig.Executors.ConfidentialClientExecutor.ExecuteAsync(AcquireTokenCommonParameters commonParameters, AcquireTokenForClientParameters clientParameters, CancellationToken cancellationToken)
   at Azure.Identity.AbstractAcquireTokenParameterBuilderExtensions.ExecuteAsync[T](AbstractAcquireTokenParameterBuilder`1 builder, Boolean async, CancellationToken cancellationToken)
   at Azure.Identity.MsalConfidentialClient.AcquireTokenForClientCoreAsync(String[] scopes, String tenantId, String claims, Boolean enableCae, Boolean async, CancellationToken cancellationToken)
   at Azure.Identity.MsalConfidentialClient.AcquireTokenForClientAsync(String[] scopes, String tenantId, String claims, Boolean enableCae, Boolean async, CancellationToken cancellationToken)
   at Azure.Identity.ClientSecretCredential.GetTokenAsync(TokenRequestContext requestContext, CancellationToken cancellationToken)
	StatusCode: 400 
	ResponseBody: {"error":"invalid_resource","error_description":"AADSTS500011: The resource principal named https://spaarkedev1.api.crm.dynamics.com/XRMServices/2011/Organization.svc/web?SDKClientVersion=9.2.49.11611 was not found in the tenant named Spaarke Inc.. This can happen if the application has not been installed by the administrator of the tenant or consented to by any user in the tenant. You might have sent your authentication request to the wrong tenant. Trace ID: 7e6a4ca2-e209-4114-9b32-b1dc2949ec00 Correlation ID: 1b20edf9-b3e7-44a3-bcd4-a4a233db97f2 Timestamp: 2025-10-20 17:13:21Z","error_codes":[500011],"timestamp":"2025-10-20 17:13:21Z","trace_id":"7e6a4ca2-e209-4114-9b32-b1dc2949ec00","correlation_id":"1b20edf9-b3e7-44a3-bcd4-a4a233db97f2","error_uri":"https://login.microsoftonline.com/error?code=500011"} 
	Headers: Cache-Control: no-store, no-cache
Pragma: no-cache
Strict-Transport-Security: max-age=31536000; includeSubDomains
X-Content-Type-Options: nosniff
P3P: CP="DSP CUR OTPi IND OTRi ONL FIN"
client-request-id: 1b20edf9-b3e7-44a3-bcd4-a4a233db97f2
x-ms-request-id: 7e6a4ca2-e209-4114-9b32-b1dc2949ec00
x-ms-ests-server: 2.1.22170.4 - NCUS ProdSlices
x-ms-clitelem: 1,500011,0,,
x-ms-srs: 1.P
Content-Security-Policy-Report-Only: object-src 'none'; base-uri 'self'; script-src 'self' 'nonce-Sr0_v4xdKOQbglX4Dqi3Bg' 'unsafe-inline' 'unsafe-eval' https://*.msauth.net https://*.msftauth.net https://*.msftauthimages.net https://*.msauthimages.net https://*.msidentity.com https://*.microsoftonline-p.com https://*.microsoftazuread-sso.com https://*.azureedge.net https://*.outlook.com https://*.office.com https://*.office365.com https://*.microsoft.com https://*.bing.com 'report-sample'; report-uri https://csp.microsoft.com/report/ESTS-UX-All
Cross-Origin-Opener-Policy-Report-Only: same-origin; report-to="coop-endpoint"
Reporting-Endpoints: coop-endpoint="https://idux.azurewebsites.net/api/coopReport"
X-XSS-Protection: 0
Set-Cookie: fpc=An5WYb412dxGi4PRCj8dUysUL0t-AQAAALBkiOAOAAAA; expires=Wed, 19-Nov-2025 17:13:21 GMT; path=/; secure; HttpOnly; SameSite=None, x-ms-gateway-slice=estsfd; path=/; secure; samesite=none; httponly, stsservicecookie=estsfd; path=/; secure; samesite=none; httponly
Date: Mon, 20 Oct 2025 17:13:20 GMT

   --- End of inner exception stack trace ---
   at Azure.Identity.CredentialDiagnosticScope.FailWrapAndThrow(Exception ex, String additionalMessage, Boolean isCredentialUnavailable)
   at Azure.Identity.ClientSecretCredential.GetTokenAsync(TokenRequestContext requestContext, CancellationToken cancellationToken)
   at Spaarke.Dataverse.DataverseServiceClientImpl.&lt;&gt;c__DisplayClass3_0.&lt;&lt;-ctor&gt;b__0&gt;d.MoveNext() in C:\code_files\spaarke\src\shared\Spaarke.Dataverse\DataverseServiceClientImpl.cs:line 60
--- End of stack trace from previous location ---
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.ConnectAndInitServiceAsync(OrganizationDetail orgdata, Boolean IsOnPrem, Uri homeRealmUri)
   --- End of inner exception stack trace ---
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.ConnectAndInitServiceAsync(OrganizationDetail orgdata, Boolean IsOnPrem, Uri homeRealmUri)
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.DoDirectLoginAsync(Boolean IsOnPrem)
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.InitServiceAsync()
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.GetCachedService(ConnectionService&amp; ConnectionObject)
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.IntilizeService(ConnectionService&amp; ConnectionObject)
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.DoLogin(ConnectionService&amp; ConnectionObject)
   at Microsoft.PowerPlatform.Dataverse.Client.ServiceClient.CreateServiceConnection(Object externalOrgServiceProxy, AuthenticationType requestedAuthType, String hostName, String port, String orgName, NetworkCredential credential, String userId, SecureString password, String domain, String Geo, String claimsHomeRealm, Boolean useSsl, Boolean useUniqueInstance, OrganizationDetail orgDetail, String clientId, Uri redirectUri, PromptBehavior promptBehavior, OrganizationWebProxyClientAsync externalOrgWebProxyClient, String certificateThumbPrint, StoreName certificateStoreName, X509Certificate2 certificate, Uri instanceUrl, Boolean isCloned, Boolean useDefaultCreds, Version incomingOrgVersion, ILogger externalLogger, String tokenCacheStorePath)
   --- End of inner exception stack trace ---
   at Microsoft.PowerPlatform.Dataverse.Client.ServiceClient.CreateServiceConnection(Object externalOrgServiceProxy, AuthenticationType requestedAuthType, String hostName, String port, String orgName, NetworkCredential credential, String userId, SecureString password, String domain, String Geo, String claimsHomeRealm, Boolean useSsl, Boolean useUniqueInstance, OrganizationDetail orgDetail, String clientId, Uri redirectUri, PromptBehavior promptBehavior, OrganizationWebProxyClientAsync externalOrgWebProxyClient, String certificateThumbPrint, StoreName certificateStoreName, X509Certificate2 certificate, Uri instanceUrl, Boolean isCloned, Boolean useDefaultCreds, Version incomingOrgVersion, ILogger externalLogger, String tokenCacheStorePath)
   at Microsoft.PowerPlatform.Dataverse.Client.ServiceClient..ctor(Uri instanceUrl, Func`2 tokenProviderFunction, Boolean useUniqueInstance, ILogger logger)
   at Spaarke.Dataverse.DataverseServiceClientImpl..ctor(IConfiguration configuration, ILogger`1 logger) in C:\code_files\spaarke\src\shared\Spaarke.Dataverse\DataverseServiceClientImpl.cs:line 55
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T17:13:21Z"/><EventRecordID>1467878093</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware
EventId: 1
SpanId: 048149a95916b6a6
TraceId: 9c6a7ddad20943e8bad73c9eee87a966
ParentId: 0000000000000000
RequestId: 40003635-0000-f100-b63f-84710c7967bb
RequestPath: /api/navmap/sprk_document/sprk_matter_document/lookup

An unhandled exception has occurred while executing the request.

Exception: 
Microsoft.PowerPlatform.Dataverse.Client.Utils.DataverseConnectionException: Failed to connect to Dataverse
 ---&gt; System.Exception: ExternalTokenManagement Authentication Requested but not configured correctly. 003
 ---&gt; Azure.Identity.AuthenticationFailedException: ClientSecretCredential authentication failed: AADSTS500011: The resource principal named https://spaarkedev1.api.crm.dynamics.com/XRMServices/2011/Organization.svc/web?SDKClientVersion=9.2.49.11611 was not found in the tenant named Spaarke Inc.. This can happen if the application has not been installed by the administrator of the tenant or consented to by any user in the tenant. You might have sent your authentication request to the wrong tenant. Trace ID: 7e6a4ca2-e209-4114-9b32-b1dc2949ec00 Correlation ID: 1b20edf9-b3e7-44a3-bcd4-a4a233db97f2 Timestamp: 2025-10-20 17:13:21Z
 ---&gt; MSAL.NetCore.4.65.0.0.MsalServiceException:
	ErrorCode: invalid_resource
Microsoft.Identity.Client.MsalServiceException: AADSTS500011: The resource principal named https://spaarkedev1.api.crm.dynamics.com/XRMServices/2011/Organization.svc/web?SDKClientVersion=9.2.49.11611 was not found in the tenant named Spaarke Inc.. This can happen if the application has not been installed by the administrator of the tenant or consented to by any user in the tenant. You might have sent your authentication request to the wrong tenant. Trace ID: 7e6a4ca2-e209-4114-9b32-b1dc2949ec00 Correlation ID: 1b20edf9-b3e7-44a3-bcd4-a4a233db97f2 Timestamp: 2025-10-20 17:13:21Z
   at Microsoft.Identity.Client.OAuth2.OAuth2Client.ThrowServerException(HttpResponse response, RequestContext requestContext)
   at Microsoft.Identity.Client.OAuth2.OAuth2Client.CreateResponse[T](HttpResponse response, RequestContext requestContext)
   at Microsoft.Identity.Client.OAuth2.OAuth2Client.ExecuteRequestAsync[T](Uri endPoint, HttpMethod method, RequestContext requestContext, Boolean expectErrorsOn200OK, Boolean addCommonHeaders, Func`2 onBeforePostRequestData)
   at Microsoft.Identity.Client.OAuth2.TokenClient.SendHttpAndClearTelemetryAsync(String tokenEndpoint, ILoggerAdapter logger)
   at Microsoft.Identity.Client.OAuth2.TokenClient.SendHttpAndClearTelemetryAsync(String tokenEndpoint, ILoggerAdapter logger)
   at Microsoft.Identity.Client.OAuth2.TokenClient.SendTokenRequestAsync(IDictionary`2 additionalBodyParameters, String scopeOverride, String tokenEndpointOverride, CancellationToken cancellationToken)
   at Microsoft.Identity.Client.Internal.Requests.RequestBase.SendTokenRequestAsync(IDictionary`2 additionalBodyParameters, CancellationToken cancellationToken)
   at Microsoft.Identity.Client.Internal.Requests.ClientCredentialRequest.GetAccessTokenAsync(CancellationToken cancellationToken, ILoggerAdapter logger)
   at Microsoft.Identity.Client.Internal.Requests.ClientCredentialRequest.ExecuteAsync(CancellationToken cancellationToken)
   at Microsoft.Identity.Client.Internal.Requests.RequestBase.&lt;&gt;c__DisplayClass11_1.&lt;&lt;RunAsync&gt;b__1&gt;d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.Identity.Client.Utils.StopwatchService.MeasureCodeBlockAsync(Func`1 codeBlock)
   at Microsoft.Identity.Client.Internal.Requests.RequestBase.RunAsync(CancellationToken cancellationToken)
   at Microsoft.Identity.Client.ApiConfig.Executors.ConfidentialClientExecutor.ExecuteAsync(AcquireTokenCommonParameters commonParameters, AcquireTokenForClientParameters clientParameters, CancellationToken cancellationToken)
   at Azure.Identity.AbstractAcquireTokenParameterBuilderExtensions.ExecuteAsync[T](AbstractAcquireTokenParameterBuilder`1 builder, Boolean async, CancellationToken cancellationToken)
   at Azure.Identity.MsalConfidentialClient.AcquireTokenForClientCoreAsync(String[] scopes, String tenantId, String claims, Boolean enableCae, Boolean async, CancellationToken cancellationToken)
   at Azure.Identity.MsalConfidentialClient.AcquireTokenForClientAsync(String[] scopes, String tenantId, String claims, Boolean enableCae, Boolean async, CancellationToken cancellationToken)
   at Azure.Identity.ClientSecretCredential.GetTokenAsync(TokenRequestContext requestContext, CancellationToken cancellationToken)
	StatusCode: 400 
	ResponseBody: {"error":"invalid_resource","error_description":"AADSTS500011: The resource principal named https://spaarkedev1.api.crm.dynamics.com/XRMServices/2011/Organization.svc/web?SDKClientVersion=9.2.49.11611 was not found in the tenant named Spaarke Inc.. This can happen if the application has not been installed by the administrator of the tenant or consented to by any user in the tenant. You might have sent your authentication request to the wrong tenant. Trace ID: 7e6a4ca2-e209-4114-9b32-b1dc2949ec00 Correlation ID: 1b20edf9-b3e7-44a3-bcd4-a4a233db97f2 Timestamp: 2025-10-20 17:13:21Z","error_codes":[500011],"timestamp":"2025-10-20 17:13:21Z","trace_id":"7e6a4ca2-e209-4114-9b32-b1dc2949ec00","correlation_id":"1b20edf9-b3e7-44a3-bcd4-a4a233db97f2","error_uri":"https://login.microsoftonline.com/error?code=500011"} 
	Headers: Cache-Control: no-store, no-cache
Pragma: no-cache
Strict-Transport-Security: max-age=31536000; includeSubDomains
X-Content-Type-Options: nosniff
P3P: CP="DSP CUR OTPi IND OTRi ONL FIN"
client-request-id: 1b20edf9-b3e7-44a3-bcd4-a4a233db97f2
x-ms-request-id: 7e6a4ca2-e209-4114-9b32-b1dc2949ec00
x-ms-ests-server: 2.1.22170.4 - NCUS ProdSlices
x-ms-clitelem: 1,500011,0,,
x-ms-srs: 1.P
Content-Security-Policy-Report-Only: object-src 'none'; base-uri 'self'; script-src 'self' 'nonce-Sr0_v4xdKOQbglX4Dqi3Bg' 'unsafe-inline' 'unsafe-eval' https://*.msauth.net https://*.msftauth.net https://*.msftauthimages.net https://*.msauthimages.net https://*.msidentity.com https://*.microsoftonline-p.com https://*.microsoftazuread-sso.com https://*.azureedge.net https://*.outlook.com https://*.office.com https://*.office365.com https://*.microsoft.com https://*.bing.com 'report-sample'; report-uri https://csp.microsoft.com/report/ESTS-UX-All
Cross-Origin-Opener-Policy-Report-Only: same-origin; report-to="coop-endpoint"
Reporting-Endpoints: coop-endpoint="https://idux.azurewebsites.net/api/coopReport"
X-XSS-Protection: 0
Set-Cookie: fpc=An5WYb412dxGi4PRCj8dUysUL0t-AQAAALBkiOAOAAAA; expires=Wed, 19-Nov-2025 17:13:21 GMT; path=/; secure; HttpOnly; SameSite=None, x-ms-gateway-slice=estsfd; path=/; secure; samesite=none; httponly, stsservicecookie=estsfd; path=/; secure; samesite=none; httponly
Date: Mon, 20 Oct 2025 17:13:20 GMT

   --- End of inner exception stack trace ---
   at Azure.Identity.CredentialDiagnosticScope.FailWrapAndThrow(Exception ex, String additionalMessage, Boolean isCredentialUnavailable)
   at Azure.Identity.ClientSecretCredential.GetTokenAsync(TokenRequestContext requestContext, CancellationToken cancellationToken)
   at Spaarke.Dataverse.DataverseServiceClientImpl.&lt;&gt;c__DisplayClass3_0.&lt;&lt;-ctor&gt;b__0&gt;d.MoveNext() in C:\code_files\spaarke\src\shared\Spaarke.Dataverse\DataverseServiceClientImpl.cs:line 60
--- End of stack trace from previous location ---
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.ConnectAndInitServiceAsync(OrganizationDetail orgdata, Boolean IsOnPrem, Uri homeRealmUri)
   --- End of inner exception stack trace ---
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.ConnectAndInitServiceAsync(OrganizationDetail orgdata, Boolean IsOnPrem, Uri homeRealmUri)
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.DoDirectLoginAsync(Boolean IsOnPrem)
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.InitServiceAsync()
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.GetCachedService(ConnectionService&amp; ConnectionObject)
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.IntilizeService(ConnectionService&amp; ConnectionObject)
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.DoLogin(ConnectionService&amp; ConnectionObject)
   at Microsoft.PowerPlatform.Dataverse.Client.ServiceClient.CreateServiceConnection(Object externalOrgServiceProxy, AuthenticationType requestedAuthType, String hostName, String port, String orgName, NetworkCredential credential, String userId, SecureString password, String domain, String Geo, String claimsHomeRealm, Boolean useSsl, Boolean useUniqueInstance, OrganizationDetail orgDetail, String clientId, Uri redirectUri, PromptBehavior promptBehavior, OrganizationWebProxyClientAsync externalOrgWebProxyClient, String certificateThumbPrint, StoreName certificateStoreName, X509Certificate2 certificate, Uri instanceUrl, Boolean isCloned, Boolean useDefaultCreds, Version incomingOrgVersion, ILogger externalLogger, String tokenCacheStorePath)
   --- End of inner exception stack trace ---
   at Microsoft.PowerPlatform.Dataverse.Client.ServiceClient.CreateServiceConnection(Object externalOrgServiceProxy, AuthenticationType requestedAuthType, String hostName, String port, String orgName, NetworkCredential credential, String userId, SecureString password, String domain, String Geo, String claimsHomeRealm, Boolean useSsl, Boolean useUniqueInstance, OrganizationDetail orgDetail, String clientId, Uri redirectUri, PromptBehavior promptBehavior, OrganizationWebProxyClientAsync externalOrgWebProxyClient, String certificateThumbPrint, StoreName certificateStoreName, X509Certificate2 certificate, Uri instanceUrl, Boolean isCloned, Boolean useDefaultCreds, Version incomingOrgVersion, ILogger externalLogger, String tokenCacheStorePath)
   at Microsoft.PowerPlatform.Dataverse.Client.ServiceClient..ctor(Uri instanceUrl, Func`2 tokenProviderFunction, Boolean useUniqueInstance, ILogger logger)
   at Spaarke.Dataverse.DataverseServiceClientImpl..ctor(IConfiguration configuration, ILogger`1 logger) in C:\code_files\spaarke\src\shared\Spaarke.Dataverse\DataverseServiceClientImpl.cs:line 55
   at Program.&lt;&gt;c.&lt;&lt;Main&gt;$&gt;b__0_2(IServiceProvider sp) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Program.cs:line 267
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitRootCache(ServiceCallSite callSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.Resolve(ServiceCallSite callSite, ServiceProviderEngineScope scope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method70(Closure, IServiceProvider, Object[])
   at Microsoft.Extensions.Http.DefaultTypedHttpClientFactory`1.CreateClient(HttpClient httpClient)
   at Microsoft.Extensions.DependencyInjection.HttpClientBuilderExtensions.AddTransientHelper[TClient,TImplementation](IServiceProvider s, IHttpClientBuilder builder)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitDisposeCache(ServiceCallSite transientCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitCache(ServiceCallSite callSite, RuntimeResolverContext context, ServiceProviderEngineScope serviceProviderEngine, RuntimeResolverLock lockType)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitScopeCache(ServiceCallSite callSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitCache(ServiceCallSite callSite, RuntimeResolverContext context, ServiceProviderEngineScope serviceProviderEngine, RuntimeResolverLock lockType)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitScopeCache(ServiceCallSite callSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitIEnumerable(IEnumerableCallSite enumerableCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitDisposeCache(ServiceCallSite transientCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitDisposeCache(ServiceCallSite transientCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitDisposeCache(ServiceCallSite transientCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.Resolve(ServiceCallSite callSite, ServiceProviderEngineScope scope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.DynamicServiceProviderEngine.&lt;&gt;c__DisplayClass2_0.&lt;RealizeService&gt;b__0(ServiceProviderEngineScope scope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Spe.Bff.Api.Api.SecurityHeadersMiddleware.Invoke(HttpContext ctx) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Api\SecurityHeadersMiddleware.cs:line 21
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T17:13:55Z"/><EventRecordID>1467912062</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 9

BackgroundService failed

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\ServiceBusJobProcessor.cs:line 72
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T17:13:55Z"/><EventRecordID>1467912078</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 10

The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\ServiceBusJobProcessor.cs:line 72
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T17:13:57Z"/><EventRecordID>1467913625</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 9

BackgroundService failed

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.DocumentEventProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\DocumentEventProcessor.cs:line 68
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T17:13:58Z"/><EventRecordID>1467914375</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 10

The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.DocumentEventProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\DocumentEventProcessor.cs:line 68
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1033</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T17:13:59Z"/><EventRecordID>1467915515</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Application 'MACHINE/WEBROOT/APPHOST/SPE-API-DEV-67E2XZ' has shutdown.</Data><Data>Process Id: 5292.</Data><Data>File Version: 18.0.25232.20. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1032</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T17:14:51Z"/><EventRecordID>1467967406</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Application 'C:\home\site\wwwroot\' started successfully.</Data><Data>Process Id: 6720.</Data><Data>File Version: 18.0.25232.20. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T17:14:59Z"/><EventRecordID>1467975796</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Spaarke.Dataverse.DataverseServiceClientImpl
EventId: 0
SpanId: 23edf5b76c6cdb99
TraceId: 53a233e927931f5b81258508aa847fad
ParentId: 0000000000000000
RequestId: 40003637-0000-f100-b63f-84710c7967bb
RequestPath: /api/navmap/sprk_document/sprk_matter_document/lookup

Exception initializing Dataverse ServiceClient

Exception: 
Microsoft.PowerPlatform.Dataverse.Client.Utils.DataverseConnectionException: Failed to connect to Dataverse
 ---&gt; System.Exception: ExternalTokenManagement Authentication Requested but not configured correctly. 003
 ---&gt; Azure.Identity.AuthenticationFailedException: ClientSecretCredential authentication failed: AADSTS500011: The resource principal named https://spaarkedev1.api.crm.dynamics.com/XRMServices/2011/Organization.svc/web?SDKClientVersion=9.2.49.11611 was not found in the tenant named Spaarke Inc.. This can happen if the application has not been installed by the administrator of the tenant or consented to by any user in the tenant. You might have sent your authentication request to the wrong tenant. Trace ID: 7beec721-3c19-42f2-bda8-9b4a602dfe00 Correlation ID: 25c2dc57-9918-46aa-8c26-cc2cb88a4680 Timestamp: 2025-10-20 17:14:58Z
 ---&gt; MSAL.NetCore.4.65.0.0.MsalServiceException:
	ErrorCode: invalid_resource
Microsoft.Identity.Client.MsalServiceException: AADSTS500011: The resource principal named https://spaarkedev1.api.crm.dynamics.com/XRMServices/2011/Organization.svc/web?SDKClientVersion=9.2.49.11611 was not found in the tenant named Spaarke Inc.. This can happen if the application has not been installed by the administrator of the tenant or consented to by any user in the tenant. You might have sent your authentication request to the wrong tenant. Trace ID: 7beec721-3c19-42f2-bda8-9b4a602dfe00 Correlation ID: 25c2dc57-9918-46aa-8c26-cc2cb88a4680 Timestamp: 2025-10-20 17:14:58Z
   at Microsoft.Identity.Client.OAuth2.OAuth2Client.ThrowServerException(HttpResponse response, RequestContext requestContext)
   at Microsoft.Identity.Client.OAuth2.OAuth2Client.CreateResponse[T](HttpResponse response, RequestContext requestContext)
   at Microsoft.Identity.Client.OAuth2.OAuth2Client.ExecuteRequestAsync[T](Uri endPoint, HttpMethod method, RequestContext requestContext, Boolean expectErrorsOn200OK, Boolean addCommonHeaders, Func`2 onBeforePostRequestData)
   at Microsoft.Identity.Client.OAuth2.TokenClient.SendHttpAndClearTelemetryAsync(String tokenEndpoint, ILoggerAdapter logger)
   at Microsoft.Identity.Client.OAuth2.TokenClient.SendHttpAndClearTelemetryAsync(String tokenEndpoint, ILoggerAdapter logger)
   at Microsoft.Identity.Client.OAuth2.TokenClient.SendTokenRequestAsync(IDictionary`2 additionalBodyParameters, String scopeOverride, String tokenEndpointOverride, CancellationToken cancellationToken)
   at Microsoft.Identity.Client.Internal.Requests.RequestBase.SendTokenRequestAsync(IDictionary`2 additionalBodyParameters, CancellationToken cancellationToken)
   at Microsoft.Identity.Client.Internal.Requests.ClientCredentialRequest.GetAccessTokenAsync(CancellationToken cancellationToken, ILoggerAdapter logger)
   at Microsoft.Identity.Client.Internal.Requests.ClientCredentialRequest.ExecuteAsync(CancellationToken cancellationToken)
   at Microsoft.Identity.Client.Internal.Requests.RequestBase.&lt;&gt;c__DisplayClass11_1.&lt;&lt;RunAsync&gt;b__1&gt;d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.Identity.Client.Utils.StopwatchService.MeasureCodeBlockAsync(Func`1 codeBlock)
   at Microsoft.Identity.Client.Internal.Requests.RequestBase.RunAsync(CancellationToken cancellationToken)
   at Microsoft.Identity.Client.ApiConfig.Executors.ConfidentialClientExecutor.ExecuteAsync(AcquireTokenCommonParameters commonParameters, AcquireTokenForClientParameters clientParameters, CancellationToken cancellationToken)
   at Azure.Identity.AbstractAcquireTokenParameterBuilderExtensions.ExecuteAsync[T](AbstractAcquireTokenParameterBuilder`1 builder, Boolean async, CancellationToken cancellationToken)
   at Azure.Identity.MsalConfidentialClient.AcquireTokenForClientCoreAsync(String[] scopes, String tenantId, String claims, Boolean enableCae, Boolean async, CancellationToken cancellationToken)
   at Azure.Identity.MsalConfidentialClient.AcquireTokenForClientAsync(String[] scopes, String tenantId, String claims, Boolean enableCae, Boolean async, CancellationToken cancellationToken)
   at Azure.Identity.ClientSecretCredential.GetTokenAsync(TokenRequestContext requestContext, CancellationToken cancellationToken)
	StatusCode: 400 
	ResponseBody: {"error":"invalid_resource","error_description":"AADSTS500011: The resource principal named https://spaarkedev1.api.crm.dynamics.com/XRMServices/2011/Organization.svc/web?SDKClientVersion=9.2.49.11611 was not found in the tenant named Spaarke Inc.. This can happen if the application has not been installed by the administrator of the tenant or consented to by any user in the tenant. You might have sent your authentication request to the wrong tenant. Trace ID: 7beec721-3c19-42f2-bda8-9b4a602dfe00 Correlation ID: 25c2dc57-9918-46aa-8c26-cc2cb88a4680 Timestamp: 2025-10-20 17:14:58Z","error_codes":[500011],"timestamp":"2025-10-20 17:14:58Z","trace_id":"7beec721-3c19-42f2-bda8-9b4a602dfe00","correlation_id":"25c2dc57-9918-46aa-8c26-cc2cb88a4680","error_uri":"https://login.microsoftonline.com/error?code=500011"} 
	Headers: Cache-Control: no-store, no-cache
Pragma: no-cache
Strict-Transport-Security: max-age=31536000; includeSubDomains
X-Content-Type-Options: nosniff
P3P: CP="DSP CUR OTPi IND OTRi ONL FIN"
client-request-id: 25c2dc57-9918-46aa-8c26-cc2cb88a4680
x-ms-request-id: 7beec721-3c19-42f2-bda8-9b4a602dfe00
x-ms-ests-server: 2.1.22170.4 - WUS3 ProdSlices
x-ms-clitelem: 1,500011,0,,
x-ms-srs: 1.P
Content-Security-Policy-Report-Only: object-src 'none'; base-uri 'self'; script-src 'self' 'nonce--JLuiTAI4ZVd_X1wu8Zh9Q' 'unsafe-inline' 'unsafe-eval' https://*.msauth.net https://*.msftauth.net https://*.msftauthimages.net https://*.msauthimages.net https://*.msidentity.com https://*.microsoftonline-p.com https://*.microsoftazuread-sso.com https://*.azureedge.net https://*.outlook.com https://*.office.com https://*.office365.com https://*.microsoft.com https://*.bing.com 'report-sample'; report-uri https://csp.microsoft.com/report/ESTS-UX-All
Cross-Origin-Opener-Policy-Report-Only: same-origin; report-to="coop-endpoint"
Reporting-Endpoints: coop-endpoint="https://idux.azurewebsites.net/api/coopReport"
X-XSS-Protection: 0
Set-Cookie: fpc=AnSvDuVrYwVGkaE8MCw1vQ0UL0t-AQAAABFliOAOAAAA; expires=Wed, 19-Nov-2025 17:14:58 GMT; path=/; secure; HttpOnly; SameSite=None, x-ms-gateway-slice=estsfd; path=/; secure; samesite=none; httponly, stsservicecookie=estsfd; path=/; secure; samesite=none; httponly
Date: Mon, 20 Oct 2025 17:14:57 GMT

   --- End of inner exception stack trace ---
   at Azure.Identity.CredentialDiagnosticScope.FailWrapAndThrow(Exception ex, String additionalMessage, Boolean isCredentialUnavailable)
   at Azure.Identity.ClientSecretCredential.GetTokenAsync(TokenRequestContext requestContext, CancellationToken cancellationToken)
   at Spaarke.Dataverse.DataverseServiceClientImpl.&lt;&gt;c__DisplayClass3_0.&lt;&lt;-ctor&gt;b__0&gt;d.MoveNext() in C:\code_files\spaarke\src\shared\Spaarke.Dataverse\DataverseServiceClientImpl.cs:line 60
--- End of stack trace from previous location ---
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.ConnectAndInitServiceAsync(OrganizationDetail orgdata, Boolean IsOnPrem, Uri homeRealmUri)
   --- End of inner exception stack trace ---
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.ConnectAndInitServiceAsync(OrganizationDetail orgdata, Boolean IsOnPrem, Uri homeRealmUri)
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.DoDirectLoginAsync(Boolean IsOnPrem)
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.InitServiceAsync()
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.GetCachedService(ConnectionService&amp; ConnectionObject)
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.IntilizeService(ConnectionService&amp; ConnectionObject)
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.DoLogin(ConnectionService&amp; ConnectionObject)
   at Microsoft.PowerPlatform.Dataverse.Client.ServiceClient.CreateServiceConnection(Object externalOrgServiceProxy, AuthenticationType requestedAuthType, String hostName, String port, String orgName, NetworkCredential credential, String userId, SecureString password, String domain, String Geo, String claimsHomeRealm, Boolean useSsl, Boolean useUniqueInstance, OrganizationDetail orgDetail, String clientId, Uri redirectUri, PromptBehavior promptBehavior, OrganizationWebProxyClientAsync externalOrgWebProxyClient, String certificateThumbPrint, StoreName certificateStoreName, X509Certificate2 certificate, Uri instanceUrl, Boolean isCloned, Boolean useDefaultCreds, Version incomingOrgVersion, ILogger externalLogger, String tokenCacheStorePath)
   --- End of inner exception stack trace ---
   at Microsoft.PowerPlatform.Dataverse.Client.ServiceClient.CreateServiceConnection(Object externalOrgServiceProxy, AuthenticationType requestedAuthType, String hostName, String port, String orgName, NetworkCredential credential, String userId, SecureString password, String domain, String Geo, String claimsHomeRealm, Boolean useSsl, Boolean useUniqueInstance, OrganizationDetail orgDetail, String clientId, Uri redirectUri, PromptBehavior promptBehavior, OrganizationWebProxyClientAsync externalOrgWebProxyClient, String certificateThumbPrint, StoreName certificateStoreName, X509Certificate2 certificate, Uri instanceUrl, Boolean isCloned, Boolean useDefaultCreds, Version incomingOrgVersion, ILogger externalLogger, String tokenCacheStorePath)
   at Microsoft.PowerPlatform.Dataverse.Client.ServiceClient..ctor(Uri instanceUrl, Func`2 tokenProviderFunction, Boolean useUniqueInstance, ILogger logger)
   at Spaarke.Dataverse.DataverseServiceClientImpl..ctor(IConfiguration configuration, ILogger`1 logger) in C:\code_files\spaarke\src\shared\Spaarke.Dataverse\DataverseServiceClientImpl.cs:line 55
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T17:15:00Z"/><EventRecordID>1467976656</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware
EventId: 1
SpanId: 23edf5b76c6cdb99
TraceId: 53a233e927931f5b81258508aa847fad
ParentId: 0000000000000000
RequestId: 40003637-0000-f100-b63f-84710c7967bb
RequestPath: /api/navmap/sprk_document/sprk_matter_document/lookup

An unhandled exception has occurred while executing the request.

Exception: 
Microsoft.PowerPlatform.Dataverse.Client.Utils.DataverseConnectionException: Failed to connect to Dataverse
 ---&gt; System.Exception: ExternalTokenManagement Authentication Requested but not configured correctly. 003
 ---&gt; Azure.Identity.AuthenticationFailedException: ClientSecretCredential authentication failed: AADSTS500011: The resource principal named https://spaarkedev1.api.crm.dynamics.com/XRMServices/2011/Organization.svc/web?SDKClientVersion=9.2.49.11611 was not found in the tenant named Spaarke Inc.. This can happen if the application has not been installed by the administrator of the tenant or consented to by any user in the tenant. You might have sent your authentication request to the wrong tenant. Trace ID: 7beec721-3c19-42f2-bda8-9b4a602dfe00 Correlation ID: 25c2dc57-9918-46aa-8c26-cc2cb88a4680 Timestamp: 2025-10-20 17:14:58Z
 ---&gt; MSAL.NetCore.4.65.0.0.MsalServiceException:
	ErrorCode: invalid_resource
Microsoft.Identity.Client.MsalServiceException: AADSTS500011: The resource principal named https://spaarkedev1.api.crm.dynamics.com/XRMServices/2011/Organization.svc/web?SDKClientVersion=9.2.49.11611 was not found in the tenant named Spaarke Inc.. This can happen if the application has not been installed by the administrator of the tenant or consented to by any user in the tenant. You might have sent your authentication request to the wrong tenant. Trace ID: 7beec721-3c19-42f2-bda8-9b4a602dfe00 Correlation ID: 25c2dc57-9918-46aa-8c26-cc2cb88a4680 Timestamp: 2025-10-20 17:14:58Z
   at Microsoft.Identity.Client.OAuth2.OAuth2Client.ThrowServerException(HttpResponse response, RequestContext requestContext)
   at Microsoft.Identity.Client.OAuth2.OAuth2Client.CreateResponse[T](HttpResponse response, RequestContext requestContext)
   at Microsoft.Identity.Client.OAuth2.OAuth2Client.ExecuteRequestAsync[T](Uri endPoint, HttpMethod method, RequestContext requestContext, Boolean expectErrorsOn200OK, Boolean addCommonHeaders, Func`2 onBeforePostRequestData)
   at Microsoft.Identity.Client.OAuth2.TokenClient.SendHttpAndClearTelemetryAsync(String tokenEndpoint, ILoggerAdapter logger)
   at Microsoft.Identity.Client.OAuth2.TokenClient.SendHttpAndClearTelemetryAsync(String tokenEndpoint, ILoggerAdapter logger)
   at Microsoft.Identity.Client.OAuth2.TokenClient.SendTokenRequestAsync(IDictionary`2 additionalBodyParameters, String scopeOverride, String tokenEndpointOverride, CancellationToken cancellationToken)
   at Microsoft.Identity.Client.Internal.Requests.RequestBase.SendTokenRequestAsync(IDictionary`2 additionalBodyParameters, CancellationToken cancellationToken)
   at Microsoft.Identity.Client.Internal.Requests.ClientCredentialRequest.GetAccessTokenAsync(CancellationToken cancellationToken, ILoggerAdapter logger)
   at Microsoft.Identity.Client.Internal.Requests.ClientCredentialRequest.ExecuteAsync(CancellationToken cancellationToken)
   at Microsoft.Identity.Client.Internal.Requests.RequestBase.&lt;&gt;c__DisplayClass11_1.&lt;&lt;RunAsync&gt;b__1&gt;d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.Identity.Client.Utils.StopwatchService.MeasureCodeBlockAsync(Func`1 codeBlock)
   at Microsoft.Identity.Client.Internal.Requests.RequestBase.RunAsync(CancellationToken cancellationToken)
   at Microsoft.Identity.Client.ApiConfig.Executors.ConfidentialClientExecutor.ExecuteAsync(AcquireTokenCommonParameters commonParameters, AcquireTokenForClientParameters clientParameters, CancellationToken cancellationToken)
   at Azure.Identity.AbstractAcquireTokenParameterBuilderExtensions.ExecuteAsync[T](AbstractAcquireTokenParameterBuilder`1 builder, Boolean async, CancellationToken cancellationToken)
   at Azure.Identity.MsalConfidentialClient.AcquireTokenForClientCoreAsync(String[] scopes, String tenantId, String claims, Boolean enableCae, Boolean async, CancellationToken cancellationToken)
   at Azure.Identity.MsalConfidentialClient.AcquireTokenForClientAsync(String[] scopes, String tenantId, String claims, Boolean enableCae, Boolean async, CancellationToken cancellationToken)
   at Azure.Identity.ClientSecretCredential.GetTokenAsync(TokenRequestContext requestContext, CancellationToken cancellationToken)
	StatusCode: 400 
	ResponseBody: {"error":"invalid_resource","error_description":"AADSTS500011: The resource principal named https://spaarkedev1.api.crm.dynamics.com/XRMServices/2011/Organization.svc/web?SDKClientVersion=9.2.49.11611 was not found in the tenant named Spaarke Inc.. This can happen if the application has not been installed by the administrator of the tenant or consented to by any user in the tenant. You might have sent your authentication request to the wrong tenant. Trace ID: 7beec721-3c19-42f2-bda8-9b4a602dfe00 Correlation ID: 25c2dc57-9918-46aa-8c26-cc2cb88a4680 Timestamp: 2025-10-20 17:14:58Z","error_codes":[500011],"timestamp":"2025-10-20 17:14:58Z","trace_id":"7beec721-3c19-42f2-bda8-9b4a602dfe00","correlation_id":"25c2dc57-9918-46aa-8c26-cc2cb88a4680","error_uri":"https://login.microsoftonline.com/error?code=500011"} 
	Headers: Cache-Control: no-store, no-cache
Pragma: no-cache
Strict-Transport-Security: max-age=31536000; includeSubDomains
X-Content-Type-Options: nosniff
P3P: CP="DSP CUR OTPi IND OTRi ONL FIN"
client-request-id: 25c2dc57-9918-46aa-8c26-cc2cb88a4680
x-ms-request-id: 7beec721-3c19-42f2-bda8-9b4a602dfe00
x-ms-ests-server: 2.1.22170.4 - WUS3 ProdSlices
x-ms-clitelem: 1,500011,0,,
x-ms-srs: 1.P
Content-Security-Policy-Report-Only: object-src 'none'; base-uri 'self'; script-src 'self' 'nonce--JLuiTAI4ZVd_X1wu8Zh9Q' 'unsafe-inline' 'unsafe-eval' https://*.msauth.net https://*.msftauth.net https://*.msftauthimages.net https://*.msauthimages.net https://*.msidentity.com https://*.microsoftonline-p.com https://*.microsoftazuread-sso.com https://*.azureedge.net https://*.outlook.com https://*.office.com https://*.office365.com https://*.microsoft.com https://*.bing.com 'report-sample'; report-uri https://csp.microsoft.com/report/ESTS-UX-All
Cross-Origin-Opener-Policy-Report-Only: same-origin; report-to="coop-endpoint"
Reporting-Endpoints: coop-endpoint="https://idux.azurewebsites.net/api/coopReport"
X-XSS-Protection: 0
Set-Cookie: fpc=AnSvDuVrYwVGkaE8MCw1vQ0UL0t-AQAAABFliOAOAAAA; expires=Wed, 19-Nov-2025 17:14:58 GMT; path=/; secure; HttpOnly; SameSite=None, x-ms-gateway-slice=estsfd; path=/; secure; samesite=none; httponly, stsservicecookie=estsfd; path=/; secure; samesite=none; httponly
Date: Mon, 20 Oct 2025 17:14:57 GMT

   --- End of inner exception stack trace ---
   at Azure.Identity.CredentialDiagnosticScope.FailWrapAndThrow(Exception ex, String additionalMessage, Boolean isCredentialUnavailable)
   at Azure.Identity.ClientSecretCredential.GetTokenAsync(TokenRequestContext requestContext, CancellationToken cancellationToken)
   at Spaarke.Dataverse.DataverseServiceClientImpl.&lt;&gt;c__DisplayClass3_0.&lt;&lt;-ctor&gt;b__0&gt;d.MoveNext() in C:\code_files\spaarke\src\shared\Spaarke.Dataverse\DataverseServiceClientImpl.cs:line 60
--- End of stack trace from previous location ---
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.ConnectAndInitServiceAsync(OrganizationDetail orgdata, Boolean IsOnPrem, Uri homeRealmUri)
   --- End of inner exception stack trace ---
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.ConnectAndInitServiceAsync(OrganizationDetail orgdata, Boolean IsOnPrem, Uri homeRealmUri)
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.DoDirectLoginAsync(Boolean IsOnPrem)
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.InitServiceAsync()
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.GetCachedService(ConnectionService&amp; ConnectionObject)
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.IntilizeService(ConnectionService&amp; ConnectionObject)
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.DoLogin(ConnectionService&amp; ConnectionObject)
   at Microsoft.PowerPlatform.Dataverse.Client.ServiceClient.CreateServiceConnection(Object externalOrgServiceProxy, AuthenticationType requestedAuthType, String hostName, String port, String orgName, NetworkCredential credential, String userId, SecureString password, String domain, String Geo, String claimsHomeRealm, Boolean useSsl, Boolean useUniqueInstance, OrganizationDetail orgDetail, String clientId, Uri redirectUri, PromptBehavior promptBehavior, OrganizationWebProxyClientAsync externalOrgWebProxyClient, String certificateThumbPrint, StoreName certificateStoreName, X509Certificate2 certificate, Uri instanceUrl, Boolean isCloned, Boolean useDefaultCreds, Version incomingOrgVersion, ILogger externalLogger, String tokenCacheStorePath)
   --- End of inner exception stack trace ---
   at Microsoft.PowerPlatform.Dataverse.Client.ServiceClient.CreateServiceConnection(Object externalOrgServiceProxy, AuthenticationType requestedAuthType, String hostName, String port, String orgName, NetworkCredential credential, String userId, SecureString password, String domain, String Geo, String claimsHomeRealm, Boolean useSsl, Boolean useUniqueInstance, OrganizationDetail orgDetail, String clientId, Uri redirectUri, PromptBehavior promptBehavior, OrganizationWebProxyClientAsync externalOrgWebProxyClient, String certificateThumbPrint, StoreName certificateStoreName, X509Certificate2 certificate, Uri instanceUrl, Boolean isCloned, Boolean useDefaultCreds, Version incomingOrgVersion, ILogger externalLogger, String tokenCacheStorePath)
   at Microsoft.PowerPlatform.Dataverse.Client.ServiceClient..ctor(Uri instanceUrl, Func`2 tokenProviderFunction, Boolean useUniqueInstance, ILogger logger)
   at Spaarke.Dataverse.DataverseServiceClientImpl..ctor(IConfiguration configuration, ILogger`1 logger) in C:\code_files\spaarke\src\shared\Spaarke.Dataverse\DataverseServiceClientImpl.cs:line 55
   at Program.&lt;&gt;c.&lt;&lt;Main&gt;$&gt;b__0_2(IServiceProvider sp) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Program.cs:line 267
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitRootCache(ServiceCallSite callSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.Resolve(ServiceCallSite callSite, ServiceProviderEngineScope scope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method70(Closure, IServiceProvider, Object[])
   at Microsoft.Extensions.Http.DefaultTypedHttpClientFactory`1.CreateClient(HttpClient httpClient)
   at Microsoft.Extensions.DependencyInjection.HttpClientBuilderExtensions.AddTransientHelper[TClient,TImplementation](IServiceProvider s, IHttpClientBuilder builder)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitDisposeCache(ServiceCallSite transientCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitCache(ServiceCallSite callSite, RuntimeResolverContext context, ServiceProviderEngineScope serviceProviderEngine, RuntimeResolverLock lockType)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitScopeCache(ServiceCallSite callSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitCache(ServiceCallSite callSite, RuntimeResolverContext context, ServiceProviderEngineScope serviceProviderEngine, RuntimeResolverLock lockType)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitScopeCache(ServiceCallSite callSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitIEnumerable(IEnumerableCallSite enumerableCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitDisposeCache(ServiceCallSite transientCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitDisposeCache(ServiceCallSite transientCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitDisposeCache(ServiceCallSite transientCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.Resolve(ServiceCallSite callSite, ServiceProviderEngineScope scope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.DynamicServiceProviderEngine.&lt;&gt;c__DisplayClass2_0.&lt;RealizeService&gt;b__0(ServiceProviderEngineScope scope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Spe.Bff.Api.Api.SecurityHeadersMiddleware.Invoke(HttpContext ctx) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Api\SecurityHeadersMiddleware.cs:line 21
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T17:32:26Z"/><EventRecordID>1469022593</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 9

BackgroundService failed

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\ServiceBusJobProcessor.cs:line 72
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T17:32:26Z"/><EventRecordID>1469022625</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 10

The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\ServiceBusJobProcessor.cs:line 72
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T17:32:26Z"/><EventRecordID>1469022796</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 9

BackgroundService failed

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.CheckDispose()
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.DocumentEventProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\DocumentEventProcessor.cs:line 68
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T17:32:26Z"/><EventRecordID>1469022796</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 10

The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.CheckDispose()
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.DocumentEventProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\DocumentEventProcessor.cs:line 68
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1033</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T17:32:27Z"/><EventRecordID>1469023671</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Application 'MACHINE/WEBROOT/APPHOST/SPE-API-DEV-67E2XZ' has shutdown.</Data><Data>Process Id: 6720.</Data><Data>File Version: 18.0.25232.20. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1032</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T17:33:07Z"/><EventRecordID>1469063390</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Application 'C:\home\site\wwwroot\' started successfully.</Data><Data>Process Id: 3904.</Data><Data>File Version: 18.0.25232.20. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T17:33:12Z"/><EventRecordID>1469068937</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Spaarke.Dataverse.DataverseServiceClientImpl
EventId: 0
SpanId: 1585df82e73d9106
TraceId: 32c652bf2d6a121afcf787cdbfcc10ca
ParentId: 0000000000000000
RequestId: 40003639-0000-f100-b63f-84710c7967bb
RequestPath: /api/navmap/sprk_document/sprk_matter_document/lookup

Exception initializing Dataverse ServiceClient

Exception: 
Microsoft.PowerPlatform.Dataverse.Client.Utils.DataverseConnectionException: Failed to connect to Dataverse
 ---&gt; System.Exception: ExternalTokenManagement Authentication Requested but not configured correctly. 003
 ---&gt; Azure.Identity.AuthenticationFailedException: ClientSecretCredential authentication failed: AADSTS500011: The resource principal named https://spaarkedev1.api.crm.dynamics.com/XRMServices/2011/Organization.svc/web?SDKClientVersion=9.2.49.11611 was not found in the tenant named Spaarke Inc.. This can happen if the application has not been installed by the administrator of the tenant or consented to by any user in the tenant. You might have sent your authentication request to the wrong tenant. Trace ID: 9b82aa77-78f1-4f3a-8dd1-023148577d00 Correlation ID: 239002eb-00ce-44d7-803e-cc7f3bcb876d Timestamp: 2025-10-20 17:33:12Z
 ---&gt; MSAL.NetCore.4.65.0.0.MsalServiceException:
	ErrorCode: invalid_resource
Microsoft.Identity.Client.MsalServiceException: AADSTS500011: The resource principal named https://spaarkedev1.api.crm.dynamics.com/XRMServices/2011/Organization.svc/web?SDKClientVersion=9.2.49.11611 was not found in the tenant named Spaarke Inc.. This can happen if the application has not been installed by the administrator of the tenant or consented to by any user in the tenant. You might have sent your authentication request to the wrong tenant. Trace ID: 9b82aa77-78f1-4f3a-8dd1-023148577d00 Correlation ID: 239002eb-00ce-44d7-803e-cc7f3bcb876d Timestamp: 2025-10-20 17:33:12Z
   at Microsoft.Identity.Client.OAuth2.OAuth2Client.ThrowServerException(HttpResponse response, RequestContext requestContext)
   at Microsoft.Identity.Client.OAuth2.OAuth2Client.CreateResponse[T](HttpResponse response, RequestContext requestContext)
   at Microsoft.Identity.Client.OAuth2.OAuth2Client.ExecuteRequestAsync[T](Uri endPoint, HttpMethod method, RequestContext requestContext, Boolean expectErrorsOn200OK, Boolean addCommonHeaders, Func`2 onBeforePostRequestData)
   at Microsoft.Identity.Client.OAuth2.TokenClient.SendHttpAndClearTelemetryAsync(String tokenEndpoint, ILoggerAdapter logger)
   at Microsoft.Identity.Client.OAuth2.TokenClient.SendHttpAndClearTelemetryAsync(String tokenEndpoint, ILoggerAdapter logger)
   at Microsoft.Identity.Client.OAuth2.TokenClient.SendTokenRequestAsync(IDictionary`2 additionalBodyParameters, String scopeOverride, String tokenEndpointOverride, CancellationToken cancellationToken)
   at Microsoft.Identity.Client.Internal.Requests.RequestBase.SendTokenRequestAsync(IDictionary`2 additionalBodyParameters, CancellationToken cancellationToken)
   at Microsoft.Identity.Client.Internal.Requests.ClientCredentialRequest.GetAccessTokenAsync(CancellationToken cancellationToken, ILoggerAdapter logger)
   at Microsoft.Identity.Client.Internal.Requests.ClientCredentialRequest.ExecuteAsync(CancellationToken cancellationToken)
   at Microsoft.Identity.Client.Internal.Requests.RequestBase.&lt;&gt;c__DisplayClass11_1.&lt;&lt;RunAsync&gt;b__1&gt;d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.Identity.Client.Utils.StopwatchService.MeasureCodeBlockAsync(Func`1 codeBlock)
   at Microsoft.Identity.Client.Internal.Requests.RequestBase.RunAsync(CancellationToken cancellationToken)
   at Microsoft.Identity.Client.ApiConfig.Executors.ConfidentialClientExecutor.ExecuteAsync(AcquireTokenCommonParameters commonParameters, AcquireTokenForClientParameters clientParameters, CancellationToken cancellationToken)
   at Azure.Identity.AbstractAcquireTokenParameterBuilderExtensions.ExecuteAsync[T](AbstractAcquireTokenParameterBuilder`1 builder, Boolean async, CancellationToken cancellationToken)
   at Azure.Identity.MsalConfidentialClient.AcquireTokenForClientCoreAsync(String[] scopes, String tenantId, String claims, Boolean enableCae, Boolean async, CancellationToken cancellationToken)
   at Azure.Identity.MsalConfidentialClient.AcquireTokenForClientAsync(String[] scopes, String tenantId, String claims, Boolean enableCae, Boolean async, CancellationToken cancellationToken)
   at Azure.Identity.ClientSecretCredential.GetTokenAsync(TokenRequestContext requestContext, CancellationToken cancellationToken)
	StatusCode: 400 
	ResponseBody: {"error":"invalid_resource","error_description":"AADSTS500011: The resource principal named https://spaarkedev1.api.crm.dynamics.com/XRMServices/2011/Organization.svc/web?SDKClientVersion=9.2.49.11611 was not found in the tenant named Spaarke Inc.. This can happen if the application has not been installed by the administrator of the tenant or consented to by any user in the tenant. You might have sent your authentication request to the wrong tenant. Trace ID: 9b82aa77-78f1-4f3a-8dd1-023148577d00 Correlation ID: 239002eb-00ce-44d7-803e-cc7f3bcb876d Timestamp: 2025-10-20 17:33:12Z","error_codes":[500011],"timestamp":"2025-10-20 17:33:12Z","trace_id":"9b82aa77-78f1-4f3a-8dd1-023148577d00","correlation_id":"239002eb-00ce-44d7-803e-cc7f3bcb876d","error_uri":"https://login.microsoftonline.com/error?code=500011"} 
	Headers: Cache-Control: no-store, no-cache
Pragma: no-cache
Strict-Transport-Security: max-age=31536000; includeSubDomains
X-Content-Type-Options: nosniff
P3P: CP="DSP CUR OTPi IND OTRi ONL FIN"
client-request-id: 239002eb-00ce-44d7-803e-cc7f3bcb876d
x-ms-request-id: 9b82aa77-78f1-4f3a-8dd1-023148577d00
x-ms-ests-server: 2.1.22170.4 - NCUS ProdSlices
x-ms-clitelem: 1,500011,0,,
x-ms-srs: 1.P
Content-Security-Policy-Report-Only: object-src 'none'; base-uri 'self'; script-src 'self' 'nonce-JYReoK5kRNnxrvZFD8g-Ag' 'unsafe-inline' 'unsafe-eval' https://*.msauth.net https://*.msftauth.net https://*.msftauthimages.net https://*.msauthimages.net https://*.msidentity.com https://*.microsoftonline-p.com https://*.microsoftazuread-sso.com https://*.azureedge.net https://*.outlook.com https://*.office.com https://*.office365.com https://*.microsoft.com https://*.bing.com 'report-sample'; report-uri https://csp.microsoft.com/report/ESTS-UX-All
Cross-Origin-Opener-Policy-Report-Only: same-origin; report-to="coop-endpoint"
Reporting-Endpoints: coop-endpoint="https://idux.azurewebsites.net/api/coopReport"
X-XSS-Protection: 0
Set-Cookie: fpc=AvnpqKpaeeFArPNLIry3ANMUL0t-AQAAAFdpiOAOAAAA; expires=Wed, 19-Nov-2025 17:33:12 GMT; path=/; secure; HttpOnly; SameSite=None, x-ms-gateway-slice=estsfd; path=/; secure; samesite=none; httponly, stsservicecookie=estsfd; path=/; secure; samesite=none; httponly
Date: Mon, 20 Oct 2025 17:33:11 GMT

   --- End of inner exception stack trace ---
   at Azure.Identity.CredentialDiagnosticScope.FailWrapAndThrow(Exception ex, String additionalMessage, Boolean isCredentialUnavailable)
   at Azure.Identity.ClientSecretCredential.GetTokenAsync(TokenRequestContext requestContext, CancellationToken cancellationToken)
   at Spaarke.Dataverse.DataverseServiceClientImpl.&lt;&gt;c__DisplayClass3_0.&lt;&lt;-ctor&gt;b__0&gt;d.MoveNext() in C:\code_files\spaarke\src\shared\Spaarke.Dataverse\DataverseServiceClientImpl.cs:line 60
--- End of stack trace from previous location ---
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.ConnectAndInitServiceAsync(OrganizationDetail orgdata, Boolean IsOnPrem, Uri homeRealmUri)
   --- End of inner exception stack trace ---
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.ConnectAndInitServiceAsync(OrganizationDetail orgdata, Boolean IsOnPrem, Uri homeRealmUri)
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.DoDirectLoginAsync(Boolean IsOnPrem)
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.InitServiceAsync()
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.GetCachedService(ConnectionService&amp; ConnectionObject)
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.IntilizeService(ConnectionService&amp; ConnectionObject)
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.DoLogin(ConnectionService&amp; ConnectionObject)
   at Microsoft.PowerPlatform.Dataverse.Client.ServiceClient.CreateServiceConnection(Object externalOrgServiceProxy, AuthenticationType requestedAuthType, String hostName, String port, String orgName, NetworkCredential credential, String userId, SecureString password, String domain, String Geo, String claimsHomeRealm, Boolean useSsl, Boolean useUniqueInstance, OrganizationDetail orgDetail, String clientId, Uri redirectUri, PromptBehavior promptBehavior, OrganizationWebProxyClientAsync externalOrgWebProxyClient, String certificateThumbPrint, StoreName certificateStoreName, X509Certificate2 certificate, Uri instanceUrl, Boolean isCloned, Boolean useDefaultCreds, Version incomingOrgVersion, ILogger externalLogger, String tokenCacheStorePath)
   --- End of inner exception stack trace ---
   at Microsoft.PowerPlatform.Dataverse.Client.ServiceClient.CreateServiceConnection(Object externalOrgServiceProxy, AuthenticationType requestedAuthType, String hostName, String port, String orgName, NetworkCredential credential, String userId, SecureString password, String domain, String Geo, String claimsHomeRealm, Boolean useSsl, Boolean useUniqueInstance, OrganizationDetail orgDetail, String clientId, Uri redirectUri, PromptBehavior promptBehavior, OrganizationWebProxyClientAsync externalOrgWebProxyClient, String certificateThumbPrint, StoreName certificateStoreName, X509Certificate2 certificate, Uri instanceUrl, Boolean isCloned, Boolean useDefaultCreds, Version incomingOrgVersion, ILogger externalLogger, String tokenCacheStorePath)
   at Microsoft.PowerPlatform.Dataverse.Client.ServiceClient..ctor(Uri instanceUrl, Func`2 tokenProviderFunction, Boolean useUniqueInstance, ILogger logger)
   at Spaarke.Dataverse.DataverseServiceClientImpl..ctor(IConfiguration configuration, ILogger`1 logger) in C:\code_files\spaarke\src\shared\Spaarke.Dataverse\DataverseServiceClientImpl.cs:line 55
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T17:33:12Z"/><EventRecordID>1469069109</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware
EventId: 1
SpanId: 1585df82e73d9106
TraceId: 32c652bf2d6a121afcf787cdbfcc10ca
ParentId: 0000000000000000
RequestId: 40003639-0000-f100-b63f-84710c7967bb
RequestPath: /api/navmap/sprk_document/sprk_matter_document/lookup

An unhandled exception has occurred while executing the request.

Exception: 
Microsoft.PowerPlatform.Dataverse.Client.Utils.DataverseConnectionException: Failed to connect to Dataverse
 ---&gt; System.Exception: ExternalTokenManagement Authentication Requested but not configured correctly. 003
 ---&gt; Azure.Identity.AuthenticationFailedException: ClientSecretCredential authentication failed: AADSTS500011: The resource principal named https://spaarkedev1.api.crm.dynamics.com/XRMServices/2011/Organization.svc/web?SDKClientVersion=9.2.49.11611 was not found in the tenant named Spaarke Inc.. This can happen if the application has not been installed by the administrator of the tenant or consented to by any user in the tenant. You might have sent your authentication request to the wrong tenant. Trace ID: 9b82aa77-78f1-4f3a-8dd1-023148577d00 Correlation ID: 239002eb-00ce-44d7-803e-cc7f3bcb876d Timestamp: 2025-10-20 17:33:12Z
 ---&gt; MSAL.NetCore.4.65.0.0.MsalServiceException:
	ErrorCode: invalid_resource
Microsoft.Identity.Client.MsalServiceException: AADSTS500011: The resource principal named https://spaarkedev1.api.crm.dynamics.com/XRMServices/2011/Organization.svc/web?SDKClientVersion=9.2.49.11611 was not found in the tenant named Spaarke Inc.. This can happen if the application has not been installed by the administrator of the tenant or consented to by any user in the tenant. You might have sent your authentication request to the wrong tenant. Trace ID: 9b82aa77-78f1-4f3a-8dd1-023148577d00 Correlation ID: 239002eb-00ce-44d7-803e-cc7f3bcb876d Timestamp: 2025-10-20 17:33:12Z
   at Microsoft.Identity.Client.OAuth2.OAuth2Client.ThrowServerException(HttpResponse response, RequestContext requestContext)
   at Microsoft.Identity.Client.OAuth2.OAuth2Client.CreateResponse[T](HttpResponse response, RequestContext requestContext)
   at Microsoft.Identity.Client.OAuth2.OAuth2Client.ExecuteRequestAsync[T](Uri endPoint, HttpMethod method, RequestContext requestContext, Boolean expectErrorsOn200OK, Boolean addCommonHeaders, Func`2 onBeforePostRequestData)
   at Microsoft.Identity.Client.OAuth2.TokenClient.SendHttpAndClearTelemetryAsync(String tokenEndpoint, ILoggerAdapter logger)
   at Microsoft.Identity.Client.OAuth2.TokenClient.SendHttpAndClearTelemetryAsync(String tokenEndpoint, ILoggerAdapter logger)
   at Microsoft.Identity.Client.OAuth2.TokenClient.SendTokenRequestAsync(IDictionary`2 additionalBodyParameters, String scopeOverride, String tokenEndpointOverride, CancellationToken cancellationToken)
   at Microsoft.Identity.Client.Internal.Requests.RequestBase.SendTokenRequestAsync(IDictionary`2 additionalBodyParameters, CancellationToken cancellationToken)
   at Microsoft.Identity.Client.Internal.Requests.ClientCredentialRequest.GetAccessTokenAsync(CancellationToken cancellationToken, ILoggerAdapter logger)
   at Microsoft.Identity.Client.Internal.Requests.ClientCredentialRequest.ExecuteAsync(CancellationToken cancellationToken)
   at Microsoft.Identity.Client.Internal.Requests.RequestBase.&lt;&gt;c__DisplayClass11_1.&lt;&lt;RunAsync&gt;b__1&gt;d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.Identity.Client.Utils.StopwatchService.MeasureCodeBlockAsync(Func`1 codeBlock)
   at Microsoft.Identity.Client.Internal.Requests.RequestBase.RunAsync(CancellationToken cancellationToken)
   at Microsoft.Identity.Client.ApiConfig.Executors.ConfidentialClientExecutor.ExecuteAsync(AcquireTokenCommonParameters commonParameters, AcquireTokenForClientParameters clientParameters, CancellationToken cancellationToken)
   at Azure.Identity.AbstractAcquireTokenParameterBuilderExtensions.ExecuteAsync[T](AbstractAcquireTokenParameterBuilder`1 builder, Boolean async, CancellationToken cancellationToken)
   at Azure.Identity.MsalConfidentialClient.AcquireTokenForClientCoreAsync(String[] scopes, String tenantId, String claims, Boolean enableCae, Boolean async, CancellationToken cancellationToken)
   at Azure.Identity.MsalConfidentialClient.AcquireTokenForClientAsync(String[] scopes, String tenantId, String claims, Boolean enableCae, Boolean async, CancellationToken cancellationToken)
   at Azure.Identity.ClientSecretCredential.GetTokenAsync(TokenRequestContext requestContext, CancellationToken cancellationToken)
	StatusCode: 400 
	ResponseBody: {"error":"invalid_resource","error_description":"AADSTS500011: The resource principal named https://spaarkedev1.api.crm.dynamics.com/XRMServices/2011/Organization.svc/web?SDKClientVersion=9.2.49.11611 was not found in the tenant named Spaarke Inc.. This can happen if the application has not been installed by the administrator of the tenant or consented to by any user in the tenant. You might have sent your authentication request to the wrong tenant. Trace ID: 9b82aa77-78f1-4f3a-8dd1-023148577d00 Correlation ID: 239002eb-00ce-44d7-803e-cc7f3bcb876d Timestamp: 2025-10-20 17:33:12Z","error_codes":[500011],"timestamp":"2025-10-20 17:33:12Z","trace_id":"9b82aa77-78f1-4f3a-8dd1-023148577d00","correlation_id":"239002eb-00ce-44d7-803e-cc7f3bcb876d","error_uri":"https://login.microsoftonline.com/error?code=500011"} 
	Headers: Cache-Control: no-store, no-cache
Pragma: no-cache
Strict-Transport-Security: max-age=31536000; includeSubDomains
X-Content-Type-Options: nosniff
P3P: CP="DSP CUR OTPi IND OTRi ONL FIN"
client-request-id: 239002eb-00ce-44d7-803e-cc7f3bcb876d
x-ms-request-id: 9b82aa77-78f1-4f3a-8dd1-023148577d00
x-ms-ests-server: 2.1.22170.4 - NCUS ProdSlices
x-ms-clitelem: 1,500011,0,,
x-ms-srs: 1.P
Content-Security-Policy-Report-Only: object-src 'none'; base-uri 'self'; script-src 'self' 'nonce-JYReoK5kRNnxrvZFD8g-Ag' 'unsafe-inline' 'unsafe-eval' https://*.msauth.net https://*.msftauth.net https://*.msftauthimages.net https://*.msauthimages.net https://*.msidentity.com https://*.microsoftonline-p.com https://*.microsoftazuread-sso.com https://*.azureedge.net https://*.outlook.com https://*.office.com https://*.office365.com https://*.microsoft.com https://*.bing.com 'report-sample'; report-uri https://csp.microsoft.com/report/ESTS-UX-All
Cross-Origin-Opener-Policy-Report-Only: same-origin; report-to="coop-endpoint"
Reporting-Endpoints: coop-endpoint="https://idux.azurewebsites.net/api/coopReport"
X-XSS-Protection: 0
Set-Cookie: fpc=AvnpqKpaeeFArPNLIry3ANMUL0t-AQAAAFdpiOAOAAAA; expires=Wed, 19-Nov-2025 17:33:12 GMT; path=/; secure; HttpOnly; SameSite=None, x-ms-gateway-slice=estsfd; path=/; secure; samesite=none; httponly, stsservicecookie=estsfd; path=/; secure; samesite=none; httponly
Date: Mon, 20 Oct 2025 17:33:11 GMT

   --- End of inner exception stack trace ---
   at Azure.Identity.CredentialDiagnosticScope.FailWrapAndThrow(Exception ex, String additionalMessage, Boolean isCredentialUnavailable)
   at Azure.Identity.ClientSecretCredential.GetTokenAsync(TokenRequestContext requestContext, CancellationToken cancellationToken)
   at Spaarke.Dataverse.DataverseServiceClientImpl.&lt;&gt;c__DisplayClass3_0.&lt;&lt;-ctor&gt;b__0&gt;d.MoveNext() in C:\code_files\spaarke\src\shared\Spaarke.Dataverse\DataverseServiceClientImpl.cs:line 60
--- End of stack trace from previous location ---
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.ConnectAndInitServiceAsync(OrganizationDetail orgdata, Boolean IsOnPrem, Uri homeRealmUri)
   --- End of inner exception stack trace ---
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.ConnectAndInitServiceAsync(OrganizationDetail orgdata, Boolean IsOnPrem, Uri homeRealmUri)
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.DoDirectLoginAsync(Boolean IsOnPrem)
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.InitServiceAsync()
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.GetCachedService(ConnectionService&amp; ConnectionObject)
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.IntilizeService(ConnectionService&amp; ConnectionObject)
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.DoLogin(ConnectionService&amp; ConnectionObject)
   at Microsoft.PowerPlatform.Dataverse.Client.ServiceClient.CreateServiceConnection(Object externalOrgServiceProxy, AuthenticationType requestedAuthType, String hostName, String port, String orgName, NetworkCredential credential, String userId, SecureString password, String domain, String Geo, String claimsHomeRealm, Boolean useSsl, Boolean useUniqueInstance, OrganizationDetail orgDetail, String clientId, Uri redirectUri, PromptBehavior promptBehavior, OrganizationWebProxyClientAsync externalOrgWebProxyClient, String certificateThumbPrint, StoreName certificateStoreName, X509Certificate2 certificate, Uri instanceUrl, Boolean isCloned, Boolean useDefaultCreds, Version incomingOrgVersion, ILogger externalLogger, String tokenCacheStorePath)
   --- End of inner exception stack trace ---
   at Microsoft.PowerPlatform.Dataverse.Client.ServiceClient.CreateServiceConnection(Object externalOrgServiceProxy, AuthenticationType requestedAuthType, String hostName, String port, String orgName, NetworkCredential credential, String userId, SecureString password, String domain, String Geo, String claimsHomeRealm, Boolean useSsl, Boolean useUniqueInstance, OrganizationDetail orgDetail, String clientId, Uri redirectUri, PromptBehavior promptBehavior, OrganizationWebProxyClientAsync externalOrgWebProxyClient, String certificateThumbPrint, StoreName certificateStoreName, X509Certificate2 certificate, Uri instanceUrl, Boolean isCloned, Boolean useDefaultCreds, Version incomingOrgVersion, ILogger externalLogger, String tokenCacheStorePath)
   at Microsoft.PowerPlatform.Dataverse.Client.ServiceClient..ctor(Uri instanceUrl, Func`2 tokenProviderFunction, Boolean useUniqueInstance, ILogger logger)
   at Spaarke.Dataverse.DataverseServiceClientImpl..ctor(IConfiguration configuration, ILogger`1 logger) in C:\code_files\spaarke\src\shared\Spaarke.Dataverse\DataverseServiceClientImpl.cs:line 55
   at Program.&lt;&gt;c.&lt;&lt;Main&gt;$&gt;b__0_2(IServiceProvider sp) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Program.cs:line 267
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitRootCache(ServiceCallSite callSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.Resolve(ServiceCallSite callSite, ServiceProviderEngineScope scope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method70(Closure, IServiceProvider, Object[])
   at Microsoft.Extensions.Http.DefaultTypedHttpClientFactory`1.CreateClient(HttpClient httpClient)
   at Microsoft.Extensions.DependencyInjection.HttpClientBuilderExtensions.AddTransientHelper[TClient,TImplementation](IServiceProvider s, IHttpClientBuilder builder)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitDisposeCache(ServiceCallSite transientCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitCache(ServiceCallSite callSite, RuntimeResolverContext context, ServiceProviderEngineScope serviceProviderEngine, RuntimeResolverLock lockType)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitScopeCache(ServiceCallSite callSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitCache(ServiceCallSite callSite, RuntimeResolverContext context, ServiceProviderEngineScope serviceProviderEngine, RuntimeResolverLock lockType)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitScopeCache(ServiceCallSite callSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitIEnumerable(IEnumerableCallSite enumerableCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitDisposeCache(ServiceCallSite transientCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitDisposeCache(ServiceCallSite transientCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitDisposeCache(ServiceCallSite transientCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.Resolve(ServiceCallSite callSite, ServiceProviderEngineScope scope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.DynamicServiceProviderEngine.&lt;&gt;c__DisplayClass2_0.&lt;RealizeService&gt;b__0(ServiceProviderEngineScope scope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Spe.Bff.Api.Api.SecurityHeadersMiddleware.Invoke(HttpContext ctx) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Api\SecurityHeadersMiddleware.cs:line 21
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T17:38:26Z"/><EventRecordID>1469382625</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 9

BackgroundService failed

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\ServiceBusJobProcessor.cs:line 72
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T17:38:26Z"/><EventRecordID>1469382671</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 10

The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\ServiceBusJobProcessor.cs:line 72
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T17:38:28Z"/><EventRecordID>1469384828</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 9

BackgroundService failed

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.DocumentEventProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\DocumentEventProcessor.cs:line 68
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T17:38:28Z"/><EventRecordID>1469384859</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 10

The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.DocumentEventProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\DocumentEventProcessor.cs:line 68
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1033</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T17:38:35Z"/><EventRecordID>1469392093</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Application 'MACHINE/WEBROOT/APPHOST/SPE-API-DEV-67E2XZ' has shutdown.</Data><Data>Process Id: 3904.</Data><Data>File Version: 18.0.25232.20. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1032</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T17:39:26Z"/><EventRecordID>1469443156</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Application 'C:\home\site\wwwroot\' started successfully.</Data><Data>Process Id: 2884.</Data><Data>File Version: 18.0.25232.20. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T17:39:36Z"/><EventRecordID>1469453156</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Spaarke.Dataverse.DataverseServiceClientImpl
EventId: 0
SpanId: d3e634f2d87679f8
TraceId: 377c391148de7b071057eb3ea15289ae
ParentId: 0000000000000000
RequestId: 4000485e-0000-dd00-b63f-84710c7967bb
RequestPath: /api/navmap/sprk_document/sprk_matter_document/lookup

Exception initializing Dataverse ServiceClient

Exception: 
Microsoft.PowerPlatform.Dataverse.Client.Utils.DataverseConnectionException: Failed to connect to Dataverse
 ---&gt; System.Exception: ExternalTokenManagement Authentication Requested but not configured correctly. 003
 ---&gt; Azure.Identity.AuthenticationFailedException: ClientSecretCredential authentication failed: AADSTS500011: The resource principal named https://spaarkedev1.api.crm.dynamics.com/XRMServices/2011/Organization.svc/web?SDKClientVersion=9.2.49.11611 was not found in the tenant named Spaarke Inc.. This can happen if the application has not been installed by the administrator of the tenant or consented to by any user in the tenant. You might have sent your authentication request to the wrong tenant. Trace ID: 556bc330-7c90-449f-ab10-62700dcbe600 Correlation ID: 6c8e9279-6e60-406e-94eb-84aa0a2ab502 Timestamp: 2025-10-20 17:39:35Z
 ---&gt; MSAL.NetCore.4.65.0.0.MsalServiceException:
	ErrorCode: invalid_resource
Microsoft.Identity.Client.MsalServiceException: AADSTS500011: The resource principal named https://spaarkedev1.api.crm.dynamics.com/XRMServices/2011/Organization.svc/web?SDKClientVersion=9.2.49.11611 was not found in the tenant named Spaarke Inc.. This can happen if the application has not been installed by the administrator of the tenant or consented to by any user in the tenant. You might have sent your authentication request to the wrong tenant. Trace ID: 556bc330-7c90-449f-ab10-62700dcbe600 Correlation ID: 6c8e9279-6e60-406e-94eb-84aa0a2ab502 Timestamp: 2025-10-20 17:39:35Z
   at Microsoft.Identity.Client.OAuth2.OAuth2Client.ThrowServerException(HttpResponse response, RequestContext requestContext)
   at Microsoft.Identity.Client.OAuth2.OAuth2Client.CreateResponse[T](HttpResponse response, RequestContext requestContext)
   at Microsoft.Identity.Client.OAuth2.OAuth2Client.ExecuteRequestAsync[T](Uri endPoint, HttpMethod method, RequestContext requestContext, Boolean expectErrorsOn200OK, Boolean addCommonHeaders, Func`2 onBeforePostRequestData)
   at Microsoft.Identity.Client.OAuth2.TokenClient.SendHttpAndClearTelemetryAsync(String tokenEndpoint, ILoggerAdapter logger)
   at Microsoft.Identity.Client.OAuth2.TokenClient.SendHttpAndClearTelemetryAsync(String tokenEndpoint, ILoggerAdapter logger)
   at Microsoft.Identity.Client.OAuth2.TokenClient.SendTokenRequestAsync(IDictionary`2 additionalBodyParameters, String scopeOverride, String tokenEndpointOverride, CancellationToken cancellationToken)
   at Microsoft.Identity.Client.Internal.Requests.RequestBase.SendTokenRequestAsync(IDictionary`2 additionalBodyParameters, CancellationToken cancellationToken)
   at Microsoft.Identity.Client.Internal.Requests.ClientCredentialRequest.GetAccessTokenAsync(CancellationToken cancellationToken, ILoggerAdapter logger)
   at Microsoft.Identity.Client.Internal.Requests.ClientCredentialRequest.ExecuteAsync(CancellationToken cancellationToken)
   at Microsoft.Identity.Client.Internal.Requests.RequestBase.&lt;&gt;c__DisplayClass11_1.&lt;&lt;RunAsync&gt;b__1&gt;d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.Identity.Client.Utils.StopwatchService.MeasureCodeBlockAsync(Func`1 codeBlock)
   at Microsoft.Identity.Client.Internal.Requests.RequestBase.RunAsync(CancellationToken cancellationToken)
   at Microsoft.Identity.Client.ApiConfig.Executors.ConfidentialClientExecutor.ExecuteAsync(AcquireTokenCommonParameters commonParameters, AcquireTokenForClientParameters clientParameters, CancellationToken cancellationToken)
   at Azure.Identity.AbstractAcquireTokenParameterBuilderExtensions.ExecuteAsync[T](AbstractAcquireTokenParameterBuilder`1 builder, Boolean async, CancellationToken cancellationToken)
   at Azure.Identity.MsalConfidentialClient.AcquireTokenForClientCoreAsync(String[] scopes, String tenantId, String claims, Boolean enableCae, Boolean async, CancellationToken cancellationToken)
   at Azure.Identity.MsalConfidentialClient.AcquireTokenForClientAsync(String[] scopes, String tenantId, String claims, Boolean enableCae, Boolean async, CancellationToken cancellationToken)
   at Azure.Identity.ClientSecretCredential.GetTokenAsync(TokenRequestContext requestContext, CancellationToken cancellationToken)
	StatusCode: 400 
	ResponseBody: {"error":"invalid_resource","error_description":"AADSTS500011: The resource principal named https://spaarkedev1.api.crm.dynamics.com/XRMServices/2011/Organization.svc/web?SDKClientVersion=9.2.49.11611 was not found in the tenant named Spaarke Inc.. This can happen if the application has not been installed by the administrator of the tenant or consented to by any user in the tenant. You might have sent your authentication request to the wrong tenant. Trace ID: 556bc330-7c90-449f-ab10-62700dcbe600 Correlation ID: 6c8e9279-6e60-406e-94eb-84aa0a2ab502 Timestamp: 2025-10-20 17:39:35Z","error_codes":[500011],"timestamp":"2025-10-20 17:39:35Z","trace_id":"556bc330-7c90-449f-ab10-62700dcbe600","correlation_id":"6c8e9279-6e60-406e-94eb-84aa0a2ab502","error_uri":"https://login.microsoftonline.com/error?code=500011"} 
	Headers: Cache-Control: no-store, no-cache
Pragma: no-cache
Strict-Transport-Security: max-age=31536000; includeSubDomains
X-Content-Type-Options: nosniff
P3P: CP="DSP CUR OTPi IND OTRi ONL FIN"
client-request-id: 6c8e9279-6e60-406e-94eb-84aa0a2ab502
x-ms-request-id: 556bc330-7c90-449f-ab10-62700dcbe600
x-ms-ests-server: 2.1.22170.4 - WUS3 ProdSlices
x-ms-clitelem: 1,500011,0,,
x-ms-srs: 1.P
Content-Security-Policy-Report-Only: object-src 'none'; base-uri 'self'; script-src 'self' 'nonce-e5hajMZ-SFw3_EQEC-IbPA' 'unsafe-inline' 'unsafe-eval' https://*.msauth.net https://*.msftauth.net https://*.msftauthimages.net https://*.msauthimages.net https://*.msidentity.com https://*.microsoftonline-p.com https://*.microsoftazuread-sso.com https://*.azureedge.net https://*.outlook.com https://*.office.com https://*.office365.com https://*.microsoft.com https://*.bing.com 'report-sample'; report-uri https://csp.microsoft.com/report/ESTS-UX-All
Cross-Origin-Opener-Policy-Report-Only: same-origin; report-to="coop-endpoint"
Reporting-Endpoints: coop-endpoint="https://idux.azurewebsites.net/api/coopReport"
X-XSS-Protection: 0
Set-Cookie: fpc=As_UhB782qVJhGNbOXWQTYwUL0t-AQAAANdqiOAOAAAA; expires=Wed, 19-Nov-2025 17:39:35 GMT; path=/; secure; HttpOnly; SameSite=None, x-ms-gateway-slice=estsfd; path=/; secure; samesite=none; httponly, stsservicecookie=estsfd; path=/; secure; samesite=none; httponly
Date: Mon, 20 Oct 2025 17:39:35 GMT

   --- End of inner exception stack trace ---
   at Azure.Identity.CredentialDiagnosticScope.FailWrapAndThrow(Exception ex, String additionalMessage, Boolean isCredentialUnavailable)
   at Azure.Identity.ClientSecretCredential.GetTokenAsync(TokenRequestContext requestContext, CancellationToken cancellationToken)
   at Spaarke.Dataverse.DataverseServiceClientImpl.&lt;&gt;c__DisplayClass3_0.&lt;&lt;-ctor&gt;b__0&gt;d.MoveNext() in C:\code_files\spaarke\src\shared\Spaarke.Dataverse\DataverseServiceClientImpl.cs:line 60
--- End of stack trace from previous location ---
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.ConnectAndInitServiceAsync(OrganizationDetail orgdata, Boolean IsOnPrem, Uri homeRealmUri)
   --- End of inner exception stack trace ---
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.ConnectAndInitServiceAsync(OrganizationDetail orgdata, Boolean IsOnPrem, Uri homeRealmUri)
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.DoDirectLoginAsync(Boolean IsOnPrem)
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.InitServiceAsync()
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.GetCachedService(ConnectionService&amp; ConnectionObject)
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.IntilizeService(ConnectionService&amp; ConnectionObject)
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.DoLogin(ConnectionService&amp; ConnectionObject)
   at Microsoft.PowerPlatform.Dataverse.Client.ServiceClient.CreateServiceConnection(Object externalOrgServiceProxy, AuthenticationType requestedAuthType, String hostName, String port, String orgName, NetworkCredential credential, String userId, SecureString password, String domain, String Geo, String claimsHomeRealm, Boolean useSsl, Boolean useUniqueInstance, OrganizationDetail orgDetail, String clientId, Uri redirectUri, PromptBehavior promptBehavior, OrganizationWebProxyClientAsync externalOrgWebProxyClient, String certificateThumbPrint, StoreName certificateStoreName, X509Certificate2 certificate, Uri instanceUrl, Boolean isCloned, Boolean useDefaultCreds, Version incomingOrgVersion, ILogger externalLogger, String tokenCacheStorePath)
   --- End of inner exception stack trace ---
   at Microsoft.PowerPlatform.Dataverse.Client.ServiceClient.CreateServiceConnection(Object externalOrgServiceProxy, AuthenticationType requestedAuthType, String hostName, String port, String orgName, NetworkCredential credential, String userId, SecureString password, String domain, String Geo, String claimsHomeRealm, Boolean useSsl, Boolean useUniqueInstance, OrganizationDetail orgDetail, String clientId, Uri redirectUri, PromptBehavior promptBehavior, OrganizationWebProxyClientAsync externalOrgWebProxyClient, String certificateThumbPrint, StoreName certificateStoreName, X509Certificate2 certificate, Uri instanceUrl, Boolean isCloned, Boolean useDefaultCreds, Version incomingOrgVersion, ILogger externalLogger, String tokenCacheStorePath)
   at Microsoft.PowerPlatform.Dataverse.Client.ServiceClient..ctor(Uri instanceUrl, Func`2 tokenProviderFunction, Boolean useUniqueInstance, ILogger logger)
   at Spaarke.Dataverse.DataverseServiceClientImpl..ctor(IConfiguration configuration, ILogger`1 logger) in C:\code_files\spaarke\src\shared\Spaarke.Dataverse\DataverseServiceClientImpl.cs:line 55
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T17:39:37Z"/><EventRecordID>1469453359</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware
EventId: 1
SpanId: d3e634f2d87679f8
TraceId: 377c391148de7b071057eb3ea15289ae
ParentId: 0000000000000000
RequestId: 4000485e-0000-dd00-b63f-84710c7967bb
RequestPath: /api/navmap/sprk_document/sprk_matter_document/lookup

An unhandled exception has occurred while executing the request.

Exception: 
Microsoft.PowerPlatform.Dataverse.Client.Utils.DataverseConnectionException: Failed to connect to Dataverse
 ---&gt; System.Exception: ExternalTokenManagement Authentication Requested but not configured correctly. 003
 ---&gt; Azure.Identity.AuthenticationFailedException: ClientSecretCredential authentication failed: AADSTS500011: The resource principal named https://spaarkedev1.api.crm.dynamics.com/XRMServices/2011/Organization.svc/web?SDKClientVersion=9.2.49.11611 was not found in the tenant named Spaarke Inc.. This can happen if the application has not been installed by the administrator of the tenant or consented to by any user in the tenant. You might have sent your authentication request to the wrong tenant. Trace ID: 556bc330-7c90-449f-ab10-62700dcbe600 Correlation ID: 6c8e9279-6e60-406e-94eb-84aa0a2ab502 Timestamp: 2025-10-20 17:39:35Z
 ---&gt; MSAL.NetCore.4.65.0.0.MsalServiceException:
	ErrorCode: invalid_resource
Microsoft.Identity.Client.MsalServiceException: AADSTS500011: The resource principal named https://spaarkedev1.api.crm.dynamics.com/XRMServices/2011/Organization.svc/web?SDKClientVersion=9.2.49.11611 was not found in the tenant named Spaarke Inc.. This can happen if the application has not been installed by the administrator of the tenant or consented to by any user in the tenant. You might have sent your authentication request to the wrong tenant. Trace ID: 556bc330-7c90-449f-ab10-62700dcbe600 Correlation ID: 6c8e9279-6e60-406e-94eb-84aa0a2ab502 Timestamp: 2025-10-20 17:39:35Z
   at Microsoft.Identity.Client.OAuth2.OAuth2Client.ThrowServerException(HttpResponse response, RequestContext requestContext)
   at Microsoft.Identity.Client.OAuth2.OAuth2Client.CreateResponse[T](HttpResponse response, RequestContext requestContext)
   at Microsoft.Identity.Client.OAuth2.OAuth2Client.ExecuteRequestAsync[T](Uri endPoint, HttpMethod method, RequestContext requestContext, Boolean expectErrorsOn200OK, Boolean addCommonHeaders, Func`2 onBeforePostRequestData)
   at Microsoft.Identity.Client.OAuth2.TokenClient.SendHttpAndClearTelemetryAsync(String tokenEndpoint, ILoggerAdapter logger)
   at Microsoft.Identity.Client.OAuth2.TokenClient.SendHttpAndClearTelemetryAsync(String tokenEndpoint, ILoggerAdapter logger)
   at Microsoft.Identity.Client.OAuth2.TokenClient.SendTokenRequestAsync(IDictionary`2 additionalBodyParameters, String scopeOverride, String tokenEndpointOverride, CancellationToken cancellationToken)
   at Microsoft.Identity.Client.Internal.Requests.RequestBase.SendTokenRequestAsync(IDictionary`2 additionalBodyParameters, CancellationToken cancellationToken)
   at Microsoft.Identity.Client.Internal.Requests.ClientCredentialRequest.GetAccessTokenAsync(CancellationToken cancellationToken, ILoggerAdapter logger)
   at Microsoft.Identity.Client.Internal.Requests.ClientCredentialRequest.ExecuteAsync(CancellationToken cancellationToken)
   at Microsoft.Identity.Client.Internal.Requests.RequestBase.&lt;&gt;c__DisplayClass11_1.&lt;&lt;RunAsync&gt;b__1&gt;d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.Identity.Client.Utils.StopwatchService.MeasureCodeBlockAsync(Func`1 codeBlock)
   at Microsoft.Identity.Client.Internal.Requests.RequestBase.RunAsync(CancellationToken cancellationToken)
   at Microsoft.Identity.Client.ApiConfig.Executors.ConfidentialClientExecutor.ExecuteAsync(AcquireTokenCommonParameters commonParameters, AcquireTokenForClientParameters clientParameters, CancellationToken cancellationToken)
   at Azure.Identity.AbstractAcquireTokenParameterBuilderExtensions.ExecuteAsync[T](AbstractAcquireTokenParameterBuilder`1 builder, Boolean async, CancellationToken cancellationToken)
   at Azure.Identity.MsalConfidentialClient.AcquireTokenForClientCoreAsync(String[] scopes, String tenantId, String claims, Boolean enableCae, Boolean async, CancellationToken cancellationToken)
   at Azure.Identity.MsalConfidentialClient.AcquireTokenForClientAsync(String[] scopes, String tenantId, String claims, Boolean enableCae, Boolean async, CancellationToken cancellationToken)
   at Azure.Identity.ClientSecretCredential.GetTokenAsync(TokenRequestContext requestContext, CancellationToken cancellationToken)
	StatusCode: 400 
	ResponseBody: {"error":"invalid_resource","error_description":"AADSTS500011: The resource principal named https://spaarkedev1.api.crm.dynamics.com/XRMServices/2011/Organization.svc/web?SDKClientVersion=9.2.49.11611 was not found in the tenant named Spaarke Inc.. This can happen if the application has not been installed by the administrator of the tenant or consented to by any user in the tenant. You might have sent your authentication request to the wrong tenant. Trace ID: 556bc330-7c90-449f-ab10-62700dcbe600 Correlation ID: 6c8e9279-6e60-406e-94eb-84aa0a2ab502 Timestamp: 2025-10-20 17:39:35Z","error_codes":[500011],"timestamp":"2025-10-20 17:39:35Z","trace_id":"556bc330-7c90-449f-ab10-62700dcbe600","correlation_id":"6c8e9279-6e60-406e-94eb-84aa0a2ab502","error_uri":"https://login.microsoftonline.com/error?code=500011"} 
	Headers: Cache-Control: no-store, no-cache
Pragma: no-cache
Strict-Transport-Security: max-age=31536000; includeSubDomains
X-Content-Type-Options: nosniff
P3P: CP="DSP CUR OTPi IND OTRi ONL FIN"
client-request-id: 6c8e9279-6e60-406e-94eb-84aa0a2ab502
x-ms-request-id: 556bc330-7c90-449f-ab10-62700dcbe600
x-ms-ests-server: 2.1.22170.4 - WUS3 ProdSlices
x-ms-clitelem: 1,500011,0,,
x-ms-srs: 1.P
Content-Security-Policy-Report-Only: object-src 'none'; base-uri 'self'; script-src 'self' 'nonce-e5hajMZ-SFw3_EQEC-IbPA' 'unsafe-inline' 'unsafe-eval' https://*.msauth.net https://*.msftauth.net https://*.msftauthimages.net https://*.msauthimages.net https://*.msidentity.com https://*.microsoftonline-p.com https://*.microsoftazuread-sso.com https://*.azureedge.net https://*.outlook.com https://*.office.com https://*.office365.com https://*.microsoft.com https://*.bing.com 'report-sample'; report-uri https://csp.microsoft.com/report/ESTS-UX-All
Cross-Origin-Opener-Policy-Report-Only: same-origin; report-to="coop-endpoint"
Reporting-Endpoints: coop-endpoint="https://idux.azurewebsites.net/api/coopReport"
X-XSS-Protection: 0
Set-Cookie: fpc=As_UhB782qVJhGNbOXWQTYwUL0t-AQAAANdqiOAOAAAA; expires=Wed, 19-Nov-2025 17:39:35 GMT; path=/; secure; HttpOnly; SameSite=None, x-ms-gateway-slice=estsfd; path=/; secure; samesite=none; httponly, stsservicecookie=estsfd; path=/; secure; samesite=none; httponly
Date: Mon, 20 Oct 2025 17:39:35 GMT

   --- End of inner exception stack trace ---
   at Azure.Identity.CredentialDiagnosticScope.FailWrapAndThrow(Exception ex, String additionalMessage, Boolean isCredentialUnavailable)
   at Azure.Identity.ClientSecretCredential.GetTokenAsync(TokenRequestContext requestContext, CancellationToken cancellationToken)
   at Spaarke.Dataverse.DataverseServiceClientImpl.&lt;&gt;c__DisplayClass3_0.&lt;&lt;-ctor&gt;b__0&gt;d.MoveNext() in C:\code_files\spaarke\src\shared\Spaarke.Dataverse\DataverseServiceClientImpl.cs:line 60
--- End of stack trace from previous location ---
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.ConnectAndInitServiceAsync(OrganizationDetail orgdata, Boolean IsOnPrem, Uri homeRealmUri)
   --- End of inner exception stack trace ---
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.ConnectAndInitServiceAsync(OrganizationDetail orgdata, Boolean IsOnPrem, Uri homeRealmUri)
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.DoDirectLoginAsync(Boolean IsOnPrem)
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.InitServiceAsync()
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.GetCachedService(ConnectionService&amp; ConnectionObject)
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.IntilizeService(ConnectionService&amp; ConnectionObject)
   at Microsoft.PowerPlatform.Dataverse.Client.ConnectionService.DoLogin(ConnectionService&amp; ConnectionObject)
   at Microsoft.PowerPlatform.Dataverse.Client.ServiceClient.CreateServiceConnection(Object externalOrgServiceProxy, AuthenticationType requestedAuthType, String hostName, String port, String orgName, NetworkCredential credential, String userId, SecureString password, String domain, String Geo, String claimsHomeRealm, Boolean useSsl, Boolean useUniqueInstance, OrganizationDetail orgDetail, String clientId, Uri redirectUri, PromptBehavior promptBehavior, OrganizationWebProxyClientAsync externalOrgWebProxyClient, String certificateThumbPrint, StoreName certificateStoreName, X509Certificate2 certificate, Uri instanceUrl, Boolean isCloned, Boolean useDefaultCreds, Version incomingOrgVersion, ILogger externalLogger, String tokenCacheStorePath)
   --- End of inner exception stack trace ---
   at Microsoft.PowerPlatform.Dataverse.Client.ServiceClient.CreateServiceConnection(Object externalOrgServiceProxy, AuthenticationType requestedAuthType, String hostName, String port, String orgName, NetworkCredential credential, String userId, SecureString password, String domain, String Geo, String claimsHomeRealm, Boolean useSsl, Boolean useUniqueInstance, OrganizationDetail orgDetail, String clientId, Uri redirectUri, PromptBehavior promptBehavior, OrganizationWebProxyClientAsync externalOrgWebProxyClient, String certificateThumbPrint, StoreName certificateStoreName, X509Certificate2 certificate, Uri instanceUrl, Boolean isCloned, Boolean useDefaultCreds, Version incomingOrgVersion, ILogger externalLogger, String tokenCacheStorePath)
   at Microsoft.PowerPlatform.Dataverse.Client.ServiceClient..ctor(Uri instanceUrl, Func`2 tokenProviderFunction, Boolean useUniqueInstance, ILogger logger)
   at Spaarke.Dataverse.DataverseServiceClientImpl..ctor(IConfiguration configuration, ILogger`1 logger) in C:\code_files\spaarke\src\shared\Spaarke.Dataverse\DataverseServiceClientImpl.cs:line 55
   at Program.&lt;&gt;c.&lt;&lt;Main&gt;$&gt;b__0_2(IServiceProvider sp) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Program.cs:line 267
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitRootCache(ServiceCallSite callSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.Resolve(ServiceCallSite callSite, ServiceProviderEngineScope scope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method70(Closure, IServiceProvider, Object[])
   at Microsoft.Extensions.Http.DefaultTypedHttpClientFactory`1.CreateClient(HttpClient httpClient)
   at Microsoft.Extensions.DependencyInjection.HttpClientBuilderExtensions.AddTransientHelper[TClient,TImplementation](IServiceProvider s, IHttpClientBuilder builder)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitDisposeCache(ServiceCallSite transientCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitCache(ServiceCallSite callSite, RuntimeResolverContext context, ServiceProviderEngineScope serviceProviderEngine, RuntimeResolverLock lockType)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitScopeCache(ServiceCallSite callSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitCache(ServiceCallSite callSite, RuntimeResolverContext context, ServiceProviderEngineScope serviceProviderEngine, RuntimeResolverLock lockType)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitScopeCache(ServiceCallSite callSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitIEnumerable(IEnumerableCallSite enumerableCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitDisposeCache(ServiceCallSite transientCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitDisposeCache(ServiceCallSite transientCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitDisposeCache(ServiceCallSite transientCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.Resolve(ServiceCallSite callSite, ServiceProviderEngineScope scope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.DynamicServiceProviderEngine.&lt;&gt;c__DisplayClass2_0.&lt;RealizeService&gt;b__0(ServiceProviderEngineScope scope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Spe.Bff.Api.Api.SecurityHeadersMiddleware.Invoke(HttpContext ctx) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Api\SecurityHeadersMiddleware.cs:line 21
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
</Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1012</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T17:42:02Z"/><EventRecordID>1469599109</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Application 'C:\home\site\wwwroot\' was recycled after detecting app_offline.htm.</Data><Data>Process Id: 2884.</Data><Data>File Version: 18.0.25232.20. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T17:42:04Z"/><EventRecordID>1469600890</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 9

BackgroundService failed

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\ServiceBusJobProcessor.cs:line 72
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T17:42:04Z"/><EventRecordID>1469600968</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 10

The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\ServiceBusJobProcessor.cs:line 72
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T17:42:06Z"/><EventRecordID>1469603265</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 9

BackgroundService failed

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.DocumentEventProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\DocumentEventProcessor.cs:line 68
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T17:42:08Z"/><EventRecordID>1469604640</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 10

The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.DocumentEventProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\DocumentEventProcessor.cs:line 68
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1033</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T17:42:09Z"/><EventRecordID>1469606046</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Application 'MACHINE/WEBROOT/APPHOST/SPE-API-DEV-67E2XZ' has shutdown.</Data><Data>Process Id: 2884.</Data><Data>File Version: 18.0.25232.20. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1032</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T17:43:49Z"/><EventRecordID>1469706250</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Application 'C:\home\site\wwwroot\' started successfully.</Data><Data>Process Id: 3604.</Data><Data>File Version: 18.0.25232.20. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>2</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T18:04:31Z"/><EventRecordID>1470948031</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Spaarke.Dataverse.DataverseServiceClientImpl
EventId: 0
SpanId: 52e6e1f3010e0d8c
TraceId: 9050221a232df6c0a85a8c0070e57e05
ParentId: 0000000000000000
RequestId: 40004113-0000-c100-b63f-84710c7967bb
RequestPath: /api/navmap/sprk_document/sprk_project_document/lookup

Relationship sprk_project_document not found on sprk_document. Available relationships: sprk_Project_Document_1n, sprk_document_DocumentType_sprk_documenttype_1n, sprk_matter_document, sprk_document_ContainerId_sprk_container_n1, lk_sprk_document_createdby, lk_sprk_document_createdonbehalfby, lk_sprk_document_modifiedby, lk_sprk_document_modifiedonbehalfby, user_sprk_document, team_sprk_document, owner_sprk_document, business_unit_sprk_document
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>2</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T18:04:31Z"/><EventRecordID>1470948046</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Program
EventId: 0
SpanId: 52e6e1f3010e0d8c
TraceId: 9050221a232df6c0a85a8c0070e57e05
ParentId: 0000000000000000
RequestId: 40004113-0000-c100-b63f-84710c7967bb
RequestPath: /api/navmap/sprk_document/sprk_project_document/lookup

Lookup navigation not found: sprk_document.sprk_project_document
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>2</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T18:05:43Z"/><EventRecordID>1471020125</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Spaarke.Dataverse.DataverseServiceClientImpl
EventId: 0
SpanId: 9e6d1ba33f24c74d
TraceId: 7e30bad230a08d2515827a4655ef4853
ParentId: 0000000000000000
RequestId: 40004118-0000-c100-b63f-84710c7967bb
RequestPath: /api/navmap/sprk_document/sprk_project_document/lookup

Relationship sprk_project_document not found on sprk_document. Available relationships: sprk_Project_Document_1n, sprk_document_DocumentType_sprk_documenttype_1n, sprk_matter_document, sprk_document_ContainerId_sprk_container_n1, lk_sprk_document_createdby, lk_sprk_document_createdonbehalfby, lk_sprk_document_modifiedby, lk_sprk_document_modifiedonbehalfby, user_sprk_document, team_sprk_document, owner_sprk_document, business_unit_sprk_document
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>2</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T18:05:43Z"/><EventRecordID>1471020125</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Program
EventId: 0
SpanId: 9e6d1ba33f24c74d
TraceId: 7e30bad230a08d2515827a4655ef4853
ParentId: 0000000000000000
RequestId: 40004118-0000-c100-b63f-84710c7967bb
RequestPath: /api/navmap/sprk_document/sprk_project_document/lookup

Lookup navigation not found: sprk_document.sprk_project_document
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T18:27:09Z"/><EventRecordID>1472305562</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 9

BackgroundService failed

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\ServiceBusJobProcessor.cs:line 72
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T18:27:09Z"/><EventRecordID>1472305734</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 10

The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\ServiceBusJobProcessor.cs:line 72
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T18:27:09Z"/><EventRecordID>1472306093</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 9

BackgroundService failed

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.DocumentEventProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\DocumentEventProcessor.cs:line 68
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T18:27:09Z"/><EventRecordID>1472306125</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 10

The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.DocumentEventProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\DocumentEventProcessor.cs:line 68
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1033</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T18:27:12Z"/><EventRecordID>1472308734</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Application 'MACHINE/WEBROOT/APPHOST/SPE-API-DEV-67E2XZ' has shutdown.</Data><Data>Process Id: 3604.</Data><Data>File Version: 18.0.25232.20. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1032</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-20T21:28:15Z"/><EventRecordID>1483172218</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Application 'C:\home\site\wwwroot\' started successfully.</Data><Data>Process Id: 6496.</Data><Data>File Version: 18.0.25232.20. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-21T02:27:02Z"/><EventRecordID>1501098421</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 9

BackgroundService failed

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\ServiceBusJobProcessor.cs:line 72
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-21T02:27:02Z"/><EventRecordID>1501098578</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 10

The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\ServiceBusJobProcessor.cs:line 72
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-21T02:27:02Z"/><EventRecordID>1501098843</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 9

BackgroundService failed

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.DocumentEventProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\DocumentEventProcessor.cs:line 68
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-21T02:27:02Z"/><EventRecordID>1501098890</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 10

The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.DocumentEventProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\DocumentEventProcessor.cs:line 68
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1033</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-21T02:27:06Z"/><EventRecordID>1501102609</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Application 'MACHINE/WEBROOT/APPHOST/SPE-API-DEV-67E2XZ' has shutdown.</Data><Data>Process Id: 6496.</Data><Data>File Version: 18.0.25232.20. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1032</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-21T03:55:18Z"/><EventRecordID>1506394625</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Application 'C:\home\site\wwwroot\' started successfully.</Data><Data>Process Id: 5856.</Data><Data>File Version: 18.0.25232.20. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-21T18:27:02Z"/><EventRecordID>1558698703</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 9

BackgroundService failed

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\ServiceBusJobProcessor.cs:line 72
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-21T18:27:02Z"/><EventRecordID>1558698875</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 10

The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\ServiceBusJobProcessor.cs:line 72
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-21T18:27:02Z"/><EventRecordID>1558699187</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 9

BackgroundService failed

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.DocumentEventProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\DocumentEventProcessor.cs:line 68
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-21T18:27:02Z"/><EventRecordID>1558699218</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 10

The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.DocumentEventProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\DocumentEventProcessor.cs:line 68
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1033</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-21T18:27:04Z"/><EventRecordID>1558701109</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Application 'MACHINE/WEBROOT/APPHOST/SPE-API-DEV-67E2XZ' has shutdown.</Data><Data>Process Id: 5856.</Data><Data>File Version: 18.0.25232.20. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1032</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-22T04:18:47Z"/><EventRecordID>1594203843</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Application 'C:\home\site\wwwroot\' started successfully.</Data><Data>Process Id: 6548.</Data><Data>File Version: 18.0.25232.20. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-22T10:41:38Z"/><EventRecordID>1617175015</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 9

BackgroundService failed

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\ServiceBusJobProcessor.cs:line 72
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-22T10:41:38Z"/><EventRecordID>1617175218</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 10

The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\ServiceBusJobProcessor.cs:line 72
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-22T10:41:39Z"/><EventRecordID>1617175546</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 9

BackgroundService failed

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.DocumentEventProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\DocumentEventProcessor.cs:line 68
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-22T10:41:39Z"/><EventRecordID>1617175578</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 10

The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.DocumentEventProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\DocumentEventProcessor.cs:line 68
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1033</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-22T10:41:40Z"/><EventRecordID>1617177421</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Application 'MACHINE/WEBROOT/APPHOST/SPE-API-DEV-67E2XZ' has shutdown.</Data><Data>Process Id: 6548.</Data><Data>File Version: 18.0.25232.20. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1032</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-22T13:28:01Z"/><EventRecordID>1627158343</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Application 'C:\home\site\wwwroot\' started successfully.</Data><Data>Process Id: 1212.</Data><Data>File Version: 18.0.25232.20. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-23T02:41:27Z"/><EventRecordID>1674763984</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 9

BackgroundService failed

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\ServiceBusJobProcessor.cs:line 72
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-23T02:41:27Z"/><EventRecordID>1674764312</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 10

The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\ServiceBusJobProcessor.cs:line 72
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-23T02:41:28Z"/><EventRecordID>1674765015</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 9

BackgroundService failed

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.DocumentEventProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\DocumentEventProcessor.cs:line 68
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-23T02:41:28Z"/><EventRecordID>1674765062</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 10

The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.DocumentEventProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\DocumentEventProcessor.cs:line 68
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1033</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-23T02:41:31Z"/><EventRecordID>1674768406</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005I2</Computer><Security/></System><EventData><Data>Application 'MACHINE/WEBROOT/APPHOST/SPE-API-DEV-67E2XZ' has shutdown.</Data><Data>Process Id: 1212.</Data><Data>File Version: 18.0.25232.20. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1032</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-25T00:42:51Z"/><EventRecordID>143052078</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005H1</Computer><Security/></System><EventData><Data>Application 'C:\home\site\wwwroot\' started successfully.</Data><Data>Process Id: 4376.</Data><Data>File Version: 18.0.25107.16. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-25T15:12:25Z"/><EventRecordID>195225781</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005H1</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 9

BackgroundService failed

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\ServiceBusJobProcessor.cs:line 72
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-25T15:12:26Z"/><EventRecordID>195226031</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005H1</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 10

The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\ServiceBusJobProcessor.cs:line 72
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-25T15:12:27Z"/><EventRecordID>195227546</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005H1</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 9

BackgroundService failed

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.DocumentEventProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\DocumentEventProcessor.cs:line 68
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-25T15:12:27Z"/><EventRecordID>195227593</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005H1</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 10

The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.DocumentEventProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\DocumentEventProcessor.cs:line 68
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1033</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-10-25T15:12:31Z"/><EventRecordID>195231218</EventRecordID><Channel>Application</Channel><Computer>DW0SDWK0005H1</Computer><Security/></System><EventData><Data>Application 'MACHINE/WEBROOT/APPHOST/SPE-API-DEV-67E2XZ' has shutdown.</Data><Data>Process Id: 4376.</Data><Data>File Version: 18.0.25107.16. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1032</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-16T03:58:19Z"/><EventRecordID>902094421</EventRecordID><Channel>Application</Channel><Computer>dw0sdwk0006R4</Computer><Security/></System><EventData><Data>Application 'C:\home\site\wwwroot\' started successfully.</Data><Data>Process Id: 2288.</Data><Data>File Version: 18.0.25301.22. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-16T04:27:38Z"/><EventRecordID>903853359</EventRecordID><Channel>Application</Channel><Computer>dw0sdwk0006R4</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 9

BackgroundService failed

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\ServiceBusJobProcessor.cs:line 72
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-16T04:27:38Z"/><EventRecordID>903853531</EventRecordID><Channel>Application</Channel><Computer>dw0sdwk0006R4</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 10

The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\ServiceBusJobProcessor.cs:line 72
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-16T04:27:39Z"/><EventRecordID>903853875</EventRecordID><Channel>Application</Channel><Computer>dw0sdwk0006R4</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 9

BackgroundService failed

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.DocumentEventProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\DocumentEventProcessor.cs:line 68
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-16T04:27:39Z"/><EventRecordID>903853937</EventRecordID><Channel>Application</Channel><Computer>dw0sdwk0006R4</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 10

The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.DocumentEventProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\DocumentEventProcessor.cs:line 68
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1033</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-16T04:27:42Z"/><EventRecordID>903856828</EventRecordID><Channel>Application</Channel><Computer>dw0sdwk0006R4</Computer><Security/></System><EventData><Data>Application 'MACHINE/WEBROOT/APPHOST/SPE-API-DEV-67E2XZ' has shutdown.</Data><Data>Process Id: 2288.</Data><Data>File Version: 18.0.25301.22. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1032</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-17T18:16:40Z"/><EventRecordID>1039994781</EventRecordID><Channel>Application</Channel><Computer>dw0sdwk0006R4</Computer><Security/></System><EventData><Data>Application 'C:\home\site\wwwroot\' started successfully.</Data><Data>Process Id: 8144.</Data><Data>File Version: 18.0.25301.22. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-18T04:27:42Z"/><EventRecordID>1076656687</EventRecordID><Channel>Application</Channel><Computer>dw0sdwk0006R4</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 9

BackgroundService failed

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\ServiceBusJobProcessor.cs:line 72
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-18T04:27:44Z"/><EventRecordID>1076658531</EventRecordID><Channel>Application</Channel><Computer>dw0sdwk0006R4</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 10

The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\ServiceBusJobProcessor.cs:line 72
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-18T04:27:45Z"/><EventRecordID>1076659250</EventRecordID><Channel>Application</Channel><Computer>dw0sdwk0006R4</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 9

BackgroundService failed

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.DocumentEventProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\DocumentEventProcessor.cs:line 68
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-18T04:27:45Z"/><EventRecordID>1076659328</EventRecordID><Channel>Application</Channel><Computer>dw0sdwk0006R4</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 10

The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.DocumentEventProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\DocumentEventProcessor.cs:line 68
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1005</EventID><Level>2</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-18T04:27:47Z"/><EventRecordID>1076661984</EventRecordID><Channel>Application</Channel><Computer>dw0sdwk0006R4</Computer><Security/></System><EventData><Data>Failed to gracefully shutdown application 'MACHINE/WEBROOT/APPHOST/SPE-API-DEV-67E2XZ'.</Data><Data>Process Id: 8144.</Data><Data>File Version: 18.0.25301.22. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1032</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-19T21:47:56Z"/><EventRecordID>1225470125</EventRecordID><Channel>Application</Channel><Computer>dw0sdwk0006R4</Computer><Security/></System><EventData><Data>Application 'C:\home\site\wwwroot\' started successfully.</Data><Data>Process Id: 2944.</Data><Data>File Version: 18.0.25301.22. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-20T03:57:30Z"/><EventRecordID>1247644015</EventRecordID><Channel>Application</Channel><Computer>dw0sdwk0006R4</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 9

BackgroundService failed

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\ServiceBusJobProcessor.cs:line 72
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-20T03:57:30Z"/><EventRecordID>1247644343</EventRecordID><Channel>Application</Channel><Computer>dw0sdwk0006R4</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 10

The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\ServiceBusJobProcessor.cs:line 72
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-20T03:57:32Z"/><EventRecordID>1247646484</EventRecordID><Channel>Application</Channel><Computer>dw0sdwk0006R4</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 9

BackgroundService failed

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.DocumentEventProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\DocumentEventProcessor.cs:line 68
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-20T03:57:32Z"/><EventRecordID>1247646562</EventRecordID><Channel>Application</Channel><Computer>dw0sdwk0006R4</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 10

The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.DocumentEventProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\DocumentEventProcessor.cs:line 68
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1033</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-20T03:57:34Z"/><EventRecordID>1247648359</EventRecordID><Channel>Application</Channel><Computer>dw0sdwk0006R4</Computer><Security/></System><EventData><Data>Application 'MACHINE/WEBROOT/APPHOST/SPE-API-DEV-67E2XZ' has shutdown.</Data><Data>Process Id: 2944.</Data><Data>File Version: 18.0.25301.22. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1032</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-20T14:22:22Z"/><EventRecordID>1285136609</EventRecordID><Channel>Application</Channel><Computer>dw0sdwk0006R4</Computer><Security/></System><EventData><Data>Application 'C:\home\site\wwwroot\' started successfully.</Data><Data>Process Id: 4820.</Data><Data>File Version: 18.0.25301.22. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1012</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-20T20:43:25Z"/><EventRecordID>1307999546</EventRecordID><Channel>Application</Channel><Computer>dw0sdwk0006R4</Computer><Security/></System><EventData><Data>Application 'C:\home\site\wwwroot\' was recycled after detecting app_offline.htm.</Data><Data>Process Id: 4820.</Data><Data>File Version: 18.0.25301.22. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-20T20:43:28Z"/><EventRecordID>1308002437</EventRecordID><Channel>Application</Channel><Computer>dw0sdwk0006R4</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 9

BackgroundService failed

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\ServiceBusJobProcessor.cs:line 72
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-20T20:43:29Z"/><EventRecordID>1308003171</EventRecordID><Channel>Application</Channel><Computer>dw0sdwk0006R4</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 10

The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\ServiceBusJobProcessor.cs:line 72
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-20T20:43:30Z"/><EventRecordID>1308003843</EventRecordID><Channel>Application</Channel><Computer>dw0sdwk0006R4</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 9

BackgroundService failed

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.DocumentEventProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\DocumentEventProcessor.cs:line 68
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-20T20:43:30Z"/><EventRecordID>1308003937</EventRecordID><Channel>Application</Channel><Computer>dw0sdwk0006R4</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 10

The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.DocumentEventProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\DocumentEventProcessor.cs:line 68
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1033</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-20T20:43:35Z"/><EventRecordID>1308009390</EventRecordID><Channel>Application</Channel><Computer>dw0sdwk0006R4</Computer><Security/></System><EventData><Data>Application 'MACHINE/WEBROOT/APPHOST/SPE-API-DEV-67E2XZ' has shutdown.</Data><Data>Process Id: 4820.</Data><Data>File Version: 18.0.25301.22. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1032</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-20T20:46:09Z"/><EventRecordID>1308163062</EventRecordID><Channel>Application</Channel><Computer>dw0sdwk0006R4</Computer><Security/></System><EventData><Data>Application 'C:\home\site\wwwroot\' started successfully.</Data><Data>Process Id: 5892.</Data><Data>File Version: 18.0.25301.22. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-21T04:41:42Z"/><EventRecordID>1336696734</EventRecordID><Channel>Application</Channel><Computer>dw0sdwk0006R4</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 9

BackgroundService failed

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\ServiceBusJobProcessor.cs:line 72
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-21T04:41:43Z"/><EventRecordID>1336697062</EventRecordID><Channel>Application</Channel><Computer>dw0sdwk0006R4</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 10

The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\ServiceBusJobProcessor.cs:line 72
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-21T04:41:43Z"/><EventRecordID>1336697468</EventRecordID><Channel>Application</Channel><Computer>dw0sdwk0006R4</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 9

BackgroundService failed

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.DocumentEventProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\DocumentEventProcessor.cs:line 68
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-21T04:41:43Z"/><EventRecordID>1336697500</EventRecordID><Channel>Application</Channel><Computer>dw0sdwk0006R4</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 10

The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.DocumentEventProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\DocumentEventProcessor.cs:line 68
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1033</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-21T04:41:48Z"/><EventRecordID>1336701968</EventRecordID><Channel>Application</Channel><Computer>dw0sdwk0006R4</Computer><Security/></System><EventData><Data>Application 'MACHINE/WEBROOT/APPHOST/SPE-API-DEV-67E2XZ' has shutdown.</Data><Data>Process Id: 5892.</Data><Data>File Version: 18.0.25301.22. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1032</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-24T15:27:04Z"/><EventRecordID>276233812</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Application 'C:\home\site\wwwroot\' started successfully.</Data><Data>Process Id: 5548.</Data><Data>File Version: 18.0.25301.22. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-24T22:23:30Z"/><EventRecordID>301219671</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Category: Microsoft.IdentityModel.LoggingExtensions.IdentityLoggerAdapter
EventId: 0
SpanId: 578f34e1913e2675
TraceId: 079ca96bfdbdab818656461eecbaae6d
ParentId: 0000000000000000
RequestId: 400012a3-0000-f000-b63f-84710c7967bb
RequestPath: /api/documents/01LBYCMX76QPLGITR47BB355T4G2CVDL2B/preview-url

IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '11/24/2025 7:10:39 PM', Current time (UTC): '11/24/2025 10:23:30 PM'.
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-25T13:44:56Z"/><EventRecordID>356506046</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Category: Microsoft.IdentityModel.LoggingExtensions.IdentityLoggerAdapter
EventId: 0
SpanId: d70ec73b2357c909
TraceId: 852838ba14fcaf1e14c1d6d289be77fc
ParentId: 0000000000000000
RequestId: 4000107a-0000-d200-b63f-84710c7967bb
RequestPath: /api/documents/e10647ae-2fc6-f011-8543-7ced8d1a8360/preview-url

IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '11/24/2025 11:53:13 PM', Current time (UTC): '11/25/2025 1:44:56 PM'.
</Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1012</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-25T21:22:09Z"/><EventRecordID>383938468</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Application 'C:\home\site\wwwroot\' was recycled after detecting app_offline.htm.</Data><Data>Process Id: 5548.</Data><Data>File Version: 18.0.25301.22. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-25T21:22:15Z"/><EventRecordID>383944109</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 9

BackgroundService failed

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor.ExecuteAsync(CancellationToken stoppingToken)
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-25T21:22:15Z"/><EventRecordID>383944421</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 10

The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor.ExecuteAsync(CancellationToken stoppingToken)
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-25T21:22:16Z"/><EventRecordID>383945562</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 9

BackgroundService failed

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.DocumentEventProcessor.ExecuteAsync(CancellationToken stoppingToken)
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-25T21:22:16Z"/><EventRecordID>383945640</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 10

The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.DocumentEventProcessor.ExecuteAsync(CancellationToken stoppingToken)
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1005</EventID><Level>2</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-25T21:22:20Z"/><EventRecordID>383949968</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Failed to gracefully shutdown application 'MACHINE/WEBROOT/APPHOST/SPE-API-DEV-67E2XZ'.</Data><Data>Process Id: 5548.</Data><Data>File Version: 18.0.25301.22. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-25T21:23:34Z"/><EventRecordID>384023593</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Category: Microsoft.AspNetCore.Hosting.Diagnostics
EventId: 6

Application startup exception

Exception: 
System.InvalidOperationException: Body was inferred but the method does not allow inferred body parameters.
Below is the list of parameters that we found: 

Parameter           | Source                        
---------------------------------------------------------------------------------
documentId          | Route (Inferred)
documentStorageResolver | Services (Inferred)
speFileStore        | Services (Inferred)
logger              | Body (Inferred)


Did you mean to register the "Body (Inferred)" parameter(s) as a Service or apply the [FromServices] or [FromBody] attribute?


   at Microsoft.AspNetCore.Http.RequestDelegateFactory.CreateArguments(ParameterInfo[] parameters, RequestDelegateFactoryContext factoryContext)
   at Microsoft.AspNetCore.Http.RequestDelegateFactory.CreateArgumentsAndInferMetadata(MethodInfo methodInfo, RequestDelegateFactoryContext factoryContext)
   at Microsoft.AspNetCore.Http.RequestDelegateFactory.InferMetadata(MethodInfo methodInfo, RequestDelegateFactoryOptions options)
   at Microsoft.AspNetCore.Routing.RouteEndpointDataSource.CreateRouteEndpointBuilder(RouteEntry entry, RoutePattern groupPrefix, IReadOnlyList`1 groupConventions, IReadOnlyList`1 groupFinallyConventions)
   at Microsoft.AspNetCore.Routing.RouteEndpointDataSource.GetGroupedEndpoints(RouteGroupContext context)
   at Microsoft.AspNetCore.Routing.RouteGroupBuilder.GroupEndpointDataSource.GetGroupedEndpointsWithNullablePrefix(RoutePattern prefix, IReadOnlyList`1 conventions, IReadOnlyList`1 finallyConventions, IServiceProvider applicationServices)
   at Microsoft.AspNetCore.Routing.RouteGroupBuilder.GroupEndpointDataSource.get_Endpoints()
   at Microsoft.AspNetCore.Routing.CompositeEndpointDataSource.CreateEndpointsUnsynchronized()
   at Microsoft.AspNetCore.Routing.CompositeEndpointDataSource.EnsureEndpointsInitialized()
   at Microsoft.AspNetCore.Routing.CompositeEndpointDataSource.get_Endpoints()
   at Microsoft.AspNetCore.Routing.DataSourceDependentCache`1.Initialize()
   at System.Threading.LazyInitializer.EnsureInitializedCore[T](T&amp; target, Boolean&amp; initialized, Object&amp; syncLock, Func`1 valueFactory)
   at Microsoft.AspNetCore.Routing.DataSourceDependentCache`1.EnsureInitialized()
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationPolicyCache..ctor(EndpointDataSource dataSource)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitRootCache(ServiceCallSite callSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.Resolve(ServiceCallSite callSite, ServiceProviderEngineScope scope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetService[T](IServiceProvider provider)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware..ctor(RequestDelegate next, IAuthorizationPolicyProvider policyProvider, IServiceProvider services)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddlewareInternal..ctor(RequestDelegate next, IServiceProvider services, IAuthorizationPolicyProvider policyProvider, ILogger`1 logger)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-25T21:23:35Z"/><EventRecordID>384024265</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 11

Hosting failed to start

Exception: 
System.InvalidOperationException: Body was inferred but the method does not allow inferred body parameters.
Below is the list of parameters that we found: 

Parameter           | Source                        
---------------------------------------------------------------------------------
documentId          | Route (Inferred)
documentStorageResolver | Services (Inferred)
speFileStore        | Services (Inferred)
logger              | Body (Inferred)


Did you mean to register the "Body (Inferred)" parameter(s) as a Service or apply the [FromServices] or [FromBody] attribute?


   at Microsoft.AspNetCore.Http.RequestDelegateFactory.CreateArguments(ParameterInfo[] parameters, RequestDelegateFactoryContext factoryContext)
   at Microsoft.AspNetCore.Http.RequestDelegateFactory.CreateArgumentsAndInferMetadata(MethodInfo methodInfo, RequestDelegateFactoryContext factoryContext)
   at Microsoft.AspNetCore.Http.RequestDelegateFactory.InferMetadata(MethodInfo methodInfo, RequestDelegateFactoryOptions options)
   at Microsoft.AspNetCore.Routing.RouteEndpointDataSource.CreateRouteEndpointBuilder(RouteEntry entry, RoutePattern groupPrefix, IReadOnlyList`1 groupConventions, IReadOnlyList`1 groupFinallyConventions)
   at Microsoft.AspNetCore.Routing.RouteEndpointDataSource.GetGroupedEndpoints(RouteGroupContext context)
   at Microsoft.AspNetCore.Routing.RouteGroupBuilder.GroupEndpointDataSource.GetGroupedEndpointsWithNullablePrefix(RoutePattern prefix, IReadOnlyList`1 conventions, IReadOnlyList`1 finallyConventions, IServiceProvider applicationServices)
   at Microsoft.AspNetCore.Routing.RouteGroupBuilder.GroupEndpointDataSource.get_Endpoints()
   at Microsoft.AspNetCore.Routing.CompositeEndpointDataSource.CreateEndpointsUnsynchronized()
   at Microsoft.AspNetCore.Routing.CompositeEndpointDataSource.EnsureEndpointsInitialized()
   at Microsoft.AspNetCore.Routing.CompositeEndpointDataSource.get_Endpoints()
   at Microsoft.AspNetCore.Routing.DataSourceDependentCache`1.Initialize()
   at System.Threading.LazyInitializer.EnsureInitializedCore[T](T&amp; target, Boolean&amp; initialized, Object&amp; syncLock, Func`1 valueFactory)
   at Microsoft.AspNetCore.Routing.DataSourceDependentCache`1.EnsureInitialized()
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationPolicyCache..ctor(EndpointDataSource dataSource)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitRootCache(ServiceCallSite callSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.Resolve(ServiceCallSite callSite, ServiceProviderEngineScope scope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetService[T](IServiceProvider provider)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware..ctor(RequestDelegate next, IAuthorizationPolicyProvider policyProvider, IServiceProvider services)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddlewareInternal..ctor(RequestDelegate next, IServiceProvider services, IAuthorizationPolicyProvider policyProvider, ILogger`1 logger)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.&lt;StartAsync&gt;b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1026</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-25T21:23:39Z"/><EventRecordID>384028437</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Application: w3wp.exe
CoreCLR Version: 8.0.2225.52707
.NET Version: 8.0.22
Description: The process was terminated due to an unhandled exception.
Exception Info: System.InvalidOperationException: Body was inferred but the method does not allow inferred body parameters.
Below is the list of parameters that we found: 

Parameter           | Source                        
---------------------------------------------------------------------------------
documentId          | Route (Inferred)
documentStorageResolver | Services (Inferred)
speFileStore        | Services (Inferred)
logger              | Body (Inferred)


Did you mean to register the "Body (Inferred)" parameter(s) as a Service or apply the [FromServices] or [FromBody] attribute?


   at Microsoft.AspNetCore.Http.RequestDelegateFactory.CreateArguments(ParameterInfo[] parameters, RequestDelegateFactoryContext factoryContext)
   at Microsoft.AspNetCore.Http.RequestDelegateFactory.CreateArgumentsAndInferMetadata(MethodInfo methodInfo, RequestDelegateFactoryContext factoryContext)
   at Microsoft.AspNetCore.Http.RequestDelegateFactory.InferMetadata(MethodInfo methodInfo, RequestDelegateFactoryOptions options)
   at Microsoft.AspNetCore.Routing.RouteEndpointDataSource.CreateRouteEndpointBuilder(RouteEntry entry, RoutePattern groupPrefix, IReadOnlyList`1 groupConventions, IReadOnlyList`1 groupFinallyConventions)
   at Microsoft.AspNetCore.Routing.RouteEndpointDataSource.GetGroupedEndpoints(RouteGroupContext context)
   at Microsoft.AspNetCore.Routing.RouteGroupBuilder.GroupEndpointDataSource.GetGroupedEndpointsWithNullablePrefix(RoutePattern prefix, IReadOnlyList`1 conventions, IReadOnlyList`1 finallyConventions, IServiceProvider applicationServices)
   at Microsoft.AspNetCore.Routing.RouteGroupBuilder.GroupEndpointDataSource.get_Endpoints()
   at Microsoft.AspNetCore.Routing.CompositeEndpointDataSource.CreateEndpointsUnsynchronized()
   at Microsoft.AspNetCore.Routing.CompositeEndpointDataSource.EnsureEndpointsInitialized()
   at Microsoft.AspNetCore.Routing.CompositeEndpointDataSource.get_Endpoints()
   at Microsoft.AspNetCore.Routing.DataSourceDependentCache`1.Initialize()
   at System.Threading.LazyInitializer.EnsureInitializedCore[T](T&amp; target, Boolean&amp; initialized, Object&amp; syncLock, Func`1 valueFactory)
   at Microsoft.AspNetCore.Routing.DataSourceDependentCache`1.EnsureInitialized()
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationPolicyCache..ctor(EndpointDataSource dataSource)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitRootCache(ServiceCallSite callSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.Resolve(ServiceCallSite callSite, ServiceProviderEngineScope scope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetService[T](IServiceProvider provider)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware..ctor(RequestDelegate next, IAuthorizationPolicyProvider policyProvider, IServiceProvider services)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddlewareInternal..ctor(RequestDelegate next, IServiceProvider services, IAuthorizationPolicyProvider policyProvider, ILogger`1 logger)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.&lt;StartAsync&gt;b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)
   at Microsoft.Extensions.Hosting.Internal.Host.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Run(IHost host)
   at Program.&lt;Main&gt;$(String[] args) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Program.cs:line 710
</Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1018</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-25T21:23:40Z"/><EventRecordID>384029718</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Application '/LM/W3SVC/424429371/ROOT' with physical root 'C:\home\site\wwwroot\' hit unexpected managed exception, exception code = '0xe0434352'. First 30KB characters of captured stdout and stderr logs:
? Job processing configured with Service Bus (queue: sdap-jobs)
warn: Program[0]
      Distributed cache: Using in-memory cache (not distributed). This should ONLY be used in local development.
info: Program[0]
      CORS: Configured with 5 allowed origins: http://localhost:3000, http://localhost:3001, http://127.0.0.1:3000, https://spaarkedev1.crm.dynamics.com, https://spaarkedev1.api.crm.dynamics.com
dbug: Microsoft.Extensions.Hosting.Internal.Host[1]
      Hosting starting
info: Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager[64]
      Azure Web Sites environment detected. Using 'C:\home\ASP.NET\DataProtection-Keys' as key repository; keys will not be encrypted at rest.
info: Spe.Bff.Api.Infrastructure.Startup.StartupValidationService[0]
      Starting configuration validation...
info: Spe.Bff.Api.Infrastructure.Startup.StartupValidationService[0]
      ? Configuration validation successful
info: Spe.Bff.Api.Infrastructure.Startup.StartupValidationService[0]
      Configuration Summary:
info: Spe.Bff.Api.Infrastructure.Startup.StartupValidationService[0]
        Graph API:
info: Spe.Bff.Api.Infrastructure.Startup.StartupValidationService[0]
          - TenantId: a221a95e-6abc-4434-aecc-e48338a1b2f2
info: Spe.Bff.Api.Infrastructure.Startup.StartupValidationService[0]
          - ClientId: 1e40...458c
info: Spe.Bff.Api.Infrastructure.Startup.StartupValidationService[0]
          - ManagedIdentity: False
info: Spe.Bff.Api.Infrastructure.Startup.StartupValidationService[0]
        Dataverse:
info: Spe.Bff.Api.Infrastructure.Startup.StartupValidationService[0]
          - Environment: https://spaarkedev1.crm.dynamics.com
info: Spe.Bff.Api.Infrastructure.Startup.StartupValidationService[0]
          - ClientId: 1e40...458c
info: Spe.Bff.Api.Infrastructure.Startup.StartupValidationService[0]
        Service Bus:
info: Spe.Bff.Api.Infrastructure.Startup.StartupValidationService[0]
          - Queue: document-events
info: Spe.Bff.Api.Infrastructure.Startup.StartupValidationService[0]
          - MaxConcurrency: 2
info: Spe.Bff.Api.Infrastructure.Startup.StartupValidationService[0]
        Redis:
info: Spe.Bff.Api.Infrastructure.Startup.StartupValidationService[0]
          - Enabled: False
info: Spe.Bff.Api.Infrastructure.Startup.StartupValidationService[0]
          - InstanceName: sdap-dev:
dbug: Microsoft.AspNetCore.DataProtection.Repositories.FileSystemXmlRepository[37]
      Reading data from file 'C:\home\ASP.NET\DataProtection-Keys\key-4705609b-f7ee-498d-8862-969d9a2e5fb1.xml'.
dbug: Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager[18]
      Found key {4705609b-f7ee-498d-8862-969d9a2e5fb1}.
dbug: Microsoft.AspNetCore.DataProtection.KeyManagement.DefaultKeyResolver[13]
      Considering key {4705609b-f7ee-498d-8862-969d9a2e5fb1} with expiration date 2026-01-04 12:20:44Z as default key.
dbug: Microsoft.AspNetCore.DataProtection.TypeForwardingActivator[0]
      Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
dbug: Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.CngCbcAuthenticatedEncryptorFactory[4]
      Opening CNG algorithm 'AES' from provider '(null)' with chaining mode CBC.
dbug: Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.CngCbcAuthenticatedEncryptorFactory[3]
      Opening CNG algorithm 'SHA256' from provider '(null)' with HMAC.
dbug: Microsoft.AspNetCore.DataProtection.KeyManagement.KeyRingProvider[2]
      Using key {4705609b-f7ee-498d-8862-969d9a2e5fb1} as the default key.
dbug: Microsoft.AspNetCore.DataProtection.Internal.DataProtectionHostedService[65]
      Key ring with default key {4705609b-f7ee-498d-8862-969d9a2e5fb1} was loaded during application startup.
info: Spe.Bff.Api.Services.Jobs.DocumentEventProcessor[0]
      Document Event Processor starting...
info: Spe.Bff.Api.Services.Jobs.DocumentEventProcessor[0]
      Document Event Processor started successfully
info: Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor[0]
      Service Bus Job Processor starting for queue sdap-jobs with 2 concurrent calls...
info: Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor[0]
      Service Bus Job Processor started successfully
crit: Microsoft.AspNetCore.Hosting.Diagnostics[6]
      Application startup exception
      System.InvalidOperationException: Body was inferred but the method does not allow inferred body parameters.
      Below is the list of parameters that we found: 
      
      Parameter           | Source                        
      ---------------------------------------------------------------------------------
      documentId          | Route (Inferred)
      documentStorageResolver | Services (Inferred)
      speFileStore        | Services (Inferred)
      logger              | Body (Inferred)
      
      
      Did you mean to register the "Body (Inferred)" parameter(s) as a Service or apply the [FromServices] or [FromBody] attribute?
      
      
         at Microsoft.AspNetCore.Http.RequestDelegateFactory.CreateArguments(ParameterInfo[] parameters, RequestDelegateFactoryContext factoryContext)
         at Microsoft.AspNetCore.Http.RequestDelegateFactory.CreateArgumentsAndInferMetadata(MethodInfo methodInfo, RequestDelegateFactoryContext factoryContext)
         at Microsoft.AspNetCore.Http.RequestDelegateFactory.InferMetadata(MethodInfo methodInfo, RequestDelegateFactoryOptions options)
         at Microsoft.AspNetCore.Routing.RouteEndpointDataSource.CreateRouteEndpointBuilder(RouteEntry entry, RoutePattern groupPrefix, IReadOnlyList`1 groupConventions, IReadOnlyList`1 groupFinallyConventions)
         at Microsoft.AspNetCore.Routing.RouteEndpointDataSource.GetGroupedEndpoints(RouteGroupContext context)
         at Microsoft.AspNetCore.Routing.RouteGroupBuilder.GroupEndpointDataSource.GetGroupedEndpointsWithNullablePrefix(RoutePattern prefix, IReadOnlyList`1 conventions, IReadOnlyList`1 finallyConventions, IServiceProvider applicationServices)
         at Microsoft.AspNetCore.Routing.RouteGroupBuilder.GroupEndpointDataSource.get_Endpoints()
         at Microsoft.AspNetCore.Routing.CompositeEndpointDataSource.CreateEndpointsUnsynchronized()
         at Microsoft.AspNetCore.Routing.CompositeEndpointDataSource.EnsureEndpointsInitialized()
         at Microsoft.AspNetCore.Routing.CompositeEndpointDataSource.get_Endpoints()
         at Microsoft.AspNetCore.Routing.DataSourceDependentCache`1.Initialize()
         at System.Threading.LazyInitializer.EnsureInitializedCore[T](T&amp; target, Boolean&amp; initialized, Object&amp; syncLock, Func`1 valueFactory)
         at Microsoft.AspNetCore.Routing.DataSourceDependentCache`1.EnsureInitialized()
         at Microsoft.AspNetCore.Authorization.Policy.AuthorizationPolicyCache..ctor(EndpointDataSource dataSource)
         at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
         at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
         at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
         at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
         at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)
         at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
         at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitRootCache(ServiceCallSite callSite, RuntimeResolverContext context)
         at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
         at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.Resolve(ServiceCallSite callSite, ServiceProviderEngineScope scope)
         at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
         at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
         at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
         at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
         at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetService[T](IServiceProvider provider)
         at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware..ctor(RequestDelegate next, IAuthorizationPolicyProvider policyProvider, IServiceProvider services)
         at Microsoft.AspNetCore.Authorization.AuthorizationMiddlewareInternal..ctor(RequestDelegate next, IServiceProvider services, IAuthorizationPolicyProvider policyProvider, ILogger`1 logger)
         at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
         at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
         at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
         at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
         at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
         at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
         at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
         at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
         at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
         at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
fail: Microsoft.Extensions.Hosting.Internal.Host[11]
      Hosting failed to start
      System.InvalidOperationException: Body was inferred but the method does not allow inferred body parameters.
      Below is the list of parameters that we found: 
      
      Parameter           | Source                        
      ---------------------------------------------------------------------------------
      documentId          | Route (Inferred)
      documentStorageResolver | Services (Inferred)
      speFileStore        | Services (Inferred)
      logger              | Body (Inferred)
      
      
      Did you mean to register the "Body (Inferred)" parameter(s) as a Service or apply the [FromServices] or [FromBody] attribute?
      
      
         at Microsoft.AspNetCore.Http.RequestDelegateFactory.CreateArguments(ParameterInfo[] parameters, RequestDelegateFactoryContext factoryContext)
         at Microsoft.AspNetCore.Http.RequestDelegateFactory.CreateArgumentsAndInferMetadata(MethodInfo methodInfo, RequestDelegateFactoryContext factoryContext)
         at Microsoft.AspNetCore.Http.RequestDelegateFactory.InferMetadata(MethodInfo methodInfo, RequestDelegateFactoryOptions options)
         at Microsoft.AspNetCore.Routing.RouteEndpointDataSource.CreateRouteEndpointBuilder(RouteEntry entry, RoutePattern groupPrefix, IReadOnlyList`1 groupConventions, IReadOnlyList`1 groupFinallyConventions)
         at Microsoft.AspNetCore.Routing.RouteEndpointDataSource.GetGroupedEndpoints(RouteGroupContext context)
         at Microsoft.AspNetCore.Routing.RouteGroupBuilder.GroupEndpointDataSource.GetGroupedEndpointsWithNullablePrefix(RoutePattern prefix, IReadOnlyList`1 conventions, IReadOnlyList`1 finallyConventions, IServiceProvider applicationServices)
         at Microsoft.AspNetCore.Routing.RouteGroupBuilder.GroupEndpointDataSource.get_Endpoints()
         at Microsoft.AspNetCore.Routing.CompositeEndpointDataSource.CreateEndpointsUnsynchronized()
         at Microsoft.AspNetCore.Routing.CompositeEndpointDataSource.EnsureEndpointsInitialized()
         at Microsoft.AspNetCore.Routing.CompositeEndpointDataSource.get_Endpoints()
         at Microsoft.AspNetCore.Routing.DataSourceDependentCache`1.Initialize()
         at System.Threading.LazyInitializer.EnsureInitializedCore[T](T&amp; target, Boolean&amp; initialized, Object&amp; syncLock, Func`1 valueFactory)
         at Microsoft.AspNetCore.Routing.DataSourceDependentCache`1.EnsureInitialized()
         at Microsoft.AspNetCore.Authorization.Policy.AuthorizationPolicyCache..ctor(EndpointDataSource dataSource)
         at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
         at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
         at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
         at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
         at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)
         at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
         at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitRootCache(ServiceCallSite callSite, RuntimeResolverContext context)
         at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
         at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.Resolve(ServiceCallSite callSite, ServiceProviderEngineScope scope)
         at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
         at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
         at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
         at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
         at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetService[T](IServiceProvider provider)
         at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware..ctor(RequestDelegate next, IAuthorizationPolicyProvider policyProvider, IServiceProvider services)
         at Microsoft.AspNetCore.Authorization.AuthorizationMiddlewareInternal..ctor(RequestDelegate next, IServiceProvider services, IAuthorizationPolicyProvider policyProvider, ILogger`1 logger)
         at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
         at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
         at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
         at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
         at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
         at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
         at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
         at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
         at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
         at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
         at Microsoft.Extensions.Hosting.Internal.Host.&lt;StartAsync&gt;b__15_1(IHostedService service, CancellationToken token)
         at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)
info: Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor[0]
      Service Bus Job Processor stopping...
info: Spe.Bff.Api.Services.Jobs.DocumentEventProcessor[0]
      Document Event Processor stopping...
Unhandled exception. System.InvalidOperationException: Body was inferred but the method does not allow inferred body parameters.
Below is the list of parameters that we found: 

Parameter           | Source                        
---------------------------------------------------------------------------------
documentId          | Route (Inferred)
documentStorageResolver | Services (Inferred)
speFileStore        | Services (Inferred)
logger              | Body (Inferred)


Did you mean to register the "Body (Inferred)" parameter(s) as a Service or apply the [FromServices] or [FromBody] attribute?


   at Microsoft.AspNetCore.Http.RequestDelegateFactory.CreateArguments(ParameterInfo[] parameters, RequestDelegateFactoryContext factoryContext)
   at Microsoft.AspNetCore.Http.RequestDelegateFactory.CreateArgumentsAndInferMetadata(MethodInfo methodInfo, RequestDelegateFactoryContext factoryContext)
   at Microsoft.AspNetCore.Http.RequestDelegateFactory.InferMetadata(MethodInfo methodInfo, RequestDelegateFactoryOptions options)
   at Microsoft.AspNetCore.Routing.RouteEndpointDataSource.CreateRouteEndpointBuilder(RouteEntry entry, RoutePattern groupPrefix, IReadOnlyList`1 groupConventions, IReadOnlyList`1 groupFinallyConventions)
   at Microsoft.AspNetCore.Routing.RouteEndpointDataSource.GetGroupedEndpoints(RouteGroupContext context)
   at Microsoft.AspNetCore.Routing.RouteGroupBuilder.GroupEndpointDataSource.GetGroupedEndpointsWithNullablePrefix(RoutePattern prefix, IReadOnlyList`1 conventions, IReadOnlyList`1 finallyConventions, IServiceProvider applicationServices)
   at Microsoft.AspNetCore.Routing.RouteGroupBuilder.GroupEndpointDataSource.get_Endpoints()
   at Microsoft.AspNetCore.Routing.CompositeEndpointDataSource.CreateEndpointsUnsynchronized()
   at Microsoft.AspNetCore.Routing.CompositeEndpointDataSource.EnsureEndpointsInitialized()
   at Microsoft.AspNetCore.Routing.CompositeEndpointDataSource.get_Endpoints()
   at Microsoft.AspNetCore.Routing.DataSourceDependentCache`1.Initialize()
   at System.Threading.LazyInitializer.EnsureInitializedCore[T](T&amp; target, Boolean&amp; initialized, Object&amp; syncLock, Func`1 valueFactory)
   at Microsoft.AspNetCore.Routing.DataSourceDependentCache`1.EnsureInitialized()
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationPolicyCache..ctor(EndpointDataSource dataSource)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitRootCache(ServiceCallSite callSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.Resolve(ServiceCallSite callSite, ServiceProviderEngineScope scope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetService[T](IServiceProvider provider)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware..ctor(RequestDelegate next, IAuthorizationPolicyProvider policyProvider, IServiceProvider services)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddlewareInternal..ctor(RequestDelegate next, IServiceProvider services, IAuthorizationPolicyProvider policyProvider, ILogger`1 logger)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.&lt;StartAsync&gt;b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)
   at Microsoft.Extensions.Hosting.Internal.Host.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Run(IHost host)
   at Program.&lt;Main&gt;$(String[] args) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Program.cs:line 710
fail: Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor[0]
      Service Bus processor error in sdap-jobs (source: Receive): A task was canceled. (ServiceCommunicationProblem). For troubleshooting information, see https://aka.ms/azsdk/net/servicebus/exceptions/troubleshoot.
      Azure.Messaging.ServiceBus.ServiceBusException: A task was canceled. (ServiceCommunicationProblem). For troubleshooting information, see https://aka.ms/azsdk/net/servicebus/exceptions/troubleshoot.
       ---&gt; System.Threading.Tasks.TaskCanceledException: A task was canceled.
         at Microsoft.Azure.Amqp.TaskHelpers.EndAsyncResult(IAsyncResult asyncResult)
         at Microsoft.Azure.Amqp.IteratorAsyncResult`1.&lt;&gt;c.&lt;CallTask&gt;b__24_1(TIteratorAsyncResult thisPtr, IAsyncResult r)
         at Microsoft.Azure.Amqp.IteratorAsyncResult`1.StepCallback(IAsyncResult result)
      --- End of stack trace from previous location ---
         at Microsoft.Azure.Amqp.ExceptionDispatcher.Throw(Exception exception)
         at Microsoft.Azure.Amqp.AsyncResult.End[TAsyncResult](IAsyncResult result)
         at Microsoft.Azure.Amqp.AsyncResult`1.End(IAsyncResult asyncResult)
         at Microsoft.Azure.Amqp.AmqpCbsLink.EndSendToken(IAsyncResult result)
         at Microsoft.Azure.Amqp.AmqpCbsLink.&lt;&gt;c.&lt;SendTokenAsync&gt;b__4_1(IAsyncResult r)
         at System.Threading.Tasks.TaskFactory`1.FromAsyncCoreLogic(IAsyncResult iar, Func`2 endFunction, Action`1 endAction, Task`1 promise, Boolean requiresSynchronization)
      --- End of stack trace from previous location ---
         at Azure.Messaging.ServiceBus.Amqp.AmqpConnectionScope.RequestAuthorizationUsingCbsAsync(AmqpConnection connection, CbsTokenProvider tokenProvider, Uri endpoint, String[] audience, String[] requiredClaims, TimeSpan timeout, String identifier)
         at Azure.Messaging.ServiceBus.Amqp.AmqpConnectionScope.CreateReceivingLinkAsync(String entityPath, String identifier, AmqpConnection connection, Uri endpoint, TimeSpan timeout, UInt32 prefetchCount, ServiceBusReceiveMode receiveMode, String sessionId, Boolean isSessionReceiver, CancellationToken cancellationToken)
         --- End of inner exception stack trace ---
         at Azure.Messaging.ServiceBus.Amqp.AmqpConnectionScope.CreateReceivingLinkAsync(String entityPath, String identifier, AmqpConnection connection, Uri endpoint, TimeSpan timeout, UInt32 prefetchCount, ServiceBusReceiveMode receiveMode, String sessionId, Boolean isSessionReceiver, CancellationToken cancellationToken)
         at Azure.Messaging.ServiceBus.Amqp.AmqpConnectionScope.OpenReceiverLinkAsync(String identifier, String entityPath, TimeSpan timeout, UInt32 prefetchCount, ServiceBusReceiveMode receiveMode, String sessionId, Boolean isSessionReceiver, CancellationToken cancellationToken)
         at Azure.Messaging.ServiceBus.Amqp.AmqpReceiver.OpenReceiverLinkAsync(TimeSpan timeout, UInt32 prefetchCount, ServiceBusReceiveMode receiveMode, String identifier, CancellationToken cancellationToken)
         at Microsoft.Azure.Amqp.FaultTolerantAmqpObject`1.OnCreateAsync(TimeSpan timeout, CancellationToken cancellationToken)
         at Microsoft.Azure.Amqp.Singleton`1.GetOrCreateAsync(TimeSpan timeout, CancellationToken cancellationToken)
         at Microsoft.Azure.Amqp.Singleton`1.GetOrCreateAsync(TimeSpan timeout, CancellationToken cancellationToken)
         at Azure.Messaging.ServiceBus.Amqp.AmqpReceiver.ReceiveMessagesAsyncInternal(Int32 maxMessages, Nullable`1 maxWaitTime, TimeSpan timeout, CancellationToken cancellationToken)
         at Azure.Messaging.ServiceBus.Amqp.AmqpReceiver.ReceiveMessagesAsyncInternal(Int32 maxMessages, Nullable`1 maxWaitTime, TimeSpan timeout, CancellationToken cancellationToken)
         at Azure.Messaging.ServiceBus.Amqp.AmqpReceiver.&lt;&gt;c.&lt;&lt;ReceiveMessagesAsync&gt;b__44_0&gt;d.MoveNext()
      --- End of stack trace from previous location ---
         at Azure.Messaging.ServiceBus.ServiceBusRetryPolicy.RunOperation[T1,TResult](Func`4 operation, T1 t1, TransportConnectionScope scope, CancellationToken cancellationToken, Boolean logTimeoutRetriesAsVerbose)
         at Azure.Messaging.ServiceBus.ServiceBusRetryPolicy.RunOperation[T1,TResult](Func`4 operation, T1 t1, TransportConnectionScope scope, CancellationToken cancellationToken, Boolean logTimeoutRetriesAsVerbose)
         at Azure.Messaging.ServiceBus.Amqp.AmqpReceiver.ReceiveMessagesAsync(Int32 maxMessages, Nullable`1 maxWaitTime, CancellationToken cancellationToken)
         at Azure.Messaging.ServiceBus.ServiceBusReceiver.ReceiveMessagesAsync(Int32 maxMessages, Nullable`1 maxWaitTime, Boolean isProcessor, CancellationToken cancellationToken)
         at Azure.Messaging.ServiceBus.ReceiverManager.ReceiveAndProcessMessagesAsync(CancellationToken cancellationToken)
fail: Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor[0]
      Service Bus processor error in sdap-jobs (source: Receive): A task was canceled. (ServiceCommunicationProblem). For troubleshooting information, see https://aka.ms/azsdk/net/servicebus/exceptions/troubleshoot.
      Azure.Messaging.ServiceBus.ServiceBusException: A task was canceled. (ServiceCommunicationProblem). For troubleshooting information, see https://aka.ms/azsdk/net/servicebus/exceptions/troubleshoot.
       ---&gt; System.Threading.Tasks.TaskCanceledException: A task was canceled.
         at Microsoft.Azure.Amqp.TaskHelpers.EndAsyncResult(IAsyncResult asyncResult)
         at Microsoft.Azure.Amqp.IteratorAsyncResult`1.&lt;&gt;c.&lt;CallTask&gt;b__24_1(TIteratorAsyncResult thisPtr, IAsyncResult r)
         at Microsoft.Azure.Amqp.IteratorAsyncResult`1.StepCallback(IAsyncResult result)
      --- End </Data><Data>Process Id: 7932.</Data><Data>File Version: 18.0.25301.22. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1007</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-25T21:23:40Z"/><EventRecordID>384029812</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Application '/LM/W3SVC/424429371/ROOT' with physical root 'C:\home\site\wwwroot\' failed to load coreclr. Exception message:
CLR worker thread exited prematurely</Data><Data>Process Id: 7932.</Data><Data>File Version: 18.0.25301.22. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-25T21:28:19Z"/><EventRecordID>384308671</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Category: Microsoft.AspNetCore.Hosting.Diagnostics
EventId: 6

Application startup exception

Exception: 
System.InvalidOperationException: Body was inferred but the method does not allow inferred body parameters.
Below is the list of parameters that we found: 

Parameter           | Source                        
---------------------------------------------------------------------------------
documentId          | Route (Inferred)
documentStorageResolver | Services (Inferred)
graphClient         | Body (Inferred)
logger              | Services (Inferred)


Did you mean to register the "Body (Inferred)" parameter(s) as a Service or apply the [FromServices] or [FromBody] attribute?


   at Microsoft.AspNetCore.Http.RequestDelegateFactory.CreateArguments(ParameterInfo[] parameters, RequestDelegateFactoryContext factoryContext)
   at Microsoft.AspNetCore.Http.RequestDelegateFactory.CreateArgumentsAndInferMetadata(MethodInfo methodInfo, RequestDelegateFactoryContext factoryContext)
   at Microsoft.AspNetCore.Http.RequestDelegateFactory.InferMetadata(MethodInfo methodInfo, RequestDelegateFactoryOptions options)
   at Microsoft.AspNetCore.Routing.RouteEndpointDataSource.CreateRouteEndpointBuilder(RouteEntry entry, RoutePattern groupPrefix, IReadOnlyList`1 groupConventions, IReadOnlyList`1 groupFinallyConventions)
   at Microsoft.AspNetCore.Routing.RouteEndpointDataSource.GetGroupedEndpoints(RouteGroupContext context)
   at Microsoft.AspNetCore.Routing.RouteGroupBuilder.GroupEndpointDataSource.GetGroupedEndpointsWithNullablePrefix(RoutePattern prefix, IReadOnlyList`1 conventions, IReadOnlyList`1 finallyConventions, IServiceProvider applicationServices)
   at Microsoft.AspNetCore.Routing.RouteGroupBuilder.GroupEndpointDataSource.get_Endpoints()
   at Microsoft.AspNetCore.Routing.CompositeEndpointDataSource.CreateEndpointsUnsynchronized()
   at Microsoft.AspNetCore.Routing.CompositeEndpointDataSource.EnsureEndpointsInitialized()
   at Microsoft.AspNetCore.Routing.CompositeEndpointDataSource.get_Endpoints()
   at Microsoft.AspNetCore.Routing.DataSourceDependentCache`1.Initialize()
   at System.Threading.LazyInitializer.EnsureInitializedCore[T](T&amp; target, Boolean&amp; initialized, Object&amp; syncLock, Func`1 valueFactory)
   at Microsoft.AspNetCore.Routing.DataSourceDependentCache`1.EnsureInitialized()
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationPolicyCache..ctor(EndpointDataSource dataSource)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitRootCache(ServiceCallSite callSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.Resolve(ServiceCallSite callSite, ServiceProviderEngineScope scope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetService[T](IServiceProvider provider)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware..ctor(RequestDelegate next, IAuthorizationPolicyProvider policyProvider, IServiceProvider services)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddlewareInternal..ctor(RequestDelegate next, IServiceProvider services, IAuthorizationPolicyProvider policyProvider, ILogger`1 logger)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-25T21:28:19Z"/><EventRecordID>384308796</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 11

Hosting failed to start

Exception: 
System.InvalidOperationException: Body was inferred but the method does not allow inferred body parameters.
Below is the list of parameters that we found: 

Parameter           | Source                        
---------------------------------------------------------------------------------
documentId          | Route (Inferred)
documentStorageResolver | Services (Inferred)
graphClient         | Body (Inferred)
logger              | Services (Inferred)


Did you mean to register the "Body (Inferred)" parameter(s) as a Service or apply the [FromServices] or [FromBody] attribute?


   at Microsoft.AspNetCore.Http.RequestDelegateFactory.CreateArguments(ParameterInfo[] parameters, RequestDelegateFactoryContext factoryContext)
   at Microsoft.AspNetCore.Http.RequestDelegateFactory.CreateArgumentsAndInferMetadata(MethodInfo methodInfo, RequestDelegateFactoryContext factoryContext)
   at Microsoft.AspNetCore.Http.RequestDelegateFactory.InferMetadata(MethodInfo methodInfo, RequestDelegateFactoryOptions options)
   at Microsoft.AspNetCore.Routing.RouteEndpointDataSource.CreateRouteEndpointBuilder(RouteEntry entry, RoutePattern groupPrefix, IReadOnlyList`1 groupConventions, IReadOnlyList`1 groupFinallyConventions)
   at Microsoft.AspNetCore.Routing.RouteEndpointDataSource.GetGroupedEndpoints(RouteGroupContext context)
   at Microsoft.AspNetCore.Routing.RouteGroupBuilder.GroupEndpointDataSource.GetGroupedEndpointsWithNullablePrefix(RoutePattern prefix, IReadOnlyList`1 conventions, IReadOnlyList`1 finallyConventions, IServiceProvider applicationServices)
   at Microsoft.AspNetCore.Routing.RouteGroupBuilder.GroupEndpointDataSource.get_Endpoints()
   at Microsoft.AspNetCore.Routing.CompositeEndpointDataSource.CreateEndpointsUnsynchronized()
   at Microsoft.AspNetCore.Routing.CompositeEndpointDataSource.EnsureEndpointsInitialized()
   at Microsoft.AspNetCore.Routing.CompositeEndpointDataSource.get_Endpoints()
   at Microsoft.AspNetCore.Routing.DataSourceDependentCache`1.Initialize()
   at System.Threading.LazyInitializer.EnsureInitializedCore[T](T&amp; target, Boolean&amp; initialized, Object&amp; syncLock, Func`1 valueFactory)
   at Microsoft.AspNetCore.Routing.DataSourceDependentCache`1.EnsureInitialized()
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationPolicyCache..ctor(EndpointDataSource dataSource)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitRootCache(ServiceCallSite callSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.Resolve(ServiceCallSite callSite, ServiceProviderEngineScope scope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetService[T](IServiceProvider provider)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware..ctor(RequestDelegate next, IAuthorizationPolicyProvider policyProvider, IServiceProvider services)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddlewareInternal..ctor(RequestDelegate next, IServiceProvider services, IAuthorizationPolicyProvider policyProvider, ILogger`1 logger)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.&lt;StartAsync&gt;b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1026</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-25T21:28:22Z"/><EventRecordID>384311484</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Application: w3wp.exe
CoreCLR Version: 8.0.2225.52707
.NET Version: 8.0.22
Description: The process was terminated due to an unhandled exception.
Exception Info: System.InvalidOperationException: Body was inferred but the method does not allow inferred body parameters.
Below is the list of parameters that we found: 

Parameter           | Source                        
---------------------------------------------------------------------------------
documentId          | Route (Inferred)
documentStorageResolver | Services (Inferred)
graphClient         | Body (Inferred)
logger              | Services (Inferred)


Did you mean to register the "Body (Inferred)" parameter(s) as a Service or apply the [FromServices] or [FromBody] attribute?


   at Microsoft.AspNetCore.Http.RequestDelegateFactory.CreateArguments(ParameterInfo[] parameters, RequestDelegateFactoryContext factoryContext)
   at Microsoft.AspNetCore.Http.RequestDelegateFactory.CreateArgumentsAndInferMetadata(MethodInfo methodInfo, RequestDelegateFactoryContext factoryContext)
   at Microsoft.AspNetCore.Http.RequestDelegateFactory.InferMetadata(MethodInfo methodInfo, RequestDelegateFactoryOptions options)
   at Microsoft.AspNetCore.Routing.RouteEndpointDataSource.CreateRouteEndpointBuilder(RouteEntry entry, RoutePattern groupPrefix, IReadOnlyList`1 groupConventions, IReadOnlyList`1 groupFinallyConventions)
   at Microsoft.AspNetCore.Routing.RouteEndpointDataSource.GetGroupedEndpoints(RouteGroupContext context)
   at Microsoft.AspNetCore.Routing.RouteGroupBuilder.GroupEndpointDataSource.GetGroupedEndpointsWithNullablePrefix(RoutePattern prefix, IReadOnlyList`1 conventions, IReadOnlyList`1 finallyConventions, IServiceProvider applicationServices)
   at Microsoft.AspNetCore.Routing.RouteGroupBuilder.GroupEndpointDataSource.get_Endpoints()
   at Microsoft.AspNetCore.Routing.CompositeEndpointDataSource.CreateEndpointsUnsynchronized()
   at Microsoft.AspNetCore.Routing.CompositeEndpointDataSource.EnsureEndpointsInitialized()
   at Microsoft.AspNetCore.Routing.CompositeEndpointDataSource.get_Endpoints()
   at Microsoft.AspNetCore.Routing.DataSourceDependentCache`1.Initialize()
   at System.Threading.LazyInitializer.EnsureInitializedCore[T](T&amp; target, Boolean&amp; initialized, Object&amp; syncLock, Func`1 valueFactory)
   at Microsoft.AspNetCore.Routing.DataSourceDependentCache`1.EnsureInitialized()
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationPolicyCache..ctor(EndpointDataSource dataSource)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitRootCache(ServiceCallSite callSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.Resolve(ServiceCallSite callSite, ServiceProviderEngineScope scope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetService[T](IServiceProvider provider)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware..ctor(RequestDelegate next, IAuthorizationPolicyProvider policyProvider, IServiceProvider services)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddlewareInternal..ctor(RequestDelegate next, IServiceProvider services, IAuthorizationPolicyProvider policyProvider, ILogger`1 logger)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.&lt;StartAsync&gt;b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)
   at Microsoft.Extensions.Hosting.Internal.Host.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Run(IHost host)
   at Program.&lt;Main&gt;$(String[] args) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Program.cs:line 710
</Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1018</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-25T21:28:22Z"/><EventRecordID>384311765</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Application '/LM/W3SVC/424429371/ROOT' with physical root 'C:\home\site\wwwroot\' hit unexpected managed exception, exception code = '0xe0434352'. First 30KB characters of captured stdout and stderr logs:
? Job processing configured with Service Bus (queue: sdap-jobs)
warn: Program[0]
      Distributed cache: Using in-memory cache (not distributed). This should ONLY be used in local development.
info: Program[0]
      CORS: Configured with 5 allowed origins: http://localhost:3000, http://localhost:3001, http://127.0.0.1:3000, https://spaarkedev1.crm.dynamics.com, https://spaarkedev1.api.crm.dynamics.com
dbug: Microsoft.Extensions.Hosting.Internal.Host[1]
      Hosting starting
info: Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager[64]
      Azure Web Sites environment detected. Using 'C:\home\ASP.NET\DataProtection-Keys' as key repository; keys will not be encrypted at rest.
info: Spe.Bff.Api.Infrastructure.Startup.StartupValidationService[0]
      Starting configuration validation...
info: Spe.Bff.Api.Infrastructure.Startup.StartupValidationService[0]
      ? Configuration validation successful
info: Spe.Bff.Api.Infrastructure.Startup.StartupValidationService[0]
      Configuration Summary:
info: Spe.Bff.Api.Infrastructure.Startup.StartupValidationService[0]
        Graph API:
info: Spe.Bff.Api.Infrastructure.Startup.StartupValidationService[0]
          - TenantId: a221a95e-6abc-4434-aecc-e48338a1b2f2
info: Spe.Bff.Api.Infrastructure.Startup.StartupValidationService[0]
          - ClientId: 1e40...458c
info: Spe.Bff.Api.Infrastructure.Startup.StartupValidationService[0]
          - ManagedIdentity: False
info: Spe.Bff.Api.Infrastructure.Startup.StartupValidationService[0]
        Dataverse:
info: Spe.Bff.Api.Infrastructure.Startup.StartupValidationService[0]
          - Environment: https://spaarkedev1.crm.dynamics.com
info: Spe.Bff.Api.Infrastructure.Startup.StartupValidationService[0]
          - ClientId: 1e40...458c
info: Spe.Bff.Api.Infrastructure.Startup.StartupValidationService[0]
        Service Bus:
info: Spe.Bff.Api.Infrastructure.Startup.StartupValidationService[0]
          - Queue: document-events
info: Spe.Bff.Api.Infrastructure.Startup.StartupValidationService[0]
          - MaxConcurrency: 2
info: Spe.Bff.Api.Infrastructure.Startup.StartupValidationService[0]
        Redis:
info: Spe.Bff.Api.Infrastructure.Startup.StartupValidationService[0]
          - Enabled: False
info: Spe.Bff.Api.Infrastructure.Startup.StartupValidationService[0]
          - InstanceName: sdap-dev:
dbug: Microsoft.AspNetCore.DataProtection.Repositories.FileSystemXmlRepository[37]
      Reading data from file 'C:\home\ASP.NET\DataProtection-Keys\key-4705609b-f7ee-498d-8862-969d9a2e5fb1.xml'.
dbug: Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager[18]
      Found key {4705609b-f7ee-498d-8862-969d9a2e5fb1}.
dbug: Microsoft.AspNetCore.DataProtection.KeyManagement.DefaultKeyResolver[13]
      Considering key {4705609b-f7ee-498d-8862-969d9a2e5fb1} with expiration date 2026-01-04 12:20:44Z as default key.
dbug: Microsoft.AspNetCore.DataProtection.TypeForwardingActivator[0]
      Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
dbug: Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.CngCbcAuthenticatedEncryptorFactory[4]
      Opening CNG algorithm 'AES' from provider '(null)' with chaining mode CBC.
dbug: Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.CngCbcAuthenticatedEncryptorFactory[3]
      Opening CNG algorithm 'SHA256' from provider '(null)' with HMAC.
dbug: Microsoft.AspNetCore.DataProtection.KeyManagement.KeyRingProvider[2]
      Using key {4705609b-f7ee-498d-8862-969d9a2e5fb1} as the default key.
dbug: Microsoft.AspNetCore.DataProtection.Internal.DataProtectionHostedService[65]
      Key ring with default key {4705609b-f7ee-498d-8862-969d9a2e5fb1} was loaded during application startup.
info: Spe.Bff.Api.Services.Jobs.DocumentEventProcessor[0]
      Document Event Processor starting...
info: Spe.Bff.Api.Services.Jobs.DocumentEventProcessor[0]
      Document Event Processor started successfully
info: Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor[0]
      Service Bus Job Processor starting for queue sdap-jobs with 2 concurrent calls...
info: Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor[0]
      Service Bus Job Processor started successfully
crit: Microsoft.AspNetCore.Hosting.Diagnostics[6]
      Application startup exception
      System.InvalidOperationException: Body was inferred but the method does not allow inferred body parameters.
      Below is the list of parameters that we found: 
      
      Parameter           | Source                        
      ---------------------------------------------------------------------------------
      documentId          | Route (Inferred)
      documentStorageResolver | Services (Inferred)
      graphClient         | Body (Inferred)
      logger              | Services (Inferred)
      
      
      Did you mean to register the "Body (Inferred)" parameter(s) as a Service or apply the [FromServices] or [FromBody] attribute?
      
      
         at Microsoft.AspNetCore.Http.RequestDelegateFactory.CreateArguments(ParameterInfo[] parameters, RequestDelegateFactoryContext factoryContext)
         at Microsoft.AspNetCore.Http.RequestDelegateFactory.CreateArgumentsAndInferMetadata(MethodInfo methodInfo, RequestDelegateFactoryContext factoryContext)
         at Microsoft.AspNetCore.Http.RequestDelegateFactory.InferMetadata(MethodInfo methodInfo, RequestDelegateFactoryOptions options)
         at Microsoft.AspNetCore.Routing.RouteEndpointDataSource.CreateRouteEndpointBuilder(RouteEntry entry, RoutePattern groupPrefix, IReadOnlyList`1 groupConventions, IReadOnlyList`1 groupFinallyConventions)
         at Microsoft.AspNetCore.Routing.RouteEndpointDataSource.GetGroupedEndpoints(RouteGroupContext context)
         at Microsoft.AspNetCore.Routing.RouteGroupBuilder.GroupEndpointDataSource.GetGroupedEndpointsWithNullablePrefix(RoutePattern prefix, IReadOnlyList`1 conventions, IReadOnlyList`1 finallyConventions, IServiceProvider applicationServices)
         at Microsoft.AspNetCore.Routing.RouteGroupBuilder.GroupEndpointDataSource.get_Endpoints()
         at Microsoft.AspNetCore.Routing.CompositeEndpointDataSource.CreateEndpointsUnsynchronized()
         at Microsoft.AspNetCore.Routing.CompositeEndpointDataSource.EnsureEndpointsInitialized()
         at Microsoft.AspNetCore.Routing.CompositeEndpointDataSource.get_Endpoints()
         at Microsoft.AspNetCore.Routing.DataSourceDependentCache`1.Initialize()
         at System.Threading.LazyInitializer.EnsureInitializedCore[T](T&amp; target, Boolean&amp; initialized, Object&amp; syncLock, Func`1 valueFactory)
         at Microsoft.AspNetCore.Routing.DataSourceDependentCache`1.EnsureInitialized()
         at Microsoft.AspNetCore.Authorization.Policy.AuthorizationPolicyCache..ctor(EndpointDataSource dataSource)
         at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
         at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
         at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
         at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
         at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)
         at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
         at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitRootCache(ServiceCallSite callSite, RuntimeResolverContext context)
         at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
         at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.Resolve(ServiceCallSite callSite, ServiceProviderEngineScope scope)
         at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
         at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
         at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
         at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
         at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetService[T](IServiceProvider provider)
         at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware..ctor(RequestDelegate next, IAuthorizationPolicyProvider policyProvider, IServiceProvider services)
         at Microsoft.AspNetCore.Authorization.AuthorizationMiddlewareInternal..ctor(RequestDelegate next, IServiceProvider services, IAuthorizationPolicyProvider policyProvider, ILogger`1 logger)
         at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
         at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
         at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
         at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
         at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
         at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
         at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
         at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
         at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
         at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
fail: Microsoft.Extensions.Hosting.Internal.Host[11]
      Hosting failed to start
      System.InvalidOperationException: Body was inferred but the method does not allow inferred body parameters.
      Below is the list of parameters that we found: 
      
      Parameter           | Source                        
      ---------------------------------------------------------------------------------
      documentId          | Route (Inferred)
      documentStorageResolver | Services (Inferred)
      graphClient         | Body (Inferred)
      logger              | Services (Inferred)
      
      
      Did you mean to register the "Body (Inferred)" parameter(s) as a Service or apply the [FromServices] or [FromBody] attribute?
      
      
         at Microsoft.AspNetCore.Http.RequestDelegateFactory.CreateArguments(ParameterInfo[] parameters, RequestDelegateFactoryContext factoryContext)
         at Microsoft.AspNetCore.Http.RequestDelegateFactory.CreateArgumentsAndInferMetadata(MethodInfo methodInfo, RequestDelegateFactoryContext factoryContext)
         at Microsoft.AspNetCore.Http.RequestDelegateFactory.InferMetadata(MethodInfo methodInfo, RequestDelegateFactoryOptions options)
         at Microsoft.AspNetCore.Routing.RouteEndpointDataSource.CreateRouteEndpointBuilder(RouteEntry entry, RoutePattern groupPrefix, IReadOnlyList`1 groupConventions, IReadOnlyList`1 groupFinallyConventions)
         at Microsoft.AspNetCore.Routing.RouteEndpointDataSource.GetGroupedEndpoints(RouteGroupContext context)
         at Microsoft.AspNetCore.Routing.RouteGroupBuilder.GroupEndpointDataSource.GetGroupedEndpointsWithNullablePrefix(RoutePattern prefix, IReadOnlyList`1 conventions, IReadOnlyList`1 finallyConventions, IServiceProvider applicationServices)
         at Microsoft.AspNetCore.Routing.RouteGroupBuilder.GroupEndpointDataSource.get_Endpoints()
         at Microsoft.AspNetCore.Routing.CompositeEndpointDataSource.CreateEndpointsUnsynchronized()
         at Microsoft.AspNetCore.Routing.CompositeEndpointDataSource.EnsureEndpointsInitialized()
         at Microsoft.AspNetCore.Routing.CompositeEndpointDataSource.get_Endpoints()
         at Microsoft.AspNetCore.Routing.DataSourceDependentCache`1.Initialize()
         at System.Threading.LazyInitializer.EnsureInitializedCore[T](T&amp; target, Boolean&amp; initialized, Object&amp; syncLock, Func`1 valueFactory)
         at Microsoft.AspNetCore.Routing.DataSourceDependentCache`1.EnsureInitialized()
         at Microsoft.AspNetCore.Authorization.Policy.AuthorizationPolicyCache..ctor(EndpointDataSource dataSource)
         at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
         at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
         at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
         at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
         at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)
         at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
         at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitRootCache(ServiceCallSite callSite, RuntimeResolverContext context)
         at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
         at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.Resolve(ServiceCallSite callSite, ServiceProviderEngineScope scope)
         at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
         at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
         at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
         at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
         at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetService[T](IServiceProvider provider)
         at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware..ctor(RequestDelegate next, IAuthorizationPolicyProvider policyProvider, IServiceProvider services)
         at Microsoft.AspNetCore.Authorization.AuthorizationMiddlewareInternal..ctor(RequestDelegate next, IServiceProvider services, IAuthorizationPolicyProvider policyProvider, ILogger`1 logger)
         at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
         at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
         at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
         at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
         at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
         at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
         at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
         at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
         at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
         at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
         at Microsoft.Extensions.Hosting.Internal.Host.&lt;StartAsync&gt;b__15_1(IHostedService service, CancellationToken token)
         at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)
info: Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor[0]
      Service Bus Job Processor stopping...
info: Spe.Bff.Api.Services.Jobs.DocumentEventProcessor[0]
      Document Event Processor stopping...
fail: Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor[0]
      Service Bus processor error in sdap-jobs (source: Receive): The operation is canceled because the owner is being closed. (ServiceCommunicationProblem). For troubleshooting information, see https://aka.ms/azsdk/net/servicebus/exceptions/troubleshoot.
      Azure.Messaging.ServiceBus.ServiceBusException: The operation is canceled because the owner is being closed. (ServiceCommunicationProblem). For troubleshooting information, see https://aka.ms/azsdk/net/servicebus/exceptions/troubleshoot.
       ---&gt; System.OperationCanceledException: The operation is canceled because the owner is being closed.
         at Microsoft.Azure.Amqp.ExceptionDispatcher.Throw(Exception exception)
         at Microsoft.Azure.Amqp.AsyncResult.End[TAsyncResult](IAsyncResult result)
         at Microsoft.Azure.Amqp.RequestResponseAmqpLink.RequestAsyncResult.End(IAsyncResult result)
         at Microsoft.Azure.Amqp.RequestResponseAmqpLink.EndRequest(IAsyncResult result)
         at Microsoft.Azure.Amqp.AmqpCbsLink.SendTokenAsyncResult.&lt;&gt;c.&lt;GetAsyncSteps&gt;b__17_4(SendTokenAsyncResult thisPtr, IAsyncResult r)
         at Microsoft.Azure.Amqp.IteratorAsyncResult`1.StepCallback(IAsyncResult result)
      --- End of stack trace from previous location ---
         at Microsoft.Azure.Amqp.ExceptionDispatcher.Throw(Exception exception)
         at Microsoft.Azure.Amqp.AsyncResult.End[TAsyncResult](IAsyncResult result)
         at Microsoft.Azure.Amqp.AsyncResult`1.End(IAsyncResult asyncResult)
         at Microsoft.Azure.Amqp.AmqpCbsLink.EndSendToken(IAsyncResult result)
         at Microsoft.Azure.Amqp.AmqpCbsLink.&lt;&gt;c.&lt;SendTokenAsync&gt;b__4_1(IAsyncResult r)
         at System.Threading.Tasks.TaskFactory`1.FromAsyncCoreLogic(IAsyncResult iar, Func`2 endFunction, Action`1 endAction, Task`1 promise, Boolean requiresSynchronization)
      --- End of stack trace from previous location ---
         at Azure.Messaging.ServiceBus.Amqp.AmqpConnectionScope.RequestAuthorizationUsingCbsAsync(AmqpConnection connection, CbsTokenProvider tokenProvider, Uri endpoint, String[] audience, String[] requiredClaims, TimeSpan timeout, String identifier)
         at Azure.Messaging.ServiceBus.Amqp.AmqpConnectionScope.CreateReceivingLinkAsync(String entityPath, String identifier, AmqpConnection connection, Uri endpoint, TimeSpan timeout, UInt32 prefetchCount, ServiceBusReceiveMode receiveMode, String sessionId, Boolean isSessionReceiver, CancellationToken cancellationToken)
         --- End of inner exception stack trace ---
         at Azure.Messaging.ServiceBus.Amqp.AmqpConnectionScope.CreateReceivingLinkAsync(String entityPath, String identifier, AmqpConnection connection, Uri endpoint, TimeSpan timeout, UInt32 prefetchCount, ServiceBusReceiveMode receiveMode, String sessionId, Boolean isSessionReceiver, CancellationToken cancellationToken)
         at Azure.Messaging.ServiceBus.Amqp.AmqpConnectionScope.OpenReceiverLinkAsync(String identifier, String entityPath, TimeSpan timeout, UInt32 prefetchCount, ServiceBusReceiveMode receiveMode, String sessionId, Boolean isSessionReceiver, CancellationToken cancellationToken)
         at Azure.Messaging.ServiceBus.Amqp.AmqpReceiver.OpenReceiverLinkAsync(TimeSpan timeout, UInt32 prefetchCount, ServiceBusReceiveMode receiveMode, String identifier, CancellationToken cancellationToken)
         at Microsoft.Azure.Amqp.FaultTolerantAmqpObject`1.OnCreateAsync(TimeSpan timeout, CancellationToken cancellationToken)
         at Microsoft.Azure.Amqp.Singleton`1.GetOrCreateAsync(TimeSpan timeout, CancellationToken cancellationToken)
         at Microsoft.Azure.Amqp.Singleton`1.GetOrCreateAsync(TimeSpan timeout, CancellationToken cancellationToken)
         at Azure.Messaging.ServiceBus.Amqp.AmqpReceiver.ReceiveMessagesAsyncInternal(Int32 maxMessages, Nullable`1 maxWaitTime, TimeSpan timeout, CancellationToken cancellationToken)
         at Azure.Messaging.ServiceBus.Amqp.AmqpReceiver.ReceiveMessagesAsyncInternal(Int32 maxMessages, Nullable`1 maxWaitTime, TimeSpan timeout, CancellationToken cancellationToken)
         at Azure.Messaging.ServiceBus.Amqp.AmqpReceiver.&lt;&gt;c.&lt;&lt;ReceiveMessagesAsync&gt;b__44_0&gt;d.MoveNext()
      --- End of stack trace from previous location ---
         at Azure.Messaging.ServiceBus.ServiceBusRetryPolicy.RunOperation[T1,TResult](Func`4 operation, T1 t1, TransportConnectionScope scope, CancellationToken cancellationToken, Boolean logTimeoutRetriesAsVerbose)
         at Azure.Messaging.ServiceBus.ServiceBusRetryPolicy.RunOperation[T1,TResult](Func`4 operation, T1 t1, TransportConnectionScope scope, CancellationToken cancellationToken, Boolean logTimeoutRetriesAsVerbose)
         at Azure.Messaging.ServiceBus.Amqp.AmqpReceiver.ReceiveMessagesAsync(Int32 maxMessages, Nullable`1 maxWaitTime, CancellationToken cancellationToken)
         at Azure.Messaging.ServiceBus.ServiceBusReceiver.ReceiveMessagesAsync(Int32 maxMessages, Nullable`1 maxWaitTime, Boolean isProcessor, CancellationToken cancellationToken)
         at Azure.Messaging.ServiceBus.ReceiverManager.ReceiveAndProcessMessagesAsync(CancellationToken cancellationToken)
fail: Spe.Bff.Api.Services.Jobs.DocumentEventProcessor[0]
      Service Bus processor error in document-events: Can't create session when the connection is closing. (ServiceCommunicationProblem). For troubleshooting information, see https://aka.ms/azsdk/net/servicebus/exceptions/troubleshoot.
      Azure.Messaging.ServiceBus.ServiceBusException: Can't create session when the connection is closing. (ServiceCommunicationProblem). For troubleshooting information, see https://aka.ms/azsdk/net/servicebus/exceptions/troubleshoot.
       ---&gt; System.InvalidOperationException: Can't create session when the connection is closing.
         at Microsoft.Azure.Amqp.AmqpConnection.AddSession(AmqpSession session, Nullable`1 channel)
         at Microsoft.Azure.Amqp.AmqpConnection.CreateSession(AmqpSessionSettings sessionSettings)
         at Azure.Messaging.ServiceBus.Amqp.AmqpConnectionScope.CreateAndOpenSessionAsync(AmqpConnection connection, TimeSpan timeout)
         at Azure.Messaging.ServiceBus.Amqp.AmqpConnectionScope.CreateSessionIfNeededAsync(AmqpConnection connection, TimeSpan timeout)
         at Azure.Messaging.ServiceBus.Amqp.AmqpConnectionScope.CreateReceivingLinkAsync(String entityPath, String identifier, AmqpConnection connection, Uri endpoint, TimeSpan timeout, UInt32 prefetchCount, ServiceBusReceiveMode receiveMode, String sessionId, Boolean isSessionReceiver, CancellationToken cancellationToken)
         --- End of inner exception stack trace ---
         at Azure.Messaging.ServiceBus.Amqp.AmqpConnectionScope.CreateReceivingLinkAsync(String entityPath, String identifier, AmqpConnection connection, Uri endpoint, TimeSpan timeout, UInt32 prefetchCount, ServiceBusReceiveMode receiveMode, String sessionId, Boolean isSessionReceiver, CancellationToken cancellationToken)
         at Azure.Messaging.ServiceBus.Amqp.AmqpConnectionScope.OpenReceiverLinkAsync(String identifier, String entityPath, TimeSpan timeout, UInt32 prefetchCount, ServiceBusReceiveMode receiveMode, String sessionId, Boolean isSessionReceiver, CancellationToken cancellationToken)
         at Azure.Messaging.ServiceBus.Amqp.AmqpReceiver.OpenReceiverLinkAsync(TimeSpan timeout, UInt32 prefetchCount, ServiceBusReceiveMode receiveMode, String identifier, CancellationToken cancellationToken)
         at Microsoft.Azure.Amqp.FaultTolerantAmqpObject`1.OnCreateAsync(TimeSpan timeout, CancellationToken cancellationToken)
         at Microsoft.Azure.Amqp.Singleton`1.GetOrCreateAsync(TimeSpan timeout, CancellationToken cancellationToken)
         at Microsoft.Azure.Amqp.Singleton`1.GetOrCreateAsync(TimeSpan timeout, CancellationToken cancellationToken)
         at Azure.Messaging.ServiceBus.Amqp.AmqpReceiver.ReceiveMessagesAsyncInternal(Int32 maxMessages, Nullable`1 maxWaitTime, TimeSpan timeout, CancellationToken cancellationToken)
         at Azure.Messaging.ServiceBus.Amqp.AmqpReceiver.ReceiveMessagesAsyncInternal(Int32 maxMessages, Nullable`1 maxWaitTime, TimeSpan timeout, CancellationToken cancellationToken)
         at Azure.Messaging.ServiceBus.Amqp.AmqpReceiver.&lt;&gt;c.&lt;&lt;ReceiveMessagesAsync&gt;b__44_0&gt;d.MoveNext()
      --- End of stack trace from previous location ---
         at Azure.Messaging.ServiceBus.ServiceBusRetryPolicy.RunOperation[T1,TResult](Func`4 operation, T1 t1, TransportConnectionScope scope, CancellationToken cancellationToken, Boolean logTimeoutRetriesAsVerbose)
         at Azure.Messaging.ServiceBus.ServiceBusRetryPolicy.RunOperation[T1,TResult](Func`4 operation, T1 t1, TransportConnectionScope scope, CancellationToken cancellationToken, Boolean logTimeoutRetriesAsVerbose)
         at Azure.Messaging.ServiceBus.Amqp.AmqpReceiver.ReceiveMessagesAsync(Int32 maxMessages, Nullable`1 maxWaitTime, CancellationToken cancellationToken)
         at Azure.Messaging.ServiceBus.ServiceBusReceiver.ReceiveMessagesAsync(Int32 maxMessages, Nullable`1 maxWaitTime, Boolean isProcessor, CancellationToken cancellationToken)
         at Azure.Messaging.ServiceBus.ReceiverManager.ReceiveAndProcessMessagesAsync(CancellationToken cancellationToken)
fail: Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor[0]
      Service Bus processor error in sdap-jobs (source: Receive): The operation is canceled because the owner is being closed. (ServiceCommunicationProblem). For troubleshooting information, see https://aka.ms/azsdk/net/servicebus/exceptions/troubleshoot.
      Azure.Messaging.ServiceBus.ServiceBusException: The operation is canceled because the owner is being closed. (ServiceCommunicationProblem). For troubleshooting information, see https://aka.ms/azsdk/net/servicebus/exceptions/troubleshoot.
       ---&gt; System.OperationCanceledException: The operation is canceled because the owner is being closed.
         at Microsoft.Azure.Amqp.ExceptionDispatcher.Throw(Exception exception)
         at Microsoft.Azure.Amqp.AsyncResult.End[TAsyncResult](IAsyncResult result)
         at Microsoft.Azure.Amqp.RequestResponseAmqpLink.RequestAsyncResult.End(IAsyncResult result)
         at Microsoft.Azure.Amqp.RequestResponseAmqpLink.EndRequest(IAsyncResult result)
         at Microsoft.Azure.Amqp.AmqpCbsLink.SendTokenAsyncResult.&lt;&gt;c.&lt;GetAsyncSteps&gt;b__17_4(SendTokenAsyncResult thisPtr, IAsyncResult r)
         at Microsoft.Azure.Amqp.IteratorAsyncResult`1.StepCallback(IAsyncResult result)
      --- End of stack trace from previous location ---
         at Microsoft.Azure.Amqp.ExceptionDispatcher.Throw(Exception exception)
         at Microsoft.Azure.Amqp.AsyncResult.End[TAsyncResult](IAsyncResult result)
         at Microsoft.Azure.Amqp.AsyncResult`1.End(IAsyncResult asyncResult)
         at Microsoft.Azure.Amqp.AmqpCbsLink.EndSendToken(IAsyncResult result)
         at Microsoft.Azure.Amqp.AmqpCbsLink.&lt;&gt;c.&lt;SendTokenAsync&gt;b__4_1(IAsyncResult r)
         at System.Threading.Tasks.TaskFactory`1.FromAsyncCoreLogic(IAsyncResult iar, Func`2 endFunction, Action`1 endAction, Task`1 promise, Boolean requiresSynchronization)
      --- End of stack trace from previous location ---
         at Azure.Messaging.ServiceBus.Amqp.AmqpConnectionScope.RequestAuthorizationUsingCbsAsync(AmqpConnection connection, CbsTokenProvider tokenProvider, Uri endpoint, String[] audience, String[] requiredClaims, TimeSpan timeout, String identifier)
         at Azure.Messaging.ServiceBus.Amqp.AmqpConnectionScope.CreateReceivingLinkAsync(String entityPath, String identifier, AmqpConnection connection, Uri endpoint, TimeSpan timeout, UInt32 prefetchCount, ServiceBusReceiveMode receiveMode, String sessionId, Boolean isSessionReceiver, CancellationToken cancellationToken)
         --- End of inner exception stack trace ---
         at Azure.Messaging.ServiceBus.Amqp.AmqpConnectionScope.CreateReceivingLinkAsync(String entityPath, String identifier, AmqpConnection connection, Uri endpoint, TimeSpan timeout, UInt32 prefetchCount, ServiceBusReceiveMode receiveMode, String sessionId, Boolean isSessionReceiver, CancellationToken cancellationToken)
         at Azure.Messaging.ServiceBus.Amqp.AmqpConnectionScope.OpenReceiverLinkAsync(String identifier, String entityPath, TimeSpa</Data><Data>Process Id: 6204.</Data><Data>File Version: 18.0.25301.22. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1007</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-25T21:28:22Z"/><EventRecordID>384311812</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Application '/LM/W3SVC/424429371/ROOT' with physical root 'C:\home\site\wwwroot\' failed to load coreclr. Exception message:
CLR worker thread exited prematurely</Data><Data>Process Id: 6204.</Data><Data>File Version: 18.0.25301.22. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-25T21:29:46Z"/><EventRecordID>384395515</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Category: Microsoft.AspNetCore.Hosting.Diagnostics
EventId: 6

Application startup exception

Exception: 
System.InvalidOperationException: Body was inferred but the method does not allow inferred body parameters.
Below is the list of parameters that we found: 

Parameter           | Source                        
---------------------------------------------------------------------------------
documentId          | Route (Inferred)
documentStorageResolver | Services (Inferred)
graphClient         | Body (Inferred)
logger              | Services (Inferred)


Did you mean to register the "Body (Inferred)" parameter(s) as a Service or apply the [FromServices] or [FromBody] attribute?


   at Microsoft.AspNetCore.Http.RequestDelegateFactory.CreateArguments(ParameterInfo[] parameters, RequestDelegateFactoryContext factoryContext)
   at Microsoft.AspNetCore.Http.RequestDelegateFactory.CreateArgumentsAndInferMetadata(MethodInfo methodInfo, RequestDelegateFactoryContext factoryContext)
   at Microsoft.AspNetCore.Http.RequestDelegateFactory.InferMetadata(MethodInfo methodInfo, RequestDelegateFactoryOptions options)
   at Microsoft.AspNetCore.Routing.RouteEndpointDataSource.CreateRouteEndpointBuilder(RouteEntry entry, RoutePattern groupPrefix, IReadOnlyList`1 groupConventions, IReadOnlyList`1 groupFinallyConventions)
   at Microsoft.AspNetCore.Routing.RouteEndpointDataSource.GetGroupedEndpoints(RouteGroupContext context)
   at Microsoft.AspNetCore.Routing.RouteGroupBuilder.GroupEndpointDataSource.GetGroupedEndpointsWithNullablePrefix(RoutePattern prefix, IReadOnlyList`1 conventions, IReadOnlyList`1 finallyConventions, IServiceProvider applicationServices)
   at Microsoft.AspNetCore.Routing.RouteGroupBuilder.GroupEndpointDataSource.get_Endpoints()
   at Microsoft.AspNetCore.Routing.CompositeEndpointDataSource.CreateEndpointsUnsynchronized()
   at Microsoft.AspNetCore.Routing.CompositeEndpointDataSource.EnsureEndpointsInitialized()
   at Microsoft.AspNetCore.Routing.CompositeEndpointDataSource.get_Endpoints()
   at Microsoft.AspNetCore.Routing.DataSourceDependentCache`1.Initialize()
   at System.Threading.LazyInitializer.EnsureInitializedCore[T](T&amp; target, Boolean&amp; initialized, Object&amp; syncLock, Func`1 valueFactory)
   at Microsoft.AspNetCore.Routing.DataSourceDependentCache`1.EnsureInitialized()
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationPolicyCache..ctor(EndpointDataSource dataSource)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitRootCache(ServiceCallSite callSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.Resolve(ServiceCallSite callSite, ServiceProviderEngineScope scope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetService[T](IServiceProvider provider)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware..ctor(RequestDelegate next, IAuthorizationPolicyProvider policyProvider, IServiceProvider services)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddlewareInternal..ctor(RequestDelegate next, IServiceProvider services, IAuthorizationPolicyProvider policyProvider, ILogger`1 logger)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-25T21:29:46Z"/><EventRecordID>384396062</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 11

Hosting failed to start

Exception: 
System.InvalidOperationException: Body was inferred but the method does not allow inferred body parameters.
Below is the list of parameters that we found: 

Parameter           | Source                        
---------------------------------------------------------------------------------
documentId          | Route (Inferred)
documentStorageResolver | Services (Inferred)
graphClient         | Body (Inferred)
logger              | Services (Inferred)


Did you mean to register the "Body (Inferred)" parameter(s) as a Service or apply the [FromServices] or [FromBody] attribute?


   at Microsoft.AspNetCore.Http.RequestDelegateFactory.CreateArguments(ParameterInfo[] parameters, RequestDelegateFactoryContext factoryContext)
   at Microsoft.AspNetCore.Http.RequestDelegateFactory.CreateArgumentsAndInferMetadata(MethodInfo methodInfo, RequestDelegateFactoryContext factoryContext)
   at Microsoft.AspNetCore.Http.RequestDelegateFactory.InferMetadata(MethodInfo methodInfo, RequestDelegateFactoryOptions options)
   at Microsoft.AspNetCore.Routing.RouteEndpointDataSource.CreateRouteEndpointBuilder(RouteEntry entry, RoutePattern groupPrefix, IReadOnlyList`1 groupConventions, IReadOnlyList`1 groupFinallyConventions)
   at Microsoft.AspNetCore.Routing.RouteEndpointDataSource.GetGroupedEndpoints(RouteGroupContext context)
   at Microsoft.AspNetCore.Routing.RouteGroupBuilder.GroupEndpointDataSource.GetGroupedEndpointsWithNullablePrefix(RoutePattern prefix, IReadOnlyList`1 conventions, IReadOnlyList`1 finallyConventions, IServiceProvider applicationServices)
   at Microsoft.AspNetCore.Routing.RouteGroupBuilder.GroupEndpointDataSource.get_Endpoints()
   at Microsoft.AspNetCore.Routing.CompositeEndpointDataSource.CreateEndpointsUnsynchronized()
   at Microsoft.AspNetCore.Routing.CompositeEndpointDataSource.EnsureEndpointsInitialized()
   at Microsoft.AspNetCore.Routing.CompositeEndpointDataSource.get_Endpoints()
   at Microsoft.AspNetCore.Routing.DataSourceDependentCache`1.Initialize()
   at System.Threading.LazyInitializer.EnsureInitializedCore[T](T&amp; target, Boolean&amp; initialized, Object&amp; syncLock, Func`1 valueFactory)
   at Microsoft.AspNetCore.Routing.DataSourceDependentCache`1.EnsureInitialized()
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationPolicyCache..ctor(EndpointDataSource dataSource)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitRootCache(ServiceCallSite callSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.Resolve(ServiceCallSite callSite, ServiceProviderEngineScope scope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetService[T](IServiceProvider provider)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware..ctor(RequestDelegate next, IAuthorizationPolicyProvider policyProvider, IServiceProvider services)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddlewareInternal..ctor(RequestDelegate next, IServiceProvider services, IAuthorizationPolicyProvider policyProvider, ILogger`1 logger)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.&lt;StartAsync&gt;b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-25T21:29:49Z"/><EventRecordID>384398687</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Category: Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor
EventId: 0

Service Bus processor error in sdap-jobs (source: Receive): Can't create session when the connection is closing. (ServiceCommunicationProblem). For troubleshooting information, see https://aka.ms/azsdk/net/servicebus/exceptions/troubleshoot.

Exception: 
Azure.Messaging.ServiceBus.ServiceBusException: Can't create session when the connection is closing. (ServiceCommunicationProblem). For troubleshooting information, see https://aka.ms/azsdk/net/servicebus/exceptions/troubleshoot.
 ---&gt; System.InvalidOperationException: Can't create session when the connection is closing.
   at Microsoft.Azure.Amqp.AmqpConnection.AddSession(AmqpSession session, Nullable`1 channel)
   at Microsoft.Azure.Amqp.AmqpConnection.CreateSession(AmqpSessionSettings sessionSettings)
   at Azure.Messaging.ServiceBus.Amqp.AmqpConnectionScope.CreateAndOpenSessionAsync(AmqpConnection connection, TimeSpan timeout)
   at Azure.Messaging.ServiceBus.Amqp.AmqpConnectionScope.CreateSessionIfNeededAsync(AmqpConnection connection, TimeSpan timeout)
   at Azure.Messaging.ServiceBus.Amqp.AmqpConnectionScope.CreateReceivingLinkAsync(String entityPath, String identifier, AmqpConnection connection, Uri endpoint, TimeSpan timeout, UInt32 prefetchCount, ServiceBusReceiveMode receiveMode, String sessionId, Boolean isSessionReceiver, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Azure.Messaging.ServiceBus.Amqp.AmqpConnectionScope.CreateReceivingLinkAsync(String entityPath, String identifier, AmqpConnection connection, Uri endpoint, TimeSpan timeout, UInt32 prefetchCount, ServiceBusReceiveMode receiveMode, String sessionId, Boolean isSessionReceiver, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.Amqp.AmqpConnectionScope.OpenReceiverLinkAsync(String identifier, String entityPath, TimeSpan timeout, UInt32 prefetchCount, ServiceBusReceiveMode receiveMode, String sessionId, Boolean isSessionReceiver, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.Amqp.AmqpReceiver.OpenReceiverLinkAsync(TimeSpan timeout, UInt32 prefetchCount, ServiceBusReceiveMode receiveMode, String identifier, CancellationToken cancellationToken)
   at Microsoft.Azure.Amqp.FaultTolerantAmqpObject`1.OnCreateAsync(TimeSpan timeout, CancellationToken cancellationToken)
   at Microsoft.Azure.Amqp.Singleton`1.GetOrCreateAsync(TimeSpan timeout, CancellationToken cancellationToken)
   at Microsoft.Azure.Amqp.Singleton`1.GetOrCreateAsync(TimeSpan timeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.Amqp.AmqpReceiver.ReceiveMessagesAsyncInternal(Int32 maxMessages, Nullable`1 maxWaitTime, TimeSpan timeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.Amqp.AmqpReceiver.ReceiveMessagesAsyncInternal(Int32 maxMessages, Nullable`1 maxWaitTime, TimeSpan timeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.Amqp.AmqpReceiver.&lt;&gt;c.&lt;&lt;ReceiveMessagesAsync&gt;b__44_0&gt;d.MoveNext()
--- End of stack trace from previous location ---
   at Azure.Messaging.ServiceBus.ServiceBusRetryPolicy.RunOperation[T1,TResult](Func`4 operation, T1 t1, TransportConnectionScope scope, CancellationToken cancellationToken, Boolean logTimeoutRetriesAsVerbose)
   at Azure.Messaging.ServiceBus.ServiceBusRetryPolicy.RunOperation[T1,TResult](Func`4 operation, T1 t1, TransportConnectionScope scope, CancellationToken cancellationToken, Boolean logTimeoutRetriesAsVerbose)
   at Azure.Messaging.ServiceBus.Amqp.AmqpReceiver.ReceiveMessagesAsync(Int32 maxMessages, Nullable`1 maxWaitTime, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusReceiver.ReceiveMessagesAsync(Int32 maxMessages, Nullable`1 maxWaitTime, Boolean isProcessor, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ReceiverManager.ReceiveAndProcessMessagesAsync(CancellationToken cancellationToken)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1026</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-25T21:29:49Z"/><EventRecordID>384398796</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Application: w3wp.exe
CoreCLR Version: 8.0.2225.52707
.NET Version: 8.0.22
Description: The process was terminated due to an unhandled exception.
Exception Info: System.InvalidOperationException: Body was inferred but the method does not allow inferred body parameters.
Below is the list of parameters that we found: 

Parameter           | Source                        
---------------------------------------------------------------------------------
documentId          | Route (Inferred)
documentStorageResolver | Services (Inferred)
graphClient         | Body (Inferred)
logger              | Services (Inferred)


Did you mean to register the "Body (Inferred)" parameter(s) as a Service or apply the [FromServices] or [FromBody] attribute?


   at Microsoft.AspNetCore.Http.RequestDelegateFactory.CreateArguments(ParameterInfo[] parameters, RequestDelegateFactoryContext factoryContext)
   at Microsoft.AspNetCore.Http.RequestDelegateFactory.CreateArgumentsAndInferMetadata(MethodInfo methodInfo, RequestDelegateFactoryContext factoryContext)
   at Microsoft.AspNetCore.Http.RequestDelegateFactory.InferMetadata(MethodInfo methodInfo, RequestDelegateFactoryOptions options)
   at Microsoft.AspNetCore.Routing.RouteEndpointDataSource.CreateRouteEndpointBuilder(RouteEntry entry, RoutePattern groupPrefix, IReadOnlyList`1 groupConventions, IReadOnlyList`1 groupFinallyConventions)
   at Microsoft.AspNetCore.Routing.RouteEndpointDataSource.GetGroupedEndpoints(RouteGroupContext context)
   at Microsoft.AspNetCore.Routing.RouteGroupBuilder.GroupEndpointDataSource.GetGroupedEndpointsWithNullablePrefix(RoutePattern prefix, IReadOnlyList`1 conventions, IReadOnlyList`1 finallyConventions, IServiceProvider applicationServices)
   at Microsoft.AspNetCore.Routing.RouteGroupBuilder.GroupEndpointDataSource.get_Endpoints()
   at Microsoft.AspNetCore.Routing.CompositeEndpointDataSource.CreateEndpointsUnsynchronized()
   at Microsoft.AspNetCore.Routing.CompositeEndpointDataSource.EnsureEndpointsInitialized()
   at Microsoft.AspNetCore.Routing.CompositeEndpointDataSource.get_Endpoints()
   at Microsoft.AspNetCore.Routing.DataSourceDependentCache`1.Initialize()
   at System.Threading.LazyInitializer.EnsureInitializedCore[T](T&amp; target, Boolean&amp; initialized, Object&amp; syncLock, Func`1 valueFactory)
   at Microsoft.AspNetCore.Routing.DataSourceDependentCache`1.EnsureInitialized()
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationPolicyCache..ctor(EndpointDataSource dataSource)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitRootCache(ServiceCallSite callSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.Resolve(ServiceCallSite callSite, ServiceProviderEngineScope scope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetService[T](IServiceProvider provider)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware..ctor(RequestDelegate next, IAuthorizationPolicyProvider policyProvider, IServiceProvider services)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddlewareInternal..ctor(RequestDelegate next, IServiceProvider services, IAuthorizationPolicyProvider policyProvider, ILogger`1 logger)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.&lt;StartAsync&gt;b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)
   at Microsoft.Extensions.Hosting.Internal.Host.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Run(IHost host)
   at Program.&lt;Main&gt;$(String[] args) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Program.cs:line 710
</Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1018</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-25T21:29:50Z"/><EventRecordID>384399671</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Application '/LM/W3SVC/424429371/ROOT' with physical root 'C:\home\site\wwwroot\' hit unexpected managed exception, exception code = '0xe0434352'. First 30KB characters of captured stdout and stderr logs:
warn: Program[0]
      Distributed cache: Using in-memory cache (not distributed). This should ONLY be used in local development.
? Job processing configured with Service Bus (queue: sdap-jobs)
info: Program[0]
      CORS: Configured with 5 allowed origins: http://localhost:3000, http://localhost:3001, http://127.0.0.1:3000, https://spaarkedev1.crm.dynamics.com, https://spaarkedev1.api.crm.dynamics.com
dbug: Microsoft.Extensions.Hosting.Internal.Host[1]
      Hosting starting
info: Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager[64]
      Azure Web Sites environment detected. Using 'C:\home\ASP.NET\DataProtection-Keys' as key repository; keys will not be encrypted at rest.
info: Spe.Bff.Api.Infrastructure.Startup.StartupValidationService[0]
      Starting configuration validation...
info: Spe.Bff.Api.Infrastructure.Startup.StartupValidationService[0]
      ? Configuration validation successful
info: Spe.Bff.Api.Infrastructure.Startup.StartupValidationService[0]
      Configuration Summary:
info: Spe.Bff.Api.Infrastructure.Startup.StartupValidationService[0]
        Graph API:
info: Spe.Bff.Api.Infrastructure.Startup.StartupValidationService[0]
          - TenantId: a221a95e-6abc-4434-aecc-e48338a1b2f2
info: Spe.Bff.Api.Infrastructure.Startup.StartupValidationService[0]
          - ClientId: 1e40...458c
info: Spe.Bff.Api.Infrastructure.Startup.StartupValidationService[0]
          - ManagedIdentity: False
info: Spe.Bff.Api.Infrastructure.Startup.StartupValidationService[0]
        Dataverse:
info: Spe.Bff.Api.Infrastructure.Startup.StartupValidationService[0]
          - Environment: https://spaarkedev1.crm.dynamics.com
info: Spe.Bff.Api.Infrastructure.Startup.StartupValidationService[0]
          - ClientId: 1e40...458c
info: Spe.Bff.Api.Infrastructure.Startup.StartupValidationService[0]
        Service Bus:
info: Spe.Bff.Api.Infrastructure.Startup.StartupValidationService[0]
          - Queue: document-events
info: Spe.Bff.Api.Infrastructure.Startup.StartupValidationService[0]
          - MaxConcurrency: 2
info: Spe.Bff.Api.Infrastructure.Startup.StartupValidationService[0]
        Redis:
info: Spe.Bff.Api.Infrastructure.Startup.StartupValidationService[0]
          - Enabled: False
info: Spe.Bff.Api.Infrastructure.Startup.StartupValidationService[0]
          - InstanceName: sdap-dev:
dbug: Microsoft.AspNetCore.DataProtection.Repositories.FileSystemXmlRepository[37]
      Reading data from file 'C:\home\ASP.NET\DataProtection-Keys\key-4705609b-f7ee-498d-8862-969d9a2e5fb1.xml'.
dbug: Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager[18]
      Found key {4705609b-f7ee-498d-8862-969d9a2e5fb1}.
dbug: Microsoft.AspNetCore.DataProtection.KeyManagement.DefaultKeyResolver[13]
      Considering key {4705609b-f7ee-498d-8862-969d9a2e5fb1} with expiration date 2026-01-04 12:20:44Z as default key.
dbug: Microsoft.AspNetCore.DataProtection.TypeForwardingActivator[0]
      Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
dbug: Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.CngCbcAuthenticatedEncryptorFactory[4]
      Opening CNG algorithm 'AES' from provider '(null)' with chaining mode CBC.
dbug: Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.CngCbcAuthenticatedEncryptorFactory[3]
      Opening CNG algorithm 'SHA256' from provider '(null)' with HMAC.
dbug: Microsoft.AspNetCore.DataProtection.KeyManagement.KeyRingProvider[2]
      Using key {4705609b-f7ee-498d-8862-969d9a2e5fb1} as the default key.
dbug: Microsoft.AspNetCore.DataProtection.Internal.DataProtectionHostedService[65]
      Key ring with default key {4705609b-f7ee-498d-8862-969d9a2e5fb1} was loaded during application startup.
info: Spe.Bff.Api.Services.Jobs.DocumentEventProcessor[0]
      Document Event Processor starting...
info: Spe.Bff.Api.Services.Jobs.DocumentEventProcessor[0]
      Document Event Processor started successfully
info: Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor[0]
      Service Bus Job Processor starting for queue sdap-jobs with 2 concurrent calls...
info: Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor[0]
      Service Bus Job Processor started successfully
crit: Microsoft.AspNetCore.Hosting.Diagnostics[6]
      Application startup exception
      System.InvalidOperationException: Body was inferred but the method does not allow inferred body parameters.
      Below is the list of parameters that we found: 
      
      Parameter           | Source                        
      ---------------------------------------------------------------------------------
      documentId          | Route (Inferred)
      documentStorageResolver | Services (Inferred)
      graphClient         | Body (Inferred)
      logger              | Services (Inferred)
      
      
      Did you mean to register the "Body (Inferred)" parameter(s) as a Service or apply the [FromServices] or [FromBody] attribute?
      
      
         at Microsoft.AspNetCore.Http.RequestDelegateFactory.CreateArguments(ParameterInfo[] parameters, RequestDelegateFactoryContext factoryContext)
         at Microsoft.AspNetCore.Http.RequestDelegateFactory.CreateArgumentsAndInferMetadata(MethodInfo methodInfo, RequestDelegateFactoryContext factoryContext)
         at Microsoft.AspNetCore.Http.RequestDelegateFactory.InferMetadata(MethodInfo methodInfo, RequestDelegateFactoryOptions options)
         at Microsoft.AspNetCore.Routing.RouteEndpointDataSource.CreateRouteEndpointBuilder(RouteEntry entry, RoutePattern groupPrefix, IReadOnlyList`1 groupConventions, IReadOnlyList`1 groupFinallyConventions)
         at Microsoft.AspNetCore.Routing.RouteEndpointDataSource.GetGroupedEndpoints(RouteGroupContext context)
         at Microsoft.AspNetCore.Routing.RouteGroupBuilder.GroupEndpointDataSource.GetGroupedEndpointsWithNullablePrefix(RoutePattern prefix, IReadOnlyList`1 conventions, IReadOnlyList`1 finallyConventions, IServiceProvider applicationServices)
         at Microsoft.AspNetCore.Routing.RouteGroupBuilder.GroupEndpointDataSource.get_Endpoints()
         at Microsoft.AspNetCore.Routing.CompositeEndpointDataSource.CreateEndpointsUnsynchronized()
         at Microsoft.AspNetCore.Routing.CompositeEndpointDataSource.EnsureEndpointsInitialized()
         at Microsoft.AspNetCore.Routing.CompositeEndpointDataSource.get_Endpoints()
         at Microsoft.AspNetCore.Routing.DataSourceDependentCache`1.Initialize()
         at System.Threading.LazyInitializer.EnsureInitializedCore[T](T&amp; target, Boolean&amp; initialized, Object&amp; syncLock, Func`1 valueFactory)
         at Microsoft.AspNetCore.Routing.DataSourceDependentCache`1.EnsureInitialized()
         at Microsoft.AspNetCore.Authorization.Policy.AuthorizationPolicyCache..ctor(EndpointDataSource dataSource)
         at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
         at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
         at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
         at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
         at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)
         at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
         at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitRootCache(ServiceCallSite callSite, RuntimeResolverContext context)
         at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
         at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.Resolve(ServiceCallSite callSite, ServiceProviderEngineScope scope)
         at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
         at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
         at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
         at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
         at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetService[T](IServiceProvider provider)
         at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware..ctor(RequestDelegate next, IAuthorizationPolicyProvider policyProvider, IServiceProvider services)
         at Microsoft.AspNetCore.Authorization.AuthorizationMiddlewareInternal..ctor(RequestDelegate next, IServiceProvider services, IAuthorizationPolicyProvider policyProvider, ILogger`1 logger)
         at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
         at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
         at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
         at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
         at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
         at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
         at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
         at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
         at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
         at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
fail: Microsoft.Extensions.Hosting.Internal.Host[11]
      Hosting failed to start
      System.InvalidOperationException: Body was inferred but the method does not allow inferred body parameters.
      Below is the list of parameters that we found: 
      
      Parameter           | Source                        
      ---------------------------------------------------------------------------------
      documentId          | Route (Inferred)
      documentStorageResolver | Services (Inferred)
      graphClient         | Body (Inferred)
      logger              | Services (Inferred)
      
      
      Did you mean to register the "Body (Inferred)" parameter(s) as a Service or apply the [FromServices] or [FromBody] attribute?
      
      
         at Microsoft.AspNetCore.Http.RequestDelegateFactory.CreateArguments(ParameterInfo[] parameters, RequestDelegateFactoryContext factoryContext)
         at Microsoft.AspNetCore.Http.RequestDelegateFactory.CreateArgumentsAndInferMetadata(MethodInfo methodInfo, RequestDelegateFactoryContext factoryContext)
         at Microsoft.AspNetCore.Http.RequestDelegateFactory.InferMetadata(MethodInfo methodInfo, RequestDelegateFactoryOptions options)
         at Microsoft.AspNetCore.Routing.RouteEndpointDataSource.CreateRouteEndpointBuilder(RouteEntry entry, RoutePattern groupPrefix, IReadOnlyList`1 groupConventions, IReadOnlyList`1 groupFinallyConventions)
         at Microsoft.AspNetCore.Routing.RouteEndpointDataSource.GetGroupedEndpoints(RouteGroupContext context)
         at Microsoft.AspNetCore.Routing.RouteGroupBuilder.GroupEndpointDataSource.GetGroupedEndpointsWithNullablePrefix(RoutePattern prefix, IReadOnlyList`1 conventions, IReadOnlyList`1 finallyConventions, IServiceProvider applicationServices)
         at Microsoft.AspNetCore.Routing.RouteGroupBuilder.GroupEndpointDataSource.get_Endpoints()
         at Microsoft.AspNetCore.Routing.CompositeEndpointDataSource.CreateEndpointsUnsynchronized()
         at Microsoft.AspNetCore.Routing.CompositeEndpointDataSource.EnsureEndpointsInitialized()
         at Microsoft.AspNetCore.Routing.CompositeEndpointDataSource.get_Endpoints()
         at Microsoft.AspNetCore.Routing.DataSourceDependentCache`1.Initialize()
         at System.Threading.LazyInitializer.EnsureInitializedCore[T](T&amp; target, Boolean&amp; initialized, Object&amp; syncLock, Func`1 valueFactory)
         at Microsoft.AspNetCore.Routing.DataSourceDependentCache`1.EnsureInitialized()
         at Microsoft.AspNetCore.Authorization.Policy.AuthorizationPolicyCache..ctor(EndpointDataSource dataSource)
         at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
         at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
         at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
         at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
         at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)
         at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
         at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitRootCache(ServiceCallSite callSite, RuntimeResolverContext context)
         at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
         at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.Resolve(ServiceCallSite callSite, ServiceProviderEngineScope scope)
         at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
         at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
         at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
         at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
         at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetService[T](IServiceProvider provider)
         at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware..ctor(RequestDelegate next, IAuthorizationPolicyProvider policyProvider, IServiceProvider services)
         at Microsoft.AspNetCore.Authorization.AuthorizationMiddlewareInternal..ctor(RequestDelegate next, IServiceProvider services, IAuthorizationPolicyProvider policyProvider, ILogger`1 logger)
         at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
         at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
         at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
         at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
         at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
         at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
         at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
         at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
         at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
         at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
         at Microsoft.Extensions.Hosting.Internal.Host.&lt;StartAsync&gt;b__15_1(IHostedService service, CancellationToken token)
         at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)
fail: Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor[0]
      Service Bus processor error in sdap-jobs (source: Receive): Can't create session when the connection is closing. (ServiceCommunicationProblem). For troubleshooting information, see https://aka.ms/azsdk/net/servicebus/exceptions/troubleshoot.
      Azure.Messaging.ServiceBus.ServiceBusException: Can't create session when the connection is closing. (ServiceCommunicationProblem). For troubleshooting information, see https://aka.ms/azsdk/net/servicebus/exceptions/troubleshoot.
       ---&gt; System.InvalidOperationException: Can't create session when the connection is closing.
         at Microsoft.Azure.Amqp.AmqpConnection.AddSession(AmqpSession session, Nullable`1 channel)
         at Microsoft.Azure.Amqp.AmqpConnection.CreateSession(AmqpSessionSettings sessionSettings)
         at Azure.Messaging.ServiceBus.Amqp.AmqpConnectionScope.CreateAndOpenSessionAsync(AmqpConnection connection, TimeSpan timeout)
         at Azure.Messaging.ServiceBus.Amqp.AmqpConnectionScope.CreateSessionIfNeededAsync(AmqpConnection connection, TimeSpan timeout)
         at Azure.Messaging.ServiceBus.Amqp.AmqpConnectionScope.CreateReceivingLinkAsync(String entityPath, String identifier, AmqpConnection connection, Uri endpoint, TimeSpan timeout, UInt32 prefetchCount, ServiceBusReceiveMode receiveMode, String sessionId, Boolean isSessionReceiver, CancellationToken cancellationToken)
         --- End of inner exception stack trace ---
         at Azure.Messaging.ServiceBus.Amqp.AmqpConnectionScope.CreateReceivingLinkAsync(String entityPath, String identifier, AmqpConnection connection, Uri endpoint, TimeSpan timeout, UInt32 prefetchCount, ServiceBusReceiveMode receiveMode, String sessionId, Boolean isSessionReceiver, CancellationToken cancellationToken)
         at Azure.Messaging.ServiceBus.Amqp.AmqpConnectionScope.OpenReceiverLinkAsync(String identifier, String entityPath, TimeSpan timeout, UInt32 prefetchCount, ServiceBusReceiveMode receiveMode, String sessionId, Boolean isSessionReceiver, CancellationToken cancellationToken)
         at Azure.Messaging.ServiceBus.Amqp.AmqpReceiver.OpenReceiverLinkAsync(TimeSpan timeout, UInt32 prefetchCount, ServiceBusReceiveMode receiveMode, String identifier, CancellationToken cancellationToken)
         at Microsoft.Azure.Amqp.FaultTolerantAmqpObject`1.OnCreateAsync(TimeSpan timeout, CancellationToken cancellationToken)
         at Microsoft.Azure.Amqp.Singleton`1.GetOrCreateAsync(TimeSpan timeout, CancellationToken cancellationToken)
         at Microsoft.Azure.Amqp.Singleton`1.GetOrCreateAsync(TimeSpan timeout, CancellationToken cancellationToken)
         at Azure.Messaging.ServiceBus.Amqp.AmqpReceiver.ReceiveMessagesAsyncInternal(Int32 maxMessages, Nullable`1 maxWaitTime, TimeSpan timeout, CancellationToken cancellationToken)
         at Azure.Messaging.ServiceBus.Amqp.AmqpReceiver.ReceiveMessagesAsyncInternal(Int32 maxMessages, Nullable`1 maxWaitTime, TimeSpan timeout, CancellationToken cancellationToken)
         at Azure.Messaging.ServiceBus.Amqp.AmqpReceiver.&lt;&gt;c.&lt;&lt;ReceiveMessagesAsync&gt;b__44_0&gt;d.MoveNext()
      --- End of stack trace from previous location ---
         at Azure.Messaging.ServiceBus.ServiceBusRetryPolicy.RunOperation[T1,TResult](Func`4 operation, T1 t1, TransportConnectionScope scope, CancellationToken cancellationToken, Boolean logTimeoutRetriesAsVerbose)
         at Azure.Messaging.ServiceBus.ServiceBusRetryPolicy.RunOperation[T1,TResult](Func`4 operation, T1 t1, TransportConnectionScope scope, CancellationToken cancellationToken, Boolean logTimeoutRetriesAsVerbose)
         at Azure.Messaging.ServiceBus.Amqp.AmqpReceiver.ReceiveMessagesAsync(Int32 maxMessages, Nullable`1 maxWaitTime, CancellationToken cancellationToken)
         at Azure.Messaging.ServiceBus.ServiceBusReceiver.ReceiveMessagesAsync(Int32 maxMessages, Nullable`1 maxWaitTime, Boolean isProcessor, CancellationToken cancellationToken)
         at Azure.Messaging.ServiceBus.ReceiverManager.ReceiveAndProcessMessagesAsync(CancellationToken cancellationToken)
info: Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor[0]
      Service Bus Job Processor stopping...
fail: Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor[0]
      Service Bus processor error in sdap-jobs (source: Receive): Can't create session when the connection is closing. (ServiceCommunicationProblem). For troubleshooting information, see https://aka.ms/azsdk/net/servicebus/exceptions/troubleshoot.
      Azure.Messaging.ServiceBus.ServiceBusException: Can't create session when the connection is closing. (ServiceCommunicationProblem). For troubleshooting information, see https://aka.ms/azsdk/net/servicebus/exceptions/troubleshoot.
       ---&gt; System.InvalidOperationException: Can't create session when the connection is closing.
         at Microsoft.Azure.Amqp.AmqpConnection.AddSession(AmqpSession session, Nullable`1 channel)
         at Microsoft.Azure.Amqp.AmqpConnection.CreateSession(AmqpSessionSettings sessionSettings)
         at Azure.Messaging.ServiceBus.Amqp.AmqpConnectionScope.CreateAndOpenSessionAsync(AmqpConnection connection, TimeSpan timeout)
         at Azure.Messaging.ServiceBus.Amqp.AmqpConnectionScope.CreateSessionIfNeededAsync(AmqpConnection connection, TimeSpan timeout)
         at Azure.Messaging.ServiceBus.Amqp.AmqpConnectionScope.CreateReceivingLinkAsync(String entityPath, String identifier, AmqpConnection connection, Uri endpoint, TimeSpan timeout, UInt32 prefetchCount, ServiceBusReceiveMode receiveMode, String sessionId, Boolean isSessionReceiver, CancellationToken cancellationToken)
         --- End of inner exception stack trace ---
         at Azure.Messaging.ServiceBus.Amqp.AmqpConnectionScope.CreateReceivingLinkAsync(String entityPath, String identifier, AmqpConnection connection, Uri endpoint, TimeSpan timeout, UInt32 prefetchCount, ServiceBusReceiveMode receiveMode, String sessionId, Boolean isSessionReceiver, CancellationToken cancellationToken)
         at Azure.Messaging.ServiceBus.Amqp.AmqpConnectionScope.OpenReceiverLinkAsync(String identifier, String entityPath, TimeSpan timeout, UInt32 prefetchCount, ServiceBusReceiveMode receiveMode, String sessionId, Boolean isSessionReceiver, CancellationToken cancellationToken)
         at Azure.Messaging.ServiceBus.Amqp.AmqpReceiver.OpenReceiverLinkAsync(TimeSpan timeout, UInt32 prefetchCount, ServiceBusReceiveMode receiveMode, String identifier, CancellationToken cancellationToken)
         at Microsoft.Azure.Amqp.FaultTolerantAmqpObject`1.OnCreateAsync(TimeSpan timeout, CancellationToken cancellationToken)
         at Microsoft.Azure.Amqp.Singleton`1.GetOrCreateAsync(TimeSpan timeout, CancellationToken cancellationToken)
         at Microsoft.Azure.Amqp.Singleton`1.GetOrCreateAsync(TimeSpan timeout, CancellationToken cancellationToken)
         at Azure.Messaging.ServiceBus.Amqp.AmqpReceiver.ReceiveMessagesAsyncInternal(Int32 maxMessages, Nullable`1 maxWaitTime, TimeSpan timeout, CancellationToken cancellationToken)
         at Azure.Messaging.ServiceBus.Amqp.AmqpReceiver.ReceiveMessagesAsyncInternal(Int32 maxMessages, Nullable`1 maxWaitTime, TimeSpan timeout, CancellationToken cancellationToken)
         at Azure.Messaging.ServiceBus.Amqp.AmqpReceiver.&lt;&gt;c.&lt;&lt;ReceiveMessagesAsync&gt;b__44_0&gt;d.MoveNext()
      --- End of stack trace from previous location ---
         at Azure.Messaging.ServiceBus.ServiceBusRetryPolicy.RunOperation[T1,TResult](Func`4 operation, T1 t1, TransportConnectionScope scope, CancellationToken cancellationToken, Boolean logTimeoutRetriesAsVerbose)
         at Azure.Messaging.ServiceBus.ServiceBusRetryPolicy.RunOperation[T1,TResult](Func`4 operation, T1 t1, TransportConnectionScope scope, CancellationToken cancellationToken, Boolean logTimeoutRetriesAsVerbose)
         at Azure.Messaging.ServiceBus.Amqp.AmqpReceiver.ReceiveMessagesAsync(Int32 maxMessages, Nullable`1 maxWaitTime, CancellationToken cancellationToken)
         at Azure.Messaging.ServiceBus.ServiceBusReceiver.ReceiveMessagesAsync(Int32 maxMessages, Nullable`1 maxWaitTime, Boolean isProcessor, CancellationToken cancellationToken)
         at Azure.Messaging.ServiceBus.ReceiverManager.ReceiveAndProcessMessagesAsync(CancellationToken cancellationToken)
Unhandled exception. System.InvalidOperationException: Body was inferred but the method does not allow inferred body parameters.
Below is the list of parameters that we found: 

Parameter           | Source                        
---------------------------------------------------------------------------------
documentId          | Route (Inferred)
documentStorageResolver | Services (Inferred)
graphClient         | Body (Inferred)
logger              | Services (Inferred)


Did you mean to register the "Body (Inferred)" parameter(s) as a Service or apply the [FromServices] or [FromBody] attribute?


   at Microsoft.AspNetCore.Http.RequestDelegateFactory.CreateArguments(ParameterInfo[] parameters, RequestDelegateFactoryContext factoryContext)
   at Microsoft.AspNetCore.Http.RequestDelegateFactory.CreateArgumentsAndInferMetadata(MethodInfo methodInfo, RequestDelegateFactoryContext factoryContext)
   at Microsoft.AspNetCore.Http.RequestDelegateFactory.InferMetadata(MethodInfo methodInfo, RequestDelegateFactoryOptions options)
   at Microsoft.AspNetCore.Routing.RouteEndpointDataSource.CreateRouteEndpointBuilder(RouteEntry entry, RoutePattern groupPrefix, IReadOnlyList`1 groupConventions, IReadOnlyList`1 groupFinallyConventions)
   at Microsoft.AspNetCore.Routing.RouteEndpointDataSource.GetGroupedEndpoints(RouteGroupContext context)
   at Microsoft.AspNetCore.Routing.RouteGroupBuilder.GroupEndpointDataSource.GetGroupedEndpointsWithNullablePrefix(RoutePattern prefix, IReadOnlyList`1 conventions, IReadOnlyList`1 finallyConventions, IServiceProvider applicationServices)
   at Microsoft.AspNetCore.Routing.RouteGroupBuilder.GroupEndpointDataSource.get_Endpoints()
   at Microsoft.AspNetCore.Routing.CompositeEndpointDataSource.CreateEndpointsUnsynchronized()
   at Microsoft.AspNetCore.Routing.CompositeEndpointDataSource.EnsureEndpointsInitialized()
   at Microsoft.AspNetCore.Routing.CompositeEndpointDataSource.get_Endpoints()
   at Microsoft.AspNetCore.Routing.DataSourceDependentCache`1.Initialize()
   at System.Threading.LazyInitializer.EnsureInitializedCore[T](T&amp; target, Boolean&amp; initialized, Object&amp; syncLock, Func`1 valueFactory)
   at Microsoft.AspNetCore.Routing.DataSourceDependentCache`1.EnsureInitialized()
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationPolicyCache..ctor(EndpointDataSource dataSource)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitRootCache(ServiceCallSite callSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.Resolve(ServiceCallSite callSite, ServiceProviderEngineScope scope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyI</Data><Data>Process Id: 6388.</Data><Data>File Version: 18.0.25301.22. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1007</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-25T21:29:50Z"/><EventRecordID>384399937</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Application '/LM/W3SVC/424429371/ROOT' with physical root 'C:\home\site\wwwroot\' failed to load coreclr. Exception message:
CLR worker thread exited prematurely</Data><Data>Process Id: 6388.</Data><Data>File Version: 18.0.25301.22. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1012</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-25T21:32:58Z"/><EventRecordID>384587078</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Application 'C:\home\site\wwwroot\' was recycled after detecting app_offline.htm.</Data><Data>Process Id: 6388.</Data><Data>File Version: 18.0.25301.22. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1012</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-25T21:32:58Z"/><EventRecordID>384587750</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Application 'C:\home\site\wwwroot\' was recycled after detecting app_offline.htm.</Data><Data>Process Id: 6388.</Data><Data>File Version: 18.0.25301.22. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1032</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-25T21:34:45Z"/><EventRecordID>384694203</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Application 'C:\home\site\wwwroot\' started successfully.</Data><Data>Process Id: 6164.</Data><Data>File Version: 18.0.25301.22. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-25T21:38:46Z"/><EventRecordID>384935656</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Category: Program
EventId: 0
SpanId: 57f73d0374075721
TraceId: 93689ff5198470fabdce92c2ad39e96c
ParentId: 0000000000000000
RequestId: 4000175a-0000-d700-b63f-84710c7967bb
RequestPath: /api/documents/ab1b0c34-52a5-f011-bbd3-7c1e5215b8b5/preview-url

[4b3a257d-1ba7-4722-8d02-fe5f9335885c] Error getting preview URL for document ab1b0c34-52a5-f011-bbd3-7c1e5215b8b5

Exception: 
System.ServiceModel.FaultException`1[Microsoft.Xrm.Sdk.OrganizationServiceFault]: 'sprk_Document' entity doesn't contain attribute with Name = 'sprk_description' and NameMapping = 'Logical' (look up attribute by name is case-sensitive).orgIndex: 142, id: 542b5ef7-a979-f011-b4cb-7c1e5249480b, logicalName: sprk_document (Fault Detail is equal to Exception details: 
ErrorCode: 0x80041103
Message: 'sprk_Document' entity doesn't contain attribute with Name = 'sprk_description' and NameMapping = 'Logical' (look up attribute by name is case-sensitive).orgIndex: 142, id: 542b5ef7-a979-f011-b4cb-7c1e5249480b, logicalName: sprk_document
TimeStamp: 2025-11-25T21:38:46.1903999Z
--
Exception details: 
ErrorCode: 0x80041103
Message: 'sprk_Document' entity doesn't contain attribute with Name = 'sprk_description' and NameMapping = 'Logical' (look up attribute by name is case-sensitive).orgIndex: 142, id: 542b5ef7-a979-f011-b4cb-7c1e5249480b, logicalName: sprk_document
TimeStamp: 2025-11-25T21:38:46.1903999Z
--
).
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-25T21:39:21Z"/><EventRecordID>384970296</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Category: Program
EventId: 0
SpanId: 19b21ce1408e8c52
TraceId: 864fb81511b48affe7c33865540d6dbc
ParentId: 0000000000000000
RequestId: 4000175c-0000-d700-b63f-84710c7967bb
RequestPath: /api/documents/ab1b0c34-52a5-f011-bbd3-7c1e5215b8b5/preview-url

[1c6e5a14-4e10-4e33-a8e1-ab8ab004784d] Error getting preview URL for document ab1b0c34-52a5-f011-bbd3-7c1e5215b8b5

Exception: 
System.ServiceModel.FaultException`1[Microsoft.Xrm.Sdk.OrganizationServiceFault]: 'sprk_Document' entity doesn't contain attribute with Name = 'sprk_description' and NameMapping = 'Logical' (look up attribute by name is case-sensitive).orgIndex: 142, id: 542b5ef7-a979-f011-b4cb-7c1e5249480b, logicalName: sprk_document (Fault Detail is equal to Exception details: 
ErrorCode: 0x80041103
Message: 'sprk_Document' entity doesn't contain attribute with Name = 'sprk_description' and NameMapping = 'Logical' (look up attribute by name is case-sensitive).orgIndex: 142, id: 542b5ef7-a979-f011-b4cb-7c1e5249480b, logicalName: sprk_document
TimeStamp: 2025-11-25T21:39:19.5452162Z
--
Exception details: 
ErrorCode: 0x80041103
Message: 'sprk_Document' entity doesn't contain attribute with Name = 'sprk_description' and NameMapping = 'Logical' (look up attribute by name is case-sensitive).orgIndex: 142, id: 542b5ef7-a979-f011-b4cb-7c1e5249480b, logicalName: sprk_document
TimeStamp: 2025-11-25T21:39:19.5452162Z
--
).
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-25T21:41:13Z"/><EventRecordID>385082671</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Category: Program
EventId: 0
SpanId: b6d172b2efc22bb6
TraceId: 99243dd274ca19726ada69698a0b9de3
ParentId: 0000000000000000
RequestId: 40000ac0-0000-cd00-b63f-84710c7967bb
RequestPath: /api/documents/802dce6e-47ca-f011-8543-000d3a1a9353/preview-url

[ec0b2742-f528-4bf6-9071-b6dc5415a929] Error getting preview URL for document 802dce6e-47ca-f011-8543-000d3a1a9353

Exception: 
System.ServiceModel.FaultException`1[Microsoft.Xrm.Sdk.OrganizationServiceFault]: 'sprk_Document' entity doesn't contain attribute with Name = 'sprk_description' and NameMapping = 'Logical' (look up attribute by name is case-sensitive).orgIndex: 142, id: 542b5ef7-a979-f011-b4cb-7c1e5249480b, logicalName: sprk_document (Fault Detail is equal to Exception details: 
ErrorCode: 0x80041103
Message: 'sprk_Document' entity doesn't contain attribute with Name = 'sprk_description' and NameMapping = 'Logical' (look up attribute by name is case-sensitive).orgIndex: 142, id: 542b5ef7-a979-f011-b4cb-7c1e5249480b, logicalName: sprk_document
TimeStamp: 2025-11-25T21:41:13.5325845Z
--
Exception details: 
ErrorCode: 0x80041103
Message: 'sprk_Document' entity doesn't contain attribute with Name = 'sprk_description' and NameMapping = 'Logical' (look up attribute by name is case-sensitive).orgIndex: 142, id: 542b5ef7-a979-f011-b4cb-7c1e5249480b, logicalName: sprk_document
TimeStamp: 2025-11-25T21:41:13.5325845Z
--
).
</Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1012</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-25T21:53:30Z"/><EventRecordID>385819546</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Application 'C:\home\site\wwwroot\' was recycled after detecting app_offline.htm.</Data><Data>Process Id: 6164.</Data><Data>File Version: 18.0.25301.22. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-25T21:53:32Z"/><EventRecordID>385821218</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 9

BackgroundService failed

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\ServiceBusJobProcessor.cs:line 72
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-25T21:53:32Z"/><EventRecordID>385821296</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 10

The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\ServiceBusJobProcessor.cs:line 72
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-25T21:53:36Z"/><EventRecordID>385825656</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 9

BackgroundService failed

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.DocumentEventProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\DocumentEventProcessor.cs:line 68
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-25T21:53:36Z"/><EventRecordID>385825765</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 10

The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.DocumentEventProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\DocumentEventProcessor.cs:line 68
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1005</EventID><Level>2</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-25T21:53:41Z"/><EventRecordID>385830562</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Failed to gracefully shutdown application 'MACHINE/WEBROOT/APPHOST/SPE-API-DEV-67E2XZ'.</Data><Data>Process Id: 6164.</Data><Data>File Version: 18.0.25301.22. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1032</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-25T21:54:41Z"/><EventRecordID>385890640</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Application 'C:\home\site\wwwroot\' started successfully.</Data><Data>Process Id: 7296.</Data><Data>File Version: 18.0.25301.22. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-25T21:56:03Z"/><EventRecordID>385972671</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 9

BackgroundService failed

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\ServiceBusJobProcessor.cs:line 72
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-25T21:56:03Z"/><EventRecordID>385972734</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 10

The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\ServiceBusJobProcessor.cs:line 72
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-25T21:56:05Z"/><EventRecordID>385974171</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 9

BackgroundService failed

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.DocumentEventProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\DocumentEventProcessor.cs:line 68
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-25T21:56:05Z"/><EventRecordID>385974328</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 10

The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.DocumentEventProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\DocumentEventProcessor.cs:line 68
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1033</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-25T21:56:05Z"/><EventRecordID>385974843</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Application 'MACHINE/WEBROOT/APPHOST/SPE-API-DEV-67E2XZ' has shutdown.</Data><Data>Process Id: 7296.</Data><Data>File Version: 18.0.25301.22. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1032</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-25T21:57:24Z"/><EventRecordID>386053187</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Application 'C:\home\site\wwwroot\' started successfully.</Data><Data>Process Id: 4936.</Data><Data>File Version: 18.0.25301.22. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-25T22:02:29Z"/><EventRecordID>386358890</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Category: Program
EventId: 0
SpanId: d2c3c21b7337372e
TraceId: 50038e72464fd15158aa6260f73b9e81
ParentId: 0000000000000000
RequestId: 4000002e-0000-e000-b63f-84710c7967bb
RequestPath: /api/documents/ab1b0c34-52a5-f011-bbd3-7c1e5215b8b5/preview-url

[c4561ae7-9079-4b20-a7f8-6de28c115fa3] Error getting preview URL for document ab1b0c34-52a5-f011-bbd3-7c1e5215b8b5

Exception: 
System.InvalidCastException: Unable to cast object of type 'System.Int32' to type 'System.Nullable`1[System.Int64]'.
   at Microsoft.Xrm.Sdk.Entity.GetAttributeValue[T](String attributeLogicalName)
   at Spaarke.Dataverse.DataverseServiceClientImpl.MapToDocumentEntity(Entity entity) in C:\code_files\spaarke\src\shared\Spaarke.Dataverse\DataverseServiceClientImpl.cs:line 435
   at Spaarke.Dataverse.DataverseServiceClientImpl.GetDocumentAsync(String id, CancellationToken ct) in C:\code_files\spaarke\src\shared\Spaarke.Dataverse\DataverseServiceClientImpl.cs:line 107
   at Spe.Bff.Api.Infrastructure.Dataverse.DocumentStorageResolver.GetSpePointersAsync(Guid documentId, CancellationToken cancellationToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Infrastructure\Dataverse\DocumentStorageResolver.cs:line 32
   at Spe.Bff.Api.Api.FileAccessEndpoints.&lt;MapFileAccessEndpoints&gt;g__GetPreviewUrl|0_0(String documentId, IDocumentStorageResolver documentStorageResolver, SpeFileStore speFileStore, ILogger`1 logger, HttpContext context, CancellationToken ct) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Api\FileAccessEndpoints.cs:line 112
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-25T22:02:40Z"/><EventRecordID>386369328</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Category: Program
EventId: 0
SpanId: 6725b0a049b44eb1
TraceId: 6074a48308f73e11753de1af3c5a91d4
ParentId: 0000000000000000
RequestId: 40000030-0000-e000-b63f-84710c7967bb
RequestPath: /api/documents/ab1b0c34-52a5-f011-bbd3-7c1e5215b8b5/preview-url

[839f1d14-2664-4754-9ccf-66bc6cce3435] Error getting preview URL for document ab1b0c34-52a5-f011-bbd3-7c1e5215b8b5

Exception: 
System.InvalidCastException: Unable to cast object of type 'System.Int32' to type 'System.Nullable`1[System.Int64]'.
   at Microsoft.Xrm.Sdk.Entity.GetAttributeValue[T](String attributeLogicalName)
   at Spaarke.Dataverse.DataverseServiceClientImpl.MapToDocumentEntity(Entity entity) in C:\code_files\spaarke\src\shared\Spaarke.Dataverse\DataverseServiceClientImpl.cs:line 435
   at Spaarke.Dataverse.DataverseServiceClientImpl.GetDocumentAsync(String id, CancellationToken ct) in C:\code_files\spaarke\src\shared\Spaarke.Dataverse\DataverseServiceClientImpl.cs:line 107
   at Spe.Bff.Api.Infrastructure.Dataverse.DocumentStorageResolver.GetSpePointersAsync(Guid documentId, CancellationToken cancellationToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Infrastructure\Dataverse\DocumentStorageResolver.cs:line 32
   at Spe.Bff.Api.Api.FileAccessEndpoints.&lt;MapFileAccessEndpoints&gt;g__GetPreviewUrl|0_0(String documentId, IDocumentStorageResolver documentStorageResolver, SpeFileStore speFileStore, ILogger`1 logger, HttpContext context, CancellationToken ct) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Api\FileAccessEndpoints.cs:line 112
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-25T22:03:18Z"/><EventRecordID>386407953</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Category: Program
EventId: 0
SpanId: 6c671ae184f1d243
TraceId: 9581db922e68ee45c7626a8bd477bf2a
ParentId: 0000000000000000
RequestId: 40000032-0000-e000-b63f-84710c7967bb
RequestPath: /api/documents/ab1b0c34-52a5-f011-bbd3-7c1e5215b8b5/preview-url

[839f1d14-2664-4754-9ccf-66bc6cce3435] Error getting preview URL for document ab1b0c34-52a5-f011-bbd3-7c1e5215b8b5

Exception: 
System.InvalidCastException: Unable to cast object of type 'System.Int32' to type 'System.Nullable`1[System.Int64]'.
   at Microsoft.Xrm.Sdk.Entity.GetAttributeValue[T](String attributeLogicalName)
   at Spaarke.Dataverse.DataverseServiceClientImpl.MapToDocumentEntity(Entity entity) in C:\code_files\spaarke\src\shared\Spaarke.Dataverse\DataverseServiceClientImpl.cs:line 435
   at Spaarke.Dataverse.DataverseServiceClientImpl.GetDocumentAsync(String id, CancellationToken ct) in C:\code_files\spaarke\src\shared\Spaarke.Dataverse\DataverseServiceClientImpl.cs:line 107
   at Spe.Bff.Api.Infrastructure.Dataverse.DocumentStorageResolver.GetSpePointersAsync(Guid documentId, CancellationToken cancellationToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Infrastructure\Dataverse\DocumentStorageResolver.cs:line 32
   at Spe.Bff.Api.Api.FileAccessEndpoints.&lt;MapFileAccessEndpoints&gt;g__GetPreviewUrl|0_0(String documentId, IDocumentStorageResolver documentStorageResolver, SpeFileStore speFileStore, ILogger`1 logger, HttpContext context, CancellationToken ct) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Api\FileAccessEndpoints.cs:line 112
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-25T22:03:32Z"/><EventRecordID>386421593</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Category: Program
EventId: 0
SpanId: c92b23348d6f4d41
TraceId: 4b504e8ee02aefdf96a224691000f496
ParentId: 0000000000000000
RequestId: 40000034-0000-e000-b63f-84710c7967bb
RequestPath: /api/documents/ab1b0c34-52a5-f011-bbd3-7c1e5215b8b5/preview-url

[c96214f7-78b3-4df7-9969-c1590b39886f] Error getting preview URL for document ab1b0c34-52a5-f011-bbd3-7c1e5215b8b5

Exception: 
System.InvalidCastException: Unable to cast object of type 'System.Int32' to type 'System.Nullable`1[System.Int64]'.
   at Microsoft.Xrm.Sdk.Entity.GetAttributeValue[T](String attributeLogicalName)
   at Spaarke.Dataverse.DataverseServiceClientImpl.MapToDocumentEntity(Entity entity) in C:\code_files\spaarke\src\shared\Spaarke.Dataverse\DataverseServiceClientImpl.cs:line 435
   at Spaarke.Dataverse.DataverseServiceClientImpl.GetDocumentAsync(String id, CancellationToken ct) in C:\code_files\spaarke\src\shared\Spaarke.Dataverse\DataverseServiceClientImpl.cs:line 107
   at Spe.Bff.Api.Infrastructure.Dataverse.DocumentStorageResolver.GetSpePointersAsync(Guid documentId, CancellationToken cancellationToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Infrastructure\Dataverse\DocumentStorageResolver.cs:line 32
   at Spe.Bff.Api.Api.FileAccessEndpoints.&lt;MapFileAccessEndpoints&gt;g__GetPreviewUrl|0_0(String documentId, IDocumentStorageResolver documentStorageResolver, SpeFileStore speFileStore, ILogger`1 logger, HttpContext context, CancellationToken ct) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Api\FileAccessEndpoints.cs:line 112
</Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1012</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-25T22:07:24Z"/><EventRecordID>386653828</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Application 'C:\home\site\wwwroot\' was recycled after detecting app_offline.htm.</Data><Data>Process Id: 4936.</Data><Data>File Version: 18.0.25301.22. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-25T22:07:30Z"/><EventRecordID>386659062</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 9

BackgroundService failed

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\ServiceBusJobProcessor.cs:line 72
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-25T22:07:33Z"/><EventRecordID>386662671</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 10

The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\ServiceBusJobProcessor.cs:line 72
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1005</EventID><Level>2</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-25T22:07:37Z"/><EventRecordID>386666843</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Failed to gracefully shutdown application 'MACHINE/WEBROOT/APPHOST/SPE-API-DEV-67E2XZ'.</Data><Data>Process Id: 4936.</Data><Data>File Version: 18.0.25301.22. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-25T22:07:45Z"/><EventRecordID>386674703</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 9

BackgroundService failed

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.DocumentEventProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\DocumentEventProcessor.cs:line 68
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-25T22:07:46Z"/><EventRecordID>386675515</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 10

The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.DocumentEventProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\DocumentEventProcessor.cs:line 68
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1032</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-25T22:10:04Z"/><EventRecordID>386813656</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Application 'C:\home\site\wwwroot\' started successfully.</Data><Data>Process Id: 6384.</Data><Data>File Version: 18.0.25301.22. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-25T22:11:25Z"/><EventRecordID>386894734</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Category: Program
EventId: 0
SpanId: 09928dedb00b498b
TraceId: fc80e5a026fbc562887ea5e65e365c99
ParentId: 0000000000000000
RequestId: 400017bd-0000-cc00-b63f-84710c7967bb
RequestPath: /api/documents/ab1b0c34-52a5-f011-bbd3-7c1e5215b8b5/preview-url

[5de96e5a-99e1-4cc9-bbe0-cdbf9e5254db] Error getting preview URL for document ab1b0c34-52a5-f011-bbd3-7c1e5215b8b5

Exception: 
System.ServiceModel.FaultException`1[Microsoft.Xrm.Sdk.OrganizationServiceFault]: 'sprk_Document' entity doesn't contain attribute with Name = 'sprk_DocumentDescription' and NameMapping = 'Logical' (look up attribute by name is case-sensitive).orgIndex: 142, id: 542b5ef7-a979-f011-b4cb-7c1e5249480b, logicalName: sprk_document (Fault Detail is equal to Exception details: 
ErrorCode: 0x80041103
Message: 'sprk_Document' entity doesn't contain attribute with Name = 'sprk_DocumentDescription' and NameMapping = 'Logical' (look up attribute by name is case-sensitive).orgIndex: 142, id: 542b5ef7-a979-f011-b4cb-7c1e5249480b, logicalName: sprk_document
TimeStamp: 2025-11-25T22:11:25.3328264Z
--
Exception details: 
ErrorCode: 0x80041103
Message: 'sprk_Document' entity doesn't contain attribute with Name = 'sprk_DocumentDescription' and NameMapping = 'Logical' (look up attribute by name is case-sensitive).orgIndex: 142, id: 542b5ef7-a979-f011-b4cb-7c1e5249480b, logicalName: sprk_document
TimeStamp: 2025-11-25T22:11:25.3328264Z
--
).
</Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1012</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-25T22:16:25Z"/><EventRecordID>387194562</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Application 'C:\home\site\wwwroot\' was recycled after detecting app_offline.htm.</Data><Data>Process Id: 6384.</Data><Data>File Version: 18.0.25301.22. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-25T22:16:26Z"/><EventRecordID>387195906</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 9

BackgroundService failed

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\ServiceBusJobProcessor.cs:line 72
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-25T22:16:27Z"/><EventRecordID>387196062</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 10

The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\ServiceBusJobProcessor.cs:line 72
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-25T22:16:29Z"/><EventRecordID>387198390</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 9

BackgroundService failed

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.DocumentEventProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\DocumentEventProcessor.cs:line 68
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-25T22:16:29Z"/><EventRecordID>387198781</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 10

The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.DocumentEventProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\DocumentEventProcessor.cs:line 68
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1033</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-25T22:16:30Z"/><EventRecordID>387199593</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Application 'MACHINE/WEBROOT/APPHOST/SPE-API-DEV-67E2XZ' has shutdown.</Data><Data>Process Id: 6384.</Data><Data>File Version: 18.0.25301.22. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1032</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-25T22:18:19Z"/><EventRecordID>387308250</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Application 'C:\home\site\wwwroot\' started successfully.</Data><Data>Process Id: 5548.</Data><Data>File Version: 18.0.25301.22. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-25T22:18:29Z"/><EventRecordID>387318781</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Category: Program
EventId: 0
SpanId: 3b5741d8c7e649cc
TraceId: 6680b99dbc91406c84c87fad2fd16d62
ParentId: 0000000000000000
RequestId: 4000119e-0000-ed00-b63f-84710c7967bb
RequestPath: /api/documents/ab1b0c34-52a5-f011-bbd3-7c1e5215b8b5/preview-url

[827eab65-a0a6-4356-bcfd-de1c9dca3847] Error getting preview URL for document ab1b0c34-52a5-f011-bbd3-7c1e5215b8b5

Exception: 
System.InvalidCastException: Unable to cast object of type 'System.Int32' to type 'System.Nullable`1[System.Int64]'.
   at Microsoft.Xrm.Sdk.Entity.GetAttributeValue[T](String attributeLogicalName)
   at Spaarke.Dataverse.DataverseServiceClientImpl.MapToDocumentEntity(Entity entity) in C:\code_files\spaarke\src\shared\Spaarke.Dataverse\DataverseServiceClientImpl.cs:line 433
   at Spaarke.Dataverse.DataverseServiceClientImpl.GetDocumentAsync(String id, CancellationToken ct) in C:\code_files\spaarke\src\shared\Spaarke.Dataverse\DataverseServiceClientImpl.cs:line 106
   at Spe.Bff.Api.Infrastructure.Dataverse.DocumentStorageResolver.GetSpePointersAsync(Guid documentId, CancellationToken cancellationToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Infrastructure\Dataverse\DocumentStorageResolver.cs:line 32
   at Spe.Bff.Api.Api.FileAccessEndpoints.&lt;MapFileAccessEndpoints&gt;g__GetPreviewUrl|0_0(String documentId, IDocumentStorageResolver documentStorageResolver, SpeFileStore speFileStore, ILogger`1 logger, HttpContext context, CancellationToken ct) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Api\FileAccessEndpoints.cs:line 112
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-25T22:26:26Z"/><EventRecordID>387795640</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Category: Program
EventId: 0
SpanId: 2af18fe1c3d29ec9
TraceId: 4bbc612efe359950dd4135fa04876d64
ParentId: 0000000000000000
RequestId: 40001770-0000-fe00-b63f-84710c7967bb
RequestPath: /api/documents/ab1b0c34-52a5-f011-bbd3-7c1e5215b8b5/preview-url

[2c6fc835-1dff-427f-b4c3-07dd52be980e] Error getting preview URL for document ab1b0c34-52a5-f011-bbd3-7c1e5215b8b5

Exception: 
System.InvalidCastException: Unable to cast object of type 'System.Int32' to type 'System.Nullable`1[System.Int64]'.
   at Microsoft.Xrm.Sdk.Entity.GetAttributeValue[T](String attributeLogicalName)
   at Spaarke.Dataverse.DataverseServiceClientImpl.MapToDocumentEntity(Entity entity) in C:\code_files\spaarke\src\shared\Spaarke.Dataverse\DataverseServiceClientImpl.cs:line 433
   at Spaarke.Dataverse.DataverseServiceClientImpl.GetDocumentAsync(String id, CancellationToken ct) in C:\code_files\spaarke\src\shared\Spaarke.Dataverse\DataverseServiceClientImpl.cs:line 106
   at Spe.Bff.Api.Infrastructure.Dataverse.DocumentStorageResolver.GetSpePointersAsync(Guid documentId, CancellationToken cancellationToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Infrastructure\Dataverse\DocumentStorageResolver.cs:line 32
   at Spe.Bff.Api.Api.FileAccessEndpoints.&lt;MapFileAccessEndpoints&gt;g__GetPreviewUrl|0_0(String documentId, IDocumentStorageResolver documentStorageResolver, SpeFileStore speFileStore, ILogger`1 logger, HttpContext context, CancellationToken ct) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Api\FileAccessEndpoints.cs:line 112
</Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1012</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-25T22:30:16Z"/><EventRecordID>388026031</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Application 'C:\home\site\wwwroot\' was recycled after detecting app_offline.htm.</Data><Data>Process Id: 5548.</Data><Data>File Version: 18.0.25301.22. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-25T22:30:18Z"/><EventRecordID>388027937</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 9

BackgroundService failed

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\ServiceBusJobProcessor.cs:line 72
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-25T22:30:18Z"/><EventRecordID>388028000</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 10

The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\ServiceBusJobProcessor.cs:line 72
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-25T22:30:21Z"/><EventRecordID>388030812</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 9

BackgroundService failed

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.DocumentEventProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\DocumentEventProcessor.cs:line 68
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-25T22:30:21Z"/><EventRecordID>388031000</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 10

The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.DocumentEventProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\DocumentEventProcessor.cs:line 68
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1033</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-25T22:30:25Z"/><EventRecordID>388034843</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Application 'MACHINE/WEBROOT/APPHOST/SPE-API-DEV-67E2XZ' has shutdown.</Data><Data>Process Id: 5548.</Data><Data>File Version: 18.0.25301.22. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1032</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-25T22:32:29Z"/><EventRecordID>388158906</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Application 'C:\home\site\wwwroot\' started successfully.</Data><Data>Process Id: 8128.</Data><Data>File Version: 18.0.25301.22. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-25T22:32:43Z"/><EventRecordID>388172359</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Category: Spe.Bff.Api.Infrastructure.Graph.DriveItemOperations
EventId: 0
SpanId: ad554829c6ca540f
TraceId: e6fba2ce580cb8619d7c5ec050537c27
ParentId: 0000000000000000
RequestId: 40001775-0000-f900-b63f-84710c7967bb
RequestPath: /api/documents/ab1b0c34-52a5-f011-bbd3-7c1e5215b8b5/preview-url

[947113c6-c645-4d32-aa81-8afcb1ae056d] Unexpected error getting preview URL for 01LBYCMX5QI2GQJSIJVBGYSRJILMDIITCI

Exception: 
Microsoft.Graph.Models.ODataErrors.ODataError: Access denied
   at Microsoft.Kiota.Http.HttpClientLibrary.HttpClientRequestAdapter.ThrowIfFailedResponse(HttpResponseMessage response, Dictionary`2 errorMapping, Activity activityForAttributes, CancellationToken cancellationToken)
   at Microsoft.Kiota.Http.HttpClientLibrary.HttpClientRequestAdapter.SendAsync[ModelType](RequestInformation requestInfo, ParsableFactory`1 factory, Dictionary`2 errorMapping, CancellationToken cancellationToken)
   at Microsoft.Kiota.Http.HttpClientLibrary.HttpClientRequestAdapter.SendAsync[ModelType](RequestInformation requestInfo, ParsableFactory`1 factory, Dictionary`2 errorMapping, CancellationToken cancellationToken)
   at Microsoft.Graph.Drives.Item.Items.Item.Preview.PreviewRequestBuilder.PostAsync(PreviewPostRequestBody body, Action`1 requestConfiguration, CancellationToken cancellationToken)
   at Spe.Bff.Api.Infrastructure.Graph.DriveItemOperations.GetPreviewUrlAsync(String driveId, String itemId, String correlationId, CancellationToken ct) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Infrastructure\Graph\DriveItemOperations.cs:line 684
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-25T22:32:43Z"/><EventRecordID>388172484</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Category: Program
EventId: 0
SpanId: ad554829c6ca540f
TraceId: e6fba2ce580cb8619d7c5ec050537c27
ParentId: 0000000000000000
RequestId: 40001775-0000-f900-b63f-84710c7967bb
RequestPath: /api/documents/ab1b0c34-52a5-f011-bbd3-7c1e5215b8b5/preview-url

[947113c6-c645-4d32-aa81-8afcb1ae056d] Error getting preview URL for document ab1b0c34-52a5-f011-bbd3-7c1e5215b8b5

Exception: 
Microsoft.Graph.Models.ODataErrors.ODataError: Access denied
   at Microsoft.Kiota.Http.HttpClientLibrary.HttpClientRequestAdapter.ThrowIfFailedResponse(HttpResponseMessage response, Dictionary`2 errorMapping, Activity activityForAttributes, CancellationToken cancellationToken)
   at Microsoft.Kiota.Http.HttpClientLibrary.HttpClientRequestAdapter.SendAsync[ModelType](RequestInformation requestInfo, ParsableFactory`1 factory, Dictionary`2 errorMapping, CancellationToken cancellationToken)
   at Microsoft.Kiota.Http.HttpClientLibrary.HttpClientRequestAdapter.SendAsync[ModelType](RequestInformation requestInfo, ParsableFactory`1 factory, Dictionary`2 errorMapping, CancellationToken cancellationToken)
   at Microsoft.Graph.Drives.Item.Items.Item.Preview.PreviewRequestBuilder.PostAsync(PreviewPostRequestBody body, Action`1 requestConfiguration, CancellationToken cancellationToken)
   at Spe.Bff.Api.Infrastructure.Graph.DriveItemOperations.GetPreviewUrlAsync(String driveId, String itemId, String correlationId, CancellationToken ct) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Infrastructure\Graph\DriveItemOperations.cs:line 684
   at Spe.Bff.Api.Api.FileAccessEndpoints.&lt;MapFileAccessEndpoints&gt;g__GetPreviewUrl|0_0(String documentId, IDocumentStorageResolver documentStorageResolver, SpeFileStore speFileStore, ILogger`1 logger, HttpContext context, CancellationToken ct) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Api\FileAccessEndpoints.cs:line 117
</Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1012</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-26T03:54:57Z"/><EventRecordID>407506968</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Application 'C:\home\site\wwwroot\' was recycled after detecting app_offline.htm.</Data><Data>Process Id: 8128.</Data><Data>File Version: 18.0.25301.22. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-26T03:55:01Z"/><EventRecordID>407510312</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 9

BackgroundService failed

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\ServiceBusJobProcessor.cs:line 72
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-26T03:55:01Z"/><EventRecordID>407510421</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 10

The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\ServiceBusJobProcessor.cs:line 72
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-26T03:55:04Z"/><EventRecordID>407513125</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 9

BackgroundService failed

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.DocumentEventProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\DocumentEventProcessor.cs:line 68
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-26T03:55:04Z"/><EventRecordID>407513234</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 10

The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.DocumentEventProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\DocumentEventProcessor.cs:line 68
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1005</EventID><Level>2</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-26T03:55:08Z"/><EventRecordID>407517781</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Failed to gracefully shutdown application 'MACHINE/WEBROOT/APPHOST/SPE-API-DEV-67E2XZ'.</Data><Data>Process Id: 8128.</Data><Data>File Version: 18.0.25301.22. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1032</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-26T03:56:12Z"/><EventRecordID>407581421</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Application 'C:\home\site\wwwroot\' started successfully.</Data><Data>Process Id: 7392.</Data><Data>File Version: 18.0.25301.22. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1012</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-26T04:00:04Z"/><EventRecordID>407813906</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Application 'C:\home\site\wwwroot\' was recycled after detecting app_offline.htm.</Data><Data>Process Id: 7392.</Data><Data>File Version: 18.0.25301.22. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-26T04:00:07Z"/><EventRecordID>407816953</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 9

BackgroundService failed

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\ServiceBusJobProcessor.cs:line 72
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-26T04:00:08Z"/><EventRecordID>407817296</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 10

The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\ServiceBusJobProcessor.cs:line 72
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-26T04:00:10Z"/><EventRecordID>407819078</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 9

BackgroundService failed

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.DocumentEventProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\DocumentEventProcessor.cs:line 68
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-26T04:00:10Z"/><EventRecordID>407819125</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 10

The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.DocumentEventProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\DocumentEventProcessor.cs:line 68
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1033</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-26T04:00:11Z"/><EventRecordID>407820843</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Application 'MACHINE/WEBROOT/APPHOST/SPE-API-DEV-67E2XZ' has shutdown.</Data><Data>Process Id: 7392.</Data><Data>File Version: 18.0.25301.22. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1032</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-26T04:01:29Z"/><EventRecordID>407898625</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Application 'C:\home\site\wwwroot\' started successfully.</Data><Data>Process Id: 7904.</Data><Data>File Version: 18.0.25301.22. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1012</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-26T13:44:03Z"/><EventRecordID>442852843</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Application 'C:\home\site\wwwroot\' was recycled after detecting app_offline.htm.</Data><Data>Process Id: 7904.</Data><Data>File Version: 18.0.25301.22. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-26T13:44:07Z"/><EventRecordID>442856562</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 9

BackgroundService failed

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor.ExecuteAsync(CancellationToken stoppingToken)
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-26T13:44:08Z"/><EventRecordID>442857625</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 10

The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor.ExecuteAsync(CancellationToken stoppingToken)
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-26T13:44:12Z"/><EventRecordID>442861562</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 9

BackgroundService failed

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.DocumentEventProcessor.ExecuteAsync(CancellationToken stoppingToken)
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-26T13:44:12Z"/><EventRecordID>442861937</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 10

The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.DocumentEventProcessor.ExecuteAsync(CancellationToken stoppingToken)
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1005</EventID><Level>2</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-26T13:44:14Z"/><EventRecordID>442863390</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Failed to gracefully shutdown application 'MACHINE/WEBROOT/APPHOST/SPE-API-DEV-67E2XZ'.</Data><Data>Process Id: 7904.</Data><Data>File Version: 18.0.25301.22. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1032</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-26T13:45:08Z"/><EventRecordID>442917234</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Application 'C:\home\site\wwwroot\' started successfully.</Data><Data>Process Id: 3768.</Data><Data>File Version: 18.0.25301.22. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-26T13:46:54Z"/><EventRecordID>443023500</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 9

BackgroundService failed

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\ServiceBusJobProcessor.cs:line 72
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-26T13:46:54Z"/><EventRecordID>443023562</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 10

The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.ServiceBusJobProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\ServiceBusJobProcessor.cs:line 72
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-26T13:46:56Z"/><EventRecordID>443025125</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 9

BackgroundService failed

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.DocumentEventProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\DocumentEventProcessor.cs:line 68
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name=".NET Runtime"/><EventID>1000</EventID><Level>1</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-26T13:46:56Z"/><EventRecordID>443025296</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Category: Microsoft.Extensions.Hosting.Internal.Host
EventId: 10

The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.

Exception: 
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Threading.SemaphoreSlim'.
   at System.Threading.SemaphoreSlim.WaitAsync(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at Azure.Messaging.ServiceBus.ServiceBusProcessor.StopProcessingAsync(CancellationToken cancellationToken)
   at Spe.Bff.Api.Services.Jobs.DocumentEventProcessor.ExecuteAsync(CancellationToken stoppingToken) in C:\code_files\spaarke\src\api\Spe.Bff.Api\Services\Jobs\DocumentEventProcessor.cs:line 68
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
</Data></EventData></Event><Event><System><Provider Name="IIS AspNetCore Module V2"/><EventID>1033</EventID><Level>4</Level><Task>0</Task><Keywords>Keywords</Keywords><TimeCreated SystemTime="2025-11-26T13:46:56Z"/><EventRecordID>443025890</EventRecordID><Channel>Application</Channel><Computer>DW1SDWK0008M8</Computer><Security/></System><EventData><Data>Application 'MACHINE/WEBROOT/APPHOST/SPE-API-DEV-67E2XZ' has shutdown.</Data><Data>Process Id: 3768.</Data><Data>File Version: 18.0.25301.22. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: </Data></EventData></Event></Events>