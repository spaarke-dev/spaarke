{
  "permissions": {
    "allow": [
      "Bash(git commit -m \"$(cat <<''EOF''\nrefactor(dataverse): change ServiceClient lifetime from Scoped to Singleton\n\n- Change IDataverseService registration from AddScoped to AddSingleton\n- Use factory pattern for explicit service resolution\n- Add comment explaining performance benefit (eliminates 500ms overhead)\n\nServiceClient is thread-safe and expensive to initialize (~500ms).\nCreating per-request instances defeats internal connection pooling.\nSingleton lifetime reduces health check from 500ms to <50ms.\n\nNo captive dependencies: only IConfiguration and ILogger (both Singleton).\n\nPerformance Impact:\n- Health check: 500ms â†’ <100ms\n- Dataverse queries: 650ms â†’ <100ms (85% improvement)\n- Eliminates per-request connection overhead\n\nADR: ADR-010 (Singleton for expensive resources)\nTask: Phase 1, Task 3 (Fix ServiceClient Lifetime)\n\nðŸ¤– Generated with [Claude Code](https://claude.com/claude-code)\n\nCo-Authored-By: Claude <noreply@anthropic.com>\nEOF\n)\")",
      "Bash(for:*)",
      "Bash(head:*)",
      "Bash(done)",
      "Bash(dotnet test:*)",
      "Bash(git commit:*)",
      "Bash(pac entity list:*)",
      "Bash(pac help:*)",
      "Bash(pac power-fx help:*)",
      "Bash(pac entity help:*)",
      "Bash(pac power-fx run:*)",
      "Bash(az account get-access-token:*)",
      "Bash(echo:*)",
      "Bash(az login:*)",
      "Bash(else echo \"âš  Already enabled\")",
      "Bash(pac entity create:*)",
      "Bash(pac pcf list:*)",
      "Bash(pac admin list-publishers:*)",
      "Bash(msbuild:*)",
      "Bash(\"/c/Program Files/Microsoft Visual Studio/2022/Professional/MSBuild/Current/Bin/MSBuild.exe\" /t:Rebuild /p:Configuration=Release)",
      "Bash(exit 0)",
      "Bash(\"/c/Program Files/Microsoft Visual Studio/2022/Professional/MSBuild/Current/Bin/MSBuild.exe\" c:code_filesspaarkesrccontrolsUniversalQuickCreateUniversalQuickCreateSolutionUniversalQuickCreateSolution.cdsproj /t:Rebuild /p:Configuration=Release)",
      "Bash(dotnet msbuild:*)",
      "Bash(az account show:*)",
      "Read(//c/code_files/**)",
      "Bash(az webapp log config:*)",
      "Bash(az servicebus namespace show:*)",
      "Bash(az servicebus namespace list:*)",
      "Bash(git log:*)",
      "Bash(az servicebus namespace authorization-rule keys list:*)",
      "Bash(az servicebus queue list:*)",
      "Bash(az servicebus queue create:*)",
      "Bash(do echo \"Attempt $i:\")",
      "Bash(az servicebus queue show:*)",
      "Bash(do echo \"Test $i:\")",
      "Bash(az webapp config set:*)",
      "Bash(awk:*)",
      "Bash(az monitor app-insights query:*)",
      "Bash(git checkout:*)",
      "Bash(az webapp stop:*)",
      "Bash(az webapp start:*)",
      "Bash(az webapp deployment:*)",
      "Bash(\"/c/Program Files/Microsoft Visual Studio/2022/Professional/MSBuild/Current/Bin/MSBuild.exe\" /c/code_files/spaarke/src/controls/UniversalQuickCreate/UniversalQuickCreateSolution/UniversalQuickCreateSolution.cdsproj /t:Rebuild /p:Configuration=Release)",
      "Bash(else echo \"Already enabled\")",
      "Bash(az webapp log tail:*)",
      "Bash(curl:*)",
      "Bash(npm run build:*)",
      "Bash(\"/c/Program Files/Microsoft Visual Studio/2022/Professional/MSBuild/Current/Bin/MSBuild.exe\" \"c:/code_files/spaarke/src/controls/UniversalDatasetGrid/UniversalDatasetGridSolution/UniversalDatasetGridSolution.cdsproj\" /t:Rebuild /p:Configuration=Release)",
      "Bash(pac solution pack:*)",
      "Bash(pac solution import:*)",
      "Bash(pac solution list:*)",
      "Bash(pac solution add-reference:*)",
      "Bash(if [ -f \"/c/code_files/spaarke/Directory.Packages.props\" ])",
      "Bash(then mv \"/c/code_files/spaarke/Directory.Packages.props\" \"/c/code_files/spaarke/Directory.Packages.props.disabled\")",
      "Bash(fi)",
      "Bash(dotnet build:*)",
      "Bash(if [ -f \"/c/code_files/spaarke/Directory.Packages.props.disabled\" ])",
      "Bash(then mv \"/c/code_files/spaarke/Directory.Packages.props.disabled\" \"/c/code_files/spaarke/Directory.Packages.props\")",
      "Bash(pac solution publish:*)",
      "Bash(npm run clean:*)",
      "Bash(if [ -f \"../../Directory.Packages.props\" ])",
      "Bash(then mv \"../../Directory.Packages.props\" \"../../Directory.Packages.props.disabled\")",
      "Bash(if [ -f \"../../Directory.Build.props\" ])",
      "Bash(then mv \"../../Directory.Build.props\" \"../../Directory.Build.props.disabled\")",
      "Bash(if [ -f \"UniversalDatasetGrid/Directory.Build.props\" ])",
      "Bash(then mv \"UniversalDatasetGrid/Directory.Build.props\" \"UniversalDatasetGrid/Directory.Build.props.disabled\")",
      "Bash(if [ -f \"Directory.Build.props\" ])",
      "Bash(then mv \"Directory.Build.props\" \"Directory.Build.props.disabled\")",
      "Bash(pac webresource list:*)",
      "Bash(pac pcf push:*)",
      "Bash(az webapp log:*)",
      "Bash(unzip:*)",
      "Bash(dotnet publish:*)",
      "Bash(powershell:*)",
      "Bash(az webapp deploy:*)",
      "Bash(az webapp restart:*)",
      "Bash(tar:*)",
      "Bash(zip:*)",
      "Bash(az webapp config appsettings list:*)",
      "Bash(dotnet clean:*)",
      "Bash(az ad app permission list:*)",
      "Bash(az ad sp show:*)",
      "Bash(az webapp show:*)",
      "Bash(az webapp list:*)",
      "Bash(if [ -f \"Directory.Packages.props\" ])",
      "Bash(then mv \"Directory.Packages.props\" \"Directory.Packages.props.disabled\")",
      "Bash(if [ -f \"Directory.Packages.props.disabled\" ])",
      "Bash(then mv \"Directory.Packages.props.disabled\" \"Directory.Packages.props\")",
      "Bash(if [ -f \"Directory.Build.props.disabled\" ])",
      "Bash(then mv \"Directory.Build.props.disabled\" \"Directory.Build.props\")",
      "Bash(\"/c/Program Files/Microsoft Visual Studio/2022/Professional/MSBuild/Current/Bin/MSBuild.exe\" /c/code_files/spaarke/src/controls/UniversalDatasetGrid/UniversalDatasetGridSolution/UniversalDatasetGridSolution.cdsproj /t:Rebuild /p:Configuration=Release)",
      "Bash(pac solution export:*)",
      "Bash(timeout 30 pac webresource:*)",
      "Bash(pac solution delete:*)",
      "Bash(tree:*)",
      "Bash(while read f)",
      "Bash(do echo \"=== $f ===\")",
      "Bash(ls:*)",
      "Bash(cat:*)",
      "Bash(else echo \"Directory.Packages.props already disabled or doesn''t exist\")",
      "Bash(else echo \"Directory.Packages.props already restored\")",
      "Bash(pac auth list:*)",
      "Bash(pac entity show:*)",
      "Bash(find:*)",
      "Bash(if [ -f \"c:/code_files/spaarke/src/controls/UniversalQuickCreate/Directory.Packages.props.disabled\" ])",
      "Bash(then mv \"c:/code_files/spaarke/src/controls/UniversalQuickCreate/Directory.Packages.props.disabled\" \"c:/code_files/spaarke/src/controls/UniversalQuickCreate/Directory.Packages.props\")",
      "Bash(else echo \"Directory.Packages.props already exists or wasn''t disabled\")",
      "Read(//c/**)",
      "Bash(pac data query:*)",
      "Bash(pac auth:*)",
      "Bash(git add:*)",
      "Bash(\"/c/Program Files/Microsoft Visual Studio/2022/Professional/MSBuild/Current/Bin/MSBuild.exe\" /t:Rebuild /p:Configuration=Release UniversalQuickCreateSolution/UniversalQuickCreateSolution.cdsproj)",
      "Bash(\"C:/Program Files/Microsoft Visual Studio/2022/Professional/MSBuild/Current/Bin/MSBuild.exe\" /t:Rebuild /p:Configuration=Release UniversalQuickCreateSolution/UniversalQuickCreateSolution.cdsproj)",
      "Bash(git push:*)",
      "Bash(dotnet list:*)",
      "Bash(dotnet restore:*)",
      "Bash(dotnet run:*)",
      "Bash(git restore:*)",
      "Bash(dotnet --list-runtimes:*)",
      "Bash(jobs:*)",
      "Bash(dotnet nuget:*)",
      "Bash(\"/c/Program Files/Microsoft Visual Studio/2022/Professional/MSBuild/Current/Bin/MSBuild.exe\" UniversalQuickCreateSolution/UniversalQuickCreateSolution.cdsproj /t:Rebuild /p:Configuration=Release)",
      "Bash(az webapp identity show:*)",
      "Bash(az keyvault secret show:*)",
      "Bash(az ad sp list:*)",
      "Bash(az ad app permission:*)",
      "Bash(az keyvault secret set:*)",
      "Bash(pkill -f \"az webapp log tail\")",
      "Bash(pkill:*)",
      "Bash(xargs:*)",
      "Bash(git reset:*)",
      "Bash(node -c:*)",
      "Bash(pac solution online-version:*)",
      "Bash(pac webresource push:*)",
      "Bash(tee:*)",
      "Bash(pac solution sync:*)",
      "Bash(start https://make.powerapps.com)",
      "Bash(sort:*)",
      "Bash(pac canvas pack:*)",
      "Bash(if [ -f \"c:/code_files/spaarke/src/controls/UniversalQuickCreate/Directory.Packages.props\" ])",
      "Bash(then mv \"c:/code_files/spaarke/src/controls/UniversalQuickCreate/Directory.Packages.props\" \"c:/code_files/spaarke/src/controls/UniversalQuickCreate/Directory.Packages.props.disabled\")",
      "Bash(else echo \"Directory.Packages.props not found in UniversalQuickCreate folder\")",
      "Bash(if [ -f \"c:/code_files/spaarke/Directory.Packages.props\" ])",
      "Bash(then mv \"c:/code_files/spaarke/Directory.Packages.props\" \"c:/code_files/spaarke/Directory.Packages.props.disabled\")",
      "Bash(else echo \"Root Directory.Packages.props not found\")",
      "Bash(if [ -f \"c:/code_files/spaarke/Directory.Packages.props.disabled\" ])",
      "Bash(then mv \"c:/code_files/spaarke/Directory.Packages.props.disabled\" \"c:/code_files/spaarke/Directory.Packages.props\")",
      "Bash(else echo \"Already disabled\")",
      "Bash(else echo \"Already restored\")",
      "Bash(else echo \"âœ“ Directory.Packages.props already enabled\")",
      "Bash(pac data create:*)",
      "Bash(pac --version:*)",
      "Bash(\"C:\\Program Files (x86)\\Microsoft SDKs\\Windows\\v10.0A\\bin\\NETFX 4.8 Tools\\sn.exe\" -k SpaarkePlugin.snk)",
      "Bash(sn -k:*)",
      "Bash(pac pcf init:*)",
      "Bash(npm install:*)",
      "Bash(pac solution init:*)",
      "Bash(\"/c/Program Files/Microsoft Visual Studio/2022/Professional/MSBuild/Current/Bin/MSBuild.exe\" SpeFileViewerSolution.cdsproj /t:Rebuild /p:Configuration=Release)",
      "Bash(dotnet --version:*)",
      "Bash(\"/c/Program Files (x86)/Microsoft Visual Studio/2019/BuildTools/MSBuild/Current/Bin/amd64/MSBuild.exe\" SpeFileViewerSolution.cdsproj /t:Rebuild /p:Configuration=Release)",
      "Bash(\"/c/Program Files (x86)/Microsoft Visual Studio/2019/BuildTools/MSBuild/Current/Bin/amd64/MSBuild.exe\" SpeFileViewerSolution.cdsproj //t:Rebuild //p:Configuration=Release)",
      "Bash(\"/c/Program Files (x86)/Microsoft Visual Studio/2019/BuildTools/MSBuild/Current/Bin/amd64/MSBuild.exe\" SpeFileViewerSolution.cdsproj //t:Build //p:Configuration=Release)",
      "Bash(else echo \"Not found\")",
      "Bash(\"/c/Program Files (x86)/Microsoft Visual Studio/2019/BuildTools/MSBuild/Current/Bin/amd64/MSBuild.exe\" UniversalQuickCreateSolution.cdsproj //t:Build //p:Configuration=Release)",
      "Bash(else echo \"âœ“ Already disabled\")",
      "Bash(else echo \"âœ“ Already enabled\")",
      "Bash(pac solution list-components:*)",
      "Bash(else echo \"âœ“ Already disabled or doesn''t exist\")",
      "Bash(if [ -f \"c:/code_files/spaarke/src/controls/SpeFileViewer/Directory.Packages.props\" ])",
      "Bash(then mv \"c:/code_files/spaarke/src/controls/SpeFileViewer/Directory.Packages.props\" \"c:/code_files/spaarke/src/controls/SpeFileViewer/Directory.Packages.props.disabled\")",
      "Bash(else echo \"âœ“ No Directory.Packages.props to disable\")",
      "Bash(\"/c/Program Files/Microsoft Visual Studio/2022/Professional/MSBuild/Current/Bin/MSBuild.exe\" c:/code_files/spaarke/src/controls/SpeFileViewer/SpeFileViewerSolution/SpeFileViewerSolution.cdsproj /t:Rebuild /p:Configuration=Release)",
      "Bash(else echo \"âœ“ No root Directory.Packages.props\")",
      "Bash(else echo \"âœ“ Directory.Packages.props already disabled\")",
      "Bash(else echo \"âœ“ Directory.Packages.props already restored\")",
      "Bash(if [ -f \"../../Directory.Packages.props.disabled\" ])",
      "Bash(then mv \"../../Directory.Packages.props.disabled\" \"../../Directory.Packages.props\")",
      "Bash(\"/c/Program Files/Microsoft Visual Studio/2022/Professional/MSBuild/Current/Bin/MSBuild.exe\" C:/code_files/spaarke/src/controls/SpeFileViewer/SpeFileViewerSolution/SpeFileViewerSolution.cdsproj /t:Rebuild /p:Configuration=Release)",
      "Bash(git rm:*)",
      "Bash(test -d \"C:\\code_files\\spaarke\\src\\client\\pcf\\UniversalDatasetGrid\")",
      "Bash(git mv:*)",
      "Bash(mkdir:*)",
      "Bash(\"/c/Program Files/Microsoft Visual Studio/2022/Professional/MSBuild/Current/Bin/MSBuild.exe\" \"/c/code_files/spaarke/src/client/pcf/SpeFileViewer/SpeFileViewerSolution/SpeFileViewerSolution.cdsproj\" /t:Rebuild /p:Configuration=Release)",
      "Bash(\"/c/Program Files/Microsoft Visual Studio/2022/Professional/MSBuild/Current/Bin/MSBuild.exe\" SpeFileViewerSolution/SpeFileViewerSolution.cdsproj /t:Rebuild /p:Configuration=Release)",
      "Bash(pac solution help:*)",
      "Bash(pac solution unpack:*)",
      "Bash(npm test:*)",
      "Skill(push-to-github)",
      "Bash(gh auth status:*)",
      "Bash(az resource list:*)",
      "Bash(az webapp config show:*)",
      "Bash(az webapp config appsettings set:*)",
      "Bash(az cognitiveservices account list:*)",
      "Bash(az cognitiveservices account create:*)",
      "Bash(az cognitiveservices account deployment create:*)",
      "Bash(az cognitiveservices account keys list:*)",
      "Bash(az keyvault list:*)",
      "Bash(az keyvault set-policy:*)",
      "Bash(az keyvault show:*)",
      "Bash(az role assignment create:*)",
      "Bash(git check-ignore:*)",
      "Bash(python3:*)",
      "Bash(else echo \"Already disabled or doesn''t exist\")",
      "Bash(\"/c/Program Files/Microsoft Visual Studio/2022/Professional/MSBuild/Current/Bin/MSBuild.exe\" /c/code_files/spaarke/src/client/pcf/UniversalQuickCreate/UniversalQuickCreateSolution/UniversalQuickCreateSolution.cdsproj /t:Rebuild /p:Configuration=Release)",
      "Bash(\"/c/Program Files/Microsoft Visual Studio/2022/Professional/MSBuild/Current/Bin/MSBuild.exe\" UniversalQuickCreateSolution.cdsproj /t:Rebuild /p:Configuration=Release)",
      "Bash(az cognitiveservices account deployment list:*)",
      "Bash(az cognitiveservices account show:*)",
      "Bash(timeout 15 az webapp log tail:*)",
      "Bash(cmd.exe:*)",
      "Skill(dataverse-deploy)",
      "Bash(gh pr create --title \"feat(ai): AI Document Summary with Streaming SSE (v3.2.4)\" --body \"$(cat <<''EOF''\n## Summary\nComplete implementation of AI-powered document summarization feature with streaming Server-Sent Events (SSE) for real-time display in the UniversalQuickCreate PCF control.\n\n## Changes\n\n### BFF API\n- **SummarizeService**: Azure OpenAI integration with gpt-4o-mini model\n- **Streaming SSE endpoint**: `/api/ai/summarize/stream` for real-time summary display\n- **TextExtractorService**: PDF/DOCX extraction via Azure Document Intelligence, native text for txt/md/json\n- **AiOptions**: Configurable file types, prompts, token limits\n- **AiOptionsValidator**: Startup validation for AI configuration\n\n### PCF Control (UniversalQuickCreate v3.2.4)\n- AI Summary panel with streaming text display\n- Carousel for multi-file summary navigation  \n- `useAiSummary` hook for SSE consumption\n- Version footer: `v3.2.4 â€¢ Built 2025-12-09`\n\n### Documentation\n- PCF deployment workflow guide (Part B in PCF-V9-PACKAGING.md)\n- `pac pcf push` vs solution import comparison\n- Version footer requirement in PCF standards\n- Production release checklist\n\n### New Project Spec\n- `ai-file-entity-metadata-extraction` project specification\n- Phase 1a: Structured AI output (TL;DR, keywords, entities)\n- Phase 1b: Dataverse storage + PCF UI\n- Phase 2: Azure AI Search record matching\n\n## Testing\n- [x] AI summary streams correctly for PDF files\n- [x] AI summary works for DOCX files\n- [x] Native text files (txt, md, json) work\n- [x] PCF displays streaming text in real-time\n- [x] Version footer displays correctly\n\n## Deployment\nPCF deployed to Dataverse via solution import workflow:\n- Solution version: 3.2.4\n- Verified via `pac solution list`\n\nðŸ¤– Generated with [Claude Code](https://claude.com/claude-code)\nEOF\n)\")",
      "Bash(npm run build:prod:*)",
      "Bash(timeout 30 az webapp log tail:*)",
      "Bash(\"DocumentIntelligence__Enabled=true\" )",
      "Bash(\"DocumentIntelligence__OpenAiEndpoint=https://spaarke-openai-dev.openai.azure.com/\" )",
      "Bash(\"DocumentIntelligence__OpenAiKey=5ac9b4ba7d524d8d86462e3bbff4a8a4\" )",
      "Bash(\"DocumentIntelligence__SummarizeModel=gpt-4o-mini\" )",
      "Bash(\"DocumentIntelligence__DocIntelEndpoint=https://westus2.api.cognitive.microsoft.com/\" )",
      "Bash(\"DocumentIntelligence__DocIntelKey=1e1fd08f527340d1a52ec10b7f61b7e0\" )",
      "Bash(\"/c/Program Files (x86)/Microsoft Visual Studio/2019/BuildTools/MSBuild/Current/Bin/amd64/MSBuild.exe\" /c/code_files/spaarke/src/client/pcf/UniversalQuickCreate/solution/UniversalQuickCreateSolution.cdsproj /t:Rebuild /p:Configuration=Release)",
      "Bash(\"/c/Program Files (x86)/Microsoft Visual Studio/2019/BuildTools/MSBuild/Current/Bin/amd64/MSBuild.exe\" \"/c/code_files/spaarke/src/client/pcf/UniversalQuickCreate/solution/UniversalQuickCreateSolution.cdsproj\" //t:Rebuild //p:Configuration=Release)",
      "Bash(dotnet add:*)"
    ],
    "deny": [],
    "ask": []
  }
}
