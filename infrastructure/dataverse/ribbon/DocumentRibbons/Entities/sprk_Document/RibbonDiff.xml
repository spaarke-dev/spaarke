<?xml version="1.0" encoding="utf-8"?>
<RibbonDiffXml xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <CustomActions>
    <!-- ========================================== -->
    <!-- SUBGRID BUTTONS                           -->
    <!-- ========================================== -->
    <!-- Subgrid: Add Multiple Documents -->
    <CustomAction Id="sprk.Spaarke.Document.AddMultiple.Button.CustomAction" Location="Mscrm.SubGrid.sprk_document.MainTab.Management.Controls._children" Sequence="5">
      <CommandUIDefinition>
        <Button Alt="$LocLabels:Spaarke.Document.AddMultiple.Button.Alt" Command="Spaarke.Document.AddMultiple.Command" Id="Spaarke.Document.AddMultiple.Button" Image32by32="/_imgs/ribbon/DocumentAdd_32.png" Image16by16="/_imgs/ribbon/DocumentAdd_16.png" LabelText="$LocLabels:Spaarke.Document.AddMultiple.Button.LabelText" Sequence="5" TemplateAlias="o1" ToolTipTitle="$LocLabels:Spaarke.Document.AddMultiple.Button.ToolTipTitle" ToolTipDescription="$LocLabels:Spaarke.Document.AddMultiple.Button.ToolTipDescription" />
      </CommandUIDefinition>
    </CustomAction>
    <!-- Subgrid: Send to Index (Semantic Search) -->
    <CustomAction Id="sprk.Document.SendToIndex.Subgrid.CustomAction" Location="Mscrm.SubGrid.sprk_document.MainTab.Management.Controls._children" Sequence="6">
      <CommandUIDefinition>
        <Button Id="sprk.Document.SendToIndex.Subgrid.Button" Command="sprk.Document.SendToIndex.Subgrid.Command" Alt="$LocLabels:sprk.Document.SendToIndex.LabelText" LabelText="$LocLabels:sprk.Document.SendToIndex.LabelText" ToolTipTitle="$LocLabels:sprk.Document.SendToIndex.ToolTipTitle" ToolTipDescription="$LocLabels:sprk.Document.SendToIndex.ToolTipDescription" Image16by16="/_imgs/ribbon/Search_16.png" Image32by32="/_imgs/ribbon/Search_32.png" TemplateAlias="o1" Sequence="6" />
      </CommandUIDefinition>
    </CustomAction>

    <!-- ========================================== -->
    <!-- GRID BUTTONS                              -->
    <!-- ========================================== -->
    <!-- Grid: Send to Index (Semantic Search) -->
    <CustomAction Id="sprk.Document.SendToIndex.Grid.CustomAction" Location="Mscrm.HomepageGrid.sprk_document.MainTab.Actions.Controls._children" Sequence="100">
      <CommandUIDefinition>
        <Button Id="sprk.Document.SendToIndex.Grid.Button" Command="sprk.Document.SendToIndex.Grid.Command" Alt="$LocLabels:sprk.Document.SendToIndex.LabelText" LabelText="$LocLabels:sprk.Document.SendToIndex.LabelText" ToolTipTitle="$LocLabels:sprk.Document.SendToIndex.ToolTipTitle" ToolTipDescription="$LocLabels:sprk.Document.SendToIndex.ToolTipDescription" Image16by16="/_imgs/ribbon/Search_16.png" Image32by32="/_imgs/ribbon/Search_32.png" TemplateAlias="o1" Sequence="100" />
      </CommandUIDefinition>
    </CustomAction>
    <!-- Grid: Theme Menu -->
    <CustomAction Id="sprk.ThemeMenu.FlyoutAnchor.CustomAction" Location="Mscrm.HomepageGrid.sprk_document.MainTab.Actions.Controls._children" Sequence="900">
      <CommandUIDefinition>
        <FlyoutAnchor Id="sprk.ThemeMenu.FlyoutAnchor" Command="sprk.ThemeMenu.FlyoutCommand" LabelText="Dark Mode" ToolTipTitle="Dark Mode" ToolTipDescription="Choose your preferred color theme" Image16by16="$webresource:sprk_ThemeMenu16.svg" Image32by32="$webresource:sprk_ThemeMenu32.svg" PopulateDynamically="false" TemplateAlias="o1">
          <Menu Id="sprk.ThemeMenu.Menu">
            <MenuSection Id="sprk.ThemeMenu.MenuSection" Title="Color Theme" Sequence="10">
              <Controls Id="sprk.ThemeMenu.Controls">
                <Button Id="sprk.ThemeMenu.Auto" Command="sprk.ThemeMenu.SetAuto" LabelText="Auto (follows system)" Image16by16="$webresource:sprk_ThemeAuto16.svg" ToolTipTitle="Auto" ToolTipDescription="Uses your operating system's theme preference" Sequence="10" />
                <Button Id="sprk.ThemeMenu.Light" Command="sprk.ThemeMenu.SetLight" LabelText="Light" Image16by16="$webresource:sprk_ThemeLight16.svg" ToolTipTitle="Light" ToolTipDescription="Light background with dark text" Sequence="20" />
                <Button Id="sprk.ThemeMenu.Dark" Command="sprk.ThemeMenu.SetDark" LabelText="Dark" Image16by16="$webresource:sprk_ThemeDark16.svg" ToolTipTitle="Dark" ToolTipDescription="Dark background with light text" Sequence="30" />
              </Controls>
            </MenuSection>
          </Menu>
        </FlyoutAnchor>
      </CommandUIDefinition>
    </CustomAction>

    <!-- ========================================== -->
    <!-- FORM BUTTONS - Document Operations        -->
    <!-- Order: New(OOTB), Check In, Check Out,    -->
    <!--        Discard, Save(OOTB), Save&Close,   -->
    <!--        Deactivate, Delete, Refresh...     -->
    <!-- ========================================== -->
    <!-- Form: Check In Button (Sequence 15 - after New) -->
    <CustomAction Id="sprk.Document.Checkin.Button.CustomAction" Location="Mscrm.Form.sprk_document.MainTab.Save.Controls._children" Sequence="15">
      <CommandUIDefinition>
        <Button Id="sprk.Document.Checkin.Button" Command="sprk.Document.Checkin.Command" Alt="$LocLabels:sprk.Document.Checkin.LabelText" LabelText="$LocLabels:sprk.Document.Checkin.LabelText" ToolTipTitle="$LocLabels:sprk.Document.Checkin.ToolTipTitle" ToolTipDescription="$LocLabels:sprk.Document.Checkin.ToolTipDescription" Image16by16="/_imgs/ribbon/DocumentApproval_16.png" Image32by32="/_imgs/ribbon/DocumentApproval_32.png" TemplateAlias="o1" Sequence="15" />
      </CommandUIDefinition>
    </CustomAction>
    <!-- Form: Check Out Button (Sequence 16) -->
    <CustomAction Id="sprk.Document.Checkout.Button.CustomAction" Location="Mscrm.Form.sprk_document.MainTab.Save.Controls._children" Sequence="16">
      <CommandUIDefinition>
        <Button Id="sprk.Document.Checkout.Button" Command="sprk.Document.Checkout.Command" Alt="$LocLabels:sprk.Document.Checkout.LabelText" LabelText="$LocLabels:sprk.Document.Checkout.LabelText" ToolTipTitle="$LocLabels:sprk.Document.Checkout.ToolTipTitle" ToolTipDescription="$LocLabels:sprk.Document.Checkout.ToolTipDescription" Image16by16="/_imgs/ribbon/Lock_16.png" Image32by32="/_imgs/ribbon/Lock_32.png" TemplateAlias="o1" Sequence="16" />
      </CommandUIDefinition>
    </CustomAction>
    <!-- Form: Discard Checkout Button (Sequence 17) -->
    <CustomAction Id="sprk.Document.Discard.Button.CustomAction" Location="Mscrm.Form.sprk_document.MainTab.Save.Controls._children" Sequence="17">
      <CommandUIDefinition>
        <Button Id="sprk.Document.Discard.Button" Command="sprk.Document.Discard.Command" Alt="$LocLabels:sprk.Document.Discard.LabelText" LabelText="$LocLabels:sprk.Document.Discard.LabelText" ToolTipTitle="$LocLabels:sprk.Document.Discard.ToolTipTitle" ToolTipDescription="$LocLabels:sprk.Document.Discard.ToolTipDescription" Image16by16="/_imgs/ribbon/Cancel_16.png" Image32by32="/_imgs/ribbon/Cancel_32.png" TemplateAlias="o1" Sequence="17" />
      </CommandUIDefinition>
    </CustomAction>
    <!-- Form: Delete Document Button (Sequence 65 - after Deactivate) -->
    <CustomAction Id="sprk.Document.Delete.Button.CustomAction" Location="Mscrm.Form.sprk_document.MainTab.Save.Controls._children" Sequence="65">
      <CommandUIDefinition>
        <Button Id="sprk.Document.Delete.Button" Command="sprk.Document.Delete.Command" Alt="$LocLabels:sprk.Document.Delete.LabelText" LabelText="$LocLabels:sprk.Document.Delete.LabelText" ToolTipTitle="$LocLabels:sprk.Document.Delete.ToolTipTitle" ToolTipDescription="$LocLabels:sprk.Document.Delete.ToolTipDescription" Image16by16="/_imgs/ribbon/Delete_16.png" Image32by32="/_imgs/ribbon/Delete_32.png" TemplateAlias="o1" Sequence="65" />
      </CommandUIDefinition>
    </CustomAction>
    <!-- Form: Refresh Button (Sequence 70 - always visible) -->
    <CustomAction Id="sprk.Document.Refresh.Button.CustomAction" Location="Mscrm.Form.sprk_document.MainTab.Save.Controls._children" Sequence="70">
      <CommandUIDefinition>
        <Button Id="sprk.Document.Refresh.Button" Command="sprk.Document.Refresh.Command" Alt="$LocLabels:sprk.Document.Refresh.LabelText" LabelText="$LocLabels:sprk.Document.Refresh.LabelText" ToolTipTitle="$LocLabels:sprk.Document.Refresh.ToolTipTitle" ToolTipDescription="$LocLabels:sprk.Document.Refresh.ToolTipDescription" Image16by16="/_imgs/ribbon/Refresh_16.png" Image32by32="/_imgs/ribbon/Refresh_32.png" TemplateAlias="o1" Sequence="70" />
      </CommandUIDefinition>
    </CustomAction>
    <!-- Form: Open in Web Button (Sequence 71 - visible only for Office files) -->
    <CustomAction Id="sprk.Document.OpenInWeb.Button.CustomAction" Location="Mscrm.Form.sprk_document.MainTab.Save.Controls._children" Sequence="71">
      <CommandUIDefinition>
        <Button Id="sprk.Document.OpenInWeb.Button" Command="sprk.Document.OpenInWeb.Command" Alt="$LocLabels:sprk.Document.OpenInWeb.LabelText" LabelText="$LocLabels:sprk.Document.OpenInWeb.LabelText" ToolTipTitle="$LocLabels:sprk.Document.OpenInWeb.ToolTipTitle" ToolTipDescription="$LocLabels:sprk.Document.OpenInWeb.ToolTipDescription" Image16by16="/_imgs/ribbon/NewWindow_16.png" Image32by32="/_imgs/ribbon/NewWindow_32.png" TemplateAlias="o1" Sequence="71" />
      </CommandUIDefinition>
    </CustomAction>
    <!-- Form: Open in Desktop Button (Sequence 72 - visible only for Office files) -->
    <CustomAction Id="sprk.Document.OpenInDesktop.Button.CustomAction" Location="Mscrm.Form.sprk_document.MainTab.Save.Controls._children" Sequence="72">
      <CommandUIDefinition>
        <Button Id="sprk.Document.OpenInDesktop.Button" Command="sprk.Document.OpenInDesktop.Command" Alt="$LocLabels:sprk.Document.OpenInDesktop.LabelText" LabelText="$LocLabels:sprk.Document.OpenInDesktop.LabelText" ToolTipTitle="$LocLabels:sprk.Document.OpenInDesktop.ToolTipTitle" ToolTipDescription="$LocLabels:sprk.Document.OpenInDesktop.ToolTipDescription" Image16by16="/_imgs/ribbon/OpenInNewWindow_16.png" Image32by32="/_imgs/ribbon/OpenInNewWindow_32.png" TemplateAlias="o1" Sequence="72" />
      </CommandUIDefinition>
    </CustomAction>
    <!-- Form: Download Button (Sequence 73 - always visible) -->
    <CustomAction Id="sprk.Document.Download.Button.CustomAction" Location="Mscrm.Form.sprk_document.MainTab.Save.Controls._children" Sequence="73">
      <CommandUIDefinition>
        <Button Id="sprk.Document.Download.Button" Command="sprk.Document.Download.Command" Alt="$LocLabels:sprk.Document.Download.LabelText" LabelText="$LocLabels:sprk.Document.Download.LabelText" ToolTipTitle="$LocLabels:sprk.Document.Download.ToolTipTitle" ToolTipDescription="$LocLabels:sprk.Document.Download.ToolTipDescription" Image16by16="/_imgs/ribbon/Download_16.png" Image32by32="/_imgs/ribbon/Download_32.png" TemplateAlias="o1" Sequence="73" />
      </CommandUIDefinition>
    </CustomAction>
    <!-- Form: Send to Index Button (Sequence 74 - semantic search indexing) -->
    <CustomAction Id="sprk.Document.SendToIndex.Form.CustomAction" Location="Mscrm.Form.sprk_document.MainTab.Save.Controls._children" Sequence="74">
      <CommandUIDefinition>
        <Button Id="sprk.Document.SendToIndex.Form.Button" Command="sprk.Document.SendToIndex.Form.Command" Alt="$LocLabels:sprk.Document.SendToIndex.LabelText" LabelText="$LocLabels:sprk.Document.SendToIndex.LabelText" ToolTipTitle="$LocLabels:sprk.Document.SendToIndex.ToolTipTitle" ToolTipDescription="$LocLabels:sprk.Document.SendToIndex.ToolTipDescription" Image16by16="/_imgs/ribbon/Search_16.png" Image32by32="/_imgs/ribbon/Search_32.png" TemplateAlias="o1" Sequence="74" />
      </CommandUIDefinition>
    </CustomAction>
  </CustomActions>
  <Templates>
    <RibbonTemplates Id="Mscrm.Templates"></RibbonTemplates>
  </Templates>
  <CommandDefinitions>
    <CommandDefinition Id="Spaarke.Document.AddMultiple.Command">
      <EnableRules>
        <EnableRule Id="Spaarke.Document.AddMultiple.EnableRule" />
      </EnableRules>
      <DisplayRules />
      <Actions>
        <JavaScriptFunction FunctionName="Spaarke_AddMultipleDocuments" Library="$webresource:sprk_subgrid_commands">
          <CrmParameter Value="SelectedControl" />
        </JavaScriptFunction>
      </Actions>
    </CommandDefinition>
    <CommandDefinition Id="sprk.ThemeMenu.FlyoutCommand">
      <EnableRules>
        <EnableRule Id="sprk.ThemeMenu.EnableRule" />
      </EnableRules>
      <DisplayRules />
      <Actions />
    </CommandDefinition>
    <CommandDefinition Id="sprk.ThemeMenu.SetAuto">
      <EnableRules />
      <DisplayRules />
      <Actions>
        <JavaScriptFunction Library="$webresource:sprk_ThemeMenu.js" FunctionName="Spaarke.Theme.setTheme">
          <StringParameter Value="auto" />
        </JavaScriptFunction>
      </Actions>
    </CommandDefinition>
    <CommandDefinition Id="sprk.ThemeMenu.SetDark">
      <EnableRules />
      <DisplayRules />
      <Actions>
        <JavaScriptFunction Library="$webresource:sprk_ThemeMenu.js" FunctionName="Spaarke.Theme.setTheme">
          <StringParameter Value="dark" />
        </JavaScriptFunction>
      </Actions>
    </CommandDefinition>
    <CommandDefinition Id="sprk.ThemeMenu.SetLight">
      <EnableRules />
      <DisplayRules />
      <Actions>
        <JavaScriptFunction Library="$webresource:sprk_ThemeMenu.js" FunctionName="Spaarke.Theme.setTheme">
          <StringParameter Value="light" />
        </JavaScriptFunction>
      </Actions>
    </CommandDefinition>
    <!-- Document Checkout Command (enabled when NOT checked out) -->
    <CommandDefinition Id="sprk.Document.Checkout.Command">
      <EnableRules>
        <EnableRule Id="sprk.Document.Checkout.EnableRule" />
      </EnableRules>
      <DisplayRules>
        <DisplayRule Id="sprk.Document.Form.DisplayRule" />
      </DisplayRules>
      <Actions>
        <JavaScriptFunction Library="$webresource:sprk_DocumentOperations.js" FunctionName="Spaarke.Document.checkoutDocument">
          <CrmParameter Value="PrimaryControl" />
        </JavaScriptFunction>
      </Actions>
    </CommandDefinition>
    <!-- Document Checkin Command (enabled when checked out BY current user) -->
    <CommandDefinition Id="sprk.Document.Checkin.Command">
      <EnableRules>
        <EnableRule Id="sprk.Document.Checkin.EnableRule" />
      </EnableRules>
      <DisplayRules>
        <DisplayRule Id="sprk.Document.Form.DisplayRule" />
      </DisplayRules>
      <Actions>
        <JavaScriptFunction Library="$webresource:sprk_DocumentOperations.js" FunctionName="Spaarke.Document.checkinDocument">
          <CrmParameter Value="PrimaryControl" />
        </JavaScriptFunction>
      </Actions>
    </CommandDefinition>
    <!-- Document Discard Command (enabled when checked out BY current user) -->
    <CommandDefinition Id="sprk.Document.Discard.Command">
      <EnableRules>
        <EnableRule Id="sprk.Document.Discard.EnableRule" />
      </EnableRules>
      <DisplayRules>
        <DisplayRule Id="sprk.Document.Form.DisplayRule" />
      </DisplayRules>
      <Actions>
        <JavaScriptFunction Library="$webresource:sprk_DocumentOperations.js" FunctionName="Spaarke.Document.discardCheckout">
          <CrmParameter Value="PrimaryControl" />
        </JavaScriptFunction>
      </Actions>
    </CommandDefinition>
    <!-- Document Delete Command -->
    <CommandDefinition Id="sprk.Document.Delete.Command">
      <EnableRules>
        <EnableRule Id="sprk.Document.Delete.EnableRule" />
      </EnableRules>
      <DisplayRules>
        <DisplayRule Id="sprk.Document.Form.DisplayRule" />
      </DisplayRules>
      <Actions>
        <JavaScriptFunction Library="$webresource:sprk_DocumentOperations.js" FunctionName="Spaarke.Document.deleteDocument">
          <CrmParameter Value="PrimaryControl" />
        </JavaScriptFunction>
      </Actions>
    </CommandDefinition>
    <!-- Document Refresh Command (always enabled) -->
    <CommandDefinition Id="sprk.Document.Refresh.Command">
      <EnableRules>
        <EnableRule Id="sprk.Document.Refresh.EnableRule" />
      </EnableRules>
      <DisplayRules>
        <DisplayRule Id="sprk.Document.Form.DisplayRule" />
      </DisplayRules>
      <Actions>
        <JavaScriptFunction Library="$webresource:sprk_DocumentOperations.js" FunctionName="Spaarke.Document.refreshDocument">
          <CrmParameter Value="PrimaryControl" />
        </JavaScriptFunction>
      </Actions>
    </CommandDefinition>
    <!-- Document Open in Web Command (enabled for Office files only) -->
    <CommandDefinition Id="sprk.Document.OpenInWeb.Command">
      <EnableRules>
        <EnableRule Id="sprk.Document.OpenInWeb.EnableRule" />
      </EnableRules>
      <DisplayRules>
        <DisplayRule Id="sprk.Document.Form.DisplayRule" />
      </DisplayRules>
      <Actions>
        <JavaScriptFunction Library="$webresource:sprk_DocumentOperations.js" FunctionName="Spaarke.Document.openInWeb">
          <CrmParameter Value="PrimaryControl" />
        </JavaScriptFunction>
      </Actions>
    </CommandDefinition>
    <!-- Document Open in Desktop Command (enabled for Office files only) -->
    <CommandDefinition Id="sprk.Document.OpenInDesktop.Command">
      <EnableRules>
        <EnableRule Id="sprk.Document.OpenInDesktop.EnableRule" />
      </EnableRules>
      <DisplayRules>
        <DisplayRule Id="sprk.Document.Form.DisplayRule" />
      </DisplayRules>
      <Actions>
        <JavaScriptFunction Library="$webresource:sprk_DocumentOperations.js" FunctionName="Spaarke.Document.openInDesktop">
          <CrmParameter Value="PrimaryControl" />
        </JavaScriptFunction>
      </Actions>
    </CommandDefinition>
    <!-- Document Download Command (always enabled) -->
    <CommandDefinition Id="sprk.Document.Download.Command">
      <EnableRules>
        <EnableRule Id="sprk.Document.Download.EnableRule" />
      </EnableRules>
      <DisplayRules>
        <DisplayRule Id="sprk.Document.Form.DisplayRule" />
      </DisplayRules>
      <Actions>
        <JavaScriptFunction Library="$webresource:sprk_DocumentOperations.js" FunctionName="Spaarke.Document.downloadDocument">
          <CrmParameter Value="PrimaryControl" />
        </JavaScriptFunction>
      </Actions>
    </CommandDefinition>
    <!-- Send to Index Command - Form Context -->
    <CommandDefinition Id="sprk.Document.SendToIndex.Form.Command">
      <EnableRules>
        <EnableRule Id="sprk.Document.SendToIndex.Form.EnableRule" />
      </EnableRules>
      <DisplayRules>
        <DisplayRule Id="sprk.Document.Form.DisplayRule" />
      </DisplayRules>
      <Actions>
        <JavaScriptFunction Library="$webresource:sprk_DocumentOperations.js" FunctionName="Spaarke.Document.sendToIndex">
          <CrmParameter Value="PrimaryControl" />
        </JavaScriptFunction>
      </Actions>
    </CommandDefinition>
    <!-- Send to Index Command - Grid Context -->
    <CommandDefinition Id="sprk.Document.SendToIndex.Grid.Command">
      <EnableRules>
        <EnableRule Id="sprk.Document.SendToIndex.Grid.EnableRule" />
      </EnableRules>
      <DisplayRules />
      <Actions>
        <JavaScriptFunction Library="$webresource:sprk_DocumentOperations.js" FunctionName="Spaarke.Document.sendToIndex">
          <CrmParameter Value="SelectedControl" />
          <CrmParameter Value="SelectedControlSelectedItemIds" />
        </JavaScriptFunction>
      </Actions>
    </CommandDefinition>
    <!-- Send to Index Command - Subgrid Context -->
    <CommandDefinition Id="sprk.Document.SendToIndex.Subgrid.Command">
      <EnableRules>
        <EnableRule Id="sprk.Document.SendToIndex.Subgrid.EnableRule" />
      </EnableRules>
      <DisplayRules />
      <Actions>
        <JavaScriptFunction Library="$webresource:sprk_DocumentOperations.js" FunctionName="Spaarke.Document.sendToIndex">
          <CrmParameter Value="SelectedControl" />
          <CrmParameter Value="SelectedControlSelectedItemIds" />
        </JavaScriptFunction>
      </Actions>
    </CommandDefinition>
  </CommandDefinitions>
  <RuleDefinitions>
    <TabDisplayRules />
    <DisplayRules>
      <!-- Show buttons only on form (existing records, not new records) -->
      <DisplayRule Id="sprk.Document.Form.DisplayRule">
        <FormStateRule State="Existing" />
      </DisplayRule>
    </DisplayRules>
    <EnableRules>
      <EnableRule Id="Spaarke.Document.AddMultiple.EnableRule">
        <CrmClientTypeRule Type="Web" />
      </EnableRule>
      <EnableRule Id="sprk.ThemeMenu.EnableRule">
        <CustomRule FunctionName="Spaarke.Theme.isEnabled" Library="$webresource:sprk_ThemeMenu.js" Default="true" />
      </EnableRule>
      <!-- Checkout: enabled when document is NOT checked out -->
      <EnableRule Id="sprk.Document.Checkout.EnableRule">
        <CustomRule FunctionName="Spaarke.Document.canCheckout" Library="$webresource:sprk_DocumentOperations.js" Default="true" />
      </EnableRule>
      <!-- Checkin: enabled when document is checked out BY current user -->
      <EnableRule Id="sprk.Document.Checkin.EnableRule">
        <CustomRule FunctionName="Spaarke.Document.canCheckin" Library="$webresource:sprk_DocumentOperations.js" Default="false" />
      </EnableRule>
      <!-- Discard: enabled when document is checked out BY current user -->
      <EnableRule Id="sprk.Document.Discard.EnableRule">
        <CustomRule FunctionName="Spaarke.Document.canDiscard" Library="$webresource:sprk_DocumentOperations.js" Default="false" />
      </EnableRule>
      <!-- Delete: enabled when document is NOT checked out -->
      <EnableRule Id="sprk.Document.Delete.EnableRule">
        <CustomRule FunctionName="Spaarke.Document.canDelete" Library="$webresource:sprk_DocumentOperations.js" Default="true" />
      </EnableRule>
      <!-- Refresh: always enabled -->
      <EnableRule Id="sprk.Document.Refresh.EnableRule">
        <CustomRule FunctionName="Spaarke.Document.canRefresh" Library="$webresource:sprk_DocumentOperations.js" Default="true" />
      </EnableRule>
      <!-- Open in Web: enabled for Office file types only -->
      <EnableRule Id="sprk.Document.OpenInWeb.EnableRule">
        <CustomRule FunctionName="Spaarke.Document.canOpenInWeb" Library="$webresource:sprk_DocumentOperations.js" Default="false" />
      </EnableRule>
      <!-- Open in Desktop: enabled for Office file types only -->
      <EnableRule Id="sprk.Document.OpenInDesktop.EnableRule">
        <CustomRule FunctionName="Spaarke.Document.canOpenInDesktop" Library="$webresource:sprk_DocumentOperations.js" Default="false" />
      </EnableRule>
      <!-- Download: always enabled -->
      <EnableRule Id="sprk.Document.Download.EnableRule">
        <CustomRule FunctionName="Spaarke.Document.canDownload" Library="$webresource:sprk_DocumentOperations.js" Default="true" />
      </EnableRule>
      <!-- Send to Index (Form): enabled when document has a file -->
      <EnableRule Id="sprk.Document.SendToIndex.Form.EnableRule">
        <CustomRule FunctionName="Spaarke.Document.canSendToIndex" Library="$webresource:sprk_DocumentOperations.js" Default="true" />
      </EnableRule>
      <!-- Send to Index (Grid): enabled when records are selected -->
      <EnableRule Id="sprk.Document.SendToIndex.Grid.EnableRule">
        <SelectionCountRule AppliesTo="SelectedEntity" Minimum="1" Maximum="100" />
      </EnableRule>
      <!-- Send to Index (Subgrid): enabled when records are selected -->
      <EnableRule Id="sprk.Document.SendToIndex.Subgrid.EnableRule">
        <SelectionCountRule AppliesTo="SelectedEntity" Minimum="1" Maximum="100" />
      </EnableRule>
    </EnableRules>
  </RuleDefinitions>
  <LocLabels>
    <LocLabel Id="Spaarke.Document.AddMultiple.Button.Alt">
      <Titles>
        <Title description="Quick Create: Document" languagecode="1033" />
      </Titles>
    </LocLabel>
    <LocLabel Id="Spaarke.Document.AddMultiple.Button.LabelText">
      <Titles>
        <Title description="Quick Create: Document" languagecode="1033" />
      </Titles>
    </LocLabel>
    <LocLabel Id="Spaarke.Document.AddMultiple.Button.ToolTipDescription">
      <Titles>
        <Title description="Upload multiple documents to SharePoint Embedded and create Document records" languagecode="1033" />
      </Titles>
    </LocLabel>
    <LocLabel Id="Spaarke.Document.AddMultiple.Button.ToolTipTitle">
      <Titles>
        <Title description="Quick Create: Document" languagecode="1033" />
      </Titles>
    </LocLabel>
    <!-- Checkout Labels -->
    <LocLabel Id="sprk.Document.Checkout.LabelText">
      <Titles>
        <Title description="Check Out" languagecode="1033" />
      </Titles>
    </LocLabel>
    <LocLabel Id="sprk.Document.Checkout.ToolTipTitle">
      <Titles>
        <Title description="Check Out Document" languagecode="1033" />
      </Titles>
    </LocLabel>
    <LocLabel Id="sprk.Document.Checkout.ToolTipDescription">
      <Titles>
        <Title description="Lock this document for editing. Other users will not be able to edit until you check it in." languagecode="1033" />
      </Titles>
    </LocLabel>
    <!-- Checkin Labels -->
    <LocLabel Id="sprk.Document.Checkin.LabelText">
      <Titles>
        <Title description="Check In" languagecode="1033" />
      </Titles>
    </LocLabel>
    <LocLabel Id="sprk.Document.Checkin.ToolTipTitle">
      <Titles>
        <Title description="Check In Document" languagecode="1033" />
      </Titles>
    </LocLabel>
    <LocLabel Id="sprk.Document.Checkin.ToolTipDescription">
      <Titles>
        <Title description="Save your changes and unlock the document for other users to edit." languagecode="1033" />
      </Titles>
    </LocLabel>
    <!-- Discard Labels -->
    <LocLabel Id="sprk.Document.Discard.LabelText">
      <Titles>
        <Title description="Discard Checkout" languagecode="1033" />
      </Titles>
    </LocLabel>
    <LocLabel Id="sprk.Document.Discard.ToolTipTitle">
      <Titles>
        <Title description="Discard Checkout" languagecode="1033" />
      </Titles>
    </LocLabel>
    <LocLabel Id="sprk.Document.Discard.ToolTipDescription">
      <Titles>
        <Title description="Discard your changes and unlock the document. The document will be restored to its previous state." languagecode="1033" />
      </Titles>
    </LocLabel>
    <!-- Delete Labels -->
    <LocLabel Id="sprk.Document.Delete.LabelText">
      <Titles>
        <Title description="Delete" languagecode="1033" />
      </Titles>
    </LocLabel>
    <LocLabel Id="sprk.Document.Delete.ToolTipTitle">
      <Titles>
        <Title description="Delete Document" languagecode="1033" />
      </Titles>
    </LocLabel>
    <LocLabel Id="sprk.Document.Delete.ToolTipDescription">
      <Titles>
        <Title description="Permanently delete this document and its file from storage. This action cannot be undone." languagecode="1033" />
      </Titles>
    </LocLabel>
    <!-- Refresh Labels -->
    <LocLabel Id="sprk.Document.Refresh.LabelText">
      <Titles>
        <Title description="Refresh" languagecode="1033" />
      </Titles>
    </LocLabel>
    <LocLabel Id="sprk.Document.Refresh.ToolTipTitle">
      <Titles>
        <Title description="Refresh Document" languagecode="1033" />
      </Titles>
    </LocLabel>
    <LocLabel Id="sprk.Document.Refresh.ToolTipDescription">
      <Titles>
        <Title description="Refresh the form to show the latest document data and checkout status." languagecode="1033" />
      </Titles>
    </LocLabel>
    <!-- Open in Web Labels -->
    <LocLabel Id="sprk.Document.OpenInWeb.LabelText">
      <Titles>
        <Title description="Open in Web" languagecode="1033" />
      </Titles>
    </LocLabel>
    <LocLabel Id="sprk.Document.OpenInWeb.ToolTipTitle">
      <Titles>
        <Title description="Open in Office Online" languagecode="1033" />
      </Titles>
    </LocLabel>
    <LocLabel Id="sprk.Document.OpenInWeb.ToolTipDescription">
      <Titles>
        <Title description="Open this document in Office Online in a new browser tab." languagecode="1033" />
      </Titles>
    </LocLabel>
    <!-- Open in Desktop Labels -->
    <LocLabel Id="sprk.Document.OpenInDesktop.LabelText">
      <Titles>
        <Title description="Open in Desktop" languagecode="1033" />
      </Titles>
    </LocLabel>
    <LocLabel Id="sprk.Document.OpenInDesktop.ToolTipTitle">
      <Titles>
        <Title description="Open in Desktop Application" languagecode="1033" />
      </Titles>
    </LocLabel>
    <LocLabel Id="sprk.Document.OpenInDesktop.ToolTipDescription">
      <Titles>
        <Title description="Open this document in the desktop application (Word, Excel, or PowerPoint)." languagecode="1033" />
      </Titles>
    </LocLabel>
    <!-- Download Labels -->
    <LocLabel Id="sprk.Document.Download.LabelText">
      <Titles>
        <Title description="Download" languagecode="1033" />
      </Titles>
    </LocLabel>
    <LocLabel Id="sprk.Document.Download.ToolTipTitle">
      <Titles>
        <Title description="Download Document" languagecode="1033" />
      </Titles>
    </LocLabel>
    <LocLabel Id="sprk.Document.Download.ToolTipDescription">
      <Titles>
        <Title description="Download a copy of this document to your local computer." languagecode="1033" />
      </Titles>
    </LocLabel>
    <!-- Send to Index Labels -->
    <LocLabel Id="sprk.Document.SendToIndex.LabelText">
      <Titles>
        <Title description="Send to Index" languagecode="1033" />
      </Titles>
    </LocLabel>
    <LocLabel Id="sprk.Document.SendToIndex.ToolTipTitle">
      <Titles>
        <Title description="Send to Search Index" languagecode="1033" />
      </Titles>
    </LocLabel>
    <LocLabel Id="sprk.Document.SendToIndex.ToolTipDescription">
      <Titles>
        <Title description="Index this document for semantic search. The document will be searchable using AI-powered search queries." languagecode="1033" />
      </Titles>
    </LocLabel>
  </LocLabels>
</RibbonDiffXml>